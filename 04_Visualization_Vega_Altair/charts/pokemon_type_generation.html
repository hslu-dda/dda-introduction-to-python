<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript">
    // vega-embed.js bundle with Vega-Lite version v5.20.1
    const n=/("(?:[^\\"]|\\.)*")|[:,]/g;function t(t1,e={}){const o=JSON.stringify([1],void 0,void 0===e.indent?2:e.indent).slice(2,-3),i=""===o?1/0:void 0===e.maxLength?80:e.maxLength;let{replacer:r}=e;return function t(e,l,s){e&&"function"==typeof e.toJSON&&(e=e.toJSON());const c=JSON.stringify(e,r);if(void 0===c)return c;const f=i-l.length-s;if(c.length<=f){const t=c.replace(n,(n,t)=>t||`${n} `);if(t.length<=f)return t;}if(null!=r&&(e=JSON.parse(c),r=void 0),"object"==typeof e&&null!==e){const n=l+o,i=[];let r,s,c=0;if(Array.isArray(e)){r="[",s="]";const{length:o}=e;for(;c<o;c++)i.push(t(e[c],n,c===o-1?0:1)||"null");}else{r="{",s="}";const o=Object.keys(e),{length:l}=o;for(;c<l;c++){const r=o[c],s=`${JSON.stringify(r)}: `,f=t(e[r],n,s.length+(c===l-1?0:1));void 0!==f&&i.push(s+f);}}if(i.length>0)return[r,o+i.join(`,
${n}`),s].join(`
${l}`);}return c;}(t1,"",0);}function n1(n,t,e){return n.fields=t||[],n.fname=e,n;}function t1(n){return null==n?null:n.fname;}function e(n){return null==n?null:n.fields;}function r(n){return 1===n.length?u(n[0]):o(n);}const u=n=>function(t){return t[n];},o=n=>{const t=n.length;return function(e){for(let r=0;r<t;++r)e=e[n[r]];return e;};};function l(n){throw Error(n);}function c(n){const t=[],e=n.length;let r,u,o,c=null,i=0,f="";function s(){t.push(f+n.substring(r,u)),f="",r=u+1;}for(n+="",r=u=0;u<e;++u)if(o=n[u],"\\"===o)f+=n.substring(r,u++),r=u;else if(o===c)s(),c=null,i=-1;else{if(c)continue;r===i&&'"'===o||r===i&&"'"===o?(r=u+1,c=o):"."!==o||i?"["===o?(u>r&&s(),i=r=u+1):"]"===o&&(i||l("Access path missing open bracket: "+n),i>0&&s(),i=0,r=u+1):u>r?s():r=u+1;}return i&&l("Access path missing closing bracket: "+n),c&&l("Access path missing closing quote: "+n),u>r&&(u++,s()),t;}function i(t,e,u){const o=c(t);return t=1===o.length?o[0]:t,n1((u&&u.get||r)(o),[t],e||t);}const f=i("id"),s=n1(n=>n,[],"identity"),a=n1(()=>0,[],"zero"),h=n1(()=>1,[],"one"),g=n1(()=>!0,[],"true"),p=n1(()=>!1,[],"false");function b(n,t,e){const r=[t].concat([].slice.call(e));console[n].apply(console,r);}function O(n,t){let e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,r=n||0;return{level(n){return arguments.length?(r=+n,this):r;},error(){return r>=1&&e(t||"error","ERROR",arguments),this;},warn(){return r>=2&&e(t||"warn","WARN",arguments),this;},info(){return r>=3&&e(t||"log","INFO",arguments),this;},debug(){return r>=4&&e(t||"log","DEBUG",arguments),this;}};}var w=Array.isArray;function E(n){return n===Object(n);}const v=n=>"__proto__"!==n;function k(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];return t.reduce((n,t)=>{for(const e in t)if("signals"===e)n.signals=A(n.signals,t.signals);else{const r="legend"===e?{layout:1}:"style"===e||null;x(n,e,t[e],r);}return n;},{});}function x(n,t,e,r){if(!v(t))return;let u,o;if(E(e)&&!w(e))for(u in o=E(n[t])?n[t]:n[t]={},e)r&&(!0===r||r[u])?x(o,u,e[u]):v(u)&&(o[u]=e[u]);else n[t]=e;}function A(n,t){if(null==n)return t;const e={},r=[];function u(n){e[n.name]||(e[n.name]=1,r.push(n));}return t.forEach(u),n.forEach(u),r;}function D(n){return n[n.length-1];}function z(n){return null==n||""===n?null:+n;}const R=n=>t=>n*Math.exp(t),S=n=>t=>Math.log(n*t),_=n=>t=>Math.sign(t)*Math.log1p(Math.abs(t/n)),N=n=>t=>Math.sign(t)*Math.expm1(Math.abs(t))*n,T=n=>t=>t<0?-Math.pow(-t,n):Math.pow(t,n);function P(n,t,e,r){const u=e(n[0]),o=e(D(n)),l=(o-u)*t;return[r(u-l),r(o-l)];}function U(n,t){return P(n,t,z,s);}function q(n,t){var e=Math.sign(n[0]);return P(n,t,S(e),R(e));}function B(n,t,e){return P(n,t,T(e),T(1/e));}function C(n,t,e){return P(n,t,_(e),N(e));}function F(n,t,e,r,u){const o=r(n[0]),l=r(D(n)),c=null!=t?r(t):(o+l)/2;return[u(c+(o-c)*e),u(c+(l-c)*e)];}function G(n,t,e){return F(n,t,e,z,s);}function I(n,t,e){const r=Math.sign(n[0]);return F(n,t,e,S(r),R(r));}function J(n,t,e,r){return F(n,t,e,T(r),T(1/r));}function V(n,t,e,r){return F(n,t,e,_(r),N(r));}function W(n){return 1+~~(new Date(n).getMonth()/3);}function $(n){return 1+~~(new Date(n).getUTCMonth()/3);}function H(n){return null!=n?w(n)?n:[n]:[];}function K(n,t,e){let r,u=n[0],o=n[1];return o<u&&(r=o,o=u,u=r),r=o-u,r>=e-t?[t,e]:[u=Math.min(Math.max(u,t),e-r),u+r];}function L(n){return"function"==typeof n;}function Q(t,r,u){u=u||{},r=H(r)||[];const o=[],l=[],c={},f=u.comparator||Y;return H(t).forEach((n,t)=>{null!=n&&(o.push("descending"===r[t]?-1:1),l.push(n=L(n)?n:i(n,null,u)),(e(n)||[]).forEach(n=>c[n]=1));}),0===l.length?null:n1(f(l,o),Object.keys(c));}const X=(n,t)=>(n<t||null==n)&&null!=t?-1:(n>t||null==t)&&null!=n?1:(t=t instanceof Date?+t:t,(n=n instanceof Date?+n:n)!==n&&t==t?-1:t!=t&&n==n?1:0),Y=(n,t)=>1===n.length?Z(n[0],t[0]):nn(n,t,n.length),Z=(n,t)=>function(e,r){return X(n(e),n(r))*t;},nn=(n,t,e)=>(t.push(0),function(r,u){let o,l=0,c=-1;for(;0===l&&++c<e;)o=n[c],l=X(o(r),o(u));return l*t[c];});function tn(n){return L(n)?n:()=>n;}function en(n,t){let e;return r=>{e&&clearTimeout(e),e=setTimeout(()=>(t(r),e=null),n);};}function rn(n){for(let t,e,r=1,u=arguments.length;r<u;++r)for(e in t=arguments[r],t)n[e]=t[e];return n;}function un(n,t){let e,r,u,o,l=0;if(n&&(e=n.length))if(null==t){for(r=n[l];l<e&&(null==r||r!=r);r=n[++l]);for(u=o=r;l<e;++l)r=n[l],null!=r&&(r<u&&(u=r),r>o&&(o=r));}else{for(r=t(n[l]);l<e&&(null==r||r!=r);r=t(n[++l]));for(u=o=r;l<e;++l)r=t(n[l]),null!=r&&(r<u&&(u=r),r>o&&(o=r));}return[u,o];}function on(n,t){const e=n.length;let r,u,o,l,c,i=-1;if(null==t){for(;++i<e;)if(u=n[i],null!=u&&u>=u){r=o=u;break;}if(i===e)return[-1,-1];for(l=c=i;++i<e;)u=n[i],null!=u&&(r>u&&(r=u,l=i),o<u&&(o=u,c=i));}else{for(;++i<e;)if(u=t(n[i],i,n),null!=u&&u>=u){r=o=u;break;}if(i===e)return[-1,-1];for(l=c=i;++i<e;)u=t(n[i],i,n),null!=u&&(r>u&&(r=u,l=i),o<u&&(o=u,c=i));}return[l,c];}function ln(n,t){return Object.hasOwn(n,t);}const cn={};function fn(n){let t,e={};function r(n){return ln(e,n)&&e[n]!==cn;}const u={size:0,empty:0,object:e,has:r,get:n=>r(n)?e[n]:void 0,set(n,t){return r(n)||(++u.size,e[n]===cn&&--u.empty),e[n]=t,this;},delete(n){return r(n)&&(--u.size,++u.empty,e[n]=cn),this;},clear(){u.size=u.empty=0,u.object=e={};},test(n){return arguments.length?(t=n,u):t;},clean(){const n={};let r=0;for(const u in e){const o=e[u];o===cn||t&&t(o)||(n[u]=o,++r);}u.size=r,u.empty=0,u.object=e=n;}};return n&&Object.keys(n).forEach(t=>{u.set(t,n[t]);}),u;}function sn(n,t,e,r,u,o){if(!e&&0!==e)return o;const l=+e;let c,i=n[0],f=D(n);f<i&&(c=i,i=f,f=c),c=Math.abs(t-i);const s=Math.abs(f-t);return c<s&&c<=l?r:s<=l?u:o;}function an(n,t,e){const r=n.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:n,writable:!0,enumerable:!0,configurable:!0}),rn(r,e);}function hn(n,t,e,r){let u,o=t[0],l=t[t.length-1];return o>l&&(u=o,o=l,l=u),r=void 0===r||r,((e=void 0===e||e)?o<=n:o<n)&&(r?n<=l:n<l);}function gn(n){return"boolean"==typeof n;}function pn(n){return"[object Date]"===Object.prototype.toString.call(n);}function bn(n){return n&&L(n[Symbol.iterator]);}function yn(n){return"number"==typeof n;}function mn(n){return"[object RegExp]"===Object.prototype.toString.call(n);}function Mn(n){return"string"==typeof n;}function dn(t,e,u){t&&(t=e?H(t).map(n=>n.replace(/\\(.)/g,"$1")):H(t));const o=t&&t.length,l=u&&u.get||r,i=n=>l(e?[n]:c(n));let f;if(o)if(1===o){const n=i(t[0]);f=function(t){return""+n(t);};}else{const n=t.map(i);f=function(t){let e=""+n[0](t),r=0;for(;++r<o;)e+="|"+n[r](t);return e;};}else f=function(){return"";};return n1(f,t,"key");}function jn(n,t){const e=n[0],r=D(n),u=+t;return u?1===u?r:e+u*(r-e):e;}function On(n){let t,e,r;n=+n||1e4;const u=()=>{t={},e={},r=0;},o=(u,o)=>(++r>n&&(e=t,t={},r=1),t[u]=o);return u(),{clear:u,has:n=>ln(t,n)||ln(e,n),get:n=>ln(t,n)?t[n]:ln(e,n)?o(n,e[n]):void 0,set:(n,e)=>ln(t,n)?t[n]=e:o(n,e)};}function wn(n,t,e,r){const u=t.length,o=e.length;if(!o)return t;if(!u)return e;const l=r||new t.constructor(u+o);let c=0,i=0,f=0;for(;c<u&&i<o;++f)l[f]=n(t[c],e[i])>0?e[i++]:t[c++];for(;c<u;++c,++f)l[f]=t[c];for(;i<o;++i,++f)l[f]=e[i];return l;}function En(n,t){let e="";for(;--t>=0;)e+=n;return e;}function vn(n,t,e,r){const u=e||" ",o=n+"",l=t-o.length;return l<=0?o:"left"===r?En(u,l)+o:"center"===r?En(u,~~(l/2))+o+En(u,Math.ceil(l/2)):o+En(u,l);}function kn(n){return n&&D(n)-n[0]||0;}function xn(n){return w(n)?"["+n.map(xn)+"]":E(n)||Mn(n)?JSON.stringify(n).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):n;}function An(n){return null==n||""===n?null:!(!n||"false"===n||"0"===n)&&!!n;}const Dn=n=>yn(n)||pn(n)?n:Date.parse(n);function zn(n,t){return t=t||Dn,null==n||""===n?null:t(n);}function Rn(n){return null==n||""===n?null:n+"";}function Sn(n){const t={},e=n.length;for(let r=0;r<e;++r)t[n[r]]=!0;return t;}function _n(n,t,e,r){const u=null!=r?r:"â€¦",o=n+"",l=o.length,c=Math.max(0,t-u.length);return l<=t?o:"left"===e?u+o.slice(l-c):"center"===e?o.slice(0,Math.ceil(c/2))+u+o.slice(l-~~(c/2)):o.slice(0,c)+u;}function Nn(n,t,e){if(n)if(t){const r=n.length;for(let u=0;u<r;++u){const r=t(n[u]);r&&e(r,u,n);}}else n.forEach(e);}var r1={},n2={};function t2(r){return new Function("d","return {"+r.map(function(r,n){return JSON.stringify(r)+": d["+n+'] || ""';}).join(",")+"}");}function e1(r){var n=Object.create(null),t=[];return r.forEach(function(r){for(var e in r)e in n||t.push(n[e]=e);}),t;}function o1(r,n){var t=r+"",e=t.length;return e<n?new Array(n-e+1).join(0)+t:t;}function a1(r){var n,t=r.getUTCHours(),e=r.getUTCMinutes(),a=r.getUTCSeconds(),u=r.getUTCMilliseconds();return isNaN(r)?"Invalid Date":((n=r.getUTCFullYear())<0?"-"+o1(-n,6):n>9999?"+"+o1(n,6):o1(n,4))+"-"+o1(r.getUTCMonth()+1,2)+"-"+o1(r.getUTCDate(),2)+(u?"T"+o1(t,2)+":"+o1(e,2)+":"+o1(a,2)+"."+o1(u,3)+"Z":a?"T"+o1(t,2)+":"+o1(e,2)+":"+o1(a,2)+"Z":e||t?"T"+o1(t,2)+":"+o1(e,2)+"Z":"");}function u1(o){var u=new RegExp('["'+o+"\n\r]"),i=o.charCodeAt(0);function f(t,e){var o,a=[],u=t.length,f=0,c=0,s=u<=0,l=!1;function d(){if(s)return n2;if(l)return l=!1,r1;var e,o,a=f;if(34===t.charCodeAt(a)){for(;f++<u&&34!==t.charCodeAt(f)||34===t.charCodeAt(++f););return(e=f)>=u?s=!0:10===(o=t.charCodeAt(f++))?l=!0:13===o&&(l=!0,10===t.charCodeAt(f)&&++f),t.slice(a+1,e-1).replace(/""/g,'"');}for(;f<u;){if(10===(o=t.charCodeAt(e=f++)))l=!0;else if(13===o)l=!0,10===t.charCodeAt(f)&&++f;else if(o!==i)continue;return t.slice(a,e);}return s=!0,t.slice(a,u);}for(10===t.charCodeAt(u-1)&&--u,13===t.charCodeAt(u-1)&&--u;(o=d())!==n2;){for(var m=[];o!==r1&&o!==n2;)m.push(o),o=d();e&&null==(m=e(m,c++))||a.push(m);}return a;}function c(r,n){return r.map(function(r){return n.map(function(n){return l(r[n]);}).join(o);});}function s(r){return r.map(l).join(o);}function l(r){return null==r?"":r instanceof Date?a1(r):u.test(r+="")?'"'+r.replace(/"/g,'""')+'"':r;}return{parse:function(r,n){var e,o,a=f(r,function(r,a){if(e)return e(r,a-1);o=r,e=n?function(r,n){var e=t2(r);return function(t,o){return n(e(t),o,r);};}(r,n):t2(r);});return a.columns=o||[],a;},parseRows:f,format:function(r,n){return null==n&&(n=e1(r)),[n.map(l).join(o)].concat(c(r,n)).join("\n");},formatBody:function(r,n){return null==n&&(n=e1(r)),c(r,n).join("\n");},formatRows:function(r){return r.map(s).join("\n");},formatRow:s,formatValue:l};}var i1=u1(","),f1=i1.parse,c1=i1.parseRows,s1=i1.format,l1=i1.formatBody,d=i1.formatRows,m=i1.formatRow,p1=i1.formatValue,h1=u1("	"),C1=h1.parse,g1=h1.parseRows,v1=h1.format,w1=h1.formatBody,T1=h1.formatRows,A1=h1.formatRow,R1=h1.formatValue;new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function r2(r){return r;}function t3(t){if(null==t)return r2;var n,e,o=t.scale[0],a=t.scale[1],c=t.translate[0],i=t.translate[1];return function(r,t){t||(n=e=0);var u=2,f=r.length,s=new Array(f);for(s[0]=(n+=r[0])*o+c,s[1]=(e+=r[1])*a+i;u<f;)s[u]=r[u],++u;return s;};}function e2(r,t){return"string"==typeof t&&(t=r.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return o2(r,t);})}:o2(r,t);}function o2(r,t){var n=t.id,e=t.bbox,o=null==t.properties?{}:t.properties,c=a2(r,t);return null==n&&null==e?{type:"Feature",properties:o,geometry:c}:null==e?{type:"Feature",id:n,properties:o,geometry:c}:{type:"Feature",id:n,bbox:e,properties:o,geometry:c};}function a2(r,n){var e=t3(r.transform),o=r.arcs;function a(r,t){t.length&&t.pop();for(var n=o[r<0?~r:r],a=0,c=n.length;a<c;++a)t.push(e(n[a],a));r<0&&function(r,t){for(var n,e=r.length,o=e-t;o<--e;)n=r[o],r[o++]=r[e],r[e]=n;}(t,c);}function c(r){return e(r);}function i(r){for(var t=[],n=0,e=r.length;n<e;++n)a(r[n],t);return t.length<2&&t.push(t[0]),t;}function u(r){for(var t=i(r);t.length<4;)t.push(t[0]);return t;}function f(r){return r.map(u);}return function r(t){var n,e=t.type;switch(e){case"GeometryCollection":return{type:e,geometries:t.geometries.map(r)};case"Point":n=c(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(c);break;case"LineString":n=i(t.arcs);break;case"MultiLineString":n=t.arcs.map(i);break;case"Polygon":n=f(t.arcs);break;case"MultiPolygon":n=t.arcs.map(f);break;default:return null;}return{type:e,coordinates:n};}(n);}function c2(r,t){var n={},e={},o={},a=[],c=-1;function i(r,t){for(var e in r){var o=r[e];delete t[o.start],delete o.start,delete o.end,o.forEach(function(r){n[r<0?~r:r]=1;}),a.push(o);}}return t.forEach(function(n,e){var o,a=r.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(o=t[++c],t[c]=n,t[e]=o);}),t.forEach(function(t){var n,a,c=function(t){var n,e=r.arcs[t<0?~t:t],o=e[0];r.transform?(n=[0,0],e.forEach(function(r){n[0]+=r[0],n[1]+=r[1];})):n=e[e.length-1];return t<0?[n,o]:[o,n];}(t),i=c[0],u=c[1];if(n=o[i])if(delete o[n.end],n.push(t),n.end=u,a=e[u]){delete e[a.start];var f=a===n?n:n.concat(a);e[f.start=n.start]=o[f.end=a.end]=f;}else e[n.start]=o[n.end]=n;else if(n=e[u])if(delete e[n.start],n.unshift(t),n.start=i,a=o[i]){delete o[a.end];var s=a===n?n:a.concat(n);e[s.start=a.start]=o[s.end=n.end]=s;}else e[n.start]=o[n.end]=n;else e[(n=[t]).start=i]=o[n.end=u]=n;}),i(o,e),i(e,o),t.forEach(function(r){n[r<0?~r:r]||a.push([r]);}),a;}function i2(r){return a2(r,u2.apply(this,arguments));}function u2(r,t,n){var e,o,a;if(arguments.length>1)e=function(r,t,n){var e,o=[],a=[];function c(r){var t=r<0?~r:r;(a[t]||(a[t]=[])).push({i:r,g:e});}function i(r){r.forEach(c);}function u(r){r.forEach(i);}function f(r){r.forEach(u);}function s(r){switch(e=r,r.type){case"GeometryCollection":r.geometries.forEach(s);break;case"LineString":i(r.arcs);break;case"MultiLineString":case"Polygon":u(r.arcs);break;case"MultiPolygon":f(r.arcs);}}return s(t),a.forEach(null==n?function(r){o.push(r[0].i);}:function(r){n(r[0].g,r[r.length-1].g)&&o.push(r[0].i);}),o;}(0,t,n);else for(o=0,e=new Array(a=r.arcs.length);o<a;++o)e[o]=o;return{type:"MultiLineString",arcs:c2(r,e)};}class e3 extends Map{constructor(e,t=u3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,r]of e)this.set(t,r);}get(e){return super.get(r3(this,e));}has(e){return super.has(r3(this,e));}set(e,t){return super.set(n3(this,e),t);}delete(e){return super.delete(s2(this,e));}}class t4 extends Set{constructor(e,t=u3){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t);}has(e){return super.has(r3(this,e));}add(e){return super.add(n3(this,e));}delete(e){return super.delete(s2(this,e));}}function r3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r;}function n3({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r);}function s2({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r;}function u3(e){return null!==e&&"object"==typeof e?e.valueOf():e;}function r4(t,n){return null==t||null==n?NaN:t<n?-1:t>n?1:t>=n?0:NaN;}function o3(t,n){return null==t||null==n?NaN:n<t?-1:n>t?1:n>=t?0:NaN;}function e4(t){let n,e,i;function u(t,r,o=0,f=t.length){if(o<f){if(0!==n(r,r))return f;do{const n=o+f>>>1;e(t[n],r)<0?o=n+1:f=n;}while(o<f)}return o;}return 2!==t.length?(n=r4,e=(n,o)=>r4(t(n),o),i=(n,r)=>t(n)-r):(n=t===r4||t===o3?t:f2,e=t,i=t),{left:u,center:function(t,n,r=0,o=t.length){const e=u(t,n,r,o-1);return e>r&&i(t[e-1],n)>-i(t[e],n)?e-1:e;},right:function(t,r,o=0,f=t.length){if(o<f){if(0!==n(r,r))return f;do{const n=o+f>>>1;e(t[n],r)<=0?o=n+1:f=n;}while(o<f)}return o;}};}function f2(){return 0;}function i3(t){return null===t?NaN:+t;}const u4=e4(r4),l2=u4.right,c3=u4.left,a3=e4(i3).center;d1(M),d1(function(t){const n=M(t);return(t,r,o,e,f)=>{n(t,r,(o<<=2)+0,(e<<=2)+0,f<<=2),n(t,r,o+1,e+1,f),n(t,r,o+2,e+2,f),n(t,r,o+3,e+3,f);};});function d1(t){return function(n,r,o=r){if(!((r=+r)>=0))throw new RangeError("invalid rx");if(!((o=+o)>=0))throw new RangeError("invalid ry");let{data:e,width:f,height:i}=n;if(!((f=Math.floor(f))>=0))throw new RangeError("invalid width");if(!((i=Math.floor(void 0!==i?i:e.length/f))>=0))throw new RangeError("invalid height");if(!f||!i||!r&&!o)return n;const u=r&&t(r),l=o&&t(o),c=e.slice();return u&&l?(p2(u,c,e,f,i),p2(u,e,c,f,i),p2(u,c,e,f,i),m1(l,e,c,f,i),m1(l,c,e,f,i),m1(l,e,c,f,i)):u?(p2(u,e,c,f,i),p2(u,c,e,f,i),p2(u,e,c,f,i)):l&&(m1(l,e,c,f,i),m1(l,c,e,f,i),m1(l,e,c,f,i)),n;};}function p2(t,n,r,o,e){for(let f=0,i=o*e;f<i;)t(n,r,f,f+=o,1);}function m1(t,n,r,o,e){for(let f=0,i=o*e;f<o;++f)t(n,r,f,f+i,o);}function M(t){const n=Math.floor(t);if(n===t)return function(t){const n=2*t+1;return(r,o,e,f,i)=>{if(!((f-=i)>=e))return;let u=t*o[e];const l=i*t;for(let t=e,n=e+l;t<n;t+=i)u+=o[Math.min(f,t)];for(let t=e,c=f;t<=c;t+=i)u+=o[Math.min(f,t+l)],r[t]=u/n,u-=o[Math.max(e,t-l)];};}(t);const r=t-n,o=2*t+1;return(t,e,f,i,u)=>{if(!((i-=u)>=f))return;let l=n*e[f];const c=u*n,a=c+u;for(let t=f,n=f+c;t<n;t+=u)l+=e[Math.min(i,t)];for(let n=f,s=i;n<=s;n+=u)l+=e[Math.min(i,n+c)],t[n]=(l+r*(e[Math.max(f,n-a)]+e[Math.min(i,n+a)]))/o,l-=e[Math.max(f,n-c)];};}function N1(t,n){let r,o=0,e=0,f=0;if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(r=n-e,e+=r/++o,f+=r*(n-e));else{let i=-1;for(let u of t)null!=(u=n(u,++i,t))&&(u=+u)>=u&&(r=u-e,e+=r/++o,f+=r*(u-e));}if(o>1)return f/(o-1);}function E1(t,n){const r=N1(t,n);return r?Math.sqrt(r):r;}class F1{constructor(){this._partials=new Float64Array(32),this._n=0;}add(t){const n=this._partials;let r=0;for(let o=0;o<this._n&&o<32;o++){const e=n[o],f=t+e,i=Math.abs(t)<Math.abs(e)?t-(f-e):e-(f-t);i&&(n[r++]=i),t=f;}return n[r]=t,this._n=r+1,this;}valueOf(){const t=this._partials;let n,r,o,e=this._n,f=0;if(e>0){for(f=t[--e];e>0&&(n=f,r=t[--e],f=n+r,o=r-(f-n),!o););e>0&&(o<0&&t[e-1]<0||o>0&&t[e-1]>0)&&(r=2*o,n=f+r,r==n-f&&(f=n));}return f;}}function G1(t,n){return Array.from(n,n=>t[n]);}function J1(t=r4){if(t===r4)return K1;if("function"!=typeof t)throw new TypeError("compare is not a function");return(n,r)=>{const o=t(n,r);return o||0===o?o:(0===t(r,r))-(0===t(n,n));};}function K1(t,n){return(null==t||!(t>=t))-(null==n||!(n>=n))||(t<n?-1:t>n?1:0);}Array.prototype.slice;const W1=Math.sqrt(50),X1=Math.sqrt(10),Y1=Math.sqrt(2);function Z1(t,n,r){const o=(n-t)/Math.max(0,r),e=Math.floor(Math.log10(o)),f=o/Math.pow(10,e),i=f>=W1?10:f>=X1?5:f>=Y1?2:1;let u,l,c;return e<0?(c=Math.pow(10,-e)/i,u=Math.round(t*c),l=Math.round(n*c),u/c<t&&++u,l/c>n&&--l,c=-c):(c=Math.pow(10,e)*i,u=Math.round(t/c),l=Math.round(n/c),u*c<t&&++u,l*c>n&&--l),l<u&&.5<=r&&r<2?Z1(t,n,2*r):[u,l,c];}function $1(t,n,r){if(!((r=+r)>0))return[];if((t=+t)===(n=+n))return[t];const o=n<t,[e,f,i]=o?Z1(n,t,r):Z1(t,n,r);if(!(f>=e))return[];const u=f-e+1,l=new Array(u);if(o)if(i<0)for(let t=0;t<u;++t)l[t]=(f-t)/-i;else for(let t=0;t<u;++t)l[t]=(f-t)*i;else if(i<0)for(let t=0;t<u;++t)l[t]=(e+t)/-i;else for(let t=0;t<u;++t)l[t]=(e+t)*i;return l;}function tt(t,n,r){return Z1(t=+t,n=+n,r=+r)[2];}function nt(t,n,r){r=+r;const o=(n=+n)<(t=+t),e=o?tt(n,t,r):tt(t,n,r);return(o?-1:1)*(e<0?1/-e:e);}function ft(t,n){let r;if(void 0===n)for(const n of t)null!=n&&(r<n||void 0===r&&n>=n)&&(r=n);else{let o=-1;for(let e of t)null!=(e=n(e,++o,t))&&(r<e||void 0===r&&e>=e)&&(r=e);}return r;}function ut(t,n){let r;if(void 0===n)for(const n of t)null!=n&&(r>n||void 0===r&&n>=n)&&(r=n);else{let o=-1;for(let e of t)null!=(e=n(e,++o,t))&&(r>e||void 0===r&&e>=e)&&(r=e);}return r;}function ct(t,n,r=0,o=1/0,e){if(n=Math.floor(n),r=Math.floor(Math.max(0,r)),o=Math.floor(Math.min(t.length-1,o)),!(r<=n&&n<=o))return t;for(e=void 0===e?K1:J1(e);o>r;){if(o-r>600){const f=o-r+1,i=n-r+1,u=Math.log(f),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(f-l)/f)*(i-f/2<0?-1:1);ct(t,n,Math.max(r,Math.floor(n-i*l/f+c)),Math.min(o,Math.floor(n+(f-i)*l/f+c)),e);}const f=t[n];let i=r,u=o;for(at(t,r,n),e(t[o],f)>0&&at(t,r,o);i<u;){for(at(t,i,u),++i,--u;e(t[i],f)<0;)++i;for(;e(t[u],f)>0;)--u;}0===e(t[r],f)?at(t,r,u):(++u,at(t,u,o)),u<=n&&(r=u+1),n<=u&&(o=u-1);}return t;}function at(t,n,r){const o=t[n];t[n]=t[r],t[r]=o;}function ht(t,n,r){if(t=Float64Array.from(function*(t,n){if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let r=-1;for(let o of t)null!=(o=n(o,++r,t))&&(o=+o)>=o&&(yield o);}}(t,r)),(o=t.length)&&!isNaN(n=+n)){if(n<=0||o<2)return ut(t);if(n>=1)return ft(t);var o,e=(o-1)*n,f=Math.floor(e),i=ft(ct(t,f).subarray(0,f+1));return i+(ut(t.subarray(f+1))-i)*(e-f);}}function yt(t,n,r=i3){if((o=t.length)&&!isNaN(n=+n)){if(n<=0||o<2)return+r(t[0],0,t);if(n>=1)return+r(t[o-1],o-1,t);var o,e=(o-1)*n,f=Math.floor(e),u=+r(t[f],f,t);return u+(+r(t[f+1],f+1,t)-u)*(e-f);}}function Mt(t,n){let r=0,o=0;if(void 0===n)for(let n of t)null!=n&&(n=+n)>=n&&(++r,o+=n);else{let e=-1;for(let f of t)null!=(f=n(f,++e,t))&&(f=+f)>=f&&(++r,o+=f);}if(r)return o/r;}function vt(t,n){return ht(t,.5,n);}function gt(t){return Array.from(function*(t){for(const n of t)yield*n;}(t));}function Nt(t,n,r){t=+t,n=+n,r=(e=arguments.length)<2?(n=t,t=0,1):e<3?1:+r;for(var o=-1,e=0|Math.max(0,Math.ceil((n-t)/r)),f=new Array(e);++o<e;)f[o]=t+o*r;return f;}qt(Math.random);function qt(t){return function(n,r=0,o=n.length){let e=o-(r=+r);for(;e;){const o=t()*e--|0,f=n[e+r];n[e+r]=n[o+r],n[o+r]=f;}return n;};}function jt(t,n){let r=0;if(void 0===n)for(let n of t)(n=+n)&&(r+=n);else{let o=-1;for(let e of t)(e=+n(e,++o,t))&&(r+=e);}return r;}function Jt(t,...r){t=new t4(t),r=r.map(Kt);t:for(const n of t)for(const o of r)if(!o.has(n)){t.delete(n);continue t;}return t;}function Kt(t){return t instanceof t4?t:new t4(t);}function Wt(...t){const r=new t4;for(const n of t)for(const t of n)r.add(t);return r;}function t5(t,i){if((n=(t=i?t.toExponential(i-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)];}function i4(i){return(i=t5(Math.abs(i)))?i[1]:NaN;}var n4,r5=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function e5(t){if(!(i=r5.exec(t)))throw new Error("invalid format: "+t);var i;return new o4({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]});}function o4(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+"";}function a4(i,n){var r=t5(i,n);if(!r)return i+"";var e=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+e:e.length>o+1?e.slice(0,o+1)+"."+e.slice(o+1):e+new Array(o-e.length+2).join("0");}e5.prototype=o4.prototype,o4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type;};var s3={"%":(t,i)=>(100*t).toFixed(i),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10);},e:(t,i)=>t.toExponential(i),f:(t,i)=>t.toFixed(i),g:(t,i)=>t.toPrecision(i),o:t=>Math.round(t).toString(8),p:(t,i)=>a4(100*t,i),r:a4,s:function(i,r){var e=t5(i,r);if(!e)return i+"";var o=e[0],a=e[1],s=a-(n4=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,h=o.length;return s===h?o:s>h?o+new Array(s-h+1).join("0"):s>0?o.slice(0,s)+"."+o.slice(s):"0."+new Array(1-s).join("0")+t5(i,Math.max(0,r+s-1))[0];},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function h2(t){return t;}var c4,l3,u5,f3=Array.prototype.map,m2=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function d2(t){var r,o,a=void 0===t.grouping||void 0===t.thousands?h2:(r=f3.call(t.grouping,Number),o=t.thousands+"",function(t,i){for(var n=t.length,e=[],a=0,s=r[0],h=0;n>0&&s>0&&(h+s+1>i&&(s=Math.max(1,i-h)),e.push(t.substring(n-=s,n+s)),!((h+=s+1)>i));)s=r[a=(a+1)%r.length];return e.reverse().join(o);}),c=void 0===t.currency?"":t.currency[0]+"",l=void 0===t.currency?"":t.currency[1]+"",u=void 0===t.decimal?".":t.decimal+"",d=void 0===t.numerals?h2:function(t){return function(i){return i.replace(/[0-9]/g,function(i){return t[+i];});};}(f3.call(t.numerals,String)),g=void 0===t.percent?"%":t.percent+"",p=void 0===t.minus?"âˆ’":t.minus+"",v=void 0===t.nan?"NaN":t.nan+"";function M(t){var i=(t=e5(t)).fill,r=t.align,o=t.sign,h=t.symbol,f=t.zero,M=t.width,y=t.comma,x=t.precision,b=t.trim,w=t.type;"n"===w?(y=!0,w="g"):s3[w]||(void 0===x&&(x=12),b=!0,w="g"),(f||"0"===i&&"="===r)&&(f=!0,i="0",r="=");var S="$"===h?c:"#"===h&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",k="$"===h?l:/[%p]/.test(w)?g:"",z=s3[w],A=/[defgprs%]/.test(w);function N(t){var e,s,h,c=S,l=k;if("c"===w)l=z(t)+l,t="";else{var g=(t=+t)<0||1/t<0;if(t=isNaN(t)?v:z(Math.abs(t),x),b&&(t=function(t){t:for(var i,n=t.length,r=1,e=-1;r<n;++r)switch(t[r]){case".":e=i=r;break;case"0":0===e&&(e=r),i=r;break;default:if(!+t[r])break t;e>0&&(e=0);}return e>0?t.slice(0,e)+t.slice(i+1):t;}(t)),g&&0==+t&&"+"!==o&&(g=!1),c=(g?"("===o?o:p:"-"===o||"("===o?"":o)+c,l=("s"===w?m2[8+n4/3]:"")+l+(g&&"("===o?")":""),A){for(e=-1,s=t.length;++e<s;)if(48>(h=t.charCodeAt(e))||h>57){l=(46===h?u+t.slice(e+1):t.slice(e))+l,t=t.slice(0,e);break;}}}y&&!f&&(t=a(t,1/0));var N=c.length+t.length+l.length,j=N<M?new Array(M-N+1).join(i):"";switch(y&&f&&(t=a(j+t,j.length?M-l.length:1/0),j=""),r){case"<":t=c+t+l+j;break;case"=":t=c+j+t+l;break;case"^":t=j.slice(0,N=j.length>>1)+c+t+l+j.slice(N);break;default:t=j+c+t+l;}return d(t);}return x=void 0===x?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),N.toString=function(){return t+"";},N;}return{format:M,formatPrefix:function(t,n){var r=M(((t=e5(t)).type="f",t)),o=3*Math.max(-8,Math.min(8,Math.floor(i4(n)/3))),a=Math.pow(10,-o),s=m2[8+o/3];return function(t){return r(a*t)+s;};}};}function g2(t){return c4=d2(t),l3=c4.format,u5=c4.formatPrefix,c4;}function p3(t){return Math.max(0,-i4(Math.abs(t)));}function v2(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i4(n)/3)))-i4(Math.abs(t)));}function M1(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,i4(n)-i4(t))+1;}g2({thousands:",",grouping:[3],currency:["$",""]});const n5=new Date,s4=new Date;function r6(e,t,a,o){function l(t){return e(t=0===arguments.length?new Date:new Date(+t)),t;}return l.floor=t=>(e(t=new Date(+t)),t),l.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),l.round=e=>{const t=l(e),n=l.ceil(e);return e-t<n-e?t:n;},l.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),l.range=(n,s,r)=>{const a=[];if(n=l.ceil(n),r=null==r?1:Math.floor(r),!(n<s&&r>0))return a;let o;do{a.push(o=new Date(+n)),t(n,r),e(n);}while(o<n&&n<s)return a;},l.filter=n=>r6(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1);},(e,s)=>{if(e>=e)if(s<0)for(;++s<=0;)for(;t(e,-1),!n(e););else for(;--s>=0;)for(;t(e,1),!n(e););}),a&&(l.count=(t,r)=>(n5.setTime(+t),s4.setTime(+r),e(n5),e(s4),Math.floor(a(n5,s4))),l.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?l.filter(o?t=>o(t)%e==0:t=>l.count(0,t)%e==0):l:null)),l;}const a5=r6(()=>{},(e,t)=>{e.setTime(+e+t);},(e,t)=>t-e);a5.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?r6(t=>{t.setTime(Math.floor(t/e)*e);},(t,n)=>{t.setTime(+t+n*e);},(t,n)=>(n-t)/e):a5:null);const o5=a5.range,l4=1e3,g3=6e4,u6=36e5,i5=864e5,C2=r6(e=>{e.setTime(e-e.getMilliseconds());},(e,t)=>{e.setTime(+e+t*l4);},(e,t)=>(t-e)/l4,e=>e.getUTCSeconds()),U1=C2.range,M2=r6(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*l4);},(e,t)=>{e.setTime(+e+t*g3);},(e,t)=>(t-e)/g3,e=>e.getMinutes()),h3=M2.range,m3=r6(e=>{e.setUTCSeconds(0,0);},(e,t)=>{e.setTime(+e+t*g3);},(e,t)=>(t-e)/g3,e=>e.getUTCMinutes()),D1=m3.range,F2=r6(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*l4-e.getMinutes()*g3);},(e,t)=>{e.setTime(+e+t*u6);},(e,t)=>(t-e)/u6,e=>e.getHours()),Y2=F2.range,d3=r6(e=>{e.setUTCMinutes(0,0,0);},(e,t)=>{e.setTime(+e+t*u6);},(e,t)=>(t-e)/u6,e=>e.getUTCHours()),H1=d3.range,y=r6(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*g3)/i5,e=>e.getDate()-1),w2=y.range,v3=r6(e=>{e.setUTCHours(0,0,0,0);},(e,t)=>{e.setUTCDate(e.getUTCDate()+t);},(e,t)=>(t-e)/i5,e=>e.getUTCDate()-1),S1=v3.range,p4=r6(e=>{e.setUTCHours(0,0,0,0);},(e,t)=>{e.setUTCDate(e.getUTCDate()+t);},(e,t)=>(t-e)/i5,e=>Math.floor(e/i5)),k1=p4.range;function z1(e){return r6(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0);},(e,t)=>{e.setDate(e.getDate()+7*t);},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/6048e5);}const O1=z1(0),W2=z1(1),x1=z1(2),b1=z1(3),j=z1(4),q1=z1(5),A2=z1(6),B1=O1.range,E2=W2.range,G2=x1.range,I1=b1.range,J2=j.range,K2=q1.range,L1=A2.range;function N2(e){return r6(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0);},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t);},(e,t)=>(t-e)/6048e5);}const P1=N2(0),Q1=N2(1),R2=N2(2),V1=N2(3),X2=N2(4),Z2=N2(5),$2=N2(6),_1=P1.range,ee=Q1.range,te=R2.range,ne=V1.range,se=X2.range,re=Z2.range,ae=$2.range,oe=r6(e=>{e.setDate(1),e.setHours(0,0,0,0);},(e,t)=>{e.setMonth(e.getMonth()+t);},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth()),le=oe.range,ge=r6(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0);},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t);},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth()),ue=ge.range,ie=r6(e=>{e.setMonth(0,1),e.setHours(0,0,0,0);},(e,t)=>{e.setFullYear(e.getFullYear()+t);},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ie.every=e=>isFinite(e=Math.floor(e))&&e>0?r6(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0);},(t,n)=>{t.setFullYear(t.getFullYear()+n*e);}):null;const Te=ie.range,ce=r6(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t);},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ce.every=e=>isFinite(e=Math.floor(e))&&e>0?r6(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0);},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e);}):null;ce.range;function Ce(n,s,r,o,U,M){const h=[[C2,1,1e3],[C2,5,5e3],[C2,15,15e3],[C2,30,3e4],[M,1,6e4],[M,5,3e5],[M,15,9e5],[M,30,18e5],[U,1,36e5],[U,3,108e5],[U,6,216e5],[U,12,432e5],[o,1,864e5],[o,2,1728e5],[r,1,6048e5],[s,1,2592e6],[s,3,7776e6],[n,1,31536e6]];function m(s,r,o){const l=Math.abs(r-s)/o,g=e4(([,,e])=>e).right(h,l);if(g===h.length)return n.every(nt(s/31536e6,r/31536e6,o));if(0===g)return a5.every(Math.max(nt(s,r,o),1));const[u,i]=h[l/h[g-1][2]<h[g][2]/l?g-1:g];return u.every(i);}return[function(e,t,n){const s=t<e;s&&([e,t]=[t,e]);const r=n&&"function"==typeof n.range?n:m(e,t,n),a=r?r.range(e,+t+1):[];return s?a.reverse():a;},m];}const[Ue,Me]=Ce(ce,ge,P1,p4,d3,m3),[he,me]=Ce(ie,oe,O1,y,F2,M2);const b2="year",x2="quarter",H2="month",S2="week",j1="date",k2="day",q2="dayofyear",I2="hours",B2="minutes",E3="seconds",L2="milliseconds",Q2=[b2,x2,H2,S2,j1,k2,q2,I2,B2,E3,L2],W3=Q2.reduce((t,e,n)=>(t[e]=1+n,t),{});function z2(r){const o=H(r).slice(),u={};o.length||l("Missing time unit."),o.forEach(t=>{ln(W3,t)?u[t]=1:l(`Invalid time unit: ${t}.`);});return(u[S2]||u[k2]?1:0)+(u[x2]||u[H2]||u[j1]?1:0)+(u[q2]?1:0)>1&&l(`Incompatible time units: ${r}`),o.sort((t,e)=>W3[t]-W3[e]),o;}const A3={[b2]:"%Y ",[x2]:"Q%q ",[H2]:"%b ",[j1]:"%d ",[S2]:"W%U ",[k2]:"%a ",[q2]:"%j ",[I2]:"%H:00",[B2]:"00:%M",[E3]:":%S",[L2]:".%L",[`${b2}-${H2}`]:"%Y-%m ",[`${b2}-${H2}-${j1}`]:"%Y-%m-%d ",[`${I2}-${B2}`]:"%H:%M"};function G3(t,e){const n=rn({},A3,e),o=z2(t),u=o.length;let i,c,s="",a=0;for(a=0;a<u;)for(i=o.length;i>a;--i)if(c=o.slice(a,i).join("-"),null!=n[c]){s+=n[c],a=i;break;}return s.trim();}const J3=new Date;function K3(t){return J3.setFullYear(t),J3.setMonth(0),J3.setDate(1),J3.setHours(0,0,0,0),J3;}function N3(t){return P2(new Date(t));}function O2(t){return R3(new Date(t));}function P2(t){return y.count(K3(t.getFullYear())-1,t);}function R3(t){return O1.count(K3(t.getFullYear())-1,t);}function V2(t){return K3(t).getDay();}function X3(t,e,n,r,o,u,i){if(0<=t&&t<100){const c=new Date(-1,e,n,r,o,u,i);return c.setFullYear(t),c;}return new Date(t,e,n,r,o,u,i);}function Z3(t){return tt1(new Date(t));}function _2(t){return et(new Date(t));}function tt1(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return v3.count(e-1,t);}function et(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return P1.count(e-1,t);}function nt1(t){return J3.setTime(Date.UTC(t,0,1)),J3.getUTCDay();}function rt(t,e,n,r,o,u,i){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,o,u,i));return t.setUTCFullYear(n.y),t;}return new Date(Date.UTC(t,e,n,r,o,u,i));}function ot(t,e,n,r,o){const l=e||1,f=D(t),g=(t,e,o)=>(function(t,e,n,r){const o=n<=1?t:r?(e,o)=>r+n*Math.floor((t(e,o)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(o(t,n),n):o;})(n[o=o||t],r[o],t===f&&l,e),m=new Date,D1=Sn(t),T=D1[b2]?g(b2):tn(2012),U=D1[H2]?g(H2):D1[x2]?g(x2):a,h1=D1[S2]&&D1[k2]?g(k2,1,S2+k2):D1[S2]?g(S2,1):D1[k2]?g(k2,1):D1[j1]?g(j1,1):D1[q2]?g(q2,1):h,C=D1[I2]?g(I2):a,d=D1[B2]?g(B2):a,M=D1[E3]?g(E3):a,y=D1[L2]?g(L2):a;return function(t){m.setTime(+t);const e=T(m);return o(e,U(m),h1(m,e),C(m),d(m),M(m),y(m));};}function ut1(t,e,n){return e+7*t-(n+6)%7;}const it={[b2]:t=>t.getFullYear(),[x2]:t=>Math.floor(t.getMonth()/3),[H2]:t=>t.getMonth(),[j1]:t=>t.getDate(),[I2]:t=>t.getHours(),[B2]:t=>t.getMinutes(),[E3]:t=>t.getSeconds(),[L2]:t=>t.getMilliseconds(),[q2]:t=>P2(t),[S2]:t=>R3(t),[S2+k2]:(t,e)=>ut1(R3(t),t.getDay(),V2(e)),[k2]:(t,e)=>ut1(1,t.getDay(),V2(e))},ct1={[x2]:t=>3*t,[S2]:(t,e)=>ut1(t,0,V2(e))};function st(t,e){return ot(t,e||1,it,ct1,X3);}const at1={[b2]:t=>t.getUTCFullYear(),[x2]:t=>Math.floor(t.getUTCMonth()/3),[H2]:t=>t.getUTCMonth(),[j1]:t=>t.getUTCDate(),[I2]:t=>t.getUTCHours(),[B2]:t=>t.getUTCMinutes(),[E3]:t=>t.getUTCSeconds(),[L2]:t=>t.getUTCMilliseconds(),[q2]:t=>tt1(t),[S2]:t=>et(t),[k2]:(t,e)=>ut1(1,t.getUTCDay(),nt1(e)),[S2+k2]:(t,e)=>ut1(et(t),t.getUTCDay(),nt1(e))},lt={[x2]:t=>3*t,[S2]:(t,e)=>ut1(t,0,nt1(e))};function ft1(t,e){return ot(t,e||1,at1,lt,rt);}const gt1={[b2]:ie,[x2]:oe.every(3),[H2]:oe,[S2]:O1,[j1]:y,[k2]:y,[q2]:y,[I2]:F2,[B2]:M2,[E3]:C2,[L2]:a5},mt={[b2]:ce,[x2]:ge.every(3),[H2]:ge,[S2]:P1,[j1]:v3,[k2]:v3,[q2]:v3,[I2]:d3,[B2]:m3,[E3]:C2,[L2]:a5};function Dt(t){return gt1[t];}function Tt(t){return mt[t];}function Ut(t,e,n){return t?t.offset(e,n):void 0;}function ht1(t,e,n){return Ut(Dt(t),e,n);}function Ct(t,e,n){return Ut(Tt(t),e,n);}function dt(t,e,n,r){return t?t.range(e,n,r):void 0;}function Mt1(t,e,n,r){return dt(Dt(t),e,n,r);}function yt1(t,e,n,r){return dt(Tt(t),e,n,r);}const Yt=1e3,wt=6e4,pt=36e5,Ft=864e5,$t=2592e6,vt1=31536e6,bt=[b2,H2,j1,I2,B2,E3,L2],xt=bt.slice(0,-1),Ht=xt.slice(0,-1),St=Ht.slice(0,-1),jt1=St.slice(0,-1),kt=[b2,H2],qt1=[b2],It=[[xt,1,Yt],[xt,5,5e3],[xt,15,15e3],[xt,30,3e4],[Ht,1,wt],[Ht,5,3e5],[Ht,15,9e5],[Ht,30,18e5],[St,1,pt],[St,3,108e5],[St,6,216e5],[St,12,432e5],[jt1,1,Ft],[[b2,S2],1,6048e5],[kt,1,$t],[kt,3,7776e6],[qt1,1,vt1]];function Bt(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(kn(e))/n;let u,i,c=e4(t=>t[2]).right(It,r);return c===It.length?(u=qt1,i=nt(e[0]/vt1,e[1]/vt1,n)):c?(c=It[r/It[c-1][2]<It[c][2]/r?c-1:c],u=c[0],i=c[1]):(u=bt,i=Math.max(nt(e[0],e[1],n),1)),{units:u,step:i};}function l5(n){if(0<=n.y&&n.y<100){var t=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return t.setFullYear(n.y),t;}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L);}function g4(n){if(0<=n.y&&n.y<100){var t=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return t.setUTCFullYear(n.y),t;}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L));}function s5(n,t,e){return{y:n,m:t,d:e,H:0,M:0,S:0,L:0};}function h4(t){var e=t.dateTime,r=t.date,o=t.time,c=t.periods,a=t.days,h=t.shortDays,y1=t.months,v=t.shortMonths,d=p5(c),m=S3(c),D=p5(a),M=S3(a),T=p5(h),U=S3(h),x=p5(y1),w=S3(y1),un=p5(v),pn=S3(v),qn={a:function(n){return h[n.getDay()];},A:function(n){return a[n.getDay()];},b:function(n){return v[n.getMonth()];},B:function(n){return y1[n.getMonth()];},c:null,d:$3,e:$3,f:k3,g:ln1,G:sn1,H:z3,I:E4,j:R4,L:_3,m:K4,M:nn1,p:function(n){return c[+(n.getHours()>=12)];},q:function(n){return 1+~~(n.getMonth()/3);},Q:Vn,s:jn1,S:tn1,u:en1,U:rn1,V:on1,w:cn1,W:an1,x:null,X:null,y:fn1,Y:gn1,Z:hn1,"%":bn1},In={a:function(n){return h[n.getUTCDay()];},A:function(n){return a[n.getUTCDay()];},b:function(n){return v[n.getUTCMonth()];},B:function(n){return y1[n.getUTCMonth()];},c:null,d:yn1,e:yn1,f:Cn,g:Yn,G:Zn,H:vn1,I:dn1,j:mn1,L:Dn1,m:Mn1,M:Tn,p:function(n){return c[+(n.getUTCHours()>=12)];},q:function(n){return 1+~~(n.getUTCMonth()/3);},Q:Vn,s:jn1,S:Un,u:xn1,U:wn1,V:Sn1,w:Fn,W:Ln,x:null,X:null,y:Hn,Y:An1,Z:Wn,"%":bn1},Jn={a:function(n,t,e){var r=T.exec(t.slice(e));return r?(n.w=U.get(r[0].toLowerCase()),e+r[0].length):-1;},A:function(n,t,e){var r=D.exec(t.slice(e));return r?(n.w=M.get(r[0].toLowerCase()),e+r[0].length):-1;},b:function(n,t,e){var r=un.exec(t.slice(e));return r?(n.m=pn.get(r[0].toLowerCase()),e+r[0].length):-1;},B:function(n,t,e){var r=x.exec(t.slice(e));return r?(n.m=w.get(r[0].toLowerCase()),e+r[0].length):-1;},c:function(n,t,r){return On(n,e,t,r);},d:q3,e:q3,f:N4,g:W4,G:Z4,H:J4,I:J4,j:I3,L:O3,m:j2,M:Q3,p:function(n,t,e){var r=d.exec(t.slice(e));return r?(n.p=m.get(r[0].toLowerCase()),e+r[0].length):-1;},q:V3,Q:B3,s:G4,S:X4,u:L3,U:H3,V:Y3,w:F3,W:A4,x:function(n,t,e){return On(n,r,t,e);},X:function(n,t,e){return On(n,o,t,e);},y:W4,Y:Z4,Z:b3,"%":P3};function Qn(n,t){return function(e){var r,u,i,o=[],c=-1,a=0,f=n.length;for(e instanceof Date||(e=new Date(+e));++c<f;)37===n.charCodeAt(c)&&(o.push(n.slice(a,c)),null!=(u=C3[r=n.charAt(++c)])?r=n.charAt(++c):u="e"===r?" ":"0",(i=t[r])&&(r=i(e,u)),o.push(r),a=c+1);return o.push(n.slice(a,c)),o.join("");};}function Xn(t,e){return function(r){var o,c,a=s5(1900,void 0,1);if(On(a,t,r+="",0)!=r.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(c=(o=g4(s5(a.y,0,1))).getUTCDay(),o=c>4||0===c?Q1.ceil(o):Q1(o),o=v3.offset(o,7*(a.V-1)),a.y=o.getUTCFullYear(),a.m=o.getUTCMonth(),a.d=o.getUTCDate()+(a.w+6)%7):(c=(o=l5(s5(a.y,0,1))).getDay(),o=c>4||0===c?W2.ceil(o):W2(o),o=y.offset(o,7*(a.V-1)),a.y=o.getFullYear(),a.m=o.getMonth(),a.d=o.getDate()+(a.w+6)%7);}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),c="Z"in a?g4(s5(a.y,0,1)).getUTCDay():l5(s5(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(c+5)%7:a.w+7*a.U-(c+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,g4(a)):l5(a);};}function On(n,t,e,r){for(var u,i,o=0,c=t.length,a=e.length;o<c;){if(r>=a)return-1;if(37===(u=t.charCodeAt(o++))){if(u=t.charAt(o++),!(i=Jn[u in C3?t.charAt(o++):u])||(r=i(n,e,r))<0)return-1;}else if(u!=e.charCodeAt(r++))return-1;}return r;}return qn.x=Qn(r,qn),qn.X=Qn(o,qn),qn.c=Qn(e,qn),In.x=Qn(r,In),In.X=Qn(o,In),In.c=Qn(e,In),{format:function(n){var t=Qn(n+="",qn);return t.toString=function(){return n;},t;},parse:function(n){var t=Xn(n+="",!1);return t.toString=function(){return n;},t;},utcFormat:function(n){var t=Qn(n+="",In);return t.toString=function(){return n;},t;},utcParse:function(n){var t=Xn(n+="",!0);return t.toString=function(){return n;},t;}};}var y1,v4,d4,m4,D2,C3={"-":"",_:" ",0:"0"},M3=/^\s*\d+/,T2=/^%/,U2=/[\\^$*+?|[\]().{}]/g;function x3(n,t,e){var r=n<0?"-":"",u=(r?-n:n)+"",i=u.length;return r+(i<e?new Array(e-i+1).join(t)+u:u);}function w3(n){return n.replace(U2,"\\$&");}function p5(n){return new RegExp("^(?:"+n.map(w3).join("|")+")","i");}function S3(n){return new Map(n.map((n,t)=>[n.toLowerCase(),t]));}function F3(n,t,e){var r=M3.exec(t.slice(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1;}function L3(n,t,e){var r=M3.exec(t.slice(e,e+1));return r?(n.u=+r[0],e+r[0].length):-1;}function H3(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.U=+r[0],e+r[0].length):-1;}function Y3(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.V=+r[0],e+r[0].length):-1;}function A4(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.W=+r[0],e+r[0].length):-1;}function Z4(n,t,e){var r=M3.exec(t.slice(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1;}function W4(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.y=+r[0]+(+r[0]>68?1900:2e3),e+r[0].length):-1;}function b3(n,t,e){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(e,e+6));return r?(n.Z=r[1]?0:-(r[2]+(r[3]||"00")),e+r[0].length):-1;}function V3(n,t,e){var r=M3.exec(t.slice(e,e+1));return r?(n.q=3*r[0]-3,e+r[0].length):-1;}function j2(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1;}function q3(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1;}function I3(n,t,e){var r=M3.exec(t.slice(e,e+3));return r?(n.m=0,n.d=+r[0],e+r[0].length):-1;}function J4(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1;}function Q3(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1;}function X4(n,t,e){var r=M3.exec(t.slice(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1;}function O3(n,t,e){var r=M3.exec(t.slice(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1;}function N4(n,t,e){var r=M3.exec(t.slice(e,e+6));return r?(n.L=Math.floor(r[0]/1e3),e+r[0].length):-1;}function P3(n,t,e){var r=T2.exec(t.slice(e,e+1));return r?e+r[0].length:-1;}function B3(n,t,e){var r=M3.exec(t.slice(e));return r?(n.Q=+r[0],e+r[0].length):-1;}function G4(n,t,e){var r=M3.exec(t.slice(e));return r?(n.s=+r[0],e+r[0].length):-1;}function $3(n,t){return x3(n.getDate(),t,2);}function z3(n,t){return x3(n.getHours(),t,2);}function E4(n,t){return x3(n.getHours()%12||12,t,2);}function R4(e,r){return x3(1+y.count(ie(e),e),r,3);}function _3(n,t){return x3(n.getMilliseconds(),t,3);}function k3(n,t){return _3(n,t)+"000";}function K4(n,t){return x3(n.getMonth()+1,t,2);}function nn1(n,t){return x3(n.getMinutes(),t,2);}function tn1(n,t){return x3(n.getSeconds(),t,2);}function en1(n){var t=n.getDay();return 0===t?7:t;}function rn1(n,r){return x3(O1.count(ie(n)-1,n),r,2);}function un1(n){var t=n.getDay();return t>=4||0===t?j(n):j.ceil(n);}function on1(n,e){return n=un1(n),x3(j.count(ie(n),n)+(4===ie(n).getDay()),e,2);}function cn1(n){return n.getDay();}function an1(n,e){return x3(W2.count(ie(n)-1,n),e,2);}function fn1(n,t){return x3(n.getFullYear()%100,t,2);}function ln1(n,t){return x3((n=un1(n)).getFullYear()%100,t,2);}function gn1(n,t){return x3(n.getFullYear()%1e4,t,4);}function sn1(n,t){var e=n.getDay();return x3((n=e>=4||0===e?j(n):j.ceil(n)).getFullYear()%1e4,t,4);}function hn1(n){var t=n.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+x3(t/60|0,"0",2)+x3(t%60,"0",2);}function yn1(n,t){return x3(n.getUTCDate(),t,2);}function vn1(n,t){return x3(n.getUTCHours(),t,2);}function dn1(n,t){return x3(n.getUTCHours()%12||12,t,2);}function mn1(n,t){return x3(1+v3.count(ce(n),n),t,3);}function Dn1(n,t){return x3(n.getUTCMilliseconds(),t,3);}function Cn(n,t){return Dn1(n,t)+"000";}function Mn1(n,t){return x3(n.getUTCMonth()+1,t,2);}function Tn(n,t){return x3(n.getUTCMinutes(),t,2);}function Un(n,t){return x3(n.getUTCSeconds(),t,2);}function xn1(n){var t=n.getUTCDay();return 0===t?7:t;}function wn1(n,t){return x3(P1.count(ce(n)-1,n),t,2);}function pn1(n){var t=n.getUTCDay();return t>=4||0===t?X2(n):X2.ceil(n);}function Sn1(n,t){return n=pn1(n),x3(X2.count(ce(n),n)+(4===ce(n).getUTCDay()),t,2);}function Fn(n){return n.getUTCDay();}function Ln(n,t){return x3(Q1.count(ce(n)-1,n),t,2);}function Hn(n,t){return x3(n.getUTCFullYear()%100,t,2);}function Yn(n,t){return x3((n=pn1(n)).getUTCFullYear()%100,t,2);}function An1(n,t){return x3(n.getUTCFullYear()%1e4,t,4);}function Zn(n,t){var e=n.getUTCDay();return x3((n=e>=4||0===e?X2(n):X2.ceil(n)).getUTCFullYear()%1e4,t,4);}function Wn(){return"+0000";}function bn1(){return"%";}function Vn(n){return+n;}function jn1(n){return Math.floor(+n/1e3);}function qn(n){return y1=h4(n),v4=y1.format,d4=y1.parse,m4=y1.utcFormat,D2=y1.utcParse,y1;}qn({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var In="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString?function(n){return n.toISOString();}:m4(In);+new Date("2000-01-01T00:00:00.000Z")?function(n){var t=new Date(n);return isNaN(t)?null:t;}:D2(In);function B4(t){const r={};return e=>r[e]||(r[e]=t(e));}function O4(i){const a=B4(i.format),c=i.formatPrefix;return{format:a,formatPrefix:c,formatFloat(t){const e=e5(t||",");if(null==e.precision){switch(e.precision=12,e.type){case"%":e.precision-=2;break;case"e":e.precision-=1;}return n=a(e),o=a(".1f")(1)[1],t=>{const r=n(t),e=r.indexOf(o);if(e<0)return r;let i=function(t,r){let e,n=t.lastIndexOf("e");if(n>0)return n;for(n=t.length;--n>r;)if(e=t.charCodeAt(n),e>=48&&e<=57)return n+1;}(r,e);const a=i<r.length?r.slice(i):"";for(;--i>e;)if("0"!==r[i]){++i;break;}return r.slice(0,i)+a;};}return a(e);var n,o;},formatSpan(i,s,f,u){u=e5(null==u?",f":u);const m=nt(i,s,f),p=Math.max(Math.abs(i),Math.abs(s));let l;if(null==u.precision)switch(u.type){case"s":return isNaN(l=v2(m,p))||(u.precision=l),c(u,p);case"":case"e":case"g":case"p":case"r":isNaN(l=M1(m,p))||(u.precision=l-("e"===u.type));break;case"f":case"%":isNaN(l=p3(m))||(u.precision=l-2*("%"===u.type));}return a(u);}};}let S4,z4;function A5(){return S4=O4({format:l3,formatPrefix:u5});}function C4(t){return O4(d2(t));}function Y4(t){return arguments.length?S4=C4(t):S4;}function $4(t,r,e){E(e=e||{})||l(`Invalid time multi-format specifier: ${e}`);const n=r(E3),o=r(B2),i=r(I2),a=r(j1),c=r(S2),P=r(H2),b=r(x2),F=r(b2),v=t(e[L2]||".%L"),I=t(e[E3]||":%S"),M=t(e[B2]||"%I:%M"),k=t(e[I2]||"%I %p"),w=t(e[j1]||e[k2]||"%a %d"),L=t(e[S2]||"%b %d"),B=t(e[H2]||"%B"),O=t(e[x2]||"%B"),S=t(e[b2]||"%Y");return t=>(n(t)<t?v:o(t)<t?I:i(t)<t?M:a(t)<t?k:P(t)<t?c(t)<t?w:L:F(t)<t?b(t)<t?B:O:S)(t);}function j3(t){const r=B4(t.format),e=B4(t.utcFormat);return{timeFormat:t=>Mn(t)?r(t):$4(r,Dt,t),utcFormat:t=>Mn(t)?e(t):$4(e,Tt,t),timeParse:B4(t.parse),utcParse:B4(t.utcParse)};}function q4(){return z4=j3({format:v4,parse:d4,utcFormat:m4,utcParse:D2});}function D3(t){return j3(h4(t));}function E5(t){return arguments.length?z4=D3(t):z4;}A5(),q4();const G5=(t,r)=>rn({},t,r);function H4(t,r){const e=t?C4(t):Y4(),n=r?D3(r):E5();return G5(e,n);}function J5(t,r){const e=arguments.length;return e&&2!==e&&l("defaultLocale expects either zero or two arguments."),e?G5(Y4(t),E5(r)):G5(Y4(),E5());}function K5(){return A5(),q4(),J5();}var v5="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},m5=[],E6=[],A6="undefined"!=typeof Uint8Array?Uint8Array:Array,b4=!1;function R5(){b4=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0;r<64;++r)m5[r]=t[r],E6[t.charCodeAt(r)]=r;E6["-".charCodeAt(0)]=62,E6["_".charCodeAt(0)]=63;}function _4(t,r,e){for(var n,i,o=[],s=r;s<e;s+=3)n=(t[s]<<16)+(t[s+1]<<8)+t[s+2],o.push(m5[(i=n)>>18&63]+m5[i>>12&63]+m5[i>>6&63]+m5[63&i]);return o.join("");}function P4(t){var r;b4||R5();for(var e=t.length,n=e%3,i="",o=[],s=16383,u=0,f=e-n;u<f;u+=s)o.push(_4(t,u,u+s>f?f:u+s));return 1===n?(r=t[e-1],i+=m5[r>>2],i+=m5[r<<4&63],i+="=="):2===n&&(r=(t[e-2]<<8)+t[e-1],i+=m5[r>>10],i+=m5[r>>4&63],i+=m5[r<<2&63],i+="="),o.push(i),o.join("");}function T3(t,r,e,n,i){var o,s,u=8*i-n-1,f=(1<<u)-1,a=f>>1,h=-7,c=e?i-1:0,l=e?-1:1,p=t[r+c];for(c+=l,o=p&(1<<-h)-1,p>>=-h,h+=u;h>0;o=256*o+t[r+c],c+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[r+c],c+=l,h-=8);if(0===o)o=1-a;else{if(o===f)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=a;}return(p?-1:1)*s*Math.pow(2,o-n);}function U3(t,r,e,n,i,o){var s,u,f,a=8*o-i-1,h=(1<<a)-1,c=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,g=n?1:-1,y=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(u=isNaN(r)?1:0,s=h):(s=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-s))<1&&(s--,f*=2),(r+=s+c>=1?l/f:l*Math.pow(2,1-c))*f>=2&&(s++,f/=2),s+c>=h?(u=0,s=h):s+c>=1?(u=(r*f-1)*Math.pow(2,i),s+=c):(u=r*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[e+p]=255&u,p+=g,u/=256,i-=8);for(s=s<<i|u,a+=i;a>0;t[e+p]=255&s,p+=g,s/=256,a-=8);t[e+p-g]|=128*y;}var S5={}.toString,B5=Array.isArray||function(t){return"[object Array]"==S5.call(t);};function I4(){return O5.TYPED_ARRAY_SUPPORT?2147483647:1073741823;}function Y5(t,r){if(I4()<r)throw new RangeError("Invalid typed array length");return O5.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(r)).__proto__=O5.prototype:(null===t&&(t=new O5(r)),t.length=r),t;}function O5(t,r,e){if(!(O5.TYPED_ARRAY_SUPPORT||this instanceof O5))return new O5(t,r,e);if("number"==typeof t){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return x4(this,t);}return C5(this,t,r,e);}function C5(t,r,e,n){if("number"==typeof r)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?function(t,r,e,n){if(r.byteLength,e<0||r.byteLength<e)throw new RangeError("'offset' is out of bounds");if(r.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");r=void 0===e&&void 0===n?new Uint8Array(r):void 0===n?new Uint8Array(r,e):new Uint8Array(r,e,n);O5.TYPED_ARRAY_SUPPORT?(t=r).__proto__=O5.prototype:t=M4(t,r);return t;}(t,r,e,n):"string"==typeof r?function(t,r,e){"string"==typeof e&&""!==e||(e="utf8");if(!O5.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');var n=0|k4(r,e);t=Y5(t,n);var i=t.write(r,e);i!==n&&(t=t.slice(0,i));return t;}(t,r,e):function(t,r){if(N5(r)){var e=0|D4(r.length);return 0===(t=Y5(t,e)).length||r.copy(t,0,0,e),t;}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||(n=r.length)!=n?Y5(t,0):M4(t,r);if("Buffer"===r.type&&B5(r.data))return M4(t,r.data);}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}(t,r);}function L4(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative');}function x4(t,r){if(L4(r),t=Y5(t,r<0?0:0|D4(r)),!O5.TYPED_ARRAY_SUPPORT)for(var e=0;e<r;++e)t[e]=0;return t;}function M4(t,r){var e=r.length<0?0:0|D4(r.length);t=Y5(t,e);for(var n=0;n<e;n+=1)t[n]=255&r[n];return t;}function D4(t){if(t>=I4())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+I4().toString(16)+" bytes");return 0|t;}function N5(t){return!(null==t||!t._isBuffer);}function k4(t,r){if(N5(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var e=t.length;if(0===e)return 0;for(var n=!1;;)switch(r){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":case void 0:return lt1(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*e;case"hex":return e>>>1;case"base64":return pt1(t).length;default:if(n)return lt1(t).length;r=(""+r).toLowerCase(),n=!0;}}function j4(t,r,e){var n=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===e||e>this.length)&&(e=this.length),e<=0)return"";if((e>>>=0)<=(r>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return rt1(this,r,e);case"utf8":case"utf-8":return K6(this,r,e);case"ascii":return X5(this,r,e);case"latin1":case"binary":return tt2(this,r,e);case"base64":return G6(this,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return et1(this,r,e);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0;}}function z5(t,r,e){var n=t[r];t[r]=t[e],t[e]=n;}function F4(t,r,e,n,i){if(0===t.length)return-1;if("string"==typeof e?(n=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,isNaN(e)&&(e=i?0:t.length-1),e<0&&(e=t.length+e),e>=t.length){if(i)return-1;e=t.length-1;}else if(e<0){if(!i)return-1;e=0;}if("string"==typeof r&&(r=O5.from(r,n)),N5(r))return 0===r.length?-1:J6(t,r,e,n,i);if("number"==typeof r)return r&=255,O5.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,r,e):Uint8Array.prototype.lastIndexOf.call(t,r,e):J6(t,[r],e,n,i);throw new TypeError("val must be string, number or Buffer");}function J6(t,r,e,n,i){var o,s=1,u=t.length,f=r.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||r.length<2)return-1;s=2,u/=2,f/=2,e/=2;}function a(t,r){return 1===s?t[r]:t.readUInt16BE(r*s);}if(i){var h=-1;for(o=e;o<u;o++)if(a(t,o)===a(r,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===f)return h*s;}else-1!==h&&(o-=o-h),h=-1;}else for(e+f>u&&(e=u-f),o=e;o>=0;o--){for(var c=!0,l=0;l<f;l++)if(a(t,o+l)!==a(r,l)){c=!1;break;}if(c)return o;}return-1;}function W5(t,r,e,n){e=Number(e)||0;var i=t.length-e;n?(n=Number(n))>i&&(n=i):n=i;var o=r.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var u=parseInt(r.substr(2*s,2),16);if(isNaN(u))return s;t[e+s]=u;}return s;}function V4(t,r,e,n){return gt2(lt1(r,t.length-e),t,e,n);}function Z5(t,r,e,n){return gt2(function(t){for(var r=[],e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r;}(r),t,e,n);}function q5(t,r,e,n){return Z5(t,r,e,n);}function H5(t,r,e,n){return gt2(pt1(r),t,e,n);}function $5(t,r,e,n){return gt2(function(t,r){for(var e,n,i,o=[],s=0;s<t.length&&!((r-=2)<0);++s)n=(e=t.charCodeAt(s))>>8,i=e%256,o.push(i),o.push(n);return o;}(r,t.length-e),t,e,n);}function G6(t,r,e){return 0===r&&e===t.length?P4(t):P4(t.slice(r,e));}function K6(t,r,e){e=Math.min(t.length,e);for(var n=[],i=r;i<e;){var o,s,u,f,a=t[i],h=null,c=a>239?4:a>223?3:a>191?2:1;if(i+c<=e)switch(c){case 1:a<128&&(h=a);break;case 2:128==(192&(o=t[i+1]))&&(f=(31&a)<<6|63&o)>127&&(h=f);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(f=(15&a)<<12|(63&o)<<6|63&s)>2047&&(f<55296||f>57343)&&(h=f);break;case 4:o=t[i+1],s=t[i+2],u=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&u)&&(f=(15&a)<<18|(63&o)<<12|(63&s)<<6|63&u)>65535&&f<1114112&&(h=f);}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c;}return function(t){var r=t.length;if(r<=Q4)return String.fromCharCode.apply(String,t);var e="",n=0;for(;n<r;)e+=String.fromCharCode.apply(String,t.slice(n,n+=Q4));return e;}(n);}O5.TYPED_ARRAY_SUPPORT=void 0===v5.TYPED_ARRAY_SUPPORT||v5.TYPED_ARRAY_SUPPORT,I4(),O5.poolSize=8192,O5._augment=function(t){return t.__proto__=O5.prototype,t;},O5.from=function(t,r,e){return C5(null,t,r,e);},O5.TYPED_ARRAY_SUPPORT&&(O5.prototype.__proto__=Uint8Array.prototype,O5.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&O5[Symbol.species]),O5.alloc=function(t,r,e){return function(t,r,e,n){return L4(r),r<=0?Y5(t,r):void 0!==e?"string"==typeof n?Y5(t,r).fill(e,n):Y5(t,r).fill(e):Y5(t,r);}(null,t,r,e);},O5.allocUnsafe=function(t){return x4(null,t);},O5.allocUnsafeSlow=function(t){return x4(null,t);},O5.isBuffer=function(t){return null!=t&&(!!t._isBuffer||yt2(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&yt2(t.slice(0,0));}(t));},O5.compare=function(t,r){if(!N5(t)||!N5(r))throw new TypeError("Arguments must be Buffers");if(t===r)return 0;for(var e=t.length,n=r.length,i=0,o=Math.min(e,n);i<o;++i)if(t[i]!==r[i]){e=t[i],n=r[i];break;}return e<n?-1:n<e?1:0;},O5.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},O5.concat=function(t,r){if(!B5(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return O5.alloc(0);var e;if(void 0===r)for(r=0,e=0;e<t.length;++e)r+=t[e].length;var n=O5.allocUnsafe(r),i=0;for(e=0;e<t.length;++e){var o=t[e];if(!N5(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length;}return n;},O5.byteLength=k4,O5.prototype._isBuffer=!0,O5.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<t;r+=2)z5(this,r,r+1);return this;},O5.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<t;r+=4)z5(this,r,r+3),z5(this,r+1,r+2);return this;},O5.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<t;r+=8)z5(this,r,r+7),z5(this,r+1,r+6),z5(this,r+2,r+5),z5(this,r+3,r+4);return this;},O5.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?K6(this,0,t):j4.apply(this,arguments);},O5.prototype.equals=function(t){if(!N5(t))throw new TypeError("Argument must be a Buffer");return this===t||0===O5.compare(this,t);},O5.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">";},O5.prototype.compare=function(t,r,e,n,i){if(!N5(t))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===e&&(e=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),r<0||e>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&r>=e)return 0;if(n>=i)return-1;if(r>=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(e>>>=0)-(r>>>=0),u=Math.min(o,s),f=this.slice(n,i),a=t.slice(r,e),h=0;h<u;++h)if(f[h]!==a[h]){o=f[h],s=a[h];break;}return o<s?-1:s<o?1:0;},O5.prototype.includes=function(t,r,e){return-1!==this.indexOf(t,r,e);},O5.prototype.indexOf=function(t,r,e){return F4(this,t,r,e,!0);},O5.prototype.lastIndexOf=function(t,r,e){return F4(this,t,r,e,!1);},O5.prototype.write=function(t,r,e,n){if(void 0===r)n="utf8",e=this.length,r=0;else if(void 0===e&&"string"==typeof r)n=r,e=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(e)?(e|=0,void 0===n&&(n="utf8")):(n=e,e=void 0);}var i=this.length-r;if((void 0===e||e>i)&&(e=i),t.length>0&&(e<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return W5(this,t,r,e);case"utf8":case"utf-8":return V4(this,t,r,e);case"ascii":return Z5(this,t,r,e);case"latin1":case"binary":return q5(this,t,r,e);case"base64":return H5(this,t,r,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $5(this,t,r,e);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0;}},O5.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)};};var Q4=4096;function X5(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(127&t[i]);return n;}function tt2(t,r,e){var n="";e=Math.min(t.length,e);for(var i=r;i<e;++i)n+=String.fromCharCode(t[i]);return n;}function rt1(t,r,e){var n=t.length;(!r||r<0)&&(r=0),(!e||e<0||e>n)&&(e=n);for(var i="",o=r;o<e;++o)i+=ct2(t[o]);return i;}function et1(t,r,e){for(var n=t.slice(r,e),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i;}function nt2(t,r,e){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+r>e)throw new RangeError("Trying to access beyond buffer length");}function it1(t,r,e,n,i,o){if(!N5(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>i||r<o)throw new RangeError('"value" argument is out of bounds');if(e+n>t.length)throw new RangeError("Index out of range");}function ot1(t,r,e,n){r<0&&(r=65535+r+1);for(var i=0,o=Math.min(t.length-e,2);i<o;++i)t[e+i]=(r&255<<8*(n?i:1-i))>>>8*(n?i:1-i);}function st1(t,r,e,n){r<0&&(r=4294967295+r+1);for(var i=0,o=Math.min(t.length-e,4);i<o;++i)t[e+i]=r>>>8*(n?i:3-i)&255;}function ut2(t,r,e,n,i,o){if(e+n>t.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range");}function ft2(t,r,e,n,i){return i||ut2(t,0,e,4),U3(t,r,e,n,23,4),e+4;}function at2(t,r,e,n,i){return i||ut2(t,0,e,8),U3(t,r,e,n,52,8),e+8;}O5.prototype.slice=function(t,r){var e,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):r>n&&(r=n),r<t&&(r=t),O5.TYPED_ARRAY_SUPPORT)(e=this.subarray(t,r)).__proto__=O5.prototype;else{var i=r-t;e=new O5(i,void 0);for(var o=0;o<i;++o)e[o]=this[o+t];}return e;},O5.prototype.readUIntLE=function(t,r,e){t|=0,r|=0,e||nt2(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n;},O5.prototype.readUIntBE=function(t,r,e){t|=0,r|=0,e||nt2(t,r,this.length);for(var n=this[t+--r],i=1;r>0&&(i*=256);)n+=this[t+--r]*i;return n;},O5.prototype.readUInt8=function(t,r){return r||nt2(t,1,this.length),this[t];},O5.prototype.readUInt16LE=function(t,r){return r||nt2(t,2,this.length),this[t]|this[t+1]<<8;},O5.prototype.readUInt16BE=function(t,r){return r||nt2(t,2,this.length),this[t]<<8|this[t+1];},O5.prototype.readUInt32LE=function(t,r){return r||nt2(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3];},O5.prototype.readUInt32BE=function(t,r){return r||nt2(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3]);},O5.prototype.readIntLE=function(t,r,e){t|=0,r|=0,e||nt2(t,r,this.length);for(var n=this[t],i=1,o=0;++o<r&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*r)),n;},O5.prototype.readIntBE=function(t,r,e){t|=0,r|=0,e||nt2(t,r,this.length);for(var n=r,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*r)),o;},O5.prototype.readInt8=function(t,r){return r||nt2(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t];},O5.prototype.readInt16LE=function(t,r){r||nt2(t,2,this.length);var e=this[t]|this[t+1]<<8;return 32768&e?4294901760|e:e;},O5.prototype.readInt16BE=function(t,r){r||nt2(t,2,this.length);var e=this[t+1]|this[t]<<8;return 32768&e?4294901760|e:e;},O5.prototype.readInt32LE=function(t,r){return r||nt2(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24;},O5.prototype.readInt32BE=function(t,r){return r||nt2(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3];},O5.prototype.readFloatLE=function(t,r){return r||nt2(t,4,this.length),T3(this,t,!0,23,4);},O5.prototype.readFloatBE=function(t,r){return r||nt2(t,4,this.length),T3(this,t,!1,23,4);},O5.prototype.readDoubleLE=function(t,r){return r||nt2(t,8,this.length),T3(this,t,!0,52,8);},O5.prototype.readDoubleBE=function(t,r){return r||nt2(t,8,this.length),T3(this,t,!1,52,8);},O5.prototype.writeUIntLE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||it1(this,t,r,e,Math.pow(2,8*e)-1,0);var i=1,o=0;for(this[r]=255&t;++o<e&&(i*=256);)this[r+o]=t/i&255;return r+e;},O5.prototype.writeUIntBE=function(t,r,e,n){(t=+t,r|=0,e|=0,n)||it1(this,t,r,e,Math.pow(2,8*e)-1,0);var i=e-1,o=1;for(this[r+i]=255&t;--i>=0&&(o*=256);)this[r+i]=t/o&255;return r+e;},O5.prototype.writeUInt8=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,1,255,0),O5.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[r]=255&t,r+1;},O5.prototype.writeUInt16LE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,2,65535,0),O5.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):ot1(this,t,r,!0),r+2;},O5.prototype.writeUInt16BE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,2,65535,0),O5.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):ot1(this,t,r,!1),r+2;},O5.prototype.writeUInt32LE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,4,4294967295,0),O5.TYPED_ARRAY_SUPPORT?(this[r+3]=t>>>24,this[r+2]=t>>>16,this[r+1]=t>>>8,this[r]=255&t):st1(this,t,r,!0),r+4;},O5.prototype.writeUInt32BE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,4,4294967295,0),O5.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):st1(this,t,r,!1),r+4;},O5.prototype.writeIntLE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);it1(this,t,r,e,i-1,-i);}var o=0,s=1,u=0;for(this[r]=255&t;++o<e&&(s*=256);)t<0&&0===u&&0!==this[r+o-1]&&(u=1),this[r+o]=(t/s|0)-u&255;return r+e;},O5.prototype.writeIntBE=function(t,r,e,n){if(t=+t,r|=0,!n){var i=Math.pow(2,8*e-1);it1(this,t,r,e,i-1,-i);}var o=e-1,s=1,u=0;for(this[r+o]=255&t;--o>=0&&(s*=256);)t<0&&0===u&&0!==this[r+o+1]&&(u=1),this[r+o]=(t/s|0)-u&255;return r+e;},O5.prototype.writeInt8=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,1,127,-128),O5.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[r]=255&t,r+1;},O5.prototype.writeInt16LE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,2,32767,-32768),O5.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8):ot1(this,t,r,!0),r+2;},O5.prototype.writeInt16BE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,2,32767,-32768),O5.TYPED_ARRAY_SUPPORT?(this[r]=t>>>8,this[r+1]=255&t):ot1(this,t,r,!1),r+2;},O5.prototype.writeInt32LE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,4,2147483647,-2147483648),O5.TYPED_ARRAY_SUPPORT?(this[r]=255&t,this[r+1]=t>>>8,this[r+2]=t>>>16,this[r+3]=t>>>24):st1(this,t,r,!0),r+4;},O5.prototype.writeInt32BE=function(t,r,e){return t=+t,r|=0,e||it1(this,t,r,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),O5.TYPED_ARRAY_SUPPORT?(this[r]=t>>>24,this[r+1]=t>>>16,this[r+2]=t>>>8,this[r+3]=255&t):st1(this,t,r,!1),r+4;},O5.prototype.writeFloatLE=function(t,r,e){return ft2(this,t,r,!0,e);},O5.prototype.writeFloatBE=function(t,r,e){return ft2(this,t,r,!1,e);},O5.prototype.writeDoubleLE=function(t,r,e){return at2(this,t,r,!0,e);},O5.prototype.writeDoubleBE=function(t,r,e){return at2(this,t,r,!1,e);},O5.prototype.copy=function(t,r,e,n){if(e||(e=0),n||0===n||(n=this.length),r>=t.length&&(r=t.length),r||(r=0),n>0&&n<e&&(n=e),n===e)return 0;if(0===t.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(e<0||e>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-r<n-e&&(n=t.length-r+e);var i,o=n-e;if(this===t&&e<r&&r<n)for(i=o-1;i>=0;--i)t[i+r]=this[i+e];else if(o<1e3||!O5.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+r]=this[i+e];else Uint8Array.prototype.set.call(t,this.subarray(e,e+o),r);return o;},O5.prototype.fill=function(t,r,e,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,e=this.length):"string"==typeof e&&(n=e,e=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i);}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!O5.isEncoding(n))throw new TypeError("Unknown encoding: "+n);}else"number"==typeof t&&(t&=255);if(r<0||this.length<r||this.length<e)throw new RangeError("Out of range index");if(e<=r)return this;var o;if(r>>>=0,e=void 0===e?this.length:e>>>0,t||(t=0),"number"==typeof t)for(o=r;o<e;++o)this[o]=t;else{var s=N5(t)?t:lt1(new O5(t,n).toString()),u=s.length;for(o=0;o<e-r;++o)this[o+r]=s[o%u];}return this;};var ht2=/[^+\/0-9A-Za-z-_]/g;function ct2(t){return t<16?"0"+t.toString(16):t.toString(16);}function lt1(t,r){var e;r=r||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((e=t.charCodeAt(s))>55295&&e<57344){if(!i){if(e>56319){(r-=3)>-1&&o.push(239,191,189);continue;}if(s+1===n){(r-=3)>-1&&o.push(239,191,189);continue;}i=e;continue;}if(e<56320){(r-=3)>-1&&o.push(239,191,189),i=e;continue;}e=65536+(i-55296<<10|e-56320);}else i&&(r-=3)>-1&&o.push(239,191,189);if(i=null,e<128){if((r-=1)<0)break;o.push(e);}else if(e<2048){if((r-=2)<0)break;o.push(e>>6|192,63&e|128);}else if(e<65536){if((r-=3)<0)break;o.push(e>>12|224,e>>6&63|128,63&e|128);}else{if(!(e<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;o.push(e>>18|240,e>>12&63|128,e>>6&63|128,63&e|128);}}return o;}function pt1(t){return function(t){var r,e,n,i,o,s;b4||R5();var u=t.length;if(u%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===t[u-2]?2:"="===t[u-1]?1:0,s=new A6(3*u/4-o),n=o>0?u-4:u;var f=0;for(r=0,e=0;r<n;r+=4,e+=3)i=E6[t.charCodeAt(r)]<<18|E6[t.charCodeAt(r+1)]<<12|E6[t.charCodeAt(r+2)]<<6|E6[t.charCodeAt(r+3)],s[f++]=i>>16&255,s[f++]=i>>8&255,s[f++]=255&i;return 2===o?(i=E6[t.charCodeAt(r)]<<2|E6[t.charCodeAt(r+1)]>>4,s[f++]=255&i):1===o&&(i=E6[t.charCodeAt(r)]<<10|E6[t.charCodeAt(r+1)]<<4|E6[t.charCodeAt(r+2)]>>2,s[f++]=i>>8&255,s[f++]=255&i),s;}(function(t){if((t=(function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"");})(t).replace(ht2,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t;}(t));}function gt2(t,r,e,n){for(var i=0;i<n&&!(i+e>=r.length||i>=t.length);++i)r[i+e]=t[i];return i;}function yt2(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t);}const dt1=/^(data:|([A-Za-z]+:)?\/\/)/,wt1=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,vt2=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,mt1="file://";async function Et(t,r){const e=await this.sanitize(t,r),n=e.href;return e.localFile?this.file(n):this.http(n,r);}async function At(t,r){r=rn({},this.options,r);const e=this.fileAccess,n={href:null};let i,o,a;const h=wt1.test(t.replace(vt2,""));null!=t&&"string"==typeof t&&h||l("Sanitize failure, invalid URI: "+xn(t));const c=dt1.test(t);return(a=r.baseURL)&&!c&&(t.startsWith("/")||a.endsWith("/")||(t="/"+t),t=a+t),o=(i=t.startsWith(mt1))||"file"===r.mode||"http"!==r.mode&&!c&&e,i?t=t.slice(7):t.startsWith("//")&&("file"===r.defaultProtocol?(t=t.slice(2),o=!0):t=(r.defaultProtocol||"http")+":"+t),Object.defineProperty(n,"localFile",{value:!!o}),n.href=t,r.target&&(n.target=r.target+""),r.rel&&(n.rel=r.rel+""),"image"===r.context&&r.crossOrigin&&(n.crossOrigin=r.crossOrigin+""),n;}function bt1(t){return Rt;}async function Rt(){l("No file system access.");}function _t(t){return t?async function(r,e){const n=rn({},this.options.http,e),i=e&&e.response,o=await t(r,n);return o.ok?L(o[i])?o[i]():o.text():l(o.status+""+o.statusText);}:Pt;}async function Pt(){l("No HTTP fetch method available.");}const Tt1=t=>!(Number.isNaN(+t)||t instanceof Date),Ut1={boolean:An,integer:z,number:z,date:zn,string:Rn,unknown:s},St1=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>Tt1(t)&&Number.isInteger(+t),Tt1,t=>!Number.isNaN(Date.parse(t))],Bt1=["boolean","integer","number","date"];function It1(t,r){if(!t||!t.length)return"unknown";const e=t.length,n=St1.length,i=St1.map((t,r)=>r+1);for(let s,u,f=0,a=0;f<e;++f)for(u=r?t[f][r]:t[f],s=0;s<n;++s)if(i[s]&&null!=(o=u)&&o==o&&!St1[s](u)&&(i[s]=0,++a,a===St1.length))return"string";var o;return Bt1[i.reduce((t,r)=>0===t?r:t,0)-1];}function Yt1(t,r){return r.reduce((r,e)=>(r[e]=It1(t,e),r),{});}function Ot(t){const r=function(r,e){const n={delimiter:t};return Ct1(r,e?rn(e,n):n);};return r.responseType="text",r;}function Ct1(t,r){return r.header&&(t=r.header.map(xn).join(r.delimiter)+"\n"+t),u1(r.delimiter).parse(t+"");}function Lt(t,r){const e=r&&r.property?i(r.property):s;return!E(t)||(n=t,L(O5.isBuffer)&&O5.isBuffer(n))?e(JSON.parse(t)):function(t,r){!w(t)&&bn(t)&&(t=[...t]);return r&&r.copy?JSON.parse(JSON.stringify(t)):t;}(e(t),r);var n;}Ct1.responseType="text",Lt.responseType="json";const xt1={interior:(t,r)=>t!==r,exterior:(t,r)=>t===r};function Mt2(t,r){let e,n,i,o;return t=Lt(t,r),r&&r.feature?(e=e2,i=r.feature):r&&r.mesh?(e=i2,i=r.mesh,o=xt1[r.filter]):l("Missing TopoJSON feature or mesh parameter."),n=(n=t.objects[i])?e(t,n,o):l("Invalid TopoJSON object: "+i),n&&n.features||[n];}Mt2.responseType="json";const Dt1={dsv:Ct1,csv:Ot(","),tsv:Ot("	"),json:Lt,topojson:Mt2};function Nt1(t,r){return arguments.length>1?(Dt1[t]=r,this):ln(Dt1,t)?Dt1[t]:null;}function kt1(t){const r=Nt1(t);return r&&r.responseType||"text";}function jt2(t,r,e,n){const i=Nt1((r=r||{}).type||"json");return i||l("Unknown data format type: "+r.type),t=i(t,r),r.parse&&function(t,r,e,n){if(!t.length)return;const i=E5();e=e||i.timeParse,n=n||i.utcParse;let o,s,u,f,a,h,c=t.columns||Object.keys(t[0]);"auto"===r&&(r=Yt1(t,c));c=Object.keys(r);const l=c.map(t=>{const i=r[t];let o,s;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),s=o[1],("'"===s[0]&&"'"===s[s.length-1]||'"'===s[0]&&'"'===s[s.length-1])&&(s=s.slice(1,-1));return("utc"===o[0]?n:e)(s);}if(!Ut1[i])throw Error("Illegal format pattern: "+t+":"+i);return Ut1[i];});for(u=0,a=t.length,h=c.length;u<a;++u)for(o=t[u],f=0;f<h;++f)s=c[f],o[s]=l[f](o[s]);}(t,r.parse,e,n),ln(t,"columns")&&delete t.columns,t;}const zt=function(t){return r=>({options:r||{},sanitize:At,load:Et,fileAccess:!1,file:bt1(),http:_t(t)});}("undefined"!=typeof fetch&&fetch);function k5(t){const e=t||s,n=[],s1={};return n.add=t=>{const r=e(t);return s1[r]||(s1[r]=1,n.push(t)),n;},n.remove=t=>{const r=e(t);if(s1[r]){s1[r]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1);}return n;},n;}async function w4(t,e){try{await e(t);}catch(e){t.error(e);}}const y2=Symbol("vega_id");let F5=1;function D5(t){return!(!t||!E7(t));}function E7(t){return t[y2];}function A7(t,e){return t[y2]=e,t;}function O6(t){const e=t===Object(t)?t:{data:t};return E7(e)?e:A7(e,F5++);}function P5(t){return q6(t,O6({}));}function q6(t,e){for(const n in t)e[n]=t[n];return e;}function M5(t,e){return A7(e,E7(t));}function b5(t,e){return t?e?(n,s)=>t(n,s)||E7(e(n))-E7(e(s)):(e,n)=>t(e,n)||E7(e)-E7(n):null;}function S6(t){return t&&t.constructor===L5;}function L5(){const t=[],e=[],n=[],s=[],l=[];let u=null,a=!1;return{constructor:L5,insert(e){const n=H(e),s=n.length;for(let e=0;e<s;++e)t.push(n[e]);return this;},remove(t){const n=L(t)?s:e,o=H(t),l=o.length;for(let t=0;t<l;++t)n.push(o[t]);return this;},modify(t,e,s){const r={field:e,value:tn(s)};return L(t)?(r.filter=t,l.push(r)):(r.tuple=t,n.push(r)),this;},encode(t,e){return L(t)?l.push({filter:t,field:e}):n.push({tuple:t,field:e}),this;},clean(t){return u=t,this;},reflow(){return a=!0,this;},pulse(r,i){const o={},h={};let c,d,f,p,g,m;for(c=0,d=i.length;c<d;++c)o[E7(i[c])]=1;for(c=0,d=e.length;c<d;++c)g=e[c],o[E7(g)]=-1;for(c=0,d=s.length;c<d;++c)p=s[c],i.forEach(t=>{p(t)&&(o[E7(t)]=-1);});for(c=0,d=t.length;c<d;++c)g=t[c],m=E7(g),o[m]?o[m]=1:r.add.push(O6(t[c]));for(c=0,d=i.length;c<d;++c)g=i[c],o[E7(g)]<0&&r.rem.push(g);function _(t,e,n){n?t[e]=n(t):r.encode=e,a||(h[E7(t)]=t);}for(c=0,d=n.length;c<d;++c)f=n[c],g=f.tuple,p=f.field,m=o[E7(g)],m>0&&(_(g,p,f.value),r.modifies(p));for(c=0,d=l.length;c<d;++c)f=l[c],p=f.filter,i.forEach(t=>{p(t)&&o[E7(t)]>0&&_(t,f.field,f.value);}),r.modifies(f.field);if(a)r.mod=e.length||s.length?i.filter(t=>o[E7(t)]>0):i.slice();else for(m in h)r.mod.push(h[m]);return(u||null==u&&(e.length||s.length))&&r.clean(!0),r;}};}const R6="_:mod:_";function x5(){Object.defineProperty(this,R6,{writable:!0,value:{}});}x5.prototype={set(e,n,s,r){const i=this,o=i[e],l=i[R6];return null!=n&&n>=0?(o[n]!==s||r)&&(o[n]=s,l[n+":"+e]=-1,l[e]=-1):(o!==s||r)&&(i[e]=s,l[e]=w(s)?1+s.length:-1),i;},modified(e,n){const s=this[R6];if(!arguments.length){for(const t in s)if(s[t])return!0;return!1;}if(w(e)){for(let t=0;t<e.length;++t)if(s[e[t]])return!0;return!1;}return null!=n&&n>=0?n+1<s[e]||!!s[n+":"+e]:!!s[e];},clear(){return this[R6]={},this;}};let z6=0;const C6=new x5;function U4(t,e,n,s){this.id=++z6,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,s);}function N6(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this);};}U4.prototype={targets(){return this._targets||(this._targets=k5(f));},set(t){return this.value!==t?(this.value=t,1):0;},skip:N6(1),modified:N6(2),parameters(e,n,i){n=!1!==n;const o=this._argval=this._argval||new x5,l1=this._argops=this._argops||[],u=[];let a,h,c,d;const f=(t,e,s)=>{s instanceof U4?(s!==this&&(n&&s.targets().add(this),u.push(s)),l1.push({op:s,name:t,index:e})):o.set(t,e,s);};for(a in e)if(h=e[a],"pulse"===a)H(h).forEach(t=>{t instanceof U4?t!==this&&(t.targets().add(this),u.push(t)):l("Pulse parameters must be operator instances.");}),this.source=h;else if(w(h))for(o.set(a,-1,Array(c=h.length)),d=0;d<c;++d)f(a,d,h[d]);else f(a,-1,h);return this.marshall().clear(),i&&(l1.initonly=!0),u;},marshall(t){const e=this._argval||C6,n=this._argops;let s,r,i,o;if(n){const l=n.length;for(r=0;r<l;++r)s=n[r],i=s.op,o=i.modified()&&i.stamp===t,e.set(s.name,s.index,i.value,o);if(n.initonly){for(r=0;r<l;++r)s=n[r],s.op.targets().remove(this);this._argops=null,this._update=null;}}return e;},detach(){const t=this._argops;let e,n,s,r;if(t)for(e=0,n=t.length;e<n;++e)s=t[e],r=s.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null;},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),s=e.call(this,n,t);if(n.clear(),s!==this.value)this.value=s;else if(!this.modified())return t.StopPropagation;}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t;}};let j5=0;function I5(t,e,n){this.id=++j5,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e);}function $6(t,e,n){return new I5(t,e,n);}I5.prototype={_filter:g,_apply:s,targets(){return this._targets||(this._targets=k5(f));},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume;},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,s=n?n.length:0;for(let t=0;t<s;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation());}},filter(t){const e=$6(t);return this.targets().add(e),e;},apply(t){const e=$6(null,t);return this.targets().add(e),e;},merge(){const t=$6();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t;},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0;});},debounce(t){const e=$6();return this.targets().add($6(null,null,en(t,t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run();}))),e;},between(t,e){let n=!1;return t.targets().add($6(null,null,()=>n=!0)),e.targets().add($6(null,null,()=>n=!1)),this.filter(()=>n);},detach(){this._filter=g,this._targets=null;}};const T4={skip:!0};function W6(t,e,n,s,r,l){const u=rn({},l,T4);let a,h;L(n)||(n=tn(n)),void 0===s?a=e=>t.touch(n(e)):L(s)?(h=new U4(null,s,r,!1),a=e=>{h.evaluate(e);const s=n(e),r=h.value;S6(r)?t.pulse(s,r,l):t.update(s,r,u);}):a=e=>t.update(n(e),s,u),e.apply(a);}function B6(t,e,n,s,r,l){if(void 0===s)e.targets().add(n);else{const u=l||{},a=new U4(null,function(t,e){return e=L(e)?e:tn(e),t?function(n,s){const r=e(n,s);return t.skip()||(t.skip(r!==this.value).value=r),r;}:e;}(n,s),r,!1);a.modified(u.force),a.rank=e.rank,e.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),t.connect(n,[a]));}}const G7={};function H6(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null;}function J7(t,n){const s=[];return Nn(t,n,t=>s.push(t)),s;}function K7(t,e){const n={};return t.visit(e,t=>{n[E7(t)]=1;}),t=>n[E7(t)]?null:t;}function Q5(t,e){return t?(n,s)=>t(n,s)&&e(n,s):e;}function V5(t,e,n,s){const r=this;let i=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=s||null,this.pulses=n;for(const t of n)if(t.stamp===e){if(t.fields){const e=r.fields||(r.fields={});for(const n in t.fields)e[n]=1;}t.changed(r.ADD)&&(i|=r.ADD),t.changed(r.REM)&&(i|=r.REM),t.changed(r.MOD)&&(i|=r.MOD);}this.changes=i;}function X6(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t;}H6.prototype={StopPropagation:G7,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new H6(this.dataflow).init(this,t);},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23);},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new H6(this.dataflow).init(this),t.add=t.source,t.rem=[]),t;},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n;},runAfter(t){this.dataflow.runAfter(t);},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length;},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,K7(this,1))),this;},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans;},modifies(e){const n=this.fields||(this.fields={});return w(e)?e.forEach(t=>n[t]=!0):n[e]=!0,this;},modified(e,n){const s=this.fields;return!(!n&&!this.mod.length||!s)&&(arguments.length?w(e)?e.some(t=>s[t]):s[e]:!!s);},filter(t,e){const n=this;return 1&t&&(n.addF=Q5(n.addF,e)),2&t&&(n.remF=Q5(n.remF,e)),4&t&&(n.modF=Q5(n.modF,e)),16&t&&(n.srcF=Q5(n.srcF,e)),n;},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=J7(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=J7(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=J7(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e;},visit(t,n){const s=this,r=n;if(16&t)return Nn(s.source,s.srcF,r),s;1&t&&Nn(s.add,s.addF,r),2&t&&Nn(s.rem,s.remF,r),4&t&&Nn(s.mod,s.modF,r);const i=s.source;if(8&t&&i){const t=s.add.length+s.mod.length;t===i.length||Nn(i,t?K7(s,5):s.srcF,r);}return s;}},an(V5,H6,{fork(t){const e=new H6(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,t=>e.add.push(t)),t&e.REM&&this.visit(e.REM,t=>e.rem.push(t)),t&e.MOD&&this.visit(e.MOD,t=>e.mod.push(t))),e;},changed(t){return this.changes&t;},modified(e){const n=this,s=n.fields;return s&&n.changes&n.MOD?w(e)?e.some(t=>s[t]):s[e]:0;},filter(){l("MultiPulse does not support filtering.");},materialize(){l("MultiPulse does not support materialization.");},visit(t,e){const n=this,s=n.pulses,r=s.length;let i=0;if(t&n.SOURCE)for(;i<r;++i)s[i].visit(t,e);else for(;i<r;++i)s[i].stamp===n.stamp&&s[i].visit(t,e);return n;}});const Y6={skip:!1,force:!1};function Z6(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),tt3(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let s;return e.length?(s=e[0],e[0]=n,function(t,e,n){const s=e,r=t.length,i=t[e];let o,l=1+(e<<1);for(;l<r;)o=l+1,o<r&&n(t[l],t[o])>=0&&(l=o),t[e]=t[l],l=1+((e=l)<<1);t[e]=i,tt3(t,s,e,n);}(e,0,t)):s=n,s;}};}function tt3(t,e,n,s){let r,i;const o=t[n];for(;n>e&&(i=n-1>>1,r=t[i],s(o,r)<0);)t[n]=r,n=i;return t[n]=o;}function et2(){this.logger(O()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=J5();try{this._loader=zt();}catch(t){}this._touched=k5(f),this._input={},this._pulse=null,this._heap=Z6((t,e)=>t.qrank-e.qrank),this._postrun=[];}function nt3(t){return function(){return this._log[t].apply(this,arguments);};}function st2(t,e){U4.call(this,t,null,e);}et2.prototype={stamp(){return this._clock;},loader(t){return arguments.length?(this._loader=t,this):this._loader;},locale(t){return arguments.length?(this._locale=t,this):this._locale;},logger(t){return arguments.length?(this._log=t,this):this._log;},error:nt3("error"),warn:nt3("warn"),info:nt3("info"),debug:nt3("debug"),logLevel:nt3("level"),cleanThreshold:1e4,add:function(t,e,n,s){let r,o=1;return t instanceof U4?r=t:t&&t.prototype instanceof U4?r=new t:L(t)?r=new U4(null,t):(o=0,r=new U4(t,e)),this.rank(r),o&&(s=n,n=e),n&&this.connect(r,r.parameters(n,s)),this.touch(r),r;},connect:function(t,e){const n=t.rank,s=e.length;for(let r=0;r<s;++r)if(n<e[r].rank)return void this.rerank(t);},rank:function(t){t.rank=++this._rank;},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&l("Cycle detected in dataflow graph.");},pulse:function(t,e,n){this.touch(t,n||Y6);const s=new H6(this,this._clock+(this._pulse?0:1)),r=t.pulse&&t.pulse.source||[];return s.target=t,this._input[t.id]=e.pulse(s,r),this;},touch:function(t,e){const n=e||Y6;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this;},update:function(t,e,n){const s=n||Y6;return(t.set(e)||s.force)&&this.touch(t,s),this;},changeset:L5,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e));},parse:function(t,e){const n=this.locale();return jt2(t,e,n.timeParse,n.utcParse);},preload:async function(t,e,n){const s=this,r=s._pending||function(t){let e;const n=new Promise(t=>e=t);return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t));},t._pending=n;}(s);r.requests+=1;const i=await s.request(e,n);return s.pulse(t,s.changeset().remove(g).insert(i.data||[])),r.done(),i;},request:async function(t,e){const n=this;let s,r=0;try{s=await n.loader().load(t,{context:"dataflow",response:kt1(e&&e.type)});try{s=n.parse(s,e);}catch(e){r=-2,n.warn("Data ingestion failed",t,e);}}catch(e){r=-1,n.warn("Loading failed",t,e);}return{data:s,status:r};},events:function(t,e,n,s){const i=this,o=$6(n,s),l=function(t){t.dataflow=i;try{o.receive(t);}catch(t){i.error(t);}finally{i.run();}};let u;u="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):H(t);const a=u.length;for(let t=0;t<a;++t)u[t].addEventListener(e,l);return o;},on:function(t,e,n,s,r){return(t instanceof U4?B6:W6)(this,t,e,n,s,r),this;},evaluate:async function(t,e,n){const s=this,r=[];if(s._pulse)return X6(s);if(s._pending&&await s._pending,e&&await w4(s,e),!s._touched.length)return s.debug("Dataflow invoked, but nothing to do."),s;const i=++s._clock;s._pulse=new H6(s,i,t),s._touched.forEach(t=>s._enqueue(t,!0)),s._touched=k5(f);let o,l,u,a=0;try{for(;s._heap.size()>0;)o=s._heap.pop(),o.rank===o.qrank?(l=o.run(s._getPulse(o,t)),l.then?l=await l:l.async&&(r.push(l.async),l=G7),l!==G7&&o._targets&&o._targets.forEach(t=>s._enqueue(t)),++a):s._enqueue(o,!0);}catch(t){s._heap.clear(),u=t;}if(s._input={},s._pulse=null,s.debug(`Pulse ${i}: ${a} operators`),u&&(s._postrun=[],s.error(u)),s._postrun.length){const t=s._postrun.sort((t,e)=>e.priority-t.priority);s._postrun=[];for(let e=0;e<t.length;++e)await w4(s,t[e].callback);}return n&&await w4(s,n),r.length&&Promise.all(r).then(t=>s.runAsync(null,()=>{t.forEach(t=>{try{t(s);}catch(t){s.error(t);}});})),s;},run:function(t,e,n){return this._pulse?X6(this):(this.evaluate(t,e,n),this);},runAsync:async function(t,e,n){for(;this._running;)await this._running;const s=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(s,s),this._running;},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this);}catch(t){this.error(t);}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t));},_getPulse:function(e,n){const s=e.source,r=this._clock;return s&&w(s)?new V5(this,r,s.map(t=>t.pulse),n):this._input[e.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==G7&&(t.source=e.source);return t;}(this._pulse,s&&s.pulse);}},an(st2,U4,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(t=>this.pulse=t):e!==t.StopPropagation&&(this.pulse=e),e;},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n;},transform(){}});const rt2={};function it2(t){const e=ot2(t);return e&&e.Definition||null;}function ot2(t){return t=t&&t.toLowerCase(),ln(rt2,t)?rt2[t]:null;}function*l6(t,n){if(null==n)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let e=-1;for(let r of t)r=n(r,++e,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r);}}function u7(e,r,o){const u=Float64Array.from(l6(e,o));return u.sort(r4),r.map(t=>yt(u,t));}function a6(t,n){return u7(t,[.25,.5,.75],n);}function f4(t,n){const r=t.length,o=E1(t,n),l=a6(t,n),u=(l[2]-l[0])/1.34;return 1.06*(Math.min(o,u)||o||Math.abs(l[0])||1)*Math.pow(r,-.2);}function s6(t){const n=t.maxbins||20,e=t.base||10,r=Math.log(e),o=t.divide||[5,2];let l,u,a,f,s,c,i=t.extent[0],h=t.extent[1];const d=t.span||h-i||Math.abs(i)||1;if(t.step)l=t.step;else if(t.steps){for(f=d/n,s=0,c=t.steps.length;s<c&&t.steps[s]<f;++s);l=t.steps[Math.max(0,s-1)];}else{for(u=Math.ceil(Math.log(n)/r),a=t.minstep||0,l=Math.max(a,Math.pow(e,Math.round(Math.log(d)/r)-u));Math.ceil(d/l)>n;)l*=e;for(s=0,c=o.length;s<c;++s)f=l/o[s],f>=a&&d/f<=n&&(l=f);}f=Math.log(l);const p=f>=0?0:1+~~(-f/r),M=Math.pow(e,-p-1);return(t.nice||void 0===t.nice)&&(f=Math.floor(i/l+M)*l,i=i<f?f-l:f,h=Math.ceil(h/l)*l),{start:i,stop:h===i?i+l:h,step:l};}var c5=Math.random;function i6(t){c5=t;}function h5(n,e,o,u){if(!n.length)return[void 0,void 0];const a=Float64Array.from(l6(n,u)),f=a.length,s=e;let i,h,d,p;for(d=0,p=Array(s);d<s;++d){for(i=0,h=0;h<f;++h)i+=a[~~(c5()*f)];p[d]=i/f;}return p.sort(r4),[ht(p,o/2),ht(p,1-o/2)];}function d5(t,n,e,r){r=r||(t=>t);const o=t.length,l=new Float64Array(o);let u,a=0,f=1,s=r(t[0]),c=s,i=s+n;for(;f<o;++f){if(u=r(t[f]),u>=i){for(c=(s+c)/2;a<f;++a)l[a]=c;i=u+n,s=u;}c=u;}for(c=(s+c)/2;a<f;++a)l[a]=c;return e?function(t,n){const e=t.length;let r,o,l=0,u=1;for(;t[l]===t[u];)++u;for(;u<e;){for(r=u+1;t[u]===t[r];)++r;if(t[u]-t[u-1]<n){for(o=u+(l+r-u-u>>1);o<u;)t[o++]=t[u];for(;o>u;)t[o--]=t[l];}l=u,u=r;}return t;}(l,n+n/4):l;}function p6(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647;};}function M6(t,n){let e,r,o;null==n&&(n=t,t=0);const l={min(t){return arguments.length?(e=t||0,o=r-e,l):e;},max(t){return arguments.length?(r=t||0,o=r-e,l):r;},sample:()=>e+Math.floor(o*c5()),pdf:t=>t===Math.floor(t)&&t>=e&&t<r?1/o:0,cdf(t){const n=Math.floor(t);return n<e?0:n>=r?1:(n-e+1)/o;},icdf:t=>t>=0&&t<=1?e-1+Math.floor(t*o):NaN};return l.min(t).max(n);}const g5=Math.sqrt(2*Math.PI),m6=Math.SQRT2;let w5=NaN;function x6(t,n){t=t||0,n=null==n?1:n;let e,r,o=0,l=0;if(w5==w5)o=w5,w5=NaN;else{do{o=2*c5()-1,l=2*c5()-1,e=o*o+l*l;}while(0===e||e>1)r=Math.sqrt(-2*Math.log(e)/e),o*=r,w5=l*r;}return t+o*n;}function b6(t,n,e){const r=(t-(n||0))/(e=null==e?1:e);return Math.exp(-.5*r*r)/(e*g5);}function N7(t,n,e){const r=(t-(n=n||0))/(e=null==e?1:e),o=Math.abs(r);let l;if(o>37)l=0;else{const t=Math.exp(-o*o/2);let n;o<7.07106781186547?(n=.0352624965998911*o+.700383064443688,n=n*o+6.37396220353165,n=n*o+33.912866078383,n=n*o+112.079291497871,n=n*o+221.213596169931,n=n*o+220.206867912376,l=t*n,n=.0883883476483184*o+1.75566716318264,n=n*o+16.064177579207,n=n*o+86.7807322029461,n=n*o+296.564248779674,n=n*o+637.333633378831,n=n*o+793.826512519948,n=n*o+440.413735824752,l/=n):(n=o+.65,n=o+4/n,n=o+3/n,n=o+2/n,n=o+1/n,l=t/n/2.506628274631);}return r>0?1-l:l;}function y3(t,n,e){return t<0||t>1?NaN:(n||0)+(null==e?1:e)*m6*function(t){let n,e=-Math.log((1-t)*(1+t));e<6.25?(e-=3.125,n=-364441206401782e-35,n=n*e-16850591381820166e-35,n=128584807152564e-32+n*e,n=11157877678025181e-33+n*e,n=n*e-1333171662854621e-31,n=20972767875968562e-33+n*e,n=6637638134358324e-30+n*e,n=n*e-4054566272975207e-29,n=n*e-8151934197605472e-29,n=26335093153082323e-28+n*e,n=n*e-12975133253453532e-27,n=n*e-5415412054294628e-26,n=10512122733215323e-25+n*e,n=n*e-4112633980346984e-24,n=n*e-29070369957882005e-24,n=42347877827932404e-23+n*e,n=n*e-13654692000834679e-22,n=n*e-13882523362786469e-21,n=18673420803405714e-20+n*e,n=n*e-740702534166267e-18,n=n*e-.006033670871430149,n=.24015818242558962+n*e,n=1.6536545626831027+n*e):e<16?(e=Math.sqrt(e)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*e,n=n*e-27517406297064545e-23,n=18239629214389228e-24+n*e,n=15027403968909828e-22+n*e,n=n*e-4013867526981546e-21,n=29234449089955446e-22+n*e,n=12475304481671779e-21+n*e,n=n*e-47318229009055734e-21,n=6828485145957318e-20+n*e,n=24031110387097894e-21+n*e,n=n*e-3550375203628475e-19,n=9532893797373805e-19+n*e,n=n*e-.0016882755560235047,n=.002491442096107851+n*e,n=n*e-.003751208507569241,n=.005370914553590064+n*e,n=1.0052589676941592+n*e,n=3.0838856104922208+n*e):Number.isFinite(e)?(e=Math.sqrt(e)-5,n=-27109920616438573e-27,n=n*e-2555641816996525e-25,n=15076572693500548e-25+n*e,n=n*e-3789465440126737e-24,n=761570120807834e-23+n*e,n=n*e-1496002662714924e-23,n=2914795345090108e-23+n*e,n=n*e-6771199775845234e-23,n=22900482228026655e-23+n*e,n=n*e-99298272942317e-20,n=4526062597223154e-21+n*e,n=n*e-1968177810553167e-20,n=7599527703001776e-20+n*e,n=n*e-21503011930044477e-20,n=n*e-13871931833623122e-20,n=1.0103004648645344+n*e,n=4.849906401408584+n*e):n=1/0;return n*t;}(2*t-1);}function q7(t,n){let e,r;const o={mean(t){return arguments.length?(e=t||0,o):e;},stdev(t){return arguments.length?(r=null==t?1:t,o):r;},sample:()=>x6(e,r),pdf:t=>b6(t,e,r),cdf:t=>N7(t,e,r),icdf:t=>y3(t,e,r)};return o.mean(t).stdev(n);}function A8(t,n){const e=q7();let r=0;const o={data(e){return arguments.length?(t=e,r=e?e.length:0,o.bandwidth(n)):t;},bandwidth(e){return arguments.length?(!(n=e)&&t&&(n=f4(t)),o):n;},sample:()=>t[~~(c5()*r)]+n*e.sample(),pdf(o){let l=0,u=0;for(;u<r;++u)l+=e.pdf((o-t[u])/n);return l/n/r;},cdf(o){let l=0,u=0;for(;u<r;++u)l+=e.cdf((o-t[u])/n);return l/r;},icdf(){throw Error("KDE icdf not supported.");}};return o.data(t);}function F6(t,n){return t=t||0,n=null==n?1:n,Math.exp(t+x6()*n);}function v6(t,n,e){if(t<=0)return 0;n=n||0,e=null==e?1:e;const r=(Math.log(t)-n)/e;return Math.exp(-.5*r*r)/(e*g5*t);}function S7(t,n,e){return N7(Math.log(t),n,e);}function E8(t,n,e){return Math.exp(y3(t,n,e));}function L6(t,n){let e,r;const o={mean(t){return arguments.length?(e=t||0,o):e;},stdev(t){return arguments.length?(r=null==t?1:t,o):r;},sample:()=>F6(e,r),pdf:t=>v6(t,e,r),cdf:t=>S7(t,e,r),icdf:t=>E8(t,e,r)};return o.mean(t).stdev(n);}function P6(t,n){let e,r=0;const o={weights(t){return arguments.length?(e=function(t){const n=[];let e,o=0;for(e=0;e<r;++e)o+=n[e]=null==t[e]?1:+t[e];for(e=0;e<r;++e)n[e]/=o;return n;}(n=t||[]),o):n;},distributions(e){return arguments.length?(e?(r=e.length,t=e):(r=0,t=[]),o.weights(n)):t;},sample(){const n=c5();let o=t[r-1],l=e[0],u=0;for(;u<r-1;l+=e[++u])if(n<l){o=t[u];break;}return o.sample();},pdf(n){let o=0,l=0;for(;l<r;++l)o+=e[l]*t[l].pdf(n);return o;},cdf(n){let o=0,l=0;for(;l<r;++l)o+=e[l]*t[l].cdf(n);return o;},icdf(){throw Error("Mixture icdf not supported.");}};return o.distributions(t).weights(n);}function k6(t,n){return null==n&&(n=null==t?1:t,t=0),t+(n-t)*c5();}function D6(t,n,e){return null==e&&(e=null==n?1:n,n=0),t>=n&&t<=e?1/(e-n):0;}function I6(t,n,e){return null==e&&(e=null==n?1:n,n=0),t<n?0:t>e?1:(t-n)/(e-n);}function C7(t,n,e){return null==e&&(e=null==n?1:n,n=0),t>=0&&t<=1?n+t*(e-n):NaN;}function K8(t,n){let e,r;const o={min(t){return arguments.length?(e=t||0,o):e;},max(t){return arguments.length?(r=null==t?1:t,o):r;},sample:()=>k6(e,r),pdf:t=>D6(t,e,r),cdf:t=>I6(t,e,r),icdf:t=>C7(t,e,r)};return null==n&&(n=null==t?1:t,t=0),o.min(t).max(n);}function Q6(t,n,e){let r=0,o=0;for(const l of t){const t=e(l);null==n(l)||null==t||isNaN(t)||(r+=(t-r)/++o);}return{coef:[r],predict:()=>r,rSquared:0};}function R7(t,n,e,r){const o=r-t*t,l=Math.abs(o)<1e-24?0:(e-t*n)/o;return[n-l*t,l];}function G8(t,n,e,r){t=t.filter(t=>{let r=n(t),o=e(t);return null!=r&&(r=+r)>=r&&null!=o&&(o=+o)>=o;}),r&&t.sort((t,e)=>n(t)-n(e));const o=t.length,l=new Float64Array(o),u=new Float64Array(o);let a,f,s,c=0,i=0,h=0;for(s of t)l[c]=a=+n(s),u[c]=f=+e(s),++c,i+=(a-i)/c,h+=(f-h)/c;for(c=0;c<o;++c)l[c]-=i,u[c]-=h;return[l,u,i,h];}function T5(t,n,e,r){let o,l,u=-1;for(const a of t)o=n(a),l=e(a),null!=o&&(o=+o)>=o&&null!=l&&(l=+l)>=l&&r(o,l,++u);}function U5(t,n,e,r,o){let l=0,u=0;return T5(t,n,e,(t,n)=>{const e=n-o(t),a=n-r;l+=e*e,u+=a*a;}),1-l/u;}function j6(t,n,e){let r=0,o=0,l=0,u=0,a=0;T5(t,n,e,(t,n)=>{++a,r+=(t-r)/a,o+=(n-o)/a,l+=(t*n-l)/a,u+=(t*t-u)/a;});const f=R7(r,o,l,u),s=t=>f[0]+f[1]*t;return{coef:f,predict:s,rSquared:U5(t,n,e,o,s)};}function z7(t,n,e){let r=0,o=0,l=0,u=0,a=0;T5(t,n,e,(t,n)=>{++a,t=Math.log(t),r+=(t-r)/a,o+=(n-o)/a,l+=(t*n-l)/a,u+=(t*t-u)/a;});const f=R7(r,o,l,u),s=t=>f[0]+f[1]*Math.log(t);return{coef:f,predict:s,rSquared:U5(t,n,e,o,s)};}function B7(t,n,e){const[r,o,l,u]=G8(t,n,e);let a,f,s,c=0,i=0,h=0,d=0,p=0;T5(t,n,e,(t,n)=>{a=r[p++],f=Math.log(n),s=a*n,c+=(n*f-c)/p,i+=(s-i)/p,h+=(s*f-h)/p,d+=(a*s-d)/p;});const[M,g]=R7(i/u,c/u,h/u,d/u),m=t=>Math.exp(M+g*(t-l));return{coef:[Math.exp(M-g*l),g],predict:m,rSquared:U5(t,n,e,u,m)};}function H7(t,n,e){let r=0,o=0,l=0,u=0,a=0,f=0;T5(t,n,e,(t,n)=>{const e=Math.log(t),s=Math.log(n);++f,r+=(e-r)/f,o+=(s-o)/f,l+=(e*s-l)/f,u+=(e*e-u)/f,a+=(n-a)/f;});const s=R7(r,o,l,u),c=t=>s[0]*Math.pow(t,s[1]);return s[0]=Math.exp(s[0]),{coef:s,predict:c,rSquared:U5(t,n,e,a,c)};}function J8(t,n,e){const[r,o,l,u]=G8(t,n,e),a=r.length;let f,s,c,i,h=0,d=0,p=0,M=0,g=0;for(f=0;f<a;)s=r[f],c=o[f++],i=s*s,h+=(i-h)/f,d+=(i*s-d)/f,p+=(i*i-p)/f,M+=(s*c-M)/f,g+=(i*c-g)/f;const m=p-h*h,w=h*m-d*d,x=(g*h-M*d)/w,b=(M*m-g*d)/w,N=-x*h,y=t=>x*(t-=l)*t+b*t+N+u;return{coef:[N-b*l+x*l*l+u,b-2*x*l,x],predict:y,rSquared:U5(t,n,e,u,y)};}function O7(t,n,e,r){if(0===r)return Q6(t,n,e);if(1===r)return j6(t,n,e);if(2===r)return J8(t,n,e);const[o,l,u,a]=G8(t,n,e),f=o.length,s=[],c=[],i=r+1;let h,d,p,M,g;for(h=0;h<i;++h){for(p=0,M=0;p<f;++p)M+=Math.pow(o[p],h)*l[p];for(s.push(M),g=new Float64Array(i),d=0;d<i;++d){for(p=0,M=0;p<f;++p)M+=Math.pow(o[p],h+d);g[d]=M;}c.push(g);}c.push(s);const m=function(t){const n=t.length-1,e=[];let r,o,l,u,a;for(r=0;r<n;++r){for(u=r,o=r+1;o<n;++o)Math.abs(t[r][o])>Math.abs(t[r][u])&&(u=o);for(l=r;l<n+1;++l)a=t[l][r],t[l][r]=t[l][u],t[l][u]=a;for(o=r+1;o<n;++o)for(l=n;l>=r;l--)t[l][o]-=t[l][r]*t[r][o]/t[r][r];}for(o=n-1;o>=0;--o){for(a=0,l=o+1;l<n;++l)a+=t[l][o]*e[l];e[o]=(t[n][o]-a)/t[o][o];}return e;}(c),w=t=>{t-=u;let n=a+m[0]+m[1]*t+m[2]*t*t;for(h=3;h<i;++h)n+=m[h]*Math.pow(t,h);return n;};return{coef:V6(i,m,-u,a),predict:w,rSquared:U5(t,n,e,a,w)};}function V6(t,n,e,r){const o=Array(t);let l,u,a,f;for(l=0;l<t;++l)o[l]=0;for(l=t-1;l>=0;--l)for(a=n[l],f=1,o[l]+=a,u=1;u<=l;++u)f*=(l+1-u)/u,o[l-u]+=a*Math.pow(e,u)*f;return o[0]+=r,o;}function W7(t,n,e,r){const[l,u,a,f]=G8(t,n,e,!0),s=l.length,c=Math.max(2,~~(r*s)),i=new Float64Array(s),h=new Float64Array(s),d=new Float64Array(s).fill(1);for(let t=-1;++t<=2;){const n=[0,c-1];for(let t=0;t<s;++t){const e=l[t],r=n[0],o=n[1],a=e-l[r]>l[o]-e?r:o;let f=0,s=0,c=0,p=0,M=0;const g=1/Math.abs(l[a]-e||1);for(let t=r;t<=o;++t){const n=l[t],r=u[t],o=X7(Math.abs(e-n)*g)*d[t],a=n*o;f+=o,s+=a,c+=r*o,p+=r*a,M+=n*a;}const[m,w]=R7(s/f,c/f,p/f,M/f);i[t]=m+w*e,h[t]=Math.abs(u[t]-i[t]),Y7(l,t+1,n);}if(2===t)break;const e=vt(h);if(Math.abs(e)<1e-12)break;for(let t,n,r=0;r<s;++r)t=h[r]/(6*e),d[r]=t>=1?1e-12:(n=1-t*t)*n;}return function(t,n,e,r){const o=t.length,l=[];let u,a=0,f=0,s=[];for(;a<o;++a)u=t[a]+e,s[0]===u?s[1]+=(n[a]-s[1])/++f:(f=0,s[1]+=r,s=[u,n[a]],l.push(s));return s[1]+=r,l;}(l,i,a,f);}function X7(t){return(t=1-t*t*t)*t*t;}function Y7(t,n,e){const r=t[n];let o=e[0],l=e[1]+1;if(!(l>=t.length))for(;n>o&&t[l]-r<=r-t[o];)e[0]=++o,e[1]=l,++l;}const Z7=.5*Math.PI/180;function $7(t,n,e,r){e=e||25,r=Math.max(e,r||200);const o=n=>[n,t(n)],l=n[0],u=n[1],a=u-l,f=a/r,s=[o(l)],c=[];if(e===r){for(let t=1;t<r;++t)s.push(o(l+t/e*a));return s.push(o(u)),s;}c.push(o(u));for(let t=e;--t>0;)c.push(o(l+t/e*a));let i=s[0],h=c[c.length-1];const d=1/a,p=function(t,n){let e=t,r=t;const o=n.length;for(let t=0;t<o;++t){const o=n[t][1];o<e&&(e=o),o>r&&(r=o);}return 1/(r-e);}(i[1],c);for(;h;){const t=o((i[0]+h[0])/2);t[0]-i[0]>=f&&_5(i,t,h,d,p)>Z7?c.push(t):(i=h,s.push(h),c.pop()),h=c[c.length-1];}return s;}function _5(t,n,e,r,o){const l=Math.atan2(o*(e[1]-t[1]),r*(e[0]-t[0])),u=Math.atan2(o*(n[1]-t[1]),r*(n[0]-t[0]));return Math.abs(l-u);}function ie1(e){return e&&e.length?1===e.length?e[0]:(t=e,e=>{const n=t.length;let i=1,a=String(t[0](e));for(;i<n;++i)a+="|"+t[i](e);return a;}):function(){return"";};var t;}function ae1(e,t,n){return n||e+(t?"_"+t:"");}const se1=()=>{},re1={init:se1,add:se1,rem:se1,idx:0},le1={values:{init:e=>e.cell.store=!0,value:e=>e.cell.data.values(),idx:-1},count:{value:e=>e.cell.num},__count__:{value:e=>e.missing+e.valid},missing:{value:e=>e.missing},valid:{value:e=>e.valid},sum:{init:e=>e.sum=0,value:e=>e.valid?e.sum:void 0,add:(e,t)=>e.sum+=+t,rem:(e,t)=>e.sum-=t},product:{init:e=>e.product=1,value:e=>e.valid?e.product:void 0,add:(e,t)=>e.product*=t,rem:(e,t)=>e.product/=t},mean:{init:e=>e.mean=0,value:e=>e.valid?e.mean:void 0,add:(e,t)=>(e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid),rem:(e,t)=>(e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean)},average:{value:e=>e.valid?e.mean:void 0,req:["mean"],idx:1},variance:{init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):void 0,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean),req:["mean"],idx:1},variancep:{value:e=>e.valid>1?e.dev/e.valid:void 0,req:["variance"],idx:2},stdev:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):void 0,req:["variance"],idx:2},stderr:{value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:e=>e.cell.data.distinct(e.get),req:["values"],idx:3},ci0:{value:e=>e.cell.data.ci0(e.get),req:["values"],idx:3},ci1:{value:e=>e.cell.data.ci1(e.get),req:["values"],idx:3},median:{value:e=>e.cell.data.q2(e.get),req:["values"],idx:3},q1:{value:e=>e.cell.data.q1(e.get),req:["values"],idx:3},q3:{value:e=>e.cell.data.q3(e.get),req:["values"],idx:3},min:{init:e=>e.min=void 0,value:e=>e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min,add:(e,t)=>{(t<e.min||void 0===e.min)&&(e.min=t);},rem:(e,t)=>{t<=e.min&&(e.min=NaN);},req:["values"],idx:4},max:{init:e=>e.max=void 0,value:e=>e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max,add:(e,t)=>{(t>e.max||void 0===e.max)&&(e.max=t);},rem:(e,t)=>{t>=e.max&&(e.max=NaN);},req:["values"],idx:4},argmin:{init:e=>e.argmin=void 0,value:e=>e.argmin||e.cell.data.argmin(e.get),add:(e,t,n)=>{t<e.min&&(e.argmin=n);},rem:(e,t)=>{t<=e.min&&(e.argmin=void 0);},req:["min","values"],idx:3},argmax:{init:e=>e.argmax=void 0,value:e=>e.argmax||e.cell.data.argmax(e.get),add:(e,t,n)=>{t>e.max&&(e.argmax=n);},rem:(e,t)=>{t>=e.max&&(e.argmax=void 0);},req:["max","values"],idx:3},exponential:{init:(e,t)=>{e.exp=0,e.exp_r=t;},value:e=>e.valid?e.exp*(1-e.exp_r)/(1-e.exp_r**e.valid):void 0,add:(e,t)=>e.exp=e.exp_r*e.exp+t,rem:(e,t)=>e.exp=(e.exp-t/e.exp_r**(e.valid-1))/e.exp_r},exponentialb:{value:e=>e.valid?e.exp*(1-e.exp_r):void 0,req:["exponential"],idx:1}},ue1=Object.keys(le1).filter(e=>"__count__"!==e);function oe1(e,t,n){return le1[e](n,t);}function de(e,t){return e.idx-t.idx;}function me1(){this.valid=0,this.missing=0,this._ops.forEach(e=>null==e.aggregate_param?e.init(this):e.init(this,e.aggregate_param));}function fe(e,t){null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach(n=>n.add(this,e,t))):++this.missing;}function ce1(e,t){null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach(n=>n.rem(this,e,t))):--this.missing;}function he1(e){return this._out.forEach(t=>e[t.out]=t.value(this)),e;}function pe(e,t){const n=t||s,i=function(e){const t={};e.forEach(e=>t[e.name]=e);const n=e=>{e.req&&e.req.forEach(e=>{t[e]||n(t[e]=le1[e]());});};return e.forEach(n),Object.values(t).sort(de);}(e),a=e.slice().sort(de);function s1(e){this._ops=i,this._out=a,this.cell=e,this.init();}return s1.prototype.init=me1,s1.prototype.add=fe,s1.prototype.rem=ce1,s1.prototype.set=he1,s1.prototype.get=n,s1.fields=e.map(e=>e.out),s1;}function ve(e){this._key=e?i(e):E7,this.reset();}[...ue1,"__count__"].forEach(e=>{le1[e]=function(e,t){return(n,i)=>rn({name:e,aggregate_param:i,out:n||e},re1,t);}(e,le1[e]);});const ge1=ve.prototype;function ye(e){st2.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null;}ge1.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null;},ge1.add=function(e){this._add.push(e);},ge1.rem=function(e){this._rem.push(e);},ge1.values=function(){if(this._get=null,0===this._rem.length)return this._add;const e=this._add,t=this._rem,n=this._key,i=e.length,a=t.length,s=Array(i-a),r={};let l,u,o;for(l=0;l<a;++l)r[n(t[l])]=1;for(l=0,u=0;l<i;++l)r[n(o=e[l])]?r[n(o)]=0:s[u++]=o;return this._rem=[],this._add=s;},ge1.distinct=function(e){const t=this.values(),n={};let i,a=t.length,s=0;for(;--a>=0;)i=e(t[a])+"",ln(n,i)||(n[i]=1,++s);return s;},ge1.extent=function(e){if(this._get!==e||!this._ext){const t=this.values(),n=on(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e;}return this._ext;},ge1.argmin=function(e){return this.extent(e)[0]||{};},ge1.argmax=function(e){return this.extent(e)[1]||{};},ge1.min=function(e){const t=this.extent(e)[0];return null!=t?e(t):void 0;},ge1.max=function(e){const t=this.extent(e)[1];return null!=t?e(t):void 0;},ge1.quartile=function(e){return this._get===e&&this._q||(this._q=a6(this.values(),e),this._get=e),this._q;},ge1.q1=function(e){return this.quartile(e)[0];},ge1.q2=function(e){return this.quartile(e)[1];},ge1.q3=function(e){return this.quartile(e)[2];},ge1.ci=function(e){return this._get===e&&this._ci||(this._ci=h5(this.values(),1e3,.05,e),this._get=e),this._ci;},ge1.ci0=function(e){return this.ci(e)[0];},ge1.ci1=function(e){return this.ci(e)[1];},ye.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ue1},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},an(ye,st2,{transform(e,t){const n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.modified();return n.stamp=i.stamp,n.value&&(a||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=a?n.init(e):Object.create(null),t.visit(t.SOURCE,e=>n.add(e))):(n.value=n.value||n.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),i.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),t.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i);},cross(){const e=this,t=e.value,n=e._dnames,i=n.map(()=>({})),a=n.length;function s(e){let t,s,r,l;for(t in e)for(r=e[t].tuple,s=0;s<a;++s)i[s][l=r[n[s]]]=l;}s(e._prev),s(t),function s(r,l,u){const o=n[u],d=i[u++];for(const n in d){const i=r?r+"|"+n:n;l[o]=d[n],u<a?s(i,l,u):t[i]||e.cell(i,l);}}("",{},0);},init(e1){const s=this._inputs=[],r=this._outputs=[],l1={};function u(e1){const n=H(e(e1)),i=n.length;let r,u=0;for(;u<i;++u)l1[r=n[u]]||(l1[r]=1,s.push(r));}this._dims=H(e1.groupby),this._dnames=this._dims.map(e=>{const t=t1(e);return u(e),r.push(t),t;}),this.cellkey=e1.key?e1.key:ie1(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=e1.fields||[null],d=e1.ops||["count"],m=e1.aggregate_params||[null],f=e1.as||[],c=o.length,h={};let p,v,g,y,_,x,b;for(c!==d.length&&l("Unmatched number of fields and aggregate ops."),b=0;b<c;++b)p=o[b],v=d[b],g=m[b]||null,null==p&&"count"!==v&&l("Null aggregate field specified."),_=t1(p),x=ae1(v,_,f[b]),r.push(x),"count"!==v?(y=h[_],y||(u(p),y=h[_]=[],y.field=p,this._measures.push(y)),"count"!==v&&(this._countOnly=!1),y.push(oe1(v,g,x))):this._counts.push(x);return this._measures=this._measures.map(e=>pe(e,e.field)),Object.create(null);},cellkey:ie1(),cell(e,t){let n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n;},newcell(e,t){const n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){const e=this._measures,t=e.length;n.agg=Array(t);for(let i=0;i<t;++i)n.agg[i]=new e[i](n);}return n.store&&(n.data=new ve),n;},newtuple(e,t){const n=this._dnames,i=this._dims,a=i.length,s={};for(let t=0;t<a;++t)s[n[t]]=i[t](e);return t?M5(t.tuple,s):O6(s);},clean(){const e=this.value;for(const t in e)0===e[t].num&&delete e[t];},add(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(e);const i=n.agg;for(let t=0,n=i.length;t<n;++t)i[t].add(i[t].get(e),e);},rem(e){const t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(e);const i=n.agg;for(let t=0,n=i.length;t<n;++t)i[t].rem(i[t].get(e),e);},celltuple(e){const t=e.tuple,n=this._counts;e.store&&e.data.values();for(let i=0,a=n.length;i<a;++i)t[n[i]]=e.num;if(!this._countOnly){const n=e.agg;for(let e=0,i=n.length;e<i;++e)n[e].set(t);}return t;},changes(e){const t=this._adds,n=this._mods,i=this._prev,a=this._drop,s=e.add,r=e.rem,l=e.mod;let u,o,d,m;if(i)for(o in i)u=i[o],a&&!u.num||r.push(u.tuple);for(d=0,m=this._alen;d<m;++d)s.push(this.celltuple(t[d])),t[d]=null;for(d=0,m=this._mlen;d<m;++d)u=n[d],(0===u.num&&a?r:l).push(this.celltuple(u)),n[d]=null;return this._alen=this._mlen=0,this._prev=null,e;}});function _e(e){st2.call(this,null,e);}function xe(e,t,n){const i=e;let a=t||[],s=n||[],r={},l=0;return{add:e=>s.push(e),remove:e=>r[i(e)]=++l,size:()=>a.length,data:(e,t)=>(l&&(a=a.filter(e=>!r[i(e)]),r={},l=0),t&&e&&a.sort(e),s.length&&(a=e?wn(e,a,s.sort(e)):a.concat(s),s=[]),a)};}function be(e){st2.call(this,[],e);}function De(e){U4.call(this,null,Oe,e);}function Oe(e){return this.value&&!e.modified()?this.value:Q(e.fields,e.orders);}function Ee(e){st2.call(this,null,e);}function ke(e){st2.call(this,null,e);}_e.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},an(_e,st2,{transform(e1,t){const n=!1!==e1.interval,i=this._bins(e1),s=i.start,r=i.step,l=e1.as||["bin0","bin1"],u=l[0],o=l[1];let d;return d=e1.modified()?(t=t.reflow(!0)).SOURCE:t.modified(e(e1.field))?t.ADD_MOD:t.ADD,t.visit(d,n?e=>{const t=i(e);e[u]=t,e[o]=null==t?null:s+r*(1+(t-s)/r);}:e=>e[u]=i(e)),t.modifies(n?l:u);},_bins(e1){if(this.value&&!e1.modified())return this.value;const t=e1.field,i=s6(e1),r=i.step;let l,o,d=i.start,m=d+Math.ceil((i.stop-d)/r)*r;null!=(l=e1.anchor)&&(o=l-(d+r*Math.floor((l-d)/r)),d+=o,m+=o);const f=function(e){let n=z(t(e));return null==n?null:n<d?-1/0:n>m?1/0:(n=Math.max(d,Math.min(n,m-r)),d+r*Math.floor(1e-14+(n-d)/r));};return f.start=d,f.stop=i.stop,f.step=r,this.value=n1(f,e(t),e1.name||"bin_"+t1(t));}}),be.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},an(be,st2,{transform(e,t){const n=t.fork(t.ALL),i=xe(E7,this.value,n.materialize(n.ADD).add),a=e.sort,s=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return n.visit(n.REM,i.remove),this.modified(s),this.value=n.source=i.data(b5(a),s),t.source&&t.source.root&&(this.value.root=t.source.root),n;}}),an(De,U4),Ee.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},an(Ee,st2,{transform(e,t){const n=t=>n=>{for(var i,a=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();}return e.match(n);}(l(n),e.case,s)||[],u=0,o=a.length;u<o;++u)r.test(i=a[u])||t(i);},i=this._parameterCheck(e,t),a=this._counts,s=this._match,r=this._stop,l=e.field,u=e.as||["text","count"],o=n(e=>a[e]=1+(a[e]||0)),d=n(e=>a[e]-=1);return i?t.visit(t.SOURCE,o):(t.visit(t.ADD,o),t.visit(t.REM,d)),this._finish(t,u);},_parameterCheck(e,t){let n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n;},_finish(e,t){const n=this._counts,i=this._tuples||(this._tuples={}),a=t[0],s=t[1],r=e.fork(e.NO_SOURCE|e.NO_FIELDS);let l,u,o;for(l in n)u=i[l],o=n[l]||0,!u&&o?(i[l]=u=O6({}),u[a]=l,u[s]=o,r.add.push(u)):0===o?(u&&r.rem.push(u),n[l]=null,i[l]=null):u[s]!==o&&(u[s]=o,r.mod.push(u));return r.modifies(t);}}),ke.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},an(ke,st2,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.as||["a","b"],a=i[0],s=i[1],l=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter");let u=this.value;return l?(u&&(n.rem=u),u=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,i){for(var a,s,r=[],l={},u=e.length,o=0;o<u;++o)for(l[t]=s=e[o],a=0;a<u;++a)l[n]=e[a],i(l)&&(r.push(O6(l)),(l={})[t]=s);return r;}(u,a,s,e.filter||g)):n.mod=u,n.source=this.value,n.modifies(i);}});const qe={kde:A8,mixture:P6,normal:q7,lognormal:L6,uniform:K8},we="function";function Re(e,t){const n=e[we];ln(qe,n)||l("Unknown distribution function: "+n);const a=qe[n]();for(const n in e)"field"===n?a.data((e.from||t()).map(e[n])):"distributions"===n?a[n](e[n].map(e=>Re(e,t))):typeof a[n]===we&&a[n](e[n]);return a;}function Se(e){st2.call(this,null,e);}const Ne=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Me1={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Ne},{name:"weights",type:"number",array:!0}]};function Ce1(e,t){return e?e.map((e,i)=>t[i]||t1(e)):null;}function Ue1(e,t,n){const i=[],a=e=>e(u);let s,r,l,u,o,d;if(null==t)i.push(e.map(n));else for(s={},r=0,l=e.length;r<l;++r)u=e[r],o=t.map(a),d=s[o],d||(s[o]=d=[],d.dims=o,i.push(d)),d.push(n(u));return i;}Se.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Ne.concat(Me1)},{name:"as",type:"string",array:!0,default:["value","density"]}]},an(Se,st2,{transform(e,t){const n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const a=Re(e.distribution,function(e){return()=>e.materialize(e.SOURCE).source;}(t)),s=e.steps||e.minsteps||25,r=e.steps||e.maxsteps||200;let u=e.method||"pdf";"pdf"!==u&&"cdf"!==u&&l("Invalid density method: "+u),e.extent||a.data||l("Missing density extent parameter."),u=a[u];const o=e.as||["value","density"],d=e.extent||un(a.data()),m=$7(u,d,s,r).map(e=>{const t={};return t[o[0]]=e[0],t[o[1]]=e[1],O6(t);});this.value&&(n.rem=this.value),this.value=n.add=n.source=m;}return n;}});function Ae(e){st2.call(this,null,e);}Ae.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function ze(e){U4.call(this,null,Le,e),this.modified(!0);}function Le(e1){const t=e1.expr;return this.value&&!e1.modified("expr")?this.value:n1(n=>t(n,e1),e(t),t1(t));}function Fe(e){st2.call(this,[void 0,void 0],e);}function Ie(e,t){U4.call(this,e),this.parent=t,this.count=0;}function je(e){st2.call(this,{},e),this._keys=fn();const t=this._targets=[];t.active=0,t.forEach=e=>{for(let n=0,i=t.active;n<i;++n)e(t[n],n,t);};}function Pe(e){U4.call(this,null,Te1,e);}function Te1(e){return this.value&&!e.modified()?this.value:w(e.name)?H(e.name).map(e=>i(e)):i(e.name,e.as);}function $e(e){st2.call(this,fn(),e);}function We(e){st2.call(this,[],e);}function Be(e){st2.call(this,[],e);}function Je(e){st2.call(this,null,e);}function Ke(e){st2.call(this,[],e);}an(Ae,st2,{transform(e,t){if(this.value&&!e.modified()&&!t.changed())return t;const n=t.materialize(t.SOURCE).source,i=Ue1(t.source,e.groupby,s),a=e.smooth||!1,s1=e.field,r=e.step||((e,t)=>kn(un(e,t))/30)(n,s1),u=b5((e,t)=>s1(e)-s1(t)),o=e.as||"bin",d=i.length;let m,f=1/0,c=-1/0,h=0;for(;h<d;++h){const e=i[h].sort(u);m=-1;for(const t of d5(e,r,a,s1))t<f&&(f=t),t>c&&(c=t),e[++m][o]=t;}return this.value={start:f,stop:c,step:r},t.reflow(!0).modifies(o);}}),an(ze,U4),Fe.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},an(Fe,st2,{transform(e,t){const i=this.value,a=e.field,s=t.changed()||t.modified(a.fields)||e.modified("field");let r=i[0],l=i[1];if((s||null==r)&&(r=1/0,l=-1/0),t.visit(s?t.SOURCE:t.ADD,e=>{const t=z(a(e));null!=t&&(t<r&&(r=t),t>l&&(l=t));}),!Number.isFinite(r)||!Number.isFinite(l)){let e=t1(a);e&&(e=` for field "${e}"`),t.dataflow.warn(`Infinite extent${e}: [${r}, ${l}]`),r=l=void 0;}this.value=[r,l];}}),an(Ie,U4,{connect(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this;},add(e){this.count+=1,this.value.add.push(e);},rem(e){this.count-=1,this.value.rem.push(e);},mod(e){this.value.mod.push(e);},init(e){this.value.init(e,e.NO_SOURCE);},evaluate(){return this.value;}}),an(je,st2,{activate(e){this._targets[this._targets.active++]=e;},subflow(e,t,n,i){const a=this.value;let s,r,l=ln(a,e)&&a[e];return l?l.value.stamp<n.stamp&&(l.init(n),this.activate(l)):(r=i||(r=this._group[e])&&r.tuple,s=n.dataflow,l=new Ie(n.fork(n.NO_SOURCE),this),s.add(l).connect(t(s,e,r)),a[e]=l,this.activate(l)),l;},clean(){const e=this.value;let t=0;for(const n in e)if(0===e[n].count){const i=e[n].detachSubflow;i&&i(),delete e[n],++t;}if(t){const e=this._targets.filter(e=>e&&e.count>0);this.initTargets(e);}},initTargets(e){const t=this._targets,n=t.length,i=e?e.length:0;let a=0;for(;a<i;++a)t[a]=e[a];for(;a<n&&null!=t[a];++a)t[a]=null;t.active=i;},transform(e,t){const n=t.dataflow,i=e.key,a=e.subflow,s=this._keys,r=e.modified("key"),l=e=>this.subflow(e,a,t);return this._group=e.group||{},this.initTargets(),t.visit(t.REM,e=>{const t=E7(e),n=s.get(t);void 0!==n&&(s.delete(t),l(n).rem(e));}),t.visit(t.ADD,e=>{const t=i(e);s.set(E7(e),t),l(t).add(e);}),r||t.modified(i.fields)?t.visit(t.MOD,e=>{const t=E7(e),n=s.get(t),a=i(e);n===a?l(a).mod(e):(s.set(t,a),l(n).rem(e),l(a).add(e));}):t.changed(t.MOD)&&t.visit(t.MOD,e=>{l(s.get(E7(e))).mod(e);}),r&&t.visit(t.REFLOW,e=>{const t=E7(e),n=s.get(t),a=i(e);n!==a&&(s.set(t,a),l(n).rem(e),l(a).add(e));}),t.clean()?n.runAfter(()=>{this.clean(),s.clean();}):s.empty>n.cleanThreshold&&n.runAfter(s.clean),t;}}),an(Pe,U4),$e.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},an($e,st2,{transform(e,t){const n=t.dataflow,i=this.value,a=t.fork(),s=a.add,r=a.rem,l=a.mod,u=e.expr;let o=!0;function d(t){const n=E7(t),a=u(t,e),d=i.get(n);a&&d?(i.delete(n),s.push(t)):a||d?o&&a&&!d&&l.push(t):(i.set(n,1),r.push(t));}return t.visit(t.REM,e=>{const t=E7(e);i.has(t)?i.delete(t):r.push(e);}),t.visit(t.ADD,t=>{u(t,e)?s.push(t):i.set(E7(t),1);}),t.visit(t.MOD,d),e.modified()&&(o=!1,t.visit(t.REFLOW,d)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),a;}}),We.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},an(We,st2,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,a=Ce1(i,e.as||[]),s=e.index||null,r=a.length;return n.rem=this.value,t.visit(t.SOURCE,e=>{const t=i.map(t=>t(e)),l=t.reduce((e,t)=>Math.max(e,t.length),0);let u,o,d,m=0;for(;m<l;++m){for(o=P5(e),u=0;u<r;++u)o[a[u]]=null==(d=t[u][m])?null:d;s&&(o[s]=m),n.add.push(o);}}),this.value=n.source=n.add,s&&n.modifies(s),n.modifies(a);}}),Be.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},an(Be,st2,{transform(e,t){const i=t.fork(t.NO_SOURCE),a=e.fields,s=a.map(t1),r=e.as||["key","value"],l=r[0],u=r[1],o=a.length;return i.rem=this.value,t.visit(t.SOURCE,e=>{for(let t,n=0;n<o;++n)t=P5(e),t[l]=s[n],t[u]=a[n](e),i.add.push(t);}),this.value=i.source=i.add,i.modifies(r);}}),Je.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},an(Je,st2,{transform(e,t){const n=e.expr,i=e.as,a=e.modified(),s=e.initonly?t.ADD:a?t.SOURCE:t.modified(n.fields)||t.modified(i)?t.ADD_MOD:t.ADD;return a&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(i),t.visit(s,t=>t[i]=n(t,e));}}),an(Ke,st2,{transform(e,t){const n=t.fork(t.ALL),i=e.generator;let a,s,r,l=this.value,u=e.size-l.length;if(u>0){for(a=[];--u>=0;)a.push(r=O6(i(e))),l.push(r);n.add=n.add.length?n.materialize(n.ADD).add.concat(a):a;}else s=l.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(s):s,l=l.slice(-u);return n.source=this.value=l,n;}});const Qe={value:"value",median:vt,mean:Mt,min:ut,max:ft},Ge=[];function He(e){st2.call(this,[],e);}function Ve(e){ye.call(this,e);}function Xe(e){st2.call(this,null,e);}function Ye(e){U4.call(this,null,Ze,e);}function Ze(e){return this.value&&!e.modified()?this.value:dn(e.fields,e.flat);}function et3(e){st2.call(this,[],e),this._pending=null;}function tt4(e,t,n){n.forEach(O6);const i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.source=i.add=n,e._pending=null,i.rem.length&&i.clean(!0),i;}function nt4(e){st2.call(this,{},e);}function it3(e){U4.call(this,null,at3,e);}function at3(e){if(this.value&&!e.modified())return this.value;const t=e.extents,n=t.length;let i,a,s=1/0,r=-1/0;for(i=0;i<n;++i)a=t[i],a[0]<s&&(s=a[0]),a[1]>r&&(r=a[1]);return[s,r];}function st3(e){U4.call(this,null,rt3,e);}function rt3(e){return this.value&&!e.modified()?this.value:e.values.reduce((e,t)=>e.concat(t),[]);}function lt2(e){st2.call(this,null,e);}function ut3(e){ye.call(this,e);}function ot3(e){je.call(this,e);}function dt2(e){st2.call(this,null,e);}function mt2(e){st2.call(this,null,e);}function ft3(e){st2.call(this,null,e);}He.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},an(He,st2,{transform(e,t){var a,s,r,l1,u,o,d,m,f,c,h=t.fork(t.ALL),p=function(e){var t,n=e.method||Qe.value;if(null!=Qe[n])return n===Qe.value?(t=void 0!==e.value?e.value:0,()=>t):Qe[n];l("Unrecognized imputation method: "+n);}(e),v=function(e){const t=e.field;return e=>e?t(e):NaN;}(e),g=t1(e.field),y=t1(e.key),_=(e.groupby||[]).map(t1),x=function(e,t,n,i){var a,s,r,l,u,o,d,m,f=e=>e(m),c=[],h=i?i.slice():[],p={},v={};for(h.forEach((e,t)=>p[e]=t+1),l=0,d=e.length;l<d;++l)o=n(m=e[l]),u=p[o]||(p[o]=h.push(o)),(r=v[s=(a=t?t.map(f):Ge)+""])||(r=v[s]=[],c.push(r),r.values=a),r[u-1]=m;return c.domain=h,c;}(t.source,e.groupby,e.key,e.keyvals),b=[],D=this.value,O=x.domain.length;for(u=0,m=x.length;u<m;++u)for(r=(a=x[u]).values,s=NaN,d=0;d<O;++d)if(null==a[d]){for(l1=x.domain[d],c={_impute:!0},o=0,f=r.length;o<f;++o)c[_[o]]=r[o];c[y]=l1,c[g]=Number.isNaN(s)?s=p(a,v):s,b.push(O6(c));}return b.length&&(h.add=h.materialize(h.ADD).add.concat(b)),D.length&&(h.rem=h.materialize(h.REM).rem.concat(D)),this.value=b,h;}}),Ve.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ue1},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},an(Ve,ye,{transform(e,t){const n=this,i=e.modified();let a;return n.value&&(i||t.modified(n._inputs,!0))?(a=n.value=i?n.init(e):{},t.visit(t.SOURCE,e=>n.add(e))):(a=n.value=n.value||this.init(e),t.visit(t.REM,e=>n.rem(e)),t.visit(t.ADD,e=>n.add(e))),n.changes(),t.visit(t.SOURCE,e=>{rn(e,a[n.cellkey(e)].tuple);}),t.reflow(i).modifies(this._outputs);},changes(){const e=this._adds,t=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(e[n]),e[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(t[n]),t[n]=null;this._alen=this._mlen=0;}}),Xe.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},an(Xe,st2,{transform(e,t){const a=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){const s=t.materialize(t.SOURCE).source,r=Ue1(s,e.groupby,e.field),u=(e.groupby||[]).map(t1),o=e.bandwidth,d=e.cumulative?"cdf":"pdf",m=e.as||["value","density"],f=[];let c=e.extent,h=e.steps||e.minsteps||25,p=e.steps||e.maxsteps||200;"pdf"!==d&&"cdf"!==d&&l("Invalid density method: "+d),"shared"===e.resolve&&(c||(c=un(s,e.field)),h=p=e.steps||p),r.forEach(t=>{const n=A8(t,o)[d],i=e.counts?t.length:1,a=c||un(t);$7(n,a,h,p).forEach(e=>{const n={};for(let e=0;e<u.length;++e)n[u[e]]=t.dims[e];n[m[0]]=e[0],n[m[1]]=e[1]*i,f.push(O6(n));});}),this.value&&(a.rem=this.value),this.value=a.add=a.source=f;}return a;}}),an(Ye,U4),an(et3,st2,{transform(e,n){const i=n.dataflow;if(this._pending)return tt4(this,n,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"));}(e))return n.StopPropagation;if(e.values)return tt4(this,n,i.parse(e.values,e.format));if(e.async){const n=i.request(e.url,e.format).then(e=>(this._pending=H(e.data),e=>e.touch(this)));return{async:n};}return i.request(e.url,e.format).then(e=>tt4(this,n,H(e.data)));}}),nt4.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},an(nt4,st2,{transform(e,t){const a=e.fields,s=e.index,r=e.values,l1=null==e.default?null:e.default,u=e.modified(),o=a.length;let d,m,f,c=u?t.SOURCE:t.ADD,h=t,p=e.as;return r?(m=r.length,o>1&&!p&&l('Multi-field lookup requires explicit "as" parameter.'),p&&p.length!==o*m&&l('The "as" parameter has too few output field names.'),p=p||r.map(t1),d=function(e){for(var t,n,i=0,u=0;i<o;++i)if(null==(n=s.get(a[i](e))))for(t=0;t<m;++t,++u)e[p[u]]=l1;else for(t=0;t<m;++t,++u)e[p[u]]=r[t](n);}):(p||l("Missing output field names."),d=function(e){for(var t,n=0;n<o;++n)t=s.get(a[n](e)),e[p[n]]=null==t?l1:t;}),u?h=t.reflow(!0):(f=a.some(e=>t.modified(e.fields)),c|=f?t.MOD:0),t.visit(c,d),h.modifies(p);}}),an(it3,U4),an(st3,U4),an(lt2,st2,{transform(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS);}}),ut3.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ue1,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},an(ut3,ye,{_transform:ye.prototype.transform,transform(e1,t){return this._transform(function(e1,t){const n=e1.field,i=e1.value,r=("count"===e1.op?"__count__":e1.op)||"sum",l=e(n).concat(e(i)),u=function(e,t,n){const i={},a=[];return n.visit(n.SOURCE,t=>{const n=e(t);i[n]||(i[n]=1,a.push(n));}),a.sort(X),t?a.slice(0,t):a;}(n,e1.limit||0,t);t.changed()&&e1.set("__pivot__",null,null,!0);return{key:e1.key,groupby:e1.groupby,ops:u.map(()=>r),fields:u.map(e=>(function(e,t,n,i){return n1(i=>t(i)===e?n(i):NaN,i,e+"");})(e,n,i,l)),as:u.map(e=>e+""),modified:e1.modified.bind(e1)};}(e1,t),t);}}),an(ot3,je,{transform(e1,t){const n=e1.subflow,s=e1.field,r=e=>this.subflow(E7(e),n,t,e);return(e1.modified("field")||s&&t.modified(e(s)))&&l("PreFacet does not support field modification."),this.initTargets(),s?(t.visit(t.MOD,e=>{const t=r(e);s(e).forEach(e=>t.mod(e));}),t.visit(t.ADD,e=>{const t=r(e);s(e).forEach(e=>t.add(O6(e)));}),t.visit(t.REM,e=>{const t=r(e);s(e).forEach(e=>t.rem(e));})):(t.visit(t.MOD,e=>r(e).mod(e)),t.visit(t.ADD,e=>r(e).add(e)),t.visit(t.REM,e=>r(e).rem(e))),t.clean()&&t.runAfter(()=>this.clean()),t;}}),dt2.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},an(dt2,st2,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.fields,a=Ce1(e.fields,e.as||[]),s=i?(e,t)=>(function(e,t,n,i){for(let a=0,s=n.length;a<s;++a)t[i[a]]=n[a](e);return t;})(e,t,i,a):q6;let r;return this.value?r=this.value:(t=t.addAll(),r=this.value={}),t.visit(t.REM,e=>{const t=E7(e);n.rem.push(r[t]),r[t]=null;}),t.visit(t.ADD,e=>{const t=s(e,O6({}));r[E7(e)]=t,n.add.push(t);}),t.visit(t.MOD,e=>{n.mod.push(s(e,r[E7(e)]));}),n;}}),an(mt2,st2,{transform(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation;}}),ft3.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function ct3(e){st2.call(this,null,e);}function ht3(e){st2.call(this,[],e),this.count=0;}function pt2(e){st2.call(this,null,e);}function vt3(e){st2.call(this,null,e),this.modified(!0);}function gt3(e){st2.call(this,null,e);}an(ft3,st2,{transform(e,t){const i=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return i.source=this.value,i;const s=Ue1(t.materialize(t.SOURCE).source,e.groupby,e.field),r=(e.groupby||[]).map(t1),l=[],u=e.step||.01,o=e.probs||Nt(u/2,1-1e-14,u),d=o.length;return s.forEach(e=>{const t=u7(e,o);for(let n=0;n<d;++n){const i={};for(let t=0;t<r.length;++t)i[r[t]]=e.dims[t];i[a[0]]=o[n],i[a[1]]=t[n],l.push(O6(i));}}),this.value&&(i.rem=this.value),this.value=i.add=i.source=l,i;}}),an(ct3,st2,{transform(e,t){let n,i;return this.value?i=this.value:(n=t=t.addAll(),i=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,e=>{const t=E7(e);n.rem.push(i[t]),i[t]=null;}),t.visit(t.ADD,e=>{const t=P5(e);i[E7(e)]=t,n.add.push(t);}),t.visit(t.MOD,e=>{const t=i[E7(e)];for(const i in e)t[i]=e[i],n.modifies(i);n.mod.push(t);})),n;}}),ht3.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},an(ht3,st2,{transform(e,t){const n=t.fork(t.NO_SOURCE),i=e.modified("size"),a=e.size,s=this.value.reduce((e,t)=>(e[E7(t)]=1,e),{});let r=this.value,l=this.count,u=0;function o(e){let t,i;r.length<a?r.push(e):(i=~~((l+1)*c5()),i<r.length&&i>=u&&(t=r[i],s[E7(t)]&&n.rem.push(t),r[i]=e)),++l;}if(t.rem.length&&(t.visit(t.REM,e=>{const t=E7(e);s[t]&&(s[t]=-1,n.rem.push(e)),--l;}),r=r.filter(e=>-1!==s[E7(e)])),(t.rem.length||i)&&r.length<a&&t.source&&(u=l=r.length,t.visit(t.SOURCE,e=>{s[E7(e)]||o(e);}),u=-1),i&&r.length>a){const e=r.length-a;for(let t=0;t<e;++t)s[E7(r[t])]=-1,n.rem.push(r[t]);r=r.slice(e);}return t.mod.length&&t.visit(t.MOD,e=>{s[E7(e)]&&n.mod.push(e);}),t.add.length&&t.visit(t.ADD,o),(t.add.length||u<0)&&(n.add=r.filter(e=>!s[E7(e)])),this.count=l,this.value=n.source=r,n;}}),pt2.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},an(pt2,st2,{transform(e,t){if(this.value&&!e.modified())return;const n=t.materialize().fork(t.MOD),i=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Nt(e.start,e.stop,e.step||1).map(e=>{const t={};return t[i]=e,O6(t);}),n.add=t.add.concat(this.value),n;}}),an(vt3,st2,{transform(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation;}});const yt3=["unit0","unit1"];function _t1(e){st2.call(this,fn(),e);}function xt2(e){st2.call(this,null,e);}gt3.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Q2,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:yt3}]},an(gt3,st2,{transform(e1,t){const n=e1.field,i=!1!==e1.interval,s="utc"===e1.timezone,r=this._floor(e1,t),l=(s?Tt:Dt)(r.unit).offset,u=e1.as||yt3,o=u[0],d=u[1],m=r.step;let f=r.start||1/0,c=r.stop||-1/0,h=t.ADD;return(e1.modified()||t.changed(t.REM)||t.modified(e(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,c=-1/0),t.visit(h,e=>{const t=n(e);let a,s;null==t?(e[o]=null,i&&(e[d]=null)):(e[o]=a=s=r(t),i&&(e[d]=s=l(a,m)),a<f&&(f=a),s>c&&(c=s));}),r.start=f,r.stop=c,t.modifies(i?u:o);},_floor(e,t){const n="utc"===e.timezone,{units:i,step:a}=e.units?{units:e.units,step:e.step||1}:Bt({extent:e.extent||un(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),s=z2(i),r=this.value||{},u=(n?ft1:st)(s,a);return u.unit=D(s),u.units=s,u.step=a,u.start=r.start,u.stop=r.stop,this.value=u;}}),an(_t1,st2,{transform(e,t){const n=t.dataflow,i=e.field,a=this.value,s=e=>a.set(i(e),e);let r=!0;return e.modified("field")||t.modified(i.fields)?(a.clear(),t.visit(t.SOURCE,s)):t.changed()?(t.visit(t.REM,e=>a.delete(i(e))),t.visit(t.ADD,s)):r=!1,this.modified(r),a.empty>n.cleanThreshold&&n.runAfter(a.clean),t.fork();}}),an(xt2,st2,{transform(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(b5(e.sort)):t.source).map(e.field));}});const bt2={row_number:function(){return{next:e=>e.index+1};},rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?e=n+1:e;}};},dense_rank:function(){let e;return{init:()=>e=1,next:t=>{const n=t.index,i=t.data;return n&&t.compare(i[n-1],i[n])?++e:e;}};},percent_rank:function(){const e=bt2.rank(),t=e.next;return{init:e.init,next:e=>(t(e)-1)/(e.data.length-1)};},cume_dist:function(){let e;return{init:()=>e=0,next:t=>{const n=t.data,i=t.compare;let a=t.index;if(e<a){for(;a+1<n.length&&!i(n[a],n[a+1]);)++a;e=a;}return(1+e)/n.length;}};},ntile:function(e,t){(t=+t)>0||l("ntile num must be greater than zero.");const n=bt2.cume_dist(),a=n.next;return{init:n.init,next:e=>Math.ceil(t*a(e))};},lag:function(e,t){return t=+t||1,{next:n=>{const i=n.index-t;return i>=0?e(n.data[i]):null;}};},lead:function(e,t){return t=+t||1,{next:n=>{const i=n.index+t,a=n.data;return i<a.length?e(a[i]):null;}};},first_value:function(e){return{next:t=>e(t.data[t.i0])};},last_value:function(e){return{next:t=>e(t.data[t.i1-1])};},nth_value:function(e,t){return(t=+t)>0||l("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(t-1);return i<n.i1?e(n.data[i]):null;}};},prev_value:function(e){let t;return{init:()=>t=null,next:n=>{const i=e(n.data[n.index]);return null!=i?t=i:t;}};},next_value:function(e){let t,n;return{init:()=>(t=null,n=-1),next:i=>{const a=i.data;return i.index<=n?t:(n=function(e,t,n){for(let i=t.length;n<i;++n){if(null!=e(t[n]))return n;}return-1;}(e,a,i.index))<0?(n=a.length,t=null):t=e(a[n]);}};}};const Dt2=Object.keys(bt2);function Ot1(e1){const s=H(e1.ops),r=H(e1.fields),l1=H(e1.params),u=H(e1.aggregate_params),d=H(e1.as),m=this.outputs=[],f=this.windows=[],c={},h={},p=[],v=[];let g=!0;function y(e1){H(e(e1)).forEach(e=>c[e]=1);}y(e1.sort),s.forEach((e,t)=>{const a1=r[t],s=l1[t],c=u[t]||null,_=t1(a1),x=ae1(e,_,d[t]);if(y(a1),m.push(x),ln(bt2,e))f.push(function(e,t,n,i){const a1=bt2[e](t,n);return{init:a1.init||a,update:function(e,t){t[i]=a1.next(e);}};}(e,a1,s,x));else{if(null==a1&&"count"!==e&&l("Null aggregate field specified."),"count"===e)return void p.push(x);g=!1;let t=h[_];t||(t=h[_]=[],t.field=a1,v.push(t)),t.push(oe1(e,c,x));}}),(p.length||v.length)&&(this.cell=function(e,t,n){e=e.map(e=>pe(e,e.field));const i={num:0,agg:null,store:!1,count:t};if(!n)for(var a=e.length,s=i.agg=Array(a),r=0;r<a;++r)s[r]=new e[r](i);if(i.store)var l=i.data=new ve;return i.add=function(e){if(i.num+=1,!n){l&&l.add(e);for(let t=0;t<a;++t)s[t].add(s[t].get(e),e);}},i.rem=function(e){if(i.num-=1,!n){l&&l.rem(e);for(let t=0;t<a;++t)s[t].rem(s[t].get(e),e);}},i.set=function(e){let a,r;for(l&&l.values(),a=0,r=t.length;a<r;++a)e[t[a]]=i.num;if(!n)for(a=0,r=s.length;a<r;++a)s[a].set(e);},i.init=function(){i.num=0,l&&l.reset();for(let e=0;e<a;++e)s[e].init();},i;}(v,p,g)),this.inputs=Object.keys(c);}const Et1=Ot1.prototype;function kt2(e){st2.call(this,{},e),this._mlen=0,this._mods=[];}function qt2(e,t,n,i){const a=i.sort,s=a&&!i.ignorePeers,r=i.frame||[null,0],l=e.data(n),u=l.length,o=s?e4(a):null,d={i0:0,i1:0,p0:0,p1:0,index:0,data:l,compare:a||tn(-1)};t.init();for(let e=0;e<u;++e)wt2(d,r,e,u),s&&Rt1(d,o),t.update(d,l[e]);}function wt2(e,t,n,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?i:Math.min(i,n+Math.abs(t[1])+1),e.index=n;}function Rt1(e,t){const n=e.i0,i=e.i1-1,a=e.compare,s=e.data,r=s.length-1;n>0&&!a(s[n],s[n-1])&&(e.i0=t.left(s,s[n])),i<r&&!a(s[i],s[i+1])&&(e.i1=t.right(s,s[i]));}Et1.init=function(){this.windows.forEach(e=>e.init()),this.cell&&this.cell.init();},Et1.update=function(e,t){const n=this.cell,i=this.windows,a=e.data,s=i&&i.length;let r;if(n){for(r=e.p0;r<e.i0;++r)n.rem(a[r]);for(r=e.p1;r<e.i1;++r)n.add(a[r]);n.set(t);}for(r=0;r<s;++r)i[r].update(e,t);},kt2.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Dt2.concat(ue1)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},an(kt2,st2,{transform(e,t){this.stamp=t.stamp;const n=e.modified(),i=b5(e.sort),a=ie1(e.groupby),s=e=>this.group(a(e));let r=this.state;r&&!n||(r=this.state=new Ot1(e)),n||t.modified(r.inputs)?(this.value={},t.visit(t.SOURCE,e=>s(e).add(e))):(t.visit(t.REM,e=>s(e).remove(e)),t.visit(t.ADD,e=>s(e).add(e)));for(let t=0,n=this._mlen;t<n;++t)qt2(this._mods[t],r,i,e);return this._mlen=0,this._mods=[],t.reflow(n).modifies(r.outputs);},group(e){let t=this.value[e];return t||(t=this.value[e]=xe(E7),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t;}});const mod=function(){return{aggregate:ye,bin:_e,collect:be,compare:De,countpattern:Ee,cross:ke,density:Se,dotbin:Ae,expression:ze,extent:Fe,facet:je,field:Pe,filter:$e,flatten:We,fold:Be,formula:Je,generate:Ke,impute:He,joinaggregate:Ve,kde:Xe,key:Ye,load:et3,lookup:nt4,multiextent:it3,multivalues:st3,params:lt2,pivot:ut3,prefacet:ot3,project:dt2,proxy:mt2,quantile:ft3,relay:ct3,sample:ht3,sequence:pt2,sieve:vt3,subflow:Ie,timeunit:gt3,tupleindex:_t1,values:xt2,window:kt2,default:null};}();const t6=Math.PI,i7=2*t6,h6=1e-6,s7=i7-h6;function _6(t){this._+=t[0];for(let i=1,h=t.length;i<h;++i)this._+=arguments[i]+t[i];}class e6{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?_6:function(t){let i=Math.floor(t);if(!(i>=0))throw new Error(`invalid digits: ${t}`);if(i>15)return _6;const h=10**i;return function(t){this._+=t[0];for(let i=1,s=t.length;i<s;++i)this._+=Math.round(arguments[i]*h)/h+t[i];};}(t);}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`;}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`);}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`;}quadraticCurveTo(t,i,h,s){this._append`Q${+t},${+i},${this._x1=+h},${this._y1=+s}`;}bezierCurveTo(t,i,h,s,_,e){this._append`C${+t},${+i},${+h},${+s},${this._x1=+_},${this._y1=+e}`;}arcTo(i,s,_,e,n){if(i=+i,s=+s,_=+_,e=+e,(n=+n)<0)throw new Error(`negative radius: ${n}`);let $=this._x1,a=this._y1,r=_-i,o=e-s,p=$-i,l=a-s,u=p*p+l*l;if(null===this._x1)this._append`M${this._x1=i},${this._y1=s}`;else if(u>1e-6)if(Math.abs(l*r-o*p)>1e-6&&n){let x=_-$,d=e-a,y=r*r+o*o,M=x*x+d*d,c=Math.sqrt(y),f=Math.sqrt(u),w=n*Math.tan((t6-Math.acos((y+u-M)/(2*c*f)))/2),v=w/f,g=w/c;Math.abs(v-1)>1e-6&&this._append`L${i+v*p},${s+v*l}`,this._append`A${n},${n},0,0,${+(l*x>p*d)},${this._x1=i+g*r},${this._y1=s+g*o}`;}else this._append`L${this._x1=i},${this._y1=s}`;else;}arc(_,e,n,$,a,r){if(_=+_,e=+e,r=!!r,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos($),p=n*Math.sin($),l=_+o,u=e+p,x=1^r,d=r?$-a:a-$;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-u)>1e-6)&&this._append`L${l},${u}`,n&&(d<0&&(d=d%i7+i7),d>s7?this._append`A${n},${n},0,1,${x},${_-o},${e-p}A${n},${n},0,1,${x},${this._x1=l},${this._y1=u}`:d>1e-6&&this._append`A${n},${n},0,${+(d>=t6)},${x},${this._x1=_+n*Math.cos(a)},${this._y1=e+n*Math.sin(a)}`);}rect(t,i,h,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${h=+h}v${+s}h${-h}Z`;}toString(){return this._;}}function n6(){return new e6;}n6.prototype=e6.prototype;function n7(t){return function(){return t;};}const i8=Math.abs,e7=Math.atan2,s8=Math.cos,o6=Math.max,h7=Math.min,_7=Math.sin,r7=Math.sqrt,a7=1e-12,l7=Math.PI,c6=l7/2,u8=2*l7;function f5(t){return t>=1?c6:t<=-1?-c6:Math.asin(t);}function y4(n){let i=3;return n.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);i=n;}return n;},()=>new e6(i);}function x7(t){return t.innerRadius;}function p7(t){return t.outerRadius;}function v7(t){return t.startAngle;}function d6(t){return t.endAngle;}function T6(t){return t&&t.padAngle;}function g6(t,n,i,e,s,h,_){var a=t-i,l=n-e,c=(_?h:-h)/r7(a*a+l*l),u=c*l,f=-c*a,y=t+u,x=n+f,p=i+u,v=e+f,d=(y+p)/2,T=(x+v)/2,g=p-y,m=v-x,b=g*g+m*m,w=s-h,k=y*v-p*x,N=(m<0?-1:1)*r7(o6(0,w*w*b-k*k)),S=(k*m-g*N)/b,E=(-k*g-m*N)/b,A=(k*m+g*N)/b,M=(-k*g+m*N)/b,P=S-d,C=E-T,O=A-d,R=M-T;return P*P+C*C>O*O+R*R&&(S=A,E=M),{cx:S,cy:E,x01:-u,y01:-f,x11:S*(s/w-1),y11:E*(s/w-1)};}function m7(){var t=x7,o=p7,m=n7(0),b=null,w=v7,k=d6,N=T6,S=null,E=y4(A);function A(){var n,y,x=+t.apply(this,arguments),p=+o.apply(this,arguments),v=w.apply(this,arguments)-c6,d=k.apply(this,arguments)-c6,T=i8(d-v),A=d>v;if(S||(S=n=E()),p<x&&(y=p,p=x,x=y),p>1e-12)if(T>u8-1e-12)S.moveTo(p*s8(v),p*_7(v)),S.arc(0,0,p,v,d,!A),x>1e-12&&(S.moveTo(x*s8(d),x*_7(d)),S.arc(0,0,x,d,v,A));else{var M,P,C=v,O=d,R=v,z=d,X=T,Y=T,B=N.apply(this,arguments)/2,q=B>1e-12&&(b?+b.apply(this,arguments):r7(x*x+p*p)),D=h7(i8(p-x)/2,+m.apply(this,arguments)),I=D,j=D;if(q>1e-12){var L=f5(q/x*_7(B)),W=f5(q/p*_7(B));(X-=2*L)>1e-12?(R+=L*=A?1:-1,z-=L):(X=0,R=z=(v+d)/2),(Y-=2*W)>1e-12?(C+=W*=A?1:-1,O-=W):(Y=0,C=O=(v+d)/2);}var V=p*s8(C),$=p*_7(C),F=x*s8(z),G=x*_7(z);if(D>1e-12){var H,J=p*s8(O),K=p*_7(O),Q=x*s8(R),U=x*_7(R);if(T<l7)if(H=function(t,n,i,e,s,o,h,_){var r=i-t,l=e-n,c=h-s,u=_-o,f=u*r-c*l;if(!(f*f<a7))return[t+(f=(c*(n-o)-u*(t-s))/f)*r,n+f*l];}(V,$,Q,U,J,K,F,G)){var Z=V-H[0],tt=$-H[1],nt=J-H[0],it=K-H[1],et=1/_7(function(t){return t>1?0:t<-1?l7:Math.acos(t);}((Z*nt+tt*it)/(r7(Z*Z+tt*tt)*r7(nt*nt+it*it)))/2),st=r7(H[0]*H[0]+H[1]*H[1]);I=h7(D,(x-st)/(et-1)),j=h7(D,(p-st)/(et+1));}else I=j=0;}Y>1e-12?j>1e-12?(M=g6(Q,U,V,$,p,j,A),P=g6(J,K,F,G,p,j,A),S.moveTo(M.cx+M.x01,M.cy+M.y01),j<D?S.arc(M.cx,M.cy,j,e7(M.y01,M.x01),e7(P.y01,P.x01),!A):(S.arc(M.cx,M.cy,j,e7(M.y01,M.x01),e7(M.y11,M.x11),!A),S.arc(0,0,p,e7(M.cy+M.y11,M.cx+M.x11),e7(P.cy+P.y11,P.cx+P.x11),!A),S.arc(P.cx,P.cy,j,e7(P.y11,P.x11),e7(P.y01,P.x01),!A))):(S.moveTo(V,$),S.arc(0,0,p,C,O,!A)):S.moveTo(V,$),x>1e-12&&X>1e-12?I>1e-12?(M=g6(F,G,J,K,x,-I,A),P=g6(V,$,Q,U,x,-I,A),S.lineTo(M.cx+M.x01,M.cy+M.y01),I<D?S.arc(M.cx,M.cy,I,e7(M.y01,M.x01),e7(P.y01,P.x01),!A):(S.arc(M.cx,M.cy,I,e7(M.y01,M.x01),e7(M.y11,M.x11),!A),S.arc(0,0,x,e7(M.cy+M.y11,M.cx+M.x11),e7(P.cy+P.y11,P.cx+P.x11),A),S.arc(P.cx,P.cy,I,e7(P.y11,P.x11),e7(P.y01,P.x01),!A))):S.arc(0,0,x,z,R,A):S.lineTo(F,G);}else S.moveTo(0,0);if(S.closePath(),n)return S=null,n+""||null;}return A.centroid=function(){var n=(+t.apply(this,arguments)+ +o.apply(this,arguments))/2,i=(+w.apply(this,arguments)+ +k.apply(this,arguments))/2-l7/2;return[s8(i)*n,_7(i)*n];},A.innerRadius=function(i){return arguments.length?(t="function"==typeof i?i:n7(+i),A):t;},A.outerRadius=function(t){return arguments.length?(o="function"==typeof t?t:n7(+t),A):o;},A.cornerRadius=function(t){return arguments.length?(m="function"==typeof t?t:n7(+t),A):m;},A.padRadius=function(t){return arguments.length?(b=null==t?null:"function"==typeof t?t:n7(+t),A):b;},A.startAngle=function(t){return arguments.length?(w="function"==typeof t?t:n7(+t),A):w;},A.endAngle=function(t){return arguments.length?(k="function"==typeof t?t:n7(+t),A):k;},A.padAngle=function(t){return arguments.length?(N="function"==typeof t?t:n7(+t),A):N;},A.context=function(t){return arguments.length?(S=null==t?null:t,A):S;},A;}Array.prototype.slice;function w6(t){return"object"==typeof t&&"length"in t?t:Array.from(t);}function k7(t){this._context=t;}function N8(t){return new k7(t);}function S8(t){return t[0];}function E9(t){return t[1];}function A9(t,i){var e=n7(!0),s=null,o=N8,h=null,_=y4(r);function r(n){var r,a,l,c=(n=w6(n)).length,u=!1;for(null==s&&(h=o(l=_())),r=0;r<=c;++r)!(r<c&&e(a=n[r],r,n))===u&&((u=!u)?h.lineStart():h.lineEnd()),u&&h.point(+t(a,r,n),+i(a,r,n));if(l)return h=null,l+""||null;}return t="function"==typeof t?t:void 0===t?S8:n7(t),i="function"==typeof i?i:void 0===i?E9:n7(i),r.x=function(i){return arguments.length?(t="function"==typeof i?i:n7(+i),r):t;},r.y=function(t){return arguments.length?(i="function"==typeof t?t:n7(+t),r):i;},r.defined=function(t){return arguments.length?(e="function"==typeof t?t:n7(!!t),r):e;},r.curve=function(t){return arguments.length?(o=t,null!=s&&(h=o(s)),r):o;},r.context=function(t){return arguments.length?(null==t?s=h=null:h=o(s=t),r):s;},r;}function M7(t,i,e){var s=null,o=n7(!0),h=null,_=N8,r=null,a=y4(l);function l(n){var l,c,u,f,y,x=(n=w6(n)).length,p=!1,v=new Array(x),d=new Array(x);for(null==h&&(r=_(y=a())),l=0;l<=x;++l){if(!(l<x&&o(f=n[l],l,n))===p)if(p=!p)c=l,r.areaStart(),r.lineStart();else{for(r.lineEnd(),r.lineStart(),u=l-1;u>=c;--u)r.point(v[u],d[u]);r.lineEnd(),r.areaEnd();}p&&(v[l]=+t(f,l,n),d[l]=+i(f,l,n),r.point(s?+s(f,l,n):v[l],e?+e(f,l,n):d[l]));}if(y)return r=null,y+""||null;}function c(){return A9().defined(o).curve(_).context(h);}return t="function"==typeof t?t:void 0===t?S8:n7(+t),i="function"==typeof i?i:n7(void 0===i?0:+i),e="function"==typeof e?e:void 0===e?E9:n7(+e),l.x=function(i){return arguments.length?(t="function"==typeof i?i:n7(+i),s=null,l):t;},l.x0=function(i){return arguments.length?(t="function"==typeof i?i:n7(+i),l):t;},l.x1=function(t){return arguments.length?(s=null==t?null:"function"==typeof t?t:n7(+t),l):s;},l.y=function(t){return arguments.length?(i="function"==typeof t?t:n7(+t),e=null,l):i;},l.y0=function(t){return arguments.length?(i="function"==typeof t?t:n7(+t),l):i;},l.y1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:n7(+t),l):e;},l.lineX0=l.lineY0=function(){return c().x(t).y(i);},l.lineY1=function(){return c().x(t).y(e);},l.lineX1=function(){return c().x(s).y(i);},l.defined=function(t){return arguments.length?(o="function"==typeof t?t:n7(!!t),l):o;},l.curve=function(t){return arguments.length?(_=t,null!=h&&(r=_(h)),l):_;},l.context=function(t){return arguments.length?(null==t?h=r=null:r=_(h=t),l):h;},l;}k7.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._point=0;},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:this._context.lineTo(t,n);}}};X8(N8);function z8(t){this._curve=t;}function X8(t){function n(n){return new z8(t(n));}return n._curve=t,n;}z8.prototype={areaStart:function(){this._curve.areaStart();},areaEnd:function(){this._curve.areaEnd();},lineStart:function(){this._curve.lineStart();},lineEnd:function(){this._curve.lineEnd();},point:function(t,n){this._curve.point(n*Math.sin(t),n*-Math.cos(t));}};r7(3);var Z8={draw(t,n){const i=r7(n/l7);t.moveTo(i,0),t.arc(0,0,i,0,u8);}};r7(1/3);const rt4=_7(l7/10)/_7(7*l7/10),at4=_7(u8/10)*rt4,lt3=-s8(u8/10)*rt4;r7(3);r7(3);r7(3)/2,1/r7(12);function kt3(t,i){let e=null,s=y4(o);function o(){let n;if(e||(e=n=s()),t.apply(this,arguments).draw(e,+i.apply(this,arguments)),n)return e=null,n+""||null;}return t="function"==typeof t?t:n7(t||Z8),i="function"==typeof i?i:n7(void 0===i?64:+i),o.type=function(i){return arguments.length?(t="function"==typeof i?i:n7(i),o):t;},o.size=function(t){return arguments.length?(i="function"==typeof t?t:n7(+t),o):i;},o.context=function(t){return arguments.length?(e=null==t?null:t,o):e;},o;}function Nt2(){}function St2(t,n,i){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+n)/6,(t._y0+4*t._y1+i)/6);}function Et2(t){this._context=t;}function At1(t){return new Et2(t);}function Mt3(t){this._context=t;}function Pt1(t){return new Mt3(t);}function Ct2(t){this._context=t;}function Ot2(t){return new Ct2(t);}function Rt2(t,n){this._basis=new Et2(t),this._beta=n;}Et2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0;},lineEnd:function(){switch(this._point){case 3:St2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:St2(this,t,n);}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n;}},Mt3.prototype={areaStart:Nt2,areaEnd:Nt2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0;},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x2=t,this._y2=n;break;case 1:this._point=2,this._x3=t,this._y3=n;break;case 2:this._point=3,this._x4=t,this._y4=n,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+n)/6);break;default:St2(this,t,n);}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n;}},Ct2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0;},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+t)/6,e=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(i,e):this._context.moveTo(i,e);break;case 3:this._point=4;default:St2(this,t,n);}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n;}},Rt2.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart();},lineEnd:function(){var t=this._x,n=this._y,i=t.length-1;if(i>0)for(var e,s=t[0],o=n[0],h=t[i]-s,_=n[i]-o,r=-1;++r<=i;)e=r/i,this._basis.point(this._beta*t[r]+(1-this._beta)*(s+e*h),this._beta*n[r]+(1-this._beta)*(o+e*_));this._x=this._y=null,this._basis.lineEnd();},point:function(t,n){this._x.push(+t),this._y.push(+n);}};var zt1=function t(n){function i(t){return 1===n?new Et2(t):new Rt2(t,n);}return i.beta=function(n){return t(+n);},i;}(.85);function Xt(t,n,i){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-n),t._y2+t._k*(t._y1-i),t._x2,t._y2);}function Yt2(t,n){this._context=t,this._k=(1-n)/6;}Yt2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0;},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Xt(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:Xt(this,t,n);}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var Bt2=function t(n){function i(t){return new Yt2(t,n);}return i.tension=function(n){return t(+n);},i;}(0);function qt3(t,n){this._context=t,this._k=(1-n)/6;}qt3.prototype={areaStart:Nt2,areaEnd:Nt2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0;},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);}},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:Xt(this,t,n);}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var Dt3=function t(n){function i(t){return new qt3(t,n);}return i.tension=function(n){return t(+n);},i;}(0);function It2(t,n){this._context=t,this._k=(1-n)/6;}It2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0;},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Xt(this,t,n);}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var jt3=function t(n){function i(t){return new It2(t,n);}return i.tension=function(n){return t(+n);},i;}(0);function Lt1(t,n,i){var e=t._x1,s=t._y1,o=t._x2,h=t._y2;if(t._l01_a>1e-12){var _=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,r=3*t._l01_a*(t._l01_a+t._l12_a);e=(e*_-t._x0*t._l12_2a+t._x2*t._l01_2a)/r,s=(s*_-t._y0*t._l12_2a+t._y2*t._l01_2a)/r;}if(t._l23_a>1e-12){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-n*t._l12_2a)/c,h=(h*l+t._y1*t._l23_2a-i*t._l12_2a)/c;}t._context.bezierCurveTo(e,s,o,h,t._x2,t._y2);}function Wt1(t,n){this._context=t,this._alpha=n;}Wt1.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0;},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){if(t=+t,n=+n,this._point){var i=this._x2-t,e=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+e*e,this._alpha));}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:Lt1(this,t,n);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var Vt=function t(n){function i(t){return n?new Wt1(t,n):new Yt2(t,0);}return i.alpha=function(n){return t(+n);},i;}(.5);function $t1(t,n){this._context=t,this._alpha=n;}$t1.prototype={areaStart:Nt2,areaEnd:Nt2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0;},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);}},point:function(t,n){if(t=+t,n=+n,this._point){var i=this._x2-t,e=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+e*e,this._alpha));}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=n);break;case 2:this._point=3,this._x5=t,this._y5=n;break;default:Lt1(this,t,n);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var Ft1=function t(n){function i(t){return n?new $t1(t,n):new qt3(t,0);}return i.alpha=function(n){return t(+n);},i;}(.5);function Gt(t,n){this._context=t,this._alpha=n;}Gt.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0;},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){if(t=+t,n=+n,this._point){var i=this._x2-t,e=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(i*i+e*e,this._alpha));}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lt1(this,t,n);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n;}};var Ht1=function t(n){function i(t){return n?new Gt(t,n):new It2(t,0);}return i.alpha=function(n){return t(+n);},i;}(.5);function Jt1(t){this._context=t;}function Kt1(t){return new Jt1(t);}function Qt(t){return t<0?-1:1;}function Ut2(t,n,i){var e=t._x1-t._x0,s=n-t._x1,o=(t._y1-t._y0)/(e||s<0&&-0),h=(i-t._y1)/(s||e<0&&-0),_=(o*s+h*e)/(e+s);return(Qt(o)+Qt(h))*Math.min(Math.abs(o),Math.abs(h),.5*Math.abs(_))||0;}function Zt(t,n){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-n)/2:n;}function tn2(t,n,i){var e=t._x0,s=t._y0,o=t._x1,h=t._y1,_=(o-e)/3;t._context.bezierCurveTo(e+_,s+_*n,o-_,h-_*i,o,h);}function nn2(t){this._context=t;}function en2(t){this._context=new sn2(t);}function sn2(t){this._context=t;}function on2(t){return new nn2(t);}function hn2(t){return new en2(t);}function _n1(t){this._context=t;}function rn2(t){var n,i,e=t.length-1,s=new Array(e),o=new Array(e),h=new Array(e);for(s[0]=0,o[0]=2,h[0]=t[0]+2*t[1],n=1;n<e-1;++n)s[n]=1,o[n]=4,h[n]=4*t[n]+2*t[n+1];for(s[e-1]=2,o[e-1]=7,h[e-1]=8*t[e-1]+t[e],n=1;n<e;++n)i=s[n]/o[n-1],o[n]-=i,h[n]-=i*h[n-1];for(s[e-1]=h[e-1]/o[e-1],n=e-2;n>=0;--n)s[n]=(h[n]-s[n+1])/o[n];for(o[e-1]=(t[e]+s[e-1])/2,n=0;n<e-1;++n)o[n]=2*t[n+1]-s[n+1];return[s,o];}function an2(t){return new _n1(t);}function ln2(t,n){this._context=t,this._t=n;}function cn2(t){return new ln2(t,.5);}function un2(t){return new ln2(t,0);}function fn2(t){return new ln2(t,1);}Jt1.prototype={areaStart:Nt2,areaEnd:Nt2,lineStart:function(){this._point=0;},lineEnd:function(){this._point&&this._context.closePath();},point:function(t,n){t=+t,n=+n,this._point?this._context.lineTo(t,n):(this._point=1,this._context.moveTo(t,n));}},nn2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0;},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tn2(this,this._t0,Zt(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line;},point:function(t,n){var i=NaN;if(n=+n,(t=+t)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,tn2(this,Zt(this,i=Ut2(this,t,n)),i);break;default:tn2(this,this._t0,i=Ut2(this,t,n));}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n,this._t0=i;}}},(en2.prototype=Object.create(nn2.prototype)).point=function(t,n){nn2.prototype.point.call(this,n,t);},sn2.prototype={moveTo:function(t,n){this._context.moveTo(n,t);},closePath:function(){this._context.closePath();},lineTo:function(t,n){this._context.lineTo(n,t);},bezierCurveTo:function(t,n,i,e,s,o){this._context.bezierCurveTo(n,t,e,i,o,s);}},_n1.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x=[],this._y=[];},lineEnd:function(){var t=this._x,n=this._y,i=t.length;if(i)if(this._line?this._context.lineTo(t[0],n[0]):this._context.moveTo(t[0],n[0]),2===i)this._context.lineTo(t[1],n[1]);else for(var e=rn2(t),s=rn2(n),o=0,h=1;h<i;++o,++h)this._context.bezierCurveTo(e[0][o],s[0][o],e[1][o],s[1][o],t[h],n[h]);(this._line||0!==this._line&&1===i)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null;},point:function(t,n){this._x.push(+t),this._y.push(+n);}},ln2.prototype={areaStart:function(){this._line=0;},areaEnd:function(){this._line=NaN;},lineStart:function(){this._x=this._y=NaN,this._point=0;},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line);},point:function(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(t,n);else{var i=this._x*(1-this._t)+t*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,n);}}this._x=t,this._y=n;}};function e8(e,t){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n;}return null;}const t7=()=>"undefined"!=typeof Image?Image:null;function t8(t,e,i){t.prototype=e.prototype=i,i.constructor=t;}function e9(t,e){var i=Object.create(t.prototype);for(var n in e)i[n]=e[n];return i;}function i9(){}var n8=.7,r8=1/n8,a8="\\s*([+-]?\\d+)\\s*",s9="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",h8="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o7=/^#([0-9a-f]{3,8})$/,l8=new RegExp(`^rgb\\(${a8},${a8},${a8}\\)$`),u9=new RegExp(`^rgb\\(${h8},${h8},${h8}\\)$`),c7=new RegExp(`^rgba\\(${a8},${a8},${a8},${s9}\\)$`),g7=new RegExp(`^rgba\\(${h8},${h8},${h8},${s9}\\)$`),p8=new RegExp(`^hsl\\(${s9},${h8},${h8}\\)$`),b7=new RegExp(`^hsla\\(${s9},${h8},${h8},${s9}\\)$`),d7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function f6(){return this.rgb().formatHex();}function w7(){return this.rgb().formatRgb();}function y5(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=o7.exec(t))?(i=e[1].length,e=parseInt(e[1],16),6===i?m8(e):3===i?new M8(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===i?$8(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===i?$8(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=l8.exec(t))?new M8(e[1],e[2],e[3],1):(e=u9.exec(t))?new M8(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=c7.exec(t))?$8(e[1],e[2],e[3],e[4]):(e=g7.exec(t))?$8(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=p8.exec(t))?E10(e[1],e[2]/100,e[3]/100,1):(e=b7.exec(t))?E10(e[1],e[2]/100,e[3]/100,e[4]):d7.hasOwnProperty(t)?m8(d7[t]):"transparent"===t?new M8(NaN,NaN,NaN,0):null;}function m8(t){return new M8(t>>16&255,t>>8&255,255&t,1);}function $8(t,e,i,n){return n<=0&&(t=e=i=NaN),new M8(t,e,i,n);}function N9(t){return t instanceof i9||(t=y5(t)),t?new M8((t=t.rgb()).r,t.g,t.b,t.opacity):new M8;}function k8(t,e,i,n){return 1===arguments.length?N9(t):new M8(t,e,i,null==n?1:n);}function M8(t,e,i,n){this.r=+t,this.g=+e,this.b=+i,this.opacity=+n;}function v8(){return`#${R8(this.r)}${R8(this.g)}${R8(this.b)}`;}function x8(){const t=q8(this.opacity);return`${1===t?"rgb(":"rgba("}${H8(this.r)}, ${H8(this.g)}, ${H8(this.b)}${1===t?")":`, ${t})`}`;}function q8(t){return isNaN(t)?1:Math.max(0,Math.min(1,t));}function H8(t){return Math.max(0,Math.min(255,Math.round(t)||0));}function R8(t){return((t=H8(t))<16?"0":"")+t.toString(16);}function E10(t,e,i,n){return n<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new O8(t,e,i,n);}function j7(t){if(t instanceof O8)return new O8(t.h,t.s,t.l,t.opacity);if(t instanceof i9||(t=y5(t)),!t)return new O8;if(t instanceof O8)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),s=Math.max(e,n,r),h=NaN,o=s-a,l=(s+a)/2;return o?(h=e===s?(n-r)/o+6*(n<r):n===s?(r-e)/o+2:(e-n)/o+4,o/=l<.5?s+a:2-s-a,h*=60):o=l>0&&l<1?0:h,new O8(h,o,l,t.opacity);}function I7(t,e,i,n){return 1===arguments.length?j7(t):new O8(t,e,i,null==n?1:n);}function O8(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n;}function P7(t){return(t=(t||0)%360)<0?t+360:t;}function S9(t){return Math.max(0,Math.min(1,t||0));}function z9(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e);}t8(i9,y5,{copy(t){return Object.assign(new this.constructor,this,t);},displayable(){return this.rgb().displayable();},hex:f6,formatHex:f6,formatHex8:function(){return this.rgb().formatHex8();},formatHsl:function(){return j7(this).formatHsl();},formatRgb:w7,toString:w7}),t8(M8,k8,e9(i9,{brighter(t){return t=null==t?r8:Math.pow(r8,t),new M8(this.r*t,this.g*t,this.b*t,this.opacity);},darker(t){return t=null==t?n8:Math.pow(n8,t),new M8(this.r*t,this.g*t,this.b*t,this.opacity);},rgb(){return this;},clamp(){return new M8(H8(this.r),H8(this.g),H8(this.b),q8(this.opacity));},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1;},hex:v8,formatHex:v8,formatHex8:function(){return`#${R8(this.r)}${R8(this.g)}${R8(this.b)}${R8(255*(isNaN(this.opacity)?1:this.opacity))}`;},formatRgb:x8,toString:x8})),t8(O8,I7,e9(i9,{brighter(t){return t=null==t?r8:Math.pow(r8,t),new O8(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?n8:Math.pow(n8,t),new O8(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*e,r=2*i-n;return new M8(z9(t>=240?t-240:t+120,r,n),z9(t,r,n),z9(t<120?t+240:t-120,r,n),this.opacity);},clamp(){return new O8(P7(this.h),S9(this.s),S9(this.l),q8(this.opacity));},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1;},formatHsl(){const t=q8(this.opacity);return`${1===t?"hsl(":"hsla("}${P7(this.h)}, ${100*S9(this.s)}%, ${100*S9(this.l)}%${1===t?")":`, ${t})`}`;}}));const C8=Math.PI/180,L7=180/Math.PI,A10=.96422,B8=.82521,D7=4/29,F7=6/29,G9=3*F7*F7,J9=F7*F7*F7;function K9(t){if(t instanceof U6)return new U6(t.l,t.a,t.b,t.opacity);if(t instanceof et4)return it4(t);t instanceof M8||(t=N9(t));var e,i,n=Y8(t.r),r=Y8(t.g),a=Y8(t.b),s=V7((.2225045*n+.7168786*r+.0606169*a)/1);return n===r&&r===a?e=i=s:(e=V7((.4360747*n+.3850649*r+.1430804*a)/A10),i=V7((.0139322*n+.0971045*r+.7141733*a)/B8)),new U6(116*s-16,500*(e-s),200*(s-i),t.opacity);}function T7(t,e,i,n){return 1===arguments.length?K9(t):new U6(t,e,i,null==n?1:n);}function U6(t,e,i,n){this.l=+t,this.a=+e,this.b=+i,this.opacity=+n;}function V7(t){return t>J9?Math.pow(t,1/3):t/G9+D7;}function W8(t){return t>F7?t*t*t:G9*(t-D7);}function X9(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055);}function Y8(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);}function Z9(t){if(t instanceof et4)return new et4(t.h,t.c,t.l,t.opacity);if(t instanceof U6||(t=K9(t)),0===t.a&&0===t.b)return new et4(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*L7;return new et4(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity);}function tt5(t,e,i,n){return 1===arguments.length?Z9(t):new et4(t,e,i,null==n?1:n);}function et4(t,e,i,n){this.h=+t,this.c=+e,this.l=+i,this.opacity=+n;}function it4(t){if(isNaN(t.h))return new U6(t.l,0,0,t.opacity);var e=t.h*C8;return new U6(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity);}t8(U6,T7,e9(i9,{brighter(t){return new U6(this.l+18*(null==t?1:t),this.a,this.b,this.opacity);},darker(t){return new U6(this.l-18*(null==t?1:t),this.a,this.b,this.opacity);},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,i=isNaN(this.b)?t:t-this.b/200;return new M8(X9(3.1338561*(e=A10*W8(e))-1.6168667*(t=1*W8(t))-.4906146*(i=B8*W8(i))),X9(-.9787684*e+1.9161415*t+.033454*i),X9(.0719453*e-.2289914*t+1.4052427*i),this.opacity);}})),t8(et4,tt5,e9(i9,{brighter(t){return new et4(this.h,this.c,this.l+18*(null==t?1:t),this.opacity);},darker(t){return new et4(this.h,this.c,this.l-18*(null==t?1:t),this.opacity);},rgb(){return it4(this).rgb();}}));var nt5=-.14861,rt5=1.78277,at5=-.29227,st4=-.90649,ht4=1.97294,ot4=ht4*st4,lt4=ht4*rt5,ut4=rt5*at5-st4*nt5;function ct4(t,e,i,n){return 1===arguments.length?function(t){if(t instanceof gt4)return new gt4(t.h,t.s,t.l,t.opacity);t instanceof M8||(t=N9(t));var e=t.r/255,i=t.g/255,n=t.b/255,r=(ut4*n+ot4*e-lt4*i)/(ut4+ot4-lt4),a=n-r,s=(ht4*(i-r)-at5*a)/st4,h=Math.sqrt(s*s+a*a)/(ht4*r*(1-r)),o=h?Math.atan2(s,a)*L7-120:NaN;return new gt4(o<0?o+360:o,h,r,t.opacity);}(t):new gt4(t,e,i,null==n?1:n);}function gt4(t,e,i,n){this.h=+t,this.s=+e,this.l=+i,this.opacity=+n;}t8(gt4,ct4,e9(i9,{brighter(t){return t=null==t?r8:Math.pow(r8,t),new gt4(this.h,this.s,this.l*t,this.opacity);},darker(t){return t=null==t?n8:Math.pow(n8,t),new gt4(this.h,this.s,this.l*t,this.opacity);},rgb(){var t=isNaN(this.h)?0:(this.h+120)*C8,e=+this.l,i=isNaN(this.s)?0:this.s*e*(1-e),n=Math.cos(t),r=Math.sin(t);return new M8(255*(e+i*(nt5*n+rt5*r)),255*(e+i*(at5*n+st4*r)),255*(e+i*(ht4*n)),this.opacity);}}));function u10(t,n,r,e,a){var o=t*t,u=o*t;return((1-3*t+3*o-u)*n+(4-6*o+3*u)*r+(1+3*t+3*o-3*u)*e+u*a)/6;}function i10(t){var n=t.length-1;return function(r){var e=r<=0?r=0:r>=1?(r=1,n-1):Math.floor(r*n),a=t[e],o=t[e+1],i=e>0?t[e-1]:2*a-o,c=e<n-1?t[e+2]:2*o-a;return u10((r-e/n)*n,i,a,o,c);};}function c8(t){var n=t.length;return function(r){var e=Math.floor(((r%=1)<0?++r:r)*n),a=t[(e+n-1)%n],o=t[e%n],i=t[(e+1)%n],c=t[(e+2)%n];return u10((r-e/n)*n,a,o,i,c);};}var l9=t=>()=>t;function s10(t,n){return function(r){return t+r*n;};}function f7(t,n){var r=n-t;return r?s10(t,r>180||r<-180?r-360*Math.round(r/360):r):l9(isNaN(t)?n:t);}function h9(t){return 1==(t=+t)?p9:function(n,r){return r-n?function(t,n,r){return t=Math.pow(t,r),n=Math.pow(n,r)-t,r=1/r,function(e){return Math.pow(t+e*n,r);};}(n,r,t):l9(isNaN(n)?r:n);};}function p9(t,n){var r=n-t;return r?s10(t,r):l9(isNaN(t)?n:t);}var v9=function n(r){var e=h9(r);function a(n,r){var a=e((n=k8(n)).r,(r=k8(r)).r),o=e(n.g,r.g),u=e(n.b,r.b),i=p9(n.opacity,r.opacity);return function(t){return n.r=a(t),n.g=o(t),n.b=u(t),n.opacity=i(t),n+"";};}return a.gamma=n,a;}(1);function g8(n){return function(r){var e,a,o=r.length,u=new Array(o),i=new Array(o),c=new Array(o);for(e=0;e<o;++e)a=k8(r[e]),u[e]=a.r||0,i[e]=a.g||0,c[e]=a.b||0;return u=n(u),i=n(i),c=n(c),a.opacity=1,function(t){return a.r=u(t),a.g=i(t),a.b=c(t),a+"";};};}var M9=g8(i10),x9=g8(c8);function y6(t,n){n||(n=[]);var r,e=t?Math.min(n.length,t.length):0,a=n.slice();return function(o){for(r=0;r<e;++r)a[r]=t[r]*(1-o)+n[r]*o;return a;};}function b8(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView);}function w8(t,n){return(b8(n)?y6:m9)(t,n);}function m9(t,n){var r,e=n?n.length:0,a=t?Math.min(e,t.length):0,o=new Array(a),u=new Array(e);for(r=0;r<a;++r)o[r]=R9(t[r],n[r]);for(;r<e;++r)u[r]=n[r];return function(t){for(r=0;r<a;++r)u[r]=o[r](t);return u;};}function d8(t,n){var r=new Date;return t=+t,n=+n,function(e){return r.setTime(t*(1-e)+n*e),r;};}function X10(t,n){return t=+t,n=+n,function(r){return t*(1-r)+n*r;};}function A11(t,n){var r,e={},a={};for(r in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)r in t?e[r]=R9(t[r],n[r]):a[r]=n[r];return function(t){for(r in e)a[r]=e[r](t);return a;};}var N10=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Y9=new RegExp(N10.source,"g");function D8(t,n){var r,e,a,o=N10.lastIndex=Y9.lastIndex=0,u=-1,i=[],c=[];for(t+="",n+="";(r=N10.exec(t))&&(e=Y9.exec(n));)(a=e.index)>o&&(a=n.slice(o,a),i[u]?i[u]+=a:i[++u]=a),(r=r[0])===(e=e[0])?i[u]?i[u]+=e:i[++u]=e:(i[++u]=null,c.push({i:u,x:X10(r,e)})),o=Y9.lastIndex;return o<n.length&&(a=n.slice(o),i[u]?i[u]+=a:i[++u]=a),i.length<2?c[0]?function(t){return function(n){return t(n)+"";};}(c[0].x):function(t){return function(){return t;};}(n):(n=c.length,function(t){for(var r,e=0;e<n;++e)i[(r=c[e]).i]=r.x(t);return i.join("");});}function R9(t,r){var e,a=typeof r;return null==r||"boolean"===a?l9(r):("number"===a?X10:"string"===a?(e=y5(r))?(r=e,v9):D8:r instanceof y5?v9:r instanceof Date?d8:b8(r)?y6:Array.isArray(r)?m9:"function"!=typeof r.valueOf&&"function"!=typeof r.toString||isNaN(r)?A11:X10)(t,r);}function S10(t){var n=t.length;return function(r){return t[Math.max(0,Math.min(n-1,Math.floor(r*n)))];};}function k9(t,n){var r=f7(+t,+n);return function(t){var n=r(t);return n-360*Math.floor(n/360);};}function j8(t,n){return t=+t,n=+n,function(r){return Math.round(t*(1-r)+n*r);};}var q9,B9=180/Math.PI,C9={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function H9(t,n,r,e,a,o){var u,i,c;return(u=Math.sqrt(t*t+n*n))&&(t/=u,n/=u),(c=t*r+n*e)&&(r-=t*c,e-=n*c),(i=Math.sqrt(r*r+e*e))&&(r/=i,e/=i,c/=i),t*e<n*r&&(t=-t,n=-n,c=-c,u=-u),{translateX:a,translateY:o,rotate:Math.atan2(n,t)*B9,skewX:Math.atan(c)*B9,scaleX:u,scaleY:i};}function I8(t,n,r,e){function a(t){return t.length?t.pop()+" ":"";}return function(o,u){var i=[],c=[];return o=t(o),u=t(u),function(t,e,a,o,u,i){if(t!==a||e!==o){var c=u.push("translate(",null,n,null,r);i.push({i:c-4,x:X10(t,a)},{i:c-2,x:X10(e,o)});}else(a||o)&&u.push("translate("+a+n+o+r);}(o.translateX,o.translateY,u.translateX,u.translateY,i,c),function(t,n,r,o){t!==n?(t-n>180?n+=360:n-t>180&&(t+=360),o.push({i:r.push(a(r)+"rotate(",null,e)-2,x:X10(t,n)})):n&&r.push(a(r)+"rotate("+n+e);}(o.rotate,u.rotate,i,c),function(t,n,r,o){t!==n?o.push({i:r.push(a(r)+"skewX(",null,e)-2,x:X10(t,n)}):n&&r.push(a(r)+"skewX("+n+e);}(o.skewX,u.skewX,i,c),function(t,n,r,e,o,u){if(t!==r||n!==e){var i=o.push(a(o)+"scale(",null,",",null,")");u.push({i:i-4,x:X10(t,r)},{i:i-2,x:X10(n,e)});}else 1===r&&1===e||o.push(a(o)+"scale("+r+","+e+")");}(o.scaleX,o.scaleY,u.scaleX,u.scaleY,i,c),o=u=null,function(t){for(var n,r=-1,e=c.length;++r<e;)i[(n=c[r]).i]=n.x(t);return i.join("");};};}var L8=I8(function(t){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?C9:H9(n.a,n.b,n.c,n.d,n.e,n.f);},"px, ","px)","deg)"),O9=I8(function(t){return null==t?C9:(q9||(q9=document.createElementNS("http://www.w3.org/2000/svg","g")),q9.setAttribute("transform",t),(t=q9.transform.baseVal.consolidate())?H9((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):C9);},", ",")",")");function E11(t){return((t=Math.exp(t))+1/t)/2;}var T8=function t(n,r,e){function a(t,a){var o,u,i=t[0],c=t[1],l=t[2],s=a[0],f=a[1],h=a[2],p=s-i,v=f-c,g=p*p+v*v;if(g<1e-12)u=Math.log(h/l)/n,o=function(t){return[i+t*p,c+t*v,l*Math.exp(n*t*u)];};else{var M=Math.sqrt(g),x=(h*h-l*l+e*g)/(2*l*r*M),y=(h*h-l*l-e*g)/(2*h*r*M),b=Math.log(Math.sqrt(x*x+1)-x),w=Math.log(Math.sqrt(y*y+1)-y);u=(w-b)/n,o=function(t){var e,a=t*u,o=E11(b),s=l/(r*M)*(o*(e=n*a+b,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2;}(b));return[i+s*p,c+s*v,l*o/E11(n*a+b)];};}return o.duration=1e3*u*n/Math.SQRT2,o;}return a.rho=function(n){var r=Math.max(.001,+n),e=r*r;return t(r,e,e*e);},a;}(Math.SQRT2,2,4);function V8(t){return function(n,e){var a=t((n=I7(n)).h,(e=I7(e)).h),o=p9(n.s,e.s),u=p9(n.l,e.l),i=p9(n.opacity,e.opacity);return function(t){return n.h=a(t),n.s=o(t),n.l=u(t),n.opacity=i(t),n+"";};};}var Q7=V8(f7),K10=V8(p9);function P8(t,n){var r=p9((t=T7(t)).l,(n=T7(n)).l),a=p9(t.a,n.a),o=p9(t.b,n.b),u=p9(t.opacity,n.opacity);return function(n){return t.l=r(n),t.a=a(n),t.b=o(n),t.opacity=u(n),t+"";};}function W9(t){return function(n,r){var e=t((n=tt5(n)).h,(r=tt5(r)).h),o=p9(n.c,r.c),u=p9(n.l,r.l),i=p9(n.opacity,r.opacity);return function(t){return n.h=e(t),n.c=o(t),n.l=u(t),n.opacity=i(t),n+"";};};}var Z10=W9(f7),z10=W9(p9);function F8(t){return function n(r){function e(n,e){var a=t((n=ct4(n)).h,(e=ct4(e)).h),u=p9(n.s,e.s),i=p9(n.l,e.l),c=p9(n.opacity,e.opacity);return function(t){return n.h=a(t),n.s=u(t),n.l=i(Math.pow(t,r)),n.opacity=c(t),n+"";};}return r=+r,e.gamma=n,e;}(1);}var G10=F8(f7),J10=F8(p9);function U7(t,n){void 0===n&&(n=t,t=R9);for(var r=0,e=n.length-1,a=n[0],o=new Array(e<0?0:e);r<e;)o[r]=t(a,a=n[++r]);return function(t){var n=Math.max(0,Math.min(e-1,Math.floor(t*=e)));return o[n](t-n);};}function $9(t,n){for(var r=new Array(n),e=0;e<n;++e)r[e]=t(e/(n-1));return r;}const mod1=function(){return{interpolate:R9,interpolateArray:w8,interpolateBasis:i10,interpolateBasisClosed:c8,interpolateCubehelix:G10,interpolateCubehelixLong:J10,interpolateDate:d8,interpolateDiscrete:S10,interpolateHcl:Z10,interpolateHclLong:z10,interpolateHsl:Q7,interpolateHslLong:K10,interpolateHue:k9,interpolateLab:P8,interpolateNumber:X10,interpolateNumberArray:y6,interpolateObject:A11,interpolateRgb:v9,interpolateRgbBasis:M9,interpolateRgbBasisClosed:x9,interpolateRound:j8,interpolateString:D8,interpolateTransformCss:L8,interpolateTransformSvg:O9,interpolateZoom:T8,piecewise:U7,quantize:$9,default:null};}();function B10(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n);}return this;}function C10(n,t){switch(arguments.length){case 0:break;case 1:"function"==typeof n?this.interpolator(n):this.range(n);break;default:this.domain(n),"function"==typeof t?this.interpolator(t):this.range(t);}return this;}const z11=Symbol("implicit");function Y10(){var t=new e3,r=[],e=[],u=z11;function a(n){let a=t.get(n);if(void 0===a){if(u!==z11)return u;t.set(n,a=r.push(n)-1);}return e[a%e.length];}return a.domain=function(e){if(!arguments.length)return r.slice();r=[],t=new e3;for(const n of e)t.has(n)||t.set(n,r.push(n)-1);return a;},a.range=function(n){return arguments.length?(e=Array.from(n),a):e.slice();},a.unknown=function(n){return arguments.length?(u=n,a):u;},a.copy=function(){return Y10(r,e).unknown(u);},B10.apply(a,arguments),a;}function J11(n){return+n;}var K11=[0,1];function V9(n){return n;}function W10(n,t){return(t-=n=+n)?function(r){return(r-n)/t;}:(r=isNaN(t)?NaN:.5,function(){return r;});var r;}function X11(n,t,r){var e=n[0],u=n[1],a=t[0],o=t[1];return u<e?(e=W10(u,e),a=r(o,a)):(e=W10(e,u),a=r(a,o)),function(n){return a(e(n));};}function Z11(n,t,e){var u=Math.min(n.length,t.length)-1,a=new Array(u),o=new Array(u),i=-1;for(n[u]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++i<u;)a[i]=W10(n[i],n[i+1]),o[i]=e(t[i],t[i+1]);return function(t){var e=l2(n,t,1,u)-1;return o[e](a[e](t));};}function $10(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown());}function _8(){var n,t,r,e,u,a,o=K11,i=K11,c=R9,p=V9;function h(){var n,t,r,c=Math.min(o.length,i.length);return p!==V9&&(n=o[0],t=o[c-1],n>t&&(r=n,n=t,t=r),p=function(r){return Math.max(n,Math.min(t,r));}),e=c>2?Z11:X11,u=a=null,g;}function g(t){return null==t||isNaN(t=+t)?r:(u||(u=e(o.map(n),i,c)))(n(p(t)));}return g.invert=function(r){return p(t((a||(a=e(i,o.map(n),X10)))(r)));},g.domain=function(n){return arguments.length?(o=Array.from(n,J11),h()):o.slice();},g.range=function(n){return arguments.length?(i=Array.from(n),h()):i.slice();},g.rangeRound=function(n){return i=Array.from(n),c=j8,h();},g.clamp=function(n){return arguments.length?(p=!!n||V9,h()):p!==V9;},g.interpolate=function(n){return arguments.length?(c=n,h()):c;},g.unknown=function(n){return arguments.length?(r=n,g):r;},function(r,e){return n=r,t=e,h();};}function nn3(){return _8()(V9,V9);}function tn3(n,t,r,u){var a,o=nt(n,t,r);switch((u=e5(null==u?",f":u)).type){case"s":var i=Math.max(Math.abs(n),Math.abs(t));return null!=u.precision||isNaN(a=v2(o,i))||(u.precision=a),u5(u,i);case"":case"e":case"g":case"p":case"r":null!=u.precision||isNaN(a=M1(o,Math.max(Math.abs(n),Math.abs(t))))||(u.precision=a-("e"===u.type));break;case"f":case"%":null!=u.precision||isNaN(a=p3(o))||(u.precision=a-2*("%"===u.type));}return l3(u);}function rn3(n){var t=n.domain;return n.ticks=function(n){var r=t();return $1(r[0],r[r.length-1],null==n?10:n);},n.tickFormat=function(n,r){var e=t();return tn3(e[0],e[e.length-1],null==n?10:n,r);},n.nice=function(r){null==r&&(r=10);var e,u,o=t(),i=0,c=o.length-1,l=o[i],f=o[c],s=10;for(f<l&&(u=l,l=f,f=u,u=i,i=c,c=u);s-- >0;){if((u=tt(l,f,r))===e)return o[i]=l,o[c]=f,t(o);if(u>0)l=Math.floor(l/u)*u,f=Math.ceil(f/u)*u;else{if(!(u<0))break;l=Math.ceil(l*u)/u,f=Math.floor(f*u)/u;}e=u;}return n;},n;}function en3(){var n=nn3();return n.copy=function(){return $10(n,en3());},B10.apply(n,arguments),rn3(n);}function un3(n){var t;function r(n){return null==n||isNaN(n=+n)?t:n;}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(n=Array.from(t,J11),r):n.slice();},r.unknown=function(n){return arguments.length?(t=n,r):t;},r.copy=function(){return un3(n).unknown(t);},n=arguments.length?Array.from(n,J11):[0,1],rn3(r);}function an3(n,t){var r,e=0,u=(n=n.slice()).length-1,a=n[e],o=n[u];return o<a&&(r=e,e=u,u=r,r=a,a=o,o=r),n[e]=t.floor(a),n[u]=t.ceil(o),n;}function on3(n){return Math.log(n);}function cn3(n){return Math.exp(n);}function ln3(n){return-Math.log(-n);}function fn3(n){return-Math.exp(-n);}function sn3(n){return isFinite(n)?+("1e"+n):n<0?0:n;}function pn2(n){return(t,r)=>-n(-t,r);}function hn3(n){const t=n(on3,cn3),r=t.domain;let e,a,o=10;function i(){return e=function(n){return n===Math.E?Math.log:10===n&&Math.log10||2===n&&Math.log2||(n=Math.log(n),t=>Math.log(t)/n);}(o),a=function(n){return 10===n?sn3:n===Math.E?Math.exp:t=>Math.pow(n,t);}(o),r()[0]<0?(e=pn2(e),a=pn2(a),n(ln3,fn3)):n(on3,cn3),t;}return t.base=function(n){return arguments.length?(o=+n,i()):o;},t.domain=function(n){return arguments.length?(r(n),i()):r();},t.ticks=n=>{const t=r();let i=t[0],c=t[t.length-1];const l=c<i;l&&([i,c]=[c,i]);let f,s,p=e(i),h=e(c);const g=null==n?10:+n;let m=[];if(!(o%1)&&h-p<g){if(p=Math.floor(p),h=Math.ceil(h),i>0){for(;p<=h;++p)for(f=1;f<o;++f)if(s=p<0?f/a(-p):f*a(p),!(s<i)){if(s>c)break;m.push(s);}}else for(;p<=h;++p)for(f=o-1;f>=1;--f)if(s=p>0?f/a(-p):f*a(p),!(s<i)){if(s>c)break;m.push(s);}2*m.length<g&&(m=$1(i,c,g));}else m=$1(p,h,Math.min(h-p,g)).map(a);return l?m.reverse():m;},t.tickFormat=(n,r)=>{if(null==n&&(n=10),null==r&&(r=10===o?"s":","),"function"!=typeof r&&(o%1||null!=(r=e5(r)).precision||(r.trim=!0),r=l3(r)),n===1/0)return r;const u=Math.max(1,o*n/t.ticks().length);return n=>{let t=n/a(Math.round(e(n)));return t*o<o-.5&&(t*=o),t<=u?r(n):"";};},t.nice=()=>r(an3(r(),{floor:n=>a(Math.floor(e(n))),ceil:n=>a(Math.ceil(e(n)))})),t;}function gn2(){const n=hn3(_8()).domain([1,10]);return n.copy=()=>$10(n,gn2()).base(n.base()),B10.apply(n,arguments),n;}function mn2(n){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/n));};}function dn2(n){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*n;};}function yn2(n){var t=1,r=n(mn2(t),dn2(t));return r.constant=function(r){return arguments.length?n(mn2(t=+r),dn2(t)):t;},rn3(r);}function vn2(){var n=yn2(_8());return n.copy=function(){return $10(n,vn2()).constant(n.constant());},B10.apply(n,arguments);}function Mn2(n){return function(t){return t<0?-Math.pow(-t,n):Math.pow(t,n);};}function wn2(n){return n<0?-Math.sqrt(-n):Math.sqrt(n);}function kn1(n){return n<0?-n*n:n*n;}function Nn1(n){var t=n(V9,V9),r=1;return t.exponent=function(t){return arguments.length?1===(r=+t)?n(V9,V9):.5===r?n(wn2,kn1):n(Mn2(r),Mn2(1/r)):r;},rn3(t);}function xn2(){var n=Nn1(_8());return n.copy=function(){return $10(n,xn2()).exponent(n.exponent());},B10.apply(n,arguments),n;}function bn2(){return xn2.apply(null,arguments).exponent(.5);}function Sn2(){var n,t=[],e=[],u=[];function a(){var n=0,r=Math.max(1,e.length);for(u=new Array(r-1);++n<r;)u[n-1]=yt(t,n/r);return c;}function c(t){return null==t||isNaN(t=+t)?n:e[l2(u,t)];}return c.invertExtent=function(n){var r=e.indexOf(n);return r<0?[NaN,NaN]:[r>0?u[r-1]:t[0],r<u.length?u[r]:t[t.length-1]];},c.domain=function(n){if(!arguments.length)return t.slice();t=[];for(let r of n)null==r||isNaN(r=+r)||t.push(r);return t.sort(r4),a();},c.range=function(n){return arguments.length?(e=Array.from(n),a()):e.slice();},c.unknown=function(t){return arguments.length?(n=t,c):n;},c.quantiles=function(){return u.slice();},c.copy=function(){return Sn2().domain(t).range(e).unknown(n);},B10.apply(c,arguments);}function Dn2(){var n,t=0,e=1,u=1,a=[.5],o=[0,1];function i(t){return null!=t&&t<=t?o[l2(a,t,0,u)]:n;}function c(){var n=-1;for(a=new Array(u);++n<u;)a[n]=((n+1)*e-(n-u)*t)/(u+1);return i;}return i.domain=function(n){return arguments.length?([t,e]=n,t=+t,e=+e,c()):[t,e];},i.range=function(n){return arguments.length?(u=(o=Array.from(n)).length-1,c()):o.slice();},i.invertExtent=function(n){var r=o.indexOf(n);return r<0?[NaN,NaN]:r<1?[t,a[0]]:r>=u?[a[u-1],e]:[a[r-1],a[r]];},i.unknown=function(t){return arguments.length?(n=t,i):i;},i.thresholds=function(){return a.slice();},i.copy=function(){return Dn2().domain([t,e]).range(o).unknown(n);},B10.apply(rn3(i),arguments);}function In1(){var n,t=[.5],e=[0,1],u=1;function a(a){return null!=a&&a<=a?e[l2(t,a,0,u)]:n;}return a.domain=function(n){return arguments.length?(t=Array.from(n),u=Math.min(t.length,e.length-1),a):t.slice();},a.range=function(n){return arguments.length?(e=Array.from(n),u=Math.min(t.length,e.length-1),a):e.slice();},a.invertExtent=function(n){var r=e.indexOf(n);return[t[r-1],t[r]];},a.unknown=function(t){return arguments.length?(n=t,a):n;},a.copy=function(){return In1().domain(t).range(e).unknown(n);},B10.apply(a,arguments);}function On1(n){return new Date(n);}function Rn1(n){return n instanceof Date?+n:+new Date(+n);}function En1(n,t,r,e,u,a,o,i,c,l){var f=nn3(),s=f.invert,p=f.domain,h=l(".%L"),g=l(":%S"),m=l("%I:%M"),d=l("%I %p"),y=l("%a %d"),v=l("%b %d"),M=l("%B"),w=l("%Y");function k(n){return(c(n)<n?h:i(n)<n?g:o(n)<n?m:a(n)<n?d:e(n)<n?u(n)<n?y:v:r(n)<n?M:w)(n);}return f.invert=function(n){return new Date(s(n));},f.domain=function(n){return arguments.length?p(Array.from(n,Rn1)):p().map(On1);},f.ticks=function(t){var r=p();return n(r[0],r[r.length-1],null==t?10:t);},f.tickFormat=function(n,t){return null==t?k:l(t);},f.nice=function(n){var r=p();return n&&"function"==typeof n.range||(n=t(r[0],r[r.length-1],null==n?10:n)),n?p(an3(r,n)):f;},f.copy=function(){return $10(f,En1(n,t,r,e,u,a,o,i,c,l));},f;}function Ln1(){return B10.apply(En1(he,me,ie,oe,O1,y,F2,M2,C2,v4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments);}function Fn1(){return B10.apply(En1(Ue,Me,ce,ge,P1,v3,d3,m3,C2,m4).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments);}function Pn(){var n,t,r,e,u,a=0,o=1,i=V9,c=!1;function l(t){return null==t||isNaN(t=+t)?u:i(0===r?.5:(t=(e(t)-n)*r,c?Math.max(0,Math.min(1,t)):t));}function p(n){return function(t){var r,e;return arguments.length?([r,e]=t,i=n(r,e),l):[i(0),i(1)];};}return l.domain=function(u){return arguments.length?([a,o]=u,n=e(a=+a),t=e(o=+o),r=n===t?0:1/(t-n),l):[a,o];},l.clamp=function(n){return arguments.length?(c=!!n,l):c;},l.interpolator=function(n){return arguments.length?(i=n,l):i;},l.range=p(R9),l.rangeRound=p(j8),l.unknown=function(n){return arguments.length?(u=n,l):u;},function(u){return e=u,n=u(a),t=u(o),r=n===t?0:1/(t-n),l;};}function Tn1(n,t){return t.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown());}function Qn(){var n=rn3(Pn()(V9));return n.copy=function(){return Tn1(n,Qn());},C10.apply(n,arguments);}function Un1(){var n=hn3(Pn()).domain([1,10]);return n.copy=function(){return Tn1(n,Un1()).base(n.base());},C10.apply(n,arguments);}function Bn(){var n=yn2(Pn());return n.copy=function(){return Tn1(n,Bn()).constant(n.constant());},C10.apply(n,arguments);}function Cn1(){var n=Nn1(Pn());return n.copy=function(){return Tn1(n,Cn1()).exponent(n.exponent());},C10.apply(n,arguments);}function zn1(){return Cn1.apply(null,arguments).exponent(.5);}function jn2(){var n,t,r,e,u,a,o,i=0,c=.5,l=1,h=1,g=V9,m=!1;function d(n){return isNaN(n=+n)?o:(n=.5+((n=+a(n))-t)*(h*n<h*t?e:u),g(m?Math.max(0,Math.min(1,n)):n));}function y(n){return function(t){var r,e,u;return arguments.length?([r,e,u]=t,g=U7(n,[r,e,u]),d):[g(0),g(.5),g(1)];};}return d.domain=function(o){return arguments.length?([i,c,l]=o,n=a(i=+i),t=a(c=+c),r=a(l=+l),e=n===t?0:.5/(t-n),u=t===r?0:.5/(r-t),h=t<n?-1:1,d):[i,c,l];},d.clamp=function(n){return arguments.length?(m=!!n,d):m;},d.interpolator=function(n){return arguments.length?(g=n,d):g;},d.range=y(R9),d.rangeRound=y(j8),d.unknown=function(n){return arguments.length?(o=n,d):o;},function(o){return a=o,n=o(i),t=o(c),r=o(l),e=n===t?0:.5/(t-n),u=t===r?0:.5/(r-t),h=t<n?-1:1,d;};}function Gn(){var n=rn3(jn2()(V9));return n.copy=function(){return Tn1(n,Gn());},C10.apply(n,arguments);}function Hn1(){var n=hn3(jn2()).domain([.1,1,10]);return n.copy=function(){return Tn1(n,Hn1()).base(n.base());},C10.apply(n,arguments);}function Jn(){var n=yn2(jn2());return n.copy=function(){return Tn1(n,Jn()).constant(n.constant());},C10.apply(n,arguments);}function Kn(){var n=Nn1(jn2());return n.copy=function(){return Tn1(n,Kn()).exponent(n.exponent());},C10.apply(n,arguments);}function Vn1(){return Kn.apply(null,arguments).exponent(.5);}function c9(f){for(var e=f.length/6|0,a=new Array(e),d=0;d<e;)a[d]="#"+f.slice(6*d,6*++d);return a;}var b9=c9("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),t9=c9("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),r9=c9("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),n9=c9("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),s11=c9("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),o8=c9("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),m10=c9("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),h10=c9("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),l10=c9("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),p10=c9("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),i11=c9("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),u11=e=>M9(e[e.length-1]),M10=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(c9),y7=u11(M10),w9=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(c9),A12=u11(w9),P9=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(c9),B11=u11(P9),G11=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(c9),R10=u11(G11),Y11=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(c9),x10=u11(Y11),O10=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(c9),g9=u11(O10),v10=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(c9),S11=u11(v10),C11=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(c9),I9=u11(C11),D9=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(c9),T9=u11(D9),k10=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(c9),V10=u11(k10),W11=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(c9),j9=u11(W11),q10=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(c9),z12=u11(q10),E12=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(c9),F9=u11(E12),H10=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(c9),J12=u11(H10),K12=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(c9),L9=u11(K12),N11=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(c9),Q8=u11(N11),U8=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(c9),X12=u11(U8),Z12=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(c9),$11=u11(Z12),_9=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(c9),ff=u11(_9),ef=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(c9),af=u11(ef),df=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(c9),cf=u11(df),bf=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(c9),tf=u11(bf),rf=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(c9),nf=u11(rf),sf=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(c9),of=u11(sf),mf=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(c9),hf=u11(mf),lf=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(c9),pf=u11(lf),uf=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(c9),Mf=u11(uf);J10(ct4(300,.5,0),ct4(-240,.5,1)),J10(ct4(-100,.75,.35),ct4(80,1.5,.8)),J10(ct4(260,.75,.35),ct4(80,1.5,.8)),ct4();k8();function vf(f){var e=f.length;return function(a){return f[Math.max(0,Math.min(e-1,Math.floor(a*e)))];};}vf(c9("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),vf(c9("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),vf(c9("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),vf(c9("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function R11(e,c,a){const f=e-c+2*a;return e?f>0?f:1:0;}const F10="identity",A13="linear",I10="log",L10="pow",T10="sqrt",D10="symlog",P10="time",Y12="utc",j10="sequential",C12="diverging",E13="quantile",z13="quantize",U9="threshold",N12="ordinal",Q9="point",X13="band",_10="bin-ordinal",H11="continuous",J13="discrete",K13="discretizing",V11="interpolating",W12="temporal";function Z13(){const e=Y10().unknown(void 0),c=e.domain,a=e.range;let f,n,d=[0,1],t=!1,b=0,r=0,o=.5;function i(){const e=c().length,i=d[1]<d[0],l=d[1-i],s=R11(e,b,r);let m=d[i-0];f=(l-m)/(s||1),t&&(f=Math.floor(f)),m+=(l-m-f*(e-b))*o,n=f*(1-b),t&&(m=Math.round(m),n=Math.round(n));const g=Nt(e).map(e=>m+f*e);return a(i?g.reverse():g);}return delete e.unknown,e.domain=function(e){return arguments.length?(c(e),i()):c();},e.range=function(e){return arguments.length?(d=[+e[0],+e[1]],i()):d.slice();},e.rangeRound=function(e){return d=[+e[0],+e[1]],t=!0,i();},e.bandwidth=function(){return n;},e.step=function(){return f;},e.round=function(e){return arguments.length?(t=!!e,i()):t;},e.padding=function(e){return arguments.length?(r=Math.max(0,Math.min(1,e)),b=r,i()):b;},e.paddingInner=function(e){return arguments.length?(b=Math.max(0,Math.min(1,e)),i()):b;},e.paddingOuter=function(e){return arguments.length?(r=Math.max(0,Math.min(1,e)),i()):r;},e.align=function(e){return arguments.length?(o=Math.max(0,Math.min(1,e)),i()):o;},e.invertRange=function(e){if(null==e[0]||null==e[1])return;const f=d[1]<d[0],t=f?a().reverse():a(),b=t.length-1;let r,o,i,u=+e[0],s=+e[1];return u!=u||s!=s||(s<u&&(i=u,u=s,s=i),s<t[0]||u>d[1-f])?void 0:(r=Math.max(0,l2(t,u)-1),o=u===s?r:l2(t,s)-1,u-t[r]>n+1e-10&&++r,f&&(i=r,r=b-o,o=b-i),r>o?void 0:c().slice(r,o+1));},e.invert=function(c){const a=e.invertRange([c,c]);return a?a[0]:a;},e.copy=function(){return Z13().domain(c()).range(d).round(t).paddingInner(b).paddingOuter(r).align(o);},i();}function ee1(e){const c=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return ee1(c());},e;}var ce2=Array.prototype.map;const ae2=Array.prototype.slice;const fe1=new Map,ne1=Symbol("vega_scale");function de1(e){return e[ne1]=!0,e;}function te1(e){return e&&!0===e[ne1];}function be1(e,c,a){return arguments.length>1?(fe1.set(e,function(e,c,a){const f=function(){const a=c();return a.invertRange||(a.invertRange=a.invert?function(e){return function(c){let a,f=c[0],n=c[1];return n<f&&(a=f,f=n,n=a),[e.invert(f),e.invert(n)];};}(a):a.invertExtent?function(e){return function(c){const a=e.range();let f,n,d,t,b=c[0],r=c[1],o=-1;for(r<b&&(n=b,b=r,r=n),d=0,t=a.length;d<t;++d)a[d]>=b&&a[d]<=r&&(o<0&&(o=d),f=d);if(!(o<0))return b=e.invertExtent(a[o]),r=e.invertExtent(a[f]),[void 0===b[0]?b[1]:b[0],void 0===r[1]?r[0]:r[1]];};}(a):void 0),a.type=e,de1(a);};return f.metadata=Sn(H(a)),f;}(e,c,a)),this):re2(e)?fe1.get(e):void 0;}function re2(e){return fe1.has(e);}function oe2(e,c){const a=fe1.get(e);return a&&a.metadata[c];}function ie2(e){return oe2(e,H11);}function le2(e){return oe2(e,J13);}function ue2(e){return oe2(e,K13);}function se2(e){return oe2(e,I10);}function me2(e){return oe2(e,W12);}function ge2(e){return oe2(e,V11);}function pe1(e){return oe2(e,E13);}be1(F10,un3),be1(A13,en3,H11),be1(I10,gn2,[H11,I10]),be1(L10,xn2,H11),be1(T10,bn2,H11),be1(D10,vn2,H11),be1(P10,Ln1,[H11,W12]),be1(Y12,Fn1,[H11,W12]),be1(j10,Qn,[H11,V11]),be1(`${j10}-${A13}`,Qn,[H11,V11]),be1(`${j10}-${I10}`,Un1,[H11,V11,I10]),be1(`${j10}-${L10}`,Cn1,[H11,V11]),be1(`${j10}-${T10}`,zn1,[H11,V11]),be1(`${j10}-${D10}`,Bn,[H11,V11]),be1(`${C12}-${A13}`,Gn,[H11,V11]),be1(`${C12}-${I10}`,Hn1,[H11,V11,I10]),be1(`${C12}-${L10}`,Kn,[H11,V11]),be1(`${C12}-${T10}`,Vn1,[H11,V11]),be1(`${C12}-${D10}`,Jn,[H11,V11]),be1(E13,Sn2,[K13,E13]),be1(z13,Dn2,K13),be1(U9,In1,K13),be1(_10,function c(){let a=[],f=[];function n(e){return null==e||e!=e?void 0:f[(l2(a,e)-1)%f.length];}return n.domain=function(e){return arguments.length?(a=function(e){return ce2.call(e,z);}(e),n):a.slice();},n.range=function(e){return arguments.length?(f=ae2.call(e),n):f.slice();},n.tickFormat=function(c,f){return tn3(a[0],D(a),null==c?10:c,f);},n.copy=function(){return c().domain(n.domain()).range(n.range());},n;},[J13,K13]),be1(N12,Y10,J13),be1(X13,Z13,J13),be1(Q9,function(){return ee1(Z13().paddingInner(1));},J13);const he2=["clamp","base","constant","exponent"];function ye1(c,a){const f=a[0],n=D(a)-f;return function(e){return c(f+e*n);};}function ve1(e,c,a){return mod1.piecewise(xe1(c||"rgb",a),e);}function we1(e,c){const a=new Array(c),f=c+1;for(let n=0;n<c;)a[n]=e(++n/f);return a;}function Me2(e,a,f){const n=f-a;let d,t,b;return n&&Number.isFinite(n)?(d=(t=e.type).indexOf("-"),t=d<0?t:t.slice(d+1),b=be1(t)().domain([a,f]).range([0,1]),he2.forEach(c=>e[c]?b[c](e[c]()):0),b):tn(.5);}function xe1(e,c){const a=mod1[function(e){return"interpolate"+e.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("");}(e)];return null!=c&&a&&a.gamma?a.gamma(c):a;}function Se1(e){if(w(e))return e;const c=e.length/6|0,a=new Array(c);for(let f=0;f<c;)a[f]="#"+e.slice(6*f,6*++f);return a;}function qe1(e,c){for(const a in e)ke1(a,c(e[a]));}const Ge1={};function ke1(e,c){return e=e&&e.toLowerCase(),arguments.length>1?(Ge1[e]=c,this):Ge1[e];}qe1({accent:t9,category10:b9,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:r9,observable10:n9,paired:s11,pastel1:o8,pastel2:m10,set1:h10,set2:l10,set3:p10,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},Se1),qe1({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>ve1(Se1(e)));const Be1="symbol",Oe1="discrete",Re1="gradient",Fe1=e=>w(e)?e.map(e=>String(e)):String(e),Ae1=(e,c)=>e[1]-c[1],Ie1=(e,c)=>c[1]-e[1];function Le1(e,c,b){let r;return yn(c)&&(e.bins&&(c=Math.max(c,e.bins.length)),null!=b&&(c=Math.min(c,Math.floor(kn(e.domain())/b||1)+1))),E(c)&&(r=c.step,c=c.interval),Mn(c)&&(c=e.type===P10?Dt(c):e.type==Y12?Tt(c):l("Only time and utc scales accept interval strings."),r&&(c=c.every(r))),c;}function Te2(c,a,f){let n=c.range(),d=n[0],t=D(n),b=Ae1;if(d>t&&(n=t,t=d,d=n,b=Ie1),d=Math.floor(d),t=Math.ceil(t),a=a.map(e=>[e,c(e)]).filter(e=>d<=e[1]&&e[1]<=t).sort(b).map(e=>e[0]),f>0&&a.length>1){const c=[a[0],D(a)];for(;a.length>f&&a.length>=3;)a=a.filter((e,c)=>!(c%2));a.length<3&&(a=c);}return a;}function De1(e,c){return e.bins?Te2(e,e.bins,c):e.ticks?e.ticks(c):e.domain();}function Pe1(e,c,a,f,n,d){const t=c.type;let b=Fe1;if(t===P10||n===P10)b=e.timeFormat(f);else if(t===Y12||n===Y12)b=e.utcFormat(f);else if(se2(t)){const n=e.formatFloat(f);if(d||c.bins)b=n;else{const e=Ye1(c,a,!1);b=c=>e(c)?n(c):"";}}else if(c.tickFormat){const n=c.domain();b=e.formatSpan(n[0],n[n.length-1],a,f);}else f&&(b=e.format(f));return b;}function Ye1(e,c,a){const f=De1(e,c),n=e.base(),d=Math.log(n),t=Math.max(1,n*c/f.length),b=e=>{let c=e/Math.pow(n,Math.round(Math.log(e)/d));return c*n<n-.5&&(c*=n),c<=t;};return a?f.filter(b):b;}const je1={[E13]:"quantiles",[z13]:"thresholds",[U9]:"domain"},Ce2={[E13]:"quantiles",[z13]:"domain"};function Ee1(c,a){return c.bins?function(c){const a=c.slice(0,-1);return a.max=D(c),a;}(c.bins):c.type===I10?Ye1(c,a,!0):je1[c.type]?function(e){const c=[-1/0].concat(e);return c.max=1/0,c;}(c[je1[c.type]]()):De1(c,a);}function ze1(e,c,a,f,n,d,t){const b=Ce2[c.type]&&d!==P10&&d!==Y12?function(e,c,a){const f=c[Ce2[c.type]](),n=f.length;let d,t=n>1?f[1]-f[0]:f[0];for(d=1;d<n;++d)t=Math.min(t,f[d]-f[d-1]);return e.formatSpan(0,t,30,a);}(e,c,n):Pe1(e,c,a,n,d,t);return f===Be1&&(e=>je1[e.type]||e.bins)(c)?Ue2(b):f===Oe1?Qe1(b):Xe1(b);}const Ue2=e=>(c,a,f)=>{const n=Ne1(f[a+1],Ne1(f.max,1/0)),d=_e1(c,e),t=_e1(n,e);return d&&t?d+" â€“ "+t:t?"< "+t:"â‰¥ "+d;},Ne1=(e,c)=>null!=e?e:c,Qe1=e=>(c,a)=>a?e(c):null,Xe1=e=>c=>e(c),_e1=(e,c)=>Number.isFinite(e)?c(e):null;function He1(c){const a=c.domain(),f=a.length-1;let n=+a[0],d=+D(a),t=d-n;if(c.type===U9){const e=f?t/f:.1;n-=e,d+=e,t=d-n;}return e=>(e-n)/t;}function Je1(c,a,f){f=f||{};const n=Math.max(3,f.maxlen||7),t=function(e,c,a,f){const n=f||c.type;return Mn(a)&&me2(n)&&(a=a.replace(/%a/g,"%A").replace(/%b/g,"%B")),a||n!==P10?a||n!==Y12?ze1(e,c,5,null,a,f,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X");}(c,a,f.format,f.formatType);if(ue2(a.type)){const e=Ee1(a).slice(1).map(t),c=e.length;return`${c} boundar${1===c?"y":"ies"}: ${e.join(", ")}`;}if(le2(a.type)){const e=a.domain(),c=e.length;return`${c} value${1===c?"":"s"}: ${c>n?e.slice(0,n-2).map(t).join(", ")+", ending with "+e.slice(-1).map(t):e.map(t).join(", ")}`;}{const c=a.domain();return`values from ${t(c[0])} to ${t(D(c))}`;}}let B12=0;const H12="p_";function W13(t){return t&&t.gradient;}function j11(t,e,n){const i=t.gradient;let r=t.id,s="radial"===i?H12:"";return r||(r=t.id="gradient_"+B12++,"radial"===i?(t.x1=U10(t.x1,.5),t.y1=U10(t.y1,.5),t.r1=U10(t.r1,0),t.x2=U10(t.x2,.5),t.y2=U10(t.y2,.5),t.r2=U10(t.r2,.5),s=H12):(t.x1=U10(t.x1,0),t.y1=U10(t.y1,0),t.x2=U10(t.x2,1),t.y2=U10(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+s+r+")";}function U10(t,e){return null!=t?t:e;}function X14(t,e){var n,i=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:i,stop:function(t,e){return i.push({offset:t,color:e}),n;}};}const G12={basis:{curve:At1},"basis-closed":{curve:Pt1},"basis-open":{curve:Ot2},bundle:{curve:zt1,tension:"beta",value:.85},cardinal:{curve:Bt2,tension:"tension",value:0},"cardinal-open":{curve:jt3,tension:"tension",value:0},"cardinal-closed":{curve:Dt3,tension:"tension",value:0},"catmull-rom":{curve:Vt,tension:"alpha",value:.5},"catmull-rom-closed":{curve:Ft1,tension:"alpha",value:.5},"catmull-rom-open":{curve:Ht1,tension:"alpha",value:.5},linear:{curve:N8},"linear-closed":{curve:Kt1},monotone:{horizontal:hn2,vertical:on2},natural:{curve:an2},step:{curve:cn2},"step-after":{curve:fn2},"step-before":{curve:un2}};function Y13(t,e,n){var r=ln(G12,t)&&G12[t],s=null;return r&&(s=r.curve||r[e||"vertical"],r.tension&&null!=n&&(s=s[r.tension](n))),s;}const J14={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},F11=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Q10=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Z14=/^((\s+,?\s*)|(,\s*))/,K14=/^[01]/;function tt6(t){const e=[];return(t.match(F11)||[]).forEach(t=>{let n=t[0];const i=n.toLowerCase(),r=J14[i],s=function(t,e,n){const i=[];for(let r=0;e&&r<n.length;)for(let s=0;s<e;++s){const e="a"!==t||3!==s&&4!==s?Q10:K14,o=n.slice(r).match(e);if(null===o)throw Error("Invalid SVG path, incorrect parameter type");r+=o[0].length,i.push(+o[0]);const a=n.slice(r).match(Z14);null!==a&&(r+=a[0].length);}return i;}(i,r,t.slice(1).trim()),o=s.length;if(o<r||o&&o%r!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...s.slice(0,r)]),o!==r){"m"===i&&(n="M"===n?"L":"l");for(let t=r;t<o;t+=r)e.push([n,...s.slice(t,t+r)]);}}),e;}const et5=Math.PI/180,nt6=Math.PI/2,it5=2*Math.PI,rt6=Math.sqrt(3)/2;var st5={},ot5={},at6=[].join;function lt5(t){const e=at6.call(t);if(ot5[e])return ot5[e];var n=t[0],i=t[1],r=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7];const h=c*o,u=-l*a,d=l*o,f=c*a,p=Math.cos(r),g=Math.sin(r),v=Math.cos(s),y=Math.sin(s),m=.5*(s-r),_=Math.sin(.5*m),x=8/3*_*_/Math.sin(m),k=n+p-x*g,b=i+g+x*p,w=n+v,T=i+y,M=w+x*y,z=T-x*v;return ot5[e]=[h*k+u*b,d*k+f*b,h*M+u*z,d*M+f*z,h*w+u*T,d*w+f*T];}const ct5=["l",0,0,0,0,0,0,0];function ht5(t,e,n){const i=ct5[0]=t[0];if("a"===i||"A"===i)ct5[1]=e*t[1],ct5[2]=n*t[2],ct5[3]=t[3],ct5[4]=t[4],ct5[5]=t[5],ct5[6]=e*t[6],ct5[7]=n*t[7];else if("h"===i||"H"===i)ct5[1]=e*t[1];else if("v"===i||"V"===i)ct5[1]=n*t[1];else for(var r=1,s=t.length;r<s;++r)ct5[r]=(r%2==1?e:n)*t[r];return ct5;}function ut5(t,e,n,i,r,s){var o,a,l,c,h,u=null,d=0,f=0,p=0,g=0,v=0,y=0;null==n&&(n=0),null==i&&(i=0),null==r&&(r=1),null==s&&(s=r),t.beginPath&&t.beginPath();for(var m=0,_=e.length;m<_;++m){switch(o=e[m],1===r&&1===s||(o=ht5(o,r,s)),o[0]){case"l":d+=o[1],f+=o[2],t.lineTo(d+n,f+i);break;case"L":d=o[1],f=o[2],t.lineTo(d+n,f+i);break;case"h":d+=o[1],t.lineTo(d+n,f+i);break;case"H":d=o[1],t.lineTo(d+n,f+i);break;case"v":f+=o[1],t.lineTo(d+n,f+i);break;case"V":f=o[1],t.lineTo(d+n,f+i);break;case"m":v=d+=o[1],y=f+=o[2],t.moveTo(d+n,f+i);break;case"M":v=d=o[1],y=f=o[2],t.moveTo(d+n,f+i);break;case"c":a=d+o[5],l=f+o[6],p=d+o[3],g=f+o[4],t.bezierCurveTo(d+o[1]+n,f+o[2]+i,p+n,g+i,a+n,l+i),d=a,f=l;break;case"C":d=o[5],f=o[6],p=o[3],g=o[4],t.bezierCurveTo(o[1]+n,o[2]+i,p+n,g+i,d+n,f+i);break;case"s":a=d+o[3],l=f+o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+i,d+o[1]+n,f+o[2]+i,a+n,l+i),p=d+o[1],g=f+o[2],d=a,f=l;break;case"S":a=o[3],l=o[4],p=2*d-p,g=2*f-g,t.bezierCurveTo(p+n,g+i,o[1]+n,o[2]+i,a+n,l+i),d=a,f=l,p=o[1],g=o[2];break;case"q":a=d+o[3],l=f+o[4],p=d+o[1],g=f+o[2],t.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"Q":a=o[3],l=o[4],t.quadraticCurveTo(o[1]+n,o[2]+i,a+n,l+i),d=a,f=l,p=o[1],g=o[2];break;case"t":a=d+o[1],l=f+o[2],null===u[0].match(/[QqTt]/)?(p=d,g=f):"t"===u[0]?(p=2*d-c,g=2*f-h):"q"===u[0]&&(p=2*d-p,g=2*f-g),c=p,h=g,t.quadraticCurveTo(p+n,g+i,a+n,l+i),f=l,p=(d=a)+o[1],g=f+o[2];break;case"T":a=o[1],l=o[2],p=2*d-p,g=2*f-g,t.quadraticCurveTo(p+n,g+i,a+n,l+i),d=a,f=l;break;case"a":dt3(t,d+n,f+i,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+f+i]),d+=o[6],f+=o[7];break;case"A":dt3(t,d+n,f+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),d=o[6],f=o[7];break;case"z":case"Z":d=v,f=y,t.closePath();}u=o;}}function dt3(t,e,n,i){const r=function(t,e,n,i,r,s,o,a,l){const c=at6.call(arguments);if(st5[c])return st5[c];const h=o*et5,u=Math.sin(h),d=Math.cos(h),f=d*(a-t)*.5+u*(l-e)*.5,p=d*(l-e)*.5-u*(a-t)*.5;let g=f*f/((n=Math.abs(n))*n)+p*p/((i=Math.abs(i))*i);g>1&&(g=Math.sqrt(g),n*=g,i*=g);const v=d/n,y=u/n,m=-u/i,_=d/i,x=v*a+y*l,k=m*a+_*l,b=v*t+y*e,w=m*t+_*e;let T=1/((b-x)*(b-x)+(w-k)*(w-k))-.25;T<0&&(T=0);let M=Math.sqrt(T);s==r&&(M=-M);const z=.5*(x+b)-M*(w-k),R=.5*(k+w)+M*(b-x),A=Math.atan2(k-R,x-z);let C=Math.atan2(w-R,b-z)-A;C<0&&1===s?C+=it5:C>0&&0===s&&(C-=it5);const P=Math.ceil(Math.abs(C/(nt6+.001))),L=[];for(let t=0;t<P;++t){const e=A+t*C/P,r=A+(t+1)*C/P;L[t]=[z,R,e,r,n,i,u,d];}return st5[c]=L;}(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let e=0;e<r.length;++e){const n=lt5(r[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);}}const ft4=.5773502691896257,pt3={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,it5);}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i),t.lineTo(-n,i),t.lineTo(-i,i),t.lineTo(-i,n),t.lineTo(i,n),t.lineTo(i,i),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(i,-i),t.lineTo(i,-n),t.lineTo(-i,-n),t.lineTo(-i,-i),t.closePath();}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath();}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n);}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,r=n/2.5,s=n/8;t.moveTo(-i,n),t.lineTo(i,n),t.lineTo(i,-s),t.lineTo(r,-s),t.lineTo(0,-n),t.lineTo(-r,-s),t.lineTo(-i,-s),t.closePath();}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n,r=i-n*ft4,s=n/4;t.moveTo(0,-i-r),t.lineTo(-s,i-r),t.lineTo(s,i-r),t.closePath();}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n,r=i-n*ft4;t.moveTo(0,-i-r),t.lineTo(-n,i-r),t.lineTo(n,i-r),t.closePath();}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n;t.moveTo(0,-i),t.lineTo(-n,i),t.lineTo(n,i),t.closePath();}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n;t.moveTo(0,i),t.lineTo(-n,-i),t.lineTo(n,-i),t.closePath();}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n;t.moveTo(i,0),t.lineTo(-i,-n),t.lineTo(-i,n),t.closePath();}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=rt6*n;t.moveTo(-i,0),t.lineTo(i,-n),t.lineTo(i,n),t.closePath();}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0);}}};function gt5(t){return ln(pt3,t)?pt3[t]:function(t){if(!ln(vt4,t)){const e=tt6(t);vt4[t]={draw:function(t,n){ut5(t,e,0,0,Math.sqrt(n)/2);}};}return vt4[t];}(t);}var vt4={};function mt3(t){return t.x;}function _t2(t){return t.y;}function xt3(t){return t.width;}function kt4(t){return t.height;}function bt3(t){return"function"==typeof t?t:()=>+t;}function wt3(t,e,n){return Math.max(e,Math.min(t,n));}function Tt2(){var t=mt3,e=_t2,n=xt3,i=kt4,r=bt3(0),s=r,o=r,a=r,l=null;function c(c,h,u){var d,f=null!=h?h:+t.call(this,c),p=null!=u?u:+e.call(this,c),g=+n.call(this,c),v=+i.call(this,c),y=Math.min(g,v)/2,m=wt3(+r.call(this,c),0,y),_=wt3(+s.call(this,c),0,y),x=wt3(+o.call(this,c),0,y),k=wt3(+a.call(this,c),0,y);if(l||(l=d=n6()),m<=0&&_<=0&&x<=0&&k<=0)l.rect(f,p,g,v);else{var b=f+g,w=p+v;l.moveTo(f+m,p),l.lineTo(b-_,p),l.bezierCurveTo(b-.448084975506*_,p,b,p+.448084975506*_,b,p+_),l.lineTo(b,w-k),l.bezierCurveTo(b,w-.448084975506*k,b-.448084975506*k,w,b-k,w),l.lineTo(f+x,w),l.bezierCurveTo(f+.448084975506*x,w,f,w-.448084975506*x,f,w-x),l.lineTo(f,p+m),l.bezierCurveTo(f,p+.448084975506*m,f+.448084975506*m,p,f+m,p),l.closePath();}if(d)return l=null,d+""||null;}return c.x=function(e){return arguments.length?(t=bt3(e),c):t;},c.y=function(t){return arguments.length?(e=bt3(t),c):e;},c.width=function(t){return arguments.length?(n=bt3(t),c):n;},c.height=function(t){return arguments.length?(i=bt3(t),c):i;},c.cornerRadius=function(t,e,n,i){return arguments.length?(r=bt3(t),s=null!=e?bt3(e):r,a=null!=n?bt3(n):r,o=null!=i?bt3(i):s,c):r;},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l;},c;}function Mt4(){var t,e,n,i,r,s,o,a,l=null;function c(t,e,n){const i=n/2;if(r){var c=o-e,h=t-s;if(c||h){var u=Math.hypot(c,h),d=(c/=u)*a,f=(h/=u)*a,p=Math.atan2(h,c);l.moveTo(s-d,o-f),l.lineTo(t-c*i,e-h*i),l.arc(t,e,i,p-Math.PI,p),l.lineTo(s+d,o+f),l.arc(s,o,a,p,p+Math.PI);}else l.arc(t,e,i,0,it5);l.closePath();}else r=1;s=t,o=e,a=i;}function h(s){var o,a,h,u=s.length,d=!1;for(null==l&&(l=h=n6()),o=0;o<=u;++o)!(o<u&&i(a=s[o],o,s))===d&&(d=!d)&&(r=0),d&&c(+t(a,o,s),+e(a,o,s),+n(a,o,s));if(h)return l=null,h+""||null;}return h.x=function(e){return arguments.length?(t=e,h):t;},h.y=function(t){return arguments.length?(e=t,h):e;},h.size=function(t){return arguments.length?(n=t,h):n;},h.defined=function(t){return arguments.length?(i=t,h):i;},h.context=function(t){return arguments.length?(l=null==t?null:t,h):l;},h;}function zt2(t,e){return null!=t?t:e;}const Rt3=t=>t.x||0,At2=t=>t.y||0,Ct3=t=>!(!1===t.defined),Pt2=m7().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),Lt2=M7().x(Rt3).y1(At2).y0(t=>(t.y||0)+(t.height||0)).defined(Ct3),Et3=M7().y(At2).x1(Rt3).x0(t=>(t.x||0)+(t.width||0)).defined(Ct3),St3=A9().x(Rt3).y(At2).defined(Ct3),Nt3=Tt2().x(Rt3).y(At2).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>zt2(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>zt2(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>zt2(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>zt2(t.cornerRadiusBottomLeft,t.cornerRadius)||0),Ot3=kt3().type(t=>gt5(t.shape||"circle")).size(t=>zt2(t.size,64)),Dt4=Mt4().x(Rt3).y(At2).defined(Ct3).size(t=>t.size||1);function It3(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft;}function qt4(t,e,n,i){return Nt3.context(t)(e,n,i);}var $t2=1;function Vt1(t,e,n){var i=e.clip,r=t._defs,s=e.clip_id||(e.clip_id="clip"+$t2++),o=r.clipping[s]||(r.clipping[s]={id:s});return L(i)?o.path=i(null):It3(n)?o.path=qt4(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+s+")";}function Bt3(t){this.clear(),t&&this.union(t);}function Ht2(t){this.mark=t,this.bounds=this.bounds||new Bt3;}function Wt2(t){Ht2.call(this,t),this.items=this.items||[];}Bt3.prototype={clone(){return new Bt3(this);},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this;},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE;},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2;},set(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this;},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this;},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this;},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this;},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this;},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this;},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7]);},rotatedPoints(t,e,n){var{x1:i,y1:r,x2:s,y2:o}=this,a=Math.cos(t),l=Math.sin(t),c=e-e*a+n*l,h=n-e*l-n*a;return[a*i-l*r+c,l*i+a*r+h,a*i-l*o+c,l*i+a*o+h,a*s-l*r+c,l*s+a*r+h,a*s-l*o+c,l*s+a*o+h];},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this;},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this;},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2;},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2);},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2);},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2);},width(){return this.x2-this.x1;},height(){return this.y2-this.y1;}},an(Wt2,Ht2);class jt4{constructor(t){this._pending=0,this._loader=t||zt();}pending(){return this._pending;}sanitizeURL(t){const e=this;return Ut3(e),e._loader.sanitize(t,{context:"href"}).then(t=>(Xt1(e),t)).catch(()=>(Xt1(e),null));}loadImage(t){const e=this,n=t7();return Ut3(e),e._loader.sanitize(t,{context:"image"}).then(t=>{const r=t.href;if(!r||!n)throw{url:r};const s=new n,o=ln(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(s.crossOrigin=o),s.onload=()=>Xt1(e),s.onerror=()=>Xt1(e),s.src=r,s;}).catch(t=>(Xt1(e),{complete:!1,width:0,height:0,src:t&&t.url||""}));}ready(){const t=this;return new Promise(e=>{!function n(i){t.pending()?setTimeout(()=>{n(!0);},10):e(i);}(!1);});}}function Ut3(t){t._pending+=1;}function Xt1(t){t._pending-=1;}function Gt1(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const i=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(i+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e;}(e,i):0));}return t;}const Yt3=it5-1e-8;let Jt2,Ft2,Qt1,Zt1,Kt2,te2,ee2,ne2;const ie3=(t,e)=>Jt2.add(t,e),re3=(t,e)=>ie3(Ft2=t,Qt1=e),se3=t=>ie3(t,Jt2.y1),oe3=t=>ie3(Jt2.x1,t),ae3=(t,e)=>Kt2*t+ee2*e,le3=(t,e)=>te2*t+ne2*e,ce3=(t,e)=>ie3(ae3(t,e),le3(t,e)),he3=(t,e)=>re3(ae3(t,e),le3(t,e));function ue3(t,e){return Jt2=t,e?(Zt1=e*et5,Kt2=ne2=Math.cos(Zt1),te2=Math.sin(Zt1),ee2=-te2):(Kt2=ne2=1,Zt1=te2=ee2=0),de2;}const de2={beginPath(){},closePath(){},moveTo:he3,lineTo:he3,rect(t,e,n,i){Zt1?(ce3(t+n,e),ce3(t+n,e+i),ce3(t,e+i),he3(t,e)):(ie3(t+n,e+i),re3(t,e));},quadraticCurveTo(t,e,n,i){const r=ae3(t,e),s=le3(t,e),o=ae3(n,i),a=le3(n,i);fe2(Ft2,r,o,se3),fe2(Qt1,s,a,oe3),re3(o,a);},bezierCurveTo(t,e,n,i,r,s){const o=ae3(t,e),a=le3(t,e),l=ae3(n,i),c=le3(n,i),h=ae3(r,s),u=le3(r,s);pe2(Ft2,o,l,h,se3),pe2(Qt1,a,c,u,oe3),re3(h,u);},arc(t,e,n,i,r,s){if(i+=Zt1,r+=Zt1,Ft2=n*Math.cos(r)+t,Qt1=n*Math.sin(r)+e,Math.abs(r-i)>Yt3)ie3(t-n,e-n),ie3(t+n,e+n);else{const o=i=>ie3(n*Math.cos(i)+t,n*Math.sin(i)+e);let a,l;if(o(i),o(r),r!==i)if((i%=it5)<0&&(i+=it5),(r%=it5)<0&&(r+=it5),r<i&&(s=!s,a=i,i=r,r=a),s)for(r-=it5,a=i-i%nt6,l=0;l<4&&a>r;++l,a-=nt6)o(a);else for(a=i-i%nt6+nt6,l=0;l<4&&a<r;++l,a+=nt6)o(a);}}};function fe2(t,e,n,i){const r=(t-e)/(t+n-2*e);0<r&&r<1&&i(t+(e-t)*r);}function pe2(t,e,n,i,r){const s=i-t+3*e-3*n,o=t+n-2*e,a=t-e;let l,c=0,h=0;Math.abs(s)>1e-14?(l=o*o+a*s,l>=0&&(l=Math.sqrt(l),c=(-o+l)/s,h=(-o-l)/s)):c=.5*a/o,0<c&&c<1&&r(ge3(c,t,e,n,i)),0<h&&h<1&&r(ge3(h,t,e,n,i));}function ge3(t,e,n,i,r){const s=1-t,o=s*s,a=t*t;return o*s*e+3*o*t*n+3*s*a*i+a*t*r;}var ve2=(ve2=e8(1,1))?ve2.getContext("2d"):null;const ye2=new Bt3;function me3(t){return function(e,n){if(!ve2)return!0;t(ve2,e),ye2.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:r,x2:s,y2:o}=ye2;for(let t=r;t<=o;++t)for(let e=i;e<=s;++e)if(ve2.isPointInPath(e,t))return!0;return!1;};}function _e2(t,e){return e.contains(t.x||0,t.y||0);}function xe2(t,e){const n=t.x||0,i=t.y||0,r=t.width||0,s=t.height||0;return e.intersects(ye2.set(n,i,n+r,i+s));}function ke2(t,e){const n=t.x||0,i=t.y||0;return be2(e,n,i,null!=t.x2?t.x2:n,null!=t.y2?t.y2:i);}function be2(t,e,n,i,r){const{x1:s,y1:o,x2:a,y2:l}=t,c=i-e,h=r-n;let u,d,f,p,g=0,v=1;for(p=0;p<4;++p){if(0===p&&(u=-c,d=-(s-e)),1===p&&(u=c,d=a-e),2===p&&(u=-h,d=-(o-n)),3===p&&(u=h,d=l-n),Math.abs(u)<1e-10&&d<0)return!1;if(f=d/u,u<0){if(f>v)return!1;f>g&&(g=f);}else if(u>0){if(f<g)return!1;f<v&&(v=f);}}return!0;}function we2(t,e){t.globalCompositeOperation=e.blend||"source-over";}function Te3(t,e){return null==t?e:t;}function Me3(t,e){const n=e.length;for(let i=0;i<n;++i)t.addColorStop(e[i].offset,e[i].color);return t;}function ze2(t,e,n){const i=n.width(),r=n.height();let s;if("radial"===e.gradient)s=t.createRadialGradient(n.x1+Te3(e.x1,.5)*i,n.y1+Te3(e.y1,.5)*r,Math.max(i,r)*Te3(e.r1,0),n.x1+Te3(e.x2,.5)*i,n.y1+Te3(e.y2,.5)*r,Math.max(i,r)*Te3(e.r2,.5));else{const o=Te3(e.x1,0),a=Te3(e.y1,0),l=Te3(e.x2,1),c=Te3(e.y2,0);if(o!==l&&a!==c&&i!==r){const n=e8(Math.ceil(i),Math.ceil(r)),s=n.getContext("2d");return s.scale(i,r),s.fillStyle=Me3(s.createLinearGradient(o,a,l,c),e.stops),s.fillRect(0,0,i,r),t.createPattern(n,"no-repeat");}s=t.createLinearGradient(n.x1+o*i,n.y1+a*r,n.x1+l*i,n.y1+c*r);}return Me3(s,e.stops);}function Re2(t,e,n){return W13(n)?ze2(t,n,e.bounds):n;}function Ae2(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Re2(t,e,e.fill),!0);}var Ce3=[];function Pe2(t,e,n){var i=null!=(i=e.strokeWidth)?i:1;return!(i<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Re2(t,e,e.stroke),t.lineWidth=i,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Ce3),t.lineDashOffset=e.strokeDashOffset||0),!0);}function Le2(t,e){return t.zindex-e.zindex||t.index-e.index;}function Ee2(t){if(!t.zdirty)return t.zitems;var e,n,i,r=t.items,s=[];for(n=0,i=r.length;n<i;++n)(e=r[n]).index=n,e.zindex&&s.push(e);return t.zdirty=!1,t.zitems=s.sort(Le2);}function Se2(t,e){var n,i,r=t.items;if(!r||!r.length)return;const s=Ee2(t);if(s&&s.length){for(n=0,i=r.length;n<i;++n)r[n].zindex||e(r[n]);r=s;}for(n=0,i=r.length;n<i;++n)e(r[n]);}function Ne2(t,e){var n,i,r=t.items;if(!r||!r.length)return null;const s=Ee2(t);for(s&&s.length&&(r=s),i=r.length;--i>=0;)if(n=e(r[i]))return n;if(r===s){for(i=(r=t.items).length;--i>=0;)if(!r[i].zindex&&(n=e(r[i])))return n;}return null;}function Oe2(t){return function(e,n,i){Se2(n,n=>{i&&!i.intersects(n.bounds)||Ie2(t,e,n,n);});};}function De2(t){return function(e,n,i){!n.items.length||i&&!i.intersects(n.bounds)||Ie2(t,e,n.items[0],n.items);};}function Ie2(t,e,n,i){var r=null==n.opacity?1:n.opacity;0!==r&&(t(e,i)||(we2(e,n),n.fill&&Ae2(e,n,r)&&e.fill(),n.stroke&&Pe2(e,n,r)&&e.stroke()));}function qe2(t){return t=t||g,function(e,n,i,r,s,o){return i*=e.pixelRatio,r*=e.pixelRatio,Ne2(n,n=>{const a=n.bounds;if((!a||a.contains(s,o))&&a)return t(e,n,i,r,s,o)?n:void 0;});};}function $e1(t,e){return function(n,i,r,s){var o,a,l=Array.isArray(i)?i[0]:i,c=null==e?l.fill:e,h=l.stroke&&n.isPointInStroke;return h&&(o=l.strokeWidth,a=l.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=a?a:"butt"),!t(n,i)&&(c&&n.isPointInPath(r,s)||h&&n.isPointInStroke(r,s));};}function Ve1(t){return qe2($e1(t));}function Be2(t,e){return"translate("+t+","+e+")";}function He2(t){return"rotate("+t+")";}function We1(t){return Be2(t.x||0,t.y||0);}function je2(t,e,n){function i(t,n){var i=n.x||0,r=n.y||0,s=n.angle||0;t.translate(i,r),s&&t.rotate(s*=et5),t.beginPath(),e(t,n),s&&t.rotate(-s),t.translate(-i,-r);}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return Be2(t.x||0,t.y||0)+(t.angle?" "+He2(t.angle):"");}(n)),t("d",e(null,n));},bound:function(t,n){return e(ue3(t,n.angle),n),Gt1(t,n).translate(n.x||0,n.y||0);},draw:Oe2(i),pick:Ve1(i),isect:n||me3(i)};}var Ue3=je2("arc",function(t,e){return Pt2.context(t)(e);});function Xe2(t,e,n){function i(t,n){t.beginPath(),e(t,n);}const r=$e1(i);return{type:t,tag:"path",nested:!0,attr:function(t,n){var i=n.mark.items;i.length&&t("d",e(null,i));},bound:function(t,n){var i=n.items;return 0===i.length?t:(e(ue3(t),i),Gt1(t,i[0]));},draw:De2(i),pick:function(t,e,n,i,s,o){var a=e.items,l=e.bounds;return!a||!a.length||l&&!l.contains(s,o)?null:(n*=t.pixelRatio,i*=t.pixelRatio,r(t,a,n,i)?a[0]:null);},isect:_e2,tip:n};}var Ge2=Xe2("area",function(t,e){const n=e[0],i=n.interpolate||"linear";return("horizontal"===n.orient?Et3:Lt2).curve(Y13(i,n.orient,n.tension)).context(t)(e);},function(t,e){for(var n,i,r="horizontal"===t[0].orient?e[1]:e[0],s="horizontal"===t[0].orient?"y":"x",o=t.length,a=1/0;--o>=0;)!1!==t[o].defined&&(i=Math.abs(t[o][s]-r))<a&&(a=i,n=t[o]);return n;});function Ye2(t,e){t.beginPath(),It3(e)?qt4(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip();}function Je2(t){const e=Te3(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0;}function Fe2(t,e){const n=Je2(e);t("d",qt4(null,e,n,n));}function Qe2(t,e,n,i){const r=Je2(e);t.beginPath(),qt4(t,e,(n||0)+r,(i||0)+r);}const Ze1=$e1(Qe2),Ke1=$e1(Qe2,!1),tn4=$e1(Qe2,!0);var en4={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",We1(e));},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let e=0;e<i;++e)t.union(n[e].bounds);}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Gt1(t,e),t.translate(e.x||0,e.y||0);},draw:function(t,e,n,i){Se2(e,e=>{const r=e.x||0,s=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(Qe2(t,e,r,s),we2(t,e),e.fill&&Ae2(t,e,a)&&t.fill(),e.stroke&&!o&&Pe2(t,e,a)&&t.stroke()),t.save(),t.translate(r,s),e.clip&&Ye2(t,e),n&&n.translate(-r,-s),Se2(e,e=>{("group"===e.marktype||null==i||i.includes(e.marktype))&&this.draw(t,e,n,i);}),n&&n.translate(r,s),t.restore(),o&&e.stroke&&a&&(Qe2(t,e,r,s),we2(t,e),Pe2(t,e,a)&&t.stroke());});},pick:function(t,e,n,i,r,s){if(e.bounds&&!e.bounds.contains(r,s)||!e.items)return null;const o=n*t.pixelRatio,a=i*t.pixelRatio;return Ne2(e,l=>{let c,h,u;const d=l.bounds;if(d&&!d.contains(r,s))return;h=l.x||0,u=l.y||0;const f=h+(l.width||0),p=u+(l.height||0),g=l.clip;if(g&&(r<h||r>f||s<u||s>p))return;if(t.save(),t.translate(h,u),h=r-h,u=s-u,g&&It3(l)&&!tn4(t,l,o,a))return t.restore(),null;const v=l.strokeForeground,y=!1!==e.interactive;return y&&v&&l.stroke&&Ke1(t,l,o,a)?(t.restore(),l):(c=Ne2(l,t=>(function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n);})(t,h,u)?this.pick(t,n,i,h,u):null),!c&&y&&(l.fill||!v&&l.stroke)&&Ze1(t,l,o,a)&&(c=l),t.restore(),c||null);});},isect:xe2,content:function(t,e,n){t("clip-path",e.clip?Vt1(n,e,e):null);},background:function(t,e){t("class","background"),t("aria-hidden",!0),Fe2(t,e);},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Fe2(t,e):t("d","");}},nn4={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function rn4(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url;})),n;}function sn4(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0;}function on4(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0;}function an4(t,e){return"center"===t?e/2:"right"===t?e:0;}function ln4(t,e){return"middle"===t?e/2:"bottom"===t?e:0;}var cn4={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const i=rn4(e,n),r=sn4(e,i),s=on4(e,i),o=(e.x||0)-an4(e.align,r),a=(e.y||0)-ln4(e.baseline,s);t("href",!i.src&&i.toDataURL?i.toDataURL():i.src||"",nn4["xmlns:xlink"],"xlink:href"),t("transform",Be2(o,a)),t("width",r),t("height",s),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid");},bound:function(t,e){const n=e.image,i=sn4(e,n),r=on4(e,n),s=(e.x||0)-an4(e.align,i),o=(e.y||0)-ln4(e.baseline,r);return t.set(s,o,s+i,o+r);},draw:function(t,e,n){Se2(e,e=>{if(n&&!n.intersects(e.bounds))return;const i=rn4(e,this);let r=sn4(e,i),s=on4(e,i);if(0===r||0===s)return;let o,a,l,c,h=(e.x||0)-an4(e.align,r),u=(e.y||0)-ln4(e.baseline,s);!1!==e.aspect&&(a=i.width/i.height,l=e.width/e.height,a==a&&l==l&&a!==l&&(l<a?(c=r/a,u+=(s-c)/2,s=c):(c=s*a,h+=(r-c)/2,r=c))),(i.complete||i.toDataURL)&&(we2(t,e),t.globalAlpha=null!=(o=e.opacity)?o:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(i,h,u,r,s));});},pick:qe2(),isect:g,get:rn4,xOffset:an4,yOffset:ln4},hn4=Xe2("line",function(t,e){const n=e[0],i=n.interpolate||"linear";return St3.curve(Y13(i,n.orient,n.tension)).context(t)(e);},function(t,e){for(var n,i,r=Math.pow(t[0].strokeWidth||1,2),s=t.length;--s>=0;)if(!1!==t[s].defined&&(n=t[s].x-e[0])*n+(i=t[s].y-e[1])*i<r)return t[s];return null;});function un4(t,e){var n=e.path;if(null==n)return!0;var i=e.x||0,r=e.y||0,s=e.scaleX||1,o=e.scaleY||1,a=(e.angle||0)*et5,l=e.pathCache;l&&l.path===n||((e.pathCache=l=tt6(n)).path=n),a&&t.rotate&&t.translate?(t.translate(i,r),t.rotate(a),ut5(t,l,0,0,s,o),t.rotate(-a),t.translate(-i,-r)):ut5(t,l,i,r,s,o);}var dn3={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,i=e.scaleY||1;1===n&&1===i||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return Be2(t.x||0,t.y||0)+(t.angle?" "+He2(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n;}(e)),t("d",e.path);},bound:function(t,e){return un4(ue3(t,e.angle),e)?t.set(0,0,0,0):Gt1(t,e,!0);},draw:Oe2(un4),pick:Ve1(un4),isect:me3(un4)};function fn4(t,e){t.beginPath(),qt4(t,e);}var pn3={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",qt4(null,e));},bound:function(t,e){var n,i;return Gt1(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e);},draw:Oe2(fn4),pick:Ve1(fn4),isect:xe2};function gn3(t,e,n){var i,r,s,o;return!(!e.stroke||!Pe2(t,e,n))&&(i=e.x||0,r=e.y||0,s=null!=e.x2?e.x2:i,o=null!=e.y2?e.y2:r,t.beginPath(),t.moveTo(i,r),t.lineTo(s,o),!0);}var vn3={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",We1(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0);},bound:function(t,e){var n,i;return Gt1(t.set(n=e.x||0,i=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:i),e);},draw:function(t,e,n){Se2(e,e=>{if(!n||n.intersects(e.bounds)){var i=null==e.opacity?1:e.opacity;i&&gn3(t,e,i)&&(we2(t,e),t.stroke());}});},pick:qe2(function(t,e,n,i){return!!t.isPointInStroke&&gn3(t,e,1)&&t.isPointInStroke(n,i);}),isect:ke2},yn3=je2("shape",function(t,e){return(e.mark.shape||e.shape).context(t)(e);}),mn3=je2("symbol",function(t,e){return Ot3.context(t)(e);},_e2);const _n2=On();var xn3={height:zn2,measureWidth:Tn2,estimateWidth:bn3,width:bn3,canvas:kn2};function kn2(t){xn3.width=t&&ve2?Tn2:bn3;}function bn3(t,e){return wn3(Pn1(t,e),zn2(t));}function wn3(t,e){return~~(.8*t.length*e);}function Tn2(t,e){return zn2(t)<=0||!(e=Pn1(t,e))?0:Mn3(e,En2(t));}function Mn3(t,e){const n=`(${e}) ${t}`;let i=_n2.get(n);return void 0===i&&(ve2.font=e,i=ve2.measureText(t).width,_n2.set(n,i)),i;}function zn2(t){return null!=t.fontSize?+t.fontSize||0:11;}function Rn2(t){return null!=t.lineHeight?t.lineHeight:zn2(t)+2;}function An2(t){return e=t.lineBreak&&t.text&&!w(t.text)?t.text.split(t.lineBreak):t.text,w(e)?e.length>1?e:e[0]:e;var e;}function Cn2(t){const e=An2(t);return(w(e)?e.length-1:0)*Rn2(t);}function Pn1(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,i=function(t){if(xn3.width===Tn2){const e=En2(t);return t=>Mn3(t,e);}if(xn3.width===bn3){const e=zn2(t);return t=>wn3(t,e);}return e=>xn3.width(t,e);}(t);if(i(e)<n)return e;var r,s=t.ellipsis||"â€¦",o="rtl"===t.dir,a=0,l=e.length;if(n-=i(s),o){for(;a<l;)r=a+l>>>1,i(e.slice(r))>n?a=r+1:l=r;return s+e.slice(a);}for(;a<l;)r=1+(a+l>>>1),i(e.slice(0,r))<n?a=r:l=r-1;return e.slice(0,a)+s;}(t,n):n;}function Ln2(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif";}function En2(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+zn2(t)+"px "+Ln2(t,e);}function Sn3(t){var e=t.baseline,n=zn2(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Rn2(t):"line-bottom"===e?.29*n-.5*Rn2(t):0);}kn2(!0);const Nn2={left:"start",center:"middle",right:"end"},On2=new Bt3;function Dn3(t){var e,n=t.x||0,i=t.y||0,r=t.radius||0;return r&&(e=(t.theta||0)-nt6,n+=r*Math.cos(e),i+=r*Math.sin(e)),On2.x1=n,On2.y1=i,On2;}function In2(t,e,n){var i,s=xn3.height(e),o=e.align,a=Dn3(e),l=a.x1,c=a.y1,h=e.dx||0,u=(e.dy||0)+Sn3(e)-Math.round(.8*s),d=An2(e);if(w(d)?(s+=Rn2(e)*(d.length-1),i=d.reduce((t,n)=>Math.max(t,xn3.width(e,n)),0)):i=xn3.width(e,d),"center"===o?h-=i/2:"right"===o&&(h-=i),t.set(h+=l,u+=c,h+i,u+s),e.angle&&!n)t.rotate(e.angle*et5,l,c);else if(2===n)return t.rotatedPoints(e.angle*et5,l,c);return t;}var qn1={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,i=e.dx||0,r=(e.dy||0)+Sn3(e),s=Dn3(e),o=s.x1,a=s.y1,l=e.angle||0;t("text-anchor",Nn2[e.align]||"start"),l?(n=Be2(o,a)+" "+He2(l),(i||r)&&(n+=" "+Be2(i,r))):n=Be2(o+i,a+r),t("transform",n);},bound:In2,draw:function(t,e,n){Se2(e,e=>{var i,s,o,a,l,c,h,u=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===u||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=En2(e),t.textAlign=e.align||"left",s=(i=Dn3(e)).x1,o=i.y1,e.angle&&(t.save(),t.translate(s,o),t.rotate(e.angle*et5),s=o=0),s+=e.dx||0,o+=(e.dy||0)+Sn3(e),c=An2(e),we2(t,e),w(c))for(l=Rn2(e),a=0;a<c.length;++a)h=Pn1(e,c[a]),e.fill&&Ae2(t,e,u)&&t.fillText(h,s,o),e.stroke&&Pe2(t,e,u)&&t.strokeText(h,s,o),o+=l;else h=Pn1(e,c),e.fill&&Ae2(t,e,u)&&t.fillText(h,s,o),e.stroke&&Pe2(t,e,u)&&t.strokeText(h,s,o);e.angle&&t.restore();}});},pick:qe2(function(t,e,n,i,r,s){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=Dn3(e),a=o.x1,l=o.y1,c=In2(On2,e,1),h=-e.angle*et5,u=Math.cos(h),d=Math.sin(h),f=u*r-d*s+(a-u*a+d*l),p=d*r+u*s+(l-d*a-u*l);return c.contains(f,p);}),isect:function(t,e){const n=In2(On2,t,2);return be2(e,n[0],n[1],n[2],n[3])||be2(e,n[0],n[1],n[4],n[5])||be2(e,n[4],n[5],n[6],n[7])||be2(e,n[2],n[3],n[6],n[7]);}},$n=Xe2("trail",function(t,e){return Dt4.context(t)(e);},function(t,e){for(var n,i,r=t.length;--r>=0;)if(!1!==t[r].defined&&(n=t[r].x-e[0])*n+(i=t[r].y-e[1])*i<(n=t[r].size||1)*n)return t[r];return null;}),Vn2={arc:Ue3,area:Ge2,group:en4,image:cn4,line:hn4,path:dn3,rect:pn3,rule:vn3,shape:yn3,symbol:mn3,text:qn1,trail:$n};function Bn1(t,e,n){var i=Vn2[t.mark.marktype],r=e||i.bound;return i.nested&&(t=t.mark),r(t.bounds||(t.bounds=new Bt3),t,n);}var Hn2={mark:null};function Wn1(t,e,n){var i,r,s,o,a=Vn2[t.marktype],l=a.bound,c=t.items,h=c&&c.length;if(a.nested)return h?s=c[0]:(Hn2.mark=t,s=Hn2),o=Bn1(s,l,n),e=e&&e.union(o)||o;if(e=e||t.bounds&&t.bounds.clear()||new Bt3,h)for(i=0,r=c.length;i<r;++i)e.union(Bn1(c[i],l,n));return t.bounds=e;}const jn3=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Un2(t,e){return JSON.stringify(t,jn3,e);}function Xn(t){return Gn1("string"==typeof t?JSON.parse(t):t);}function Gn1(t){var e,n,i,r=t.marktype,s=t.items;if(s)for(n=0,i=s.length;n<i;++n)e=r?"mark":"group",s[n][e]=t,s[n].zindex&&(s[n][e].zdirty=!0),"group"===(r||e)&&Gn1(s[n]);return r&&Wn1(t),t;}class Yn1{constructor(t){arguments.length?this.root=Xn(t):(this.root=Jn1({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Wt2(this.root)]);}toJSON(t){return Un2(this.root,t||0);}mark(t,e,n){const i=Jn1(t,e=e||this.root.items[0]);return e.items[n]=i,i.zindex&&(i.group.zdirty=!0),i;}}function Jn1(t,e){const n={bounds:new Bt3,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n;}function Fn2(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null;}function Qn1(t,e){e=e.toLowerCase();for(var n=t.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===e)return n[i];}function Zn1(t,e,n,i){var r,s=t.childNodes[e];return s&&s.tagName.toLowerCase()===n.toLowerCase()||(r=s||null,s=Fn2(t.ownerDocument,n,i),t.insertBefore(s,r)),s;}function Kn1(t,e){for(var n=t.childNodes,i=n.length;i>e;)t.removeChild(n[--i]);return t;}function ti(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"");}function ei(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)];}class ni{constructor(t,e){this._active=null,this._handlers={},this._loader=t||zt(),this._tooltip=e||ii;}initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e);}element(){return this._el;}canvas(){return this._el&&this._el.firstChild;}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice();}scene(t){return arguments.length?(this._scene=t,this):this._scene;}on(){}off(){}_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;)if(t[i].type===e&&(!n||t[i].handler===n))return i;return-1;}handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n;}eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e);}handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),i=Fn2(null,"a");for(const t in e)i.setAttribute(t,e[t]);i.dispatchEvent(n);}).catch(()=>{});}handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,i){var r,s,o=t&&t.mark;if(o&&(r=Vn2[o.marktype]).tip){for((s=ei(e,n))[0]-=i[0],s[1]-=i[1];t=t.mark.group;)s[0]-=t.x||0,s[1]-=t.y||0;t=r.tip(o.items,s);}return t;}(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i);}}getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,r=t.bounds,s=r.width(),o=r.height();let a=r.x1+i[0]+n.left,l=r.y1+i[1]+n.top;for(;t.mark&&(t=t.mark.group);)a+=t.x||0,l+=t.y||0;return{x:a,y:l,width:s,height:o,left:a,top:l,right:a+s,bottom:l+o};}}function ii(t,e,n,i){t.element().setAttribute("title",i||"");}class ri{constructor(t){this._el=null,this._bgcolor=null,this._loader=new jt4(t);}initialize(t,e,n,i,r){return this._el=t,this.resize(e,n,i,r);}element(){return this._el;}canvas(){return this._el&&this._el.firstChild;}background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this);}resize(t,e,n,i){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=i||1,this;}dirty(){}render(t,e){const n=this;return n._call=function(){n._render(t,e);},n._call(),n._call=null,n;}_render(){}renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then(()=>n):Promise.resolve(n);}_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then(e=>{e&&t(),n._ready=null;});}return i;}sanitizeURL(t){return this._load("sanitizeURL",t);}loadImage(t){return this._load("loadImage",t);}}const si="dragenter",oi="dragleave",ai="dragover",li="pointerdown",ci="pointermove",hi="pointerout",ui="pointerover",di="mousedown",fi="mousemove",pi="mouseout",gi="mouseover",vi="click",yi="mousewheel",mi="touchstart",_i="touchmove",xi="touchend",ki=["keydown","keypress","keyup",si,oi,ai,li,"pointerup",ci,hi,ui,di,"mouseup",fi,pi,gi,vi,"dblclick","wheel",yi,mi,_i,xi],bi=ci,wi=pi,Ti=vi;class Mi extends ni{constructor(t,e){super(t,e),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=ki,this.pointermove=Ci([ci,fi],[ui,gi],[hi,pi]),this.dragover=Ci([ai],[si],[oi]),this.pointerout=Pi([hi,pi]),this.dragleave=Pi([oi]);}initialize(t,e,n){return this._canvas=t&&Qn1(t,"canvas"),[vi,di,li,ci,hi,oi].forEach(t=>Ri(this,t)),super.initialize(t,e,n);}canvas(){return this._canvas;}context(){return this._canvas.getContext("2d");}DOMMouseScroll(t){this.fire(yi,t);}pointerdown(t){this._down=this._active,this.fire(li,t);}mousedown(t){this._down=this._active,this.fire(di,t);}click(t){this._down===this._active&&(this.fire(vi,t),this._down=null);}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(mi,t,!0);}touchmove(t){this.fire(_i,t,!0);}touchend(t){this.fire(xi,t,!0),this._touch=null;}fire(t,e,n){const i=n?this._touch:this._active,r=this._handlers[t];if(e.vegaType=t,t===Ti&&i&&i.href?this.handleHref(e,i,i.href):t!==bi&&t!==wi||this.handleTooltip(e,i,t!==wi),r)for(let t=0,n=r.length;t<n;++t)r[t].handler.call(this._obj,e,i);}on(t,e){const n=this.eventName(t),i=this._handlers;return this._handlerIndex(i[n],t,e)<0&&(Ri(this,t),(i[n]||(i[n]=[])).push({type:t,handler:e})),this;}off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&i.splice(r,1),this;}pickEvent(t){const e=ei(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1]);}pick(t,e,n,i,r){const s=this.context();return Vn2[t.marktype].pick.call(this,s,t,e,n,i,r);}}const zi=t=>t===mi||t===_i||t===xi?[mi,_i,xi]:[t];function Ri(t,e){zi(e).forEach(e=>(function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)));})(t,e));}function Ai(t,e,n){e.forEach(e=>t.fire(e,n));}function Ci(t,e,n){return function(i){const r=this._active,s=this.pickEvent(i);s===r||(r&&r.exit||Ai(this,n,i),this._active=s,Ai(this,e,i)),Ai(this,t,i);};}function Pi(t){return function(e){Ai(this,t,e),this._active=null;};}function Li(t,e,n,i,r,s){const o="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,a=t.getContext("2d"),l=o?"undefined"!=typeof window&&window.devicePixelRatio||1:r;t.width=e*l,t.height=n*l;for(const t in s)a[t]=s[t];return o&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*i[0],l*i[1]),t;}class Ei extends ri{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new Bt3,this._tempb=new Bt3;}initialize(t,e,n,i,r,s){return this._options=s||{},this._canvas=this._options.externalContext?null:e8(1,1,this._options.type),t&&this._canvas&&(Kn1(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,e,n,i,r);}resize(t,e,n,i){if(super.resize(t,e,n,i),this._canvas)Li(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||l("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1]);}return this._redraw=!0,this;}canvas(){return this._canvas;}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null);}dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e);}_render(t,e){const n=this.context(),i=this._origin,r=this._width,s=this._height,o=this._dirty,a=Si(i,r,s);n.save();const l=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio);return e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e;}(n,a.intersect(o),i);return this.clear(-i[0],-i[1],r,s),this.draw(n,t,l,e),n.restore(),o.clear(),this;}draw(t,e,n,i){if("group"!==e.marktype&&null!=i&&!i.includes(e.marktype))return;const r=Vn2[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),L(n)?(t.beginPath(),n(t),t.clip()):Ye2(t,e.group);}(t,e),r.draw.call(this,t,e,n,i),e.clip&&t.restore();}clear(t,e,n,i){const r=this._options,s=this.context();"pdf"===r.type||r.externalContext||s.clearRect(t,e,n,i),null!=this._bgcolor&&(s.fillStyle=this._bgcolor,s.fillRect(t,e,n,i));}}const Si=(t,e,n)=>(new Bt3).set(0,0,e,n).translate(-t[0],-t[1]);class Ni extends ni{constructor(t,e){super(t,e);const n=this;n._hrefHandler=Oi(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href);}),n._tooltipHandler=Oi(n,(t,e)=>{n.handleTooltip(t,e,t.type!==wi);});}initialize(t,e,n){let i=this._svg;return i&&(i.removeEventListener(Ti,this._hrefHandler),i.removeEventListener(bi,this._tooltipHandler),i.removeEventListener(wi,this._tooltipHandler)),this._svg=i=t&&Qn1(t,"svg"),i&&(i.addEventListener(Ti,this._hrefHandler),i.addEventListener(bi,this._tooltipHandler),i.addEventListener(wi,this._tooltipHandler)),super.initialize(t,e,n);}canvas(){return this._svg;}on(t,e){const n=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[n],t,e)<0){const r={type:t,handler:e,listener:Oi(this,e)};(i[n]||(i[n]=[])).push(r),this._svg&&this._svg.addEventListener(n,r.listener);}return this;}off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this;}}const Oi=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,e.call(t._obj,n,i);},Di="aria-hidden",Ii="aria-label",qi="role",$i="aria-roledescription",Vi="graphics-object",Bi="graphics-symbol",Hi=(t,e,n)=>({[qi]:t,[$i]:e,[Ii]:n||void 0}),Wi=Sn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),ji={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,i=e.title?Ji(t):null,r=t.context,s=r.scales[e.scale].value,o=r.dataflow.locale(),a=s.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(i?` titled '${i}'`:"")+` for a ${le2(a)?"discrete":a} scale`+` with ${Je1(o,s,t)}`;}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?Ji(t):null,i=`${e.type||""} legend`.trim(),r=e.scales,s=Object.keys(r),o=t.context,a=o.scales[r[s[0]]].value,l=o.dataflow.locale();return c=i,(c.length?c[0].toUpperCase()+c.slice(1):c)+(n?` titled '${n}'`:"")+` for ${function(t){return t=t.map(t=>t+("fill"===t||"stroke"===t?" color":"")),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+D(t);}(s)}`+` with ${Je1(l,a,t)}`;var c;}},"title-text":{desc:"title",caption:t=>`Title text '${Yi(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${Yi(t)}'`}},Ui={ariaRole:qi,ariaRoleDescription:$i,description:Ii};function Xi(t,e){const n=!1===e.aria;if(t(Di,n||void 0),n||null==e.description)for(const e in Ui)t(Ui[e],void 0);else{const n=e.mark.marktype;t(Ii,e.description),t(qi,e.ariaRole||("group"===n?Vi:Bi)),t($i,e.ariaRoleDescription||`${n} mark`);}}function Gi(t){return!1===t.aria?{[Di]:!0}:Wi[t.role]?null:ji[t.role]?function(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return Hi(e.role||Bi,e.desc,n.description||i(n));}catch(t){return null;}}(t,ji[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return Hi(n?Vi:Bi,`${e} mark container`,t.description);}(t);}function Yi(t){return H(t.text).join(" ");}function Ji(t){try{return H(D(t.items).items[0].text).join(" ");}catch(t){return null;}}const Fi=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function Qi(){let t="",e="",n="";const i=[],r=()=>e=n="",s=(t,n)=>{var i;return null!=n&&(e+=` ${t}="${i=n,Fi(i).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),o;},o={open(a){(s=>{e&&(t+=`${e}>${n}`,r()),i.push(s);})(a),e="<"+a;for(var l=arguments.length,c=new Array(l>1?l-1:0),h=1;h<l;h++)c[h-1]=arguments[h];for(const t of c)for(const e in t)s(e,t[e]);return o;},close(){const s=i.pop();return t+=e?e+(n?`>${n}</${s}>`:"/>"):`</${s}>`,r(),o;},attr:s,text:t=>(n+=Fi(t),o),toString:()=>t};return o;}const Zi=t=>Ki(Qi(),t)+"";function Ki(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,i=n.length;for(let e=0;e<i;++e)t.attr(n[e].name,n[e].value);}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):Ki(t,e);}return t.close();}const tr={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},er={blend:"mix-blend-mode"},nr={fill:"none","stroke-miterlimit":10},ir="http://www.w3.org/2000/xmlns/",rr=nn4.xmlns;class sr extends ri{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null;}initialize(t,e,n,i,r){return this._defs={},this._clearDefs(),t&&(this._svg=Zn1(t,0,"svg",rr),this._svg.setAttributeNS(ir,"xmlns",rr),this._svg.setAttributeNS(ir,"xmlns:xlink",nn4["xmlns:xlink"]),this._svg.setAttribute("version",nn4.version),this._svg.setAttribute("class","marks"),Kn1(t,1),this._root=Zn1(this._svg,0,"g",rr),gr(this._root,nr),Kn1(this._svg,1)),this.background(this._bgcolor),super.initialize(t,e,n,i,r);}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments);}resize(t,e,n,i){return super.resize(t,e,n,i),this._svg&&(gr(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this;}canvas(){return this._svg;}svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=Zn1(t,0,"rect",rr),gr(n,{width:this._width,height:this._height,fill:e}));const i=Zi(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),i;}_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),Kn1(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this;}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t));}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID;}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,i,r,s,o,a,l;for(o=0,a=t.length;o<a;++o)n=t[o],i=n.mark,i.marktype!==r&&(r=i.marktype,s=Vn2[r]),i.zdirty&&i.dirty!==e&&(this._dirtyAll=!1,or(n,e),i.items.forEach(t=>{t.dirty=e;})),i.zdirty||(n.exit?(s.nested&&i.items.length?(l=i.items[0],l._svg&&this._update(s,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=s.nested?i.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(s,n._svg,n):(this._dirtyAll=!1,or(n,e)),n._update=e)));return!this._dirtyAll;}mark(t,e,n,i){if(!this.isDirty(e))return e._svg;const r=this._svg,s=e.marktype,o=Vn2[s],a=!1===e.interactive?"none":null,l="g"===o.tag,c=cr(e,t,n,"g",r);if("group"!==s&&null!=i&&!i.includes(s))return Kn1(c,0),e._svg;c.setAttribute("class",ti(e));const h=Gi(e);for(const t in h)vr(c,t,h[t]);l||vr(c,"pointer-events",a),vr(c,"clip-path",e.clip?Vt1(this,e,e.group):null);let u=null,d=0;const f=t=>{const e=this.isDirty(t),n=cr(t,c,u,o.tag,r);e&&(this._update(o,n,t),l&&function(t,e,n,i){e=e.lastChild.previousSibling;let r,s=0;Se2(n,n=>{r=t.mark(e,n,r,i),++s;}),Kn1(e,1+s);}(this,n,t,i)),u=n,++d;};return o.nested?e.items.length&&f(e.items[0]):Se2(e,f),Kn1(c,d),c;}_update(t,e,n){hr=e,ur=e.__values__,Xi(fr,n),t.attr(fr,n,this);const i=dr[t.type];i&&i.call(this,t,e,n),hr&&this.style(hr,n);}style(t,e){if(null!=e){for(const n in tr){let i="font"===n?Ln2(e):e[n];if(i===ur[n])continue;const r=tr[n];null==i?t.removeAttribute(r):(W13(i)&&(i=j11(i,this._defs.gradient,yr())),t.setAttribute(r,i+"")),ur[n]=i;}for(const n in er)pr(t,er[n],e[n]);}}defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const r in e.gradient)n||(e.el=n=Zn1(t,1,"defs",rr)),i=ar(n,e.gradient[r],i);for(const r in e.clipping)n||(e.el=n=Zn1(t,1,"defs",rr)),i=lr(n,e.clipping[r],i);n&&(0===i?(t.removeChild(n),e.el=null):Kn1(n,i));}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={};}}function or(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e;}}function ar(t,e,n){let i,r,s;if("radial"===e.gradient){let i=Zn1(t,n++,"pattern",rr);gr(i,{id:H12+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),i=Zn1(i,0,"rect",rr),gr(i,{width:1,height:1,fill:`url(${yr()}#${e.id})`}),gr(t=Zn1(t,n++,"radialGradient",rr),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2});}else gr(t=Zn1(t,n++,"linearGradient",rr),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(i=0,r=e.stops.length;i<r;++i)s=Zn1(t,i,"stop",rr),s.setAttribute("offset",e.stops[i].offset),s.setAttribute("stop-color",e.stops[i].color);return Kn1(t,i),n;}function lr(t,e,n){let i;return(t=Zn1(t,n,"clipPath",rr)).setAttribute("id",e.id),e.path?(i=Zn1(t,0,"path",rr),i.setAttribute("d",e.path)):(i=Zn1(t,0,"rect",rr),gr(i,{x:0,y:0,width:e.width,height:e.height})),Kn1(t,1),n+1;}function cr(t,e,n,i,r){let s,o=t._svg;if(!o&&(s=e.ownerDocument,o=Fn2(s,i,rr),t._svg=o,t.mark&&(o.__data__=t,o.__values__={fill:"default"},"g"===i))){const e=Fn2(s,"path",rr);o.appendChild(e),e.__data__=t;const n=Fn2(s,"g",rr);o.appendChild(n),n.__data__=t;const i=Fn2(s,"path",rr);o.appendChild(i),i.__data__=t,i.__values__={fill:"default"};}return(o.ownerSVGElement!==r||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e;}(o,n))&&e.insertBefore(o,n?n.nextSibling:e.firstChild),o;}let hr=null,ur=null;const dr={group(t,e,n){const i=hr=e.childNodes[2];ur=i.__values__,t.foreground(fr,n,this),ur=e.__values__,hr=e.childNodes[1],t.content(fr,n,this);const r=hr=e.childNodes[0];t.background(fr,n,this);const s=!1===n.mark.interactive?"none":null;if(s!==ur.events&&(vr(i,"pointer-events",s),vr(r,"pointer-events",s),ur.events=s),n.strokeForeground&&n.stroke){const t=n.fill;vr(i,"display",null),this.style(r,n),vr(r,"stroke",null),t&&(n.fill=null),ur=i.__values__,this.style(i,n),t&&(n.fill=t),hr=null;}else vr(i,"display","none");},image(t,e,n){!1===n.smooth?(pr(e,"image-rendering","optimizeSpeed"),pr(e,"image-rendering","pixelated")):pr(e,"image-rendering",null);},text(t,e,n){const i=An2(n);let s,o,a,l;w(i)?(o=i.map(t=>Pn1(n,t)),s=o.join("\n"),s!==ur.text&&(Kn1(e,0),a=e.ownerDocument,l=Rn2(n),o.forEach((t,i)=>{const r=Fn2(a,"tspan",rr);r.__data__=n,r.textContent=t,i&&(r.setAttribute("x",0),r.setAttribute("dy",l)),e.appendChild(r);}),ur.text=s)):(o=Pn1(n,i),o!==ur.text&&(e.textContent=o,ur.text=o)),vr(e,"font-family",Ln2(n)),vr(e,"font-size",zn2(n)+"px"),vr(e,"font-style",n.fontStyle),vr(e,"font-variant",n.fontVariant),vr(e,"font-weight",n.fontWeight);}};function fr(t,e,n){e!==ur[t]&&(n?function(t,e,n,i){null!=n?t.setAttributeNS(i,e,n):t.removeAttributeNS(i,e);}(hr,t,e,n):vr(hr,t,e),ur[t]=e);}function pr(t,e,n){n!==ur[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),ur[e]=n);}function gr(t,e){for(const n in e)vr(t,n,e[n]);}function vr(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e);}function yr(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href;}class mr extends ri{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}};}svg(){return this._text;}_render(t){const e=Qi();e.open("svg",rn({},nn4,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",nr,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this;}mark(t,e){const n=Vn2[e.marktype],i=n.tag,s=[Xi,n.attr];t.open("g",{class:ti(e),"clip-path":e.clip?Vt1(this,e,e.group):null},Gi(e),{"pointer-events":"g"!==i&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(i,this.attr(e,o,s,"g"!==i?i:null)),"text"===i){const e=An2(o);if(w(e)){const n={x:0,dy:Rn2(o)};for(let i=0;i<e.length;++i)t.open("tspan",i?n:null).text(Pn1(o,e[i])).close();}else t.text(Pn1(o,e));}else if("g"===i){const i=o.strokeForeground,r=o.fill,s=o.stroke;i&&s&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Se2(o,e=>this.mark(t,e)),t.close(),i&&s?(r&&(o.fill=null),o.stroke=s,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),r&&(o.fill=r)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close();}t.close(),a&&t.close();};return n.nested?e.items&&e.items.length&&o(e.items[0]):Se2(e,o),t.close();}href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t;});}return null;}attr(t,e,n,i){const r={},s=(t,e,n,i)=>{r[i||t]=e;};return Array.isArray(n)?n.forEach(t=>t(s,e,this)):n(s,e,this),i&&function(t,e,n,i,r){let s;if(null==e)return t;"bgrect"===i&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===i&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===i&&!1===e.smooth&&(s=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===i&&(t["font-family"]=Ln2(e),t["font-size"]=zn2(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in tr){let i=e[n];const s=tr[n];("transparent"!==i||"fill"!==s&&"stroke"!==s)&&null!=i&&(W13(i)&&(i=j11(i,r.gradient,"")),t[s]=i);}for(const t in er){const n=e[t];null!=n&&(s=s||[],s.push(`${er[t]}: ${n};`));}s&&(t.style=s.join(" "));}(r,e,t,i,this._defs),r;}defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const i=e[n],r=i.stops;"radial"===i.gradient?(t.open("pattern",{id:H12+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:i.x1,fy:i.y1,fr:i.r1,cx:i.x2,cy:i.y2,r:i.r2})):t.open("linearGradient",{id:n,x1:i.x1,x2:i.x2,y1:i.y1,y2:i.y2});for(let e=0;e<r.length;++e)t.open("stop",{offset:r[e].offset,"stop-color":r[e].color}).close();t.close();}for(const e in n){const i=n[e];t.open("clipPath",{id:e}),i.path?t.open("path",{d:i.path}).close():t.open("rect",{x:0,y:0,width:i.width,height:i.height}).close(),t.close();}t.close();}}}const _r={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function xr(t){_r.svgMarkTypes=t.svgMarkTypes??["text"],_r.svgOnTop=t.svgOnTop??!0,_r.debug=t.debug??!1;}class kr extends ri{constructor(t){super(t),this._svgRenderer=new sr(t),this._canvasRenderer=new Ei(t);}initialize(t,e,n,i,r){this._root_el=Zn1(t,0,"div");const s=Zn1(this._root_el,0,"div"),o=Zn1(this._root_el,1,"div");return this._root_el.style.position="relative",_r.debug||(s.style.height="100%",o.style.position="absolute",o.style.top="0",o.style.left="0",o.style.height="100%",o.style.width="100%"),this._svgEl=_r.svgOnTop?o:s,this._canvasEl=_r.svgOnTop?s:o,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,i,r),this._svgRenderer.initialize(this._svgEl,e,n,i,r),super.initialize(t,e,n,i,r);}dirty(t){return _r.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this;}_render(t,e){const n=(e??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter(t=>!_r.svgMarkTypes.includes(t));this._svgRenderer.render(t,_r.svgMarkTypes),this._canvasRenderer.render(t,n);}resize(t,e,n,i){return super.resize(t,e,n,i),this._svgRenderer.resize(t,e,n,i),this._canvasRenderer.resize(t,e,n,i),this;}background(t){return _r.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this;}}class br extends Mi{constructor(t,e){super(t,e);}initialize(t,e,n){const i=Zn1(Zn1(t,0,"div"),_r.svgOnTop?0:1,"div");return super.initialize(i,e,n);}}const wr="canvas",Tr="hybrid",Mr="none",zr={Canvas:wr,PNG:"png",SVG:"svg",Hybrid:Tr,None:Mr},Rr={};function Ar(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Rr[t]=e,this):Rr[t];}function Cr(t,e,n){const i=[],r=(new Bt3).union(e),o=t.marktype;return o?Pr(t,r,n,i):"group"===o?Lr(t,r,n,i):l("Intersect scene must be mark node or group item.");}function Pr(t,e,n,i){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)));}(t,e,n)){const r=t.items,s=t.marktype,o=r.length;let a=0;if("group"===s)for(;a<o;++a)Lr(r[a],e,n,i);else for(const t=Vn2[s].isect;a<o;++a){const n=r[a];Er(n,e,t)&&i.push(n);}}return i;}function Lr(t,e,n,i){n&&n(t.mark)&&Er(t,e,Vn2.group.isect)&&i.push(t);const r=t.items,s=r&&r.length;if(s){const o=t.x||0,a=t.y||0;e.translate(-o,-a);for(let t=0;t<s;++t)Pr(r[t],e,n,i);e.translate(o,a);}return i;}function Er(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e);}Rr[wr]=Rr.png={renderer:Ei,headless:Ei,handler:Mi},Rr.svg={renderer:sr,headless:mr,handler:Ni},Rr[Tr]={renderer:kr,headless:kr,handler:br},Rr[Mr]={};const Sr=new Bt3;function Nr(t){const e=t.clip;if(L(e))e(ue3(Sr.clear()));else{if(!e)return;Sr.set(0,0,t.group.width,t.group.height);}t.bounds.intersect(Sr);}function Or(t,e,n){return t===e||("path"===n?Dr(t,e):t instanceof Date&&e instanceof Date?+t==+e:yn(t)&&yn(e)?Math.abs(t-e)<=1e-9:t&&e&&(E(t)||E(e))?function(t,e){var n,i,r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(r.sort(),s.sort(),i=r.length-1;i>=0;i--)if(r[i]!=s[i])return!1;for(i=r.length-1;i>=0;i--)if(!Or(t[n=r[i]],e[n],n))return!1;return typeof t==typeof e;}(t,e):t==e);}function Dr(t,e){return Or(tt6(t),tt6(e));}function Ir(){$t2=1,B12=0;}const d9="top",h11="left",f8="right",m11="bottom",y8="start",b10="middle",x11="end",g10="group",p11="axis",w10="title",k11="frame",M11="scope",v11="legend",E14="row-header",z14="row-footer",A14="row-title",_11="column-header",D11="column-footer",B13="column-title",O11="padding",T11="fit",S12="fit-x",j12="fit-y",q11="none",F12="all",H13="each",L11="flush",P11="column",R12="row";function C13(e){st2.call(this,null,e);}function G13(t,e,n){return e(t.bounds.clear(),t,n);}an(C13,st2,{transform(t,o){const a=o.dataflow,r=t.mark,i=r.marktype,s=Vn2[i],c=s.bound;let u,l=r.bounds;if(s.nested)r.items.length&&a.dirty(r.items[0]),l=G13(r,c),r.items.forEach(t=>{t.bounds.clear().union(l);});else if(i===g10||t.modified())switch(o.visit(o.MOD,t=>a.dirty(t)),l.clear(),r.items.forEach(t=>l.union(G13(t,c))),r.role){case p11:case v11:case w10:o.reflow();}else u=o.changed(o.REM),o.visit(o.ADD,t=>{l.union(G13(t,c));}),o.visit(o.MOD,t=>{u=u||l.alignsWith(t.bounds),a.dirty(t),l.union(G13(t,c));}),u&&(l.clear(),r.items.forEach(t=>l.union(t.bounds)));return Nr(r),o.modifies("bounds");}});const I11=":vega_identifier:";function U11(e){st2.call(this,0,e);}function V12(e){st2.call(this,null,e);}function W14(e){st2.call(this,null,e);}U11.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},an(U11,st2,{transform(t,e){const n=(a=e.dataflow)._signals[I11]||(a._signals[I11]=a.add(0)),o=t.as;var a;let r=n.value;return e.visit(e.ADD,t=>t[o]=t[o]||++r),n.set(this.value=r),e;}}),an(V12,st2,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null;}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===g10?Wt2:Ht2;return e.visit(e.ADD,t=>r.call(t,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e;}});const J15={parity:t=>t.filter((t,e)=>e%2?t.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((t,o)=>o&&K15(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1));}},K15=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),N13=(t,e)=>{for(var n,o=1,a=t.length,r=t[0].bounds;o<a;r=n,++o)if(K15(r,n=t[o].bounds,e))return!0;},Q11=t=>{const e=t.bounds;return e.width()>1&&e.height()>1;},X15=t=>(t.forEach(t=>t.opacity=1),t),Y14=(t,e)=>t.reflow(e.modified()).modifies("opacity");function Z15(e){st2.call(this,null,e);}an(W14,st2,{transform(t,e){const n=J15[t.method]||J15.parity,o=t.separation||0;let a,i,s=e.materialize(e.SOURCE).source;if(!s||!s.length)return;if(!t.method)return t.modified("method")&&(X15(s),e=Y14(e,t)),e;if(s=s.filter(Q11),!s.length)return;if(t.sort&&(s=s.slice().sort(t.sort)),a=X15(s),e=Y14(e,t),a.length>=3&&N13(a,o)){do{a=n(a,o);}while(a.length>=3&&N13(a,o))a.length<3&&!D(s).opacity&&(a.length>1&&(D(a).opacity=0),D(s).opacity=1);}var c,l,h,f,y;t.boundScale&&t.boundTolerance>=0&&(c=t.boundScale,l=t.boundOrient,h=+t.boundTolerance,f=c.range(),y=new Bt3,l===d9||l===m11?y.set(f[0],-1/0,f[1],1/0):y.set(-1/0,f[0],1/0,f[1]),y.expand(h||1),i=t=>y.encloses(t.bounds),s.forEach(t=>{i(t)||(t.opacity=0);}));const b=a[0].mark.bounds.clear();return s.forEach(t=>{t.opacity&&b.union(t.bounds);}),e;}}),an(Z15,st2,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,t=>n.dirty(t)),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0);}}});const $12=new Bt3;function tt7(t,e,n){return t[e]===n?0:(t[e]=n,1);}function et6(t){var e=t.items[0].orient;return e===h11||e===f8;}function nt7(t,e,n,o){var a,r,c=e.items[0],u=c.datum,l=null!=c.translate?c.translate:.5,y=c.orient,b=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain];}(u),x=c.range,g=c.offset,p=c.position,w=c.minExtent,k=c.maxExtent,M=u.title&&c.items[b[2]].items[0],v=c.titlePadding,E=c.bounds,z=M&&Cn2(M),A=0,_=0;switch($12.clear().union(E),E.clear(),(a=b[0])>-1&&E.union(c.items[a].bounds),(a=b[1])>-1&&E.union(c.items[a].bounds),y){case d9:A=p||0,_=-g,r=Math.max(w,Math.min(k,-E.y1)),E.add(0,-r).add(x,0),M&&ot6(t,M,r,v,z,0,-1,E);break;case h11:A=-g,_=p||0,r=Math.max(w,Math.min(k,-E.x1)),E.add(-r,0).add(0,x),M&&ot6(t,M,r,v,z,1,-1,E);break;case f8:A=n+g,_=p||0,r=Math.max(w,Math.min(k,E.x2)),E.add(0,0).add(r,x),M&&ot6(t,M,r,v,z,1,1,E);break;case m11:A=p||0,_=o+g,r=Math.max(w,Math.min(k,E.y2)),E.add(0,0).add(x,r),M&&ot6(t,M,r,v,0,0,1,E);break;default:A=c.x,_=c.y;}return Gt1(E.translate(A,_),c),tt7(c,"x",A+l)|tt7(c,"y",_+l)&&(c.bounds=$12,t.dirty(c),c.bounds=E,t.dirty(c)),c.mark.bounds.clear().union(E);}function ot6(t,e,n,o,a,r,i,s){const c=e.bounds;if(e.auto){const s=i*(n+a+o);let u=0,l=0;t.dirty(e),r?u=(e.x||0)-(e.x=s):l=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(c.translate(-u,-l)),t.dirty(e);}s.union(c);}const at7=(t,e)=>Math.floor(Math.min(t,e)),rt7=(t,e)=>Math.ceil(Math.max(t,e));function it6(t){return(new Bt3).set(0,0,t.width||0,t.height||0);}function st6(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0));}function ct6(t,e,n){const o=E(t)?t[e]:t;return null!=o?o:void 0!==n?n:0;}function ut6(t){return t<0?Math.ceil(-t):0;}function lt6(t,e,n){var o,a,r,i,s,c,u,l,d,h,f,m=!n.nodirty,y=n.bounds===L11?it6:st6,g=$12.set(0,0,0,0),p=ct6(n.align,P11),w=ct6(n.align,R12),k=ct6(n.padding,P11),M=ct6(n.padding,R12),v=n.columns||e.length,E=v<=0?1:Math.ceil(e.length/v),z=e.length,A=Array(z),_=Array(v),D=0,B=Array(z),O=Array(E),T=0,S=Array(z),j=Array(z),q=Array(z);for(a=0;a<v;++a)_[a]=0;for(a=0;a<E;++a)O[a]=0;for(a=0;a<z;++a)c=e[a],s=q[a]=y(c),c.x=c.x||0,S[a]=0,c.y=c.y||0,j[a]=0,r=a%v,i=~~(a/v),D=Math.max(D,u=Math.ceil(s.x2)),T=Math.max(T,l=Math.ceil(s.y2)),_[r]=Math.max(_[r],u),O[i]=Math.max(O[i],l),A[a]=k+ut6(s.x1),B[a]=M+ut6(s.y1),m&&t.dirty(e[a]);for(a=0;a<z;++a)a%v==0&&(A[a]=0),a<v&&(B[a]=0);if(p===H13)for(r=1;r<v;++r){for(f=0,a=r;a<z;a+=v)f<A[a]&&(f=A[a]);for(a=r;a<z;a+=v)A[a]=f+_[r-1];}else if(p===F12){for(f=0,a=0;a<z;++a)a%v&&f<A[a]&&(f=A[a]);for(a=0;a<z;++a)a%v&&(A[a]=f+D);}else for(p=!1,r=1;r<v;++r)for(a=r;a<z;a+=v)A[a]+=_[r-1];if(w===H13)for(i=1;i<E;++i){for(f=0,o=(a=i*v)+v;a<o;++a)f<B[a]&&(f=B[a]);for(a=i*v;a<o;++a)B[a]=f+O[i-1];}else if(w===F12){for(f=0,a=v;a<z;++a)f<B[a]&&(f=B[a]);for(a=v;a<z;++a)B[a]=f+T;}else for(w=!1,i=1;i<E;++i)for(o=(a=i*v)+v;a<o;++a)B[a]+=O[i-1];for(d=0,a=0;a<z;++a)d=A[a]+(a%v?d:0),S[a]+=d-e[a].x;for(r=0;r<v;++r)for(h=0,a=r;a<z;a+=v)h+=B[a],j[a]+=h-e[a].y;if(p&&ct6(n.center,P11)&&E>1)for(a=0;a<z;++a)(d=(s=p===F12?D:_[a%v])-q[a].x2-e[a].x-S[a])>0&&(S[a]+=d/2);if(w&&ct6(n.center,R12)&&1!==v)for(a=0;a<z;++a)(h=(s=w===F12?T:O[~~(a/v)])-q[a].y2-e[a].y-j[a])>0&&(j[a]+=h/2);for(a=0;a<z;++a)g.union(q[a].translate(S[a],j[a]));switch(d=ct6(n.anchor,"x"),h=ct6(n.anchor,"y"),ct6(n.anchor,P11)){case x11:d-=g.width();break;case b10:d-=g.width()/2;}switch(ct6(n.anchor,R12)){case x11:h-=g.height();break;case b10:h-=g.height()/2;}for(d=Math.round(d),h=Math.round(h),g.clear(),a=0;a<z;++a)e[a].mark.bounds.clear();for(a=0;a<z;++a)(c=e[a]).x+=S[a]+=d,c.y+=j[a]+=h,g.union(c.mark.bounds.union(c.bounds.translate(S[a],j[a]))),m&&t.dirty(c);return g;}function dt4(t,e,n){var o,a,r,i,s,c,u,l=function(t){var e,n,o=t.items,a=o.length,r=0;const i={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<a;++r)if(n=(e=o[r]).items,e.marktype===g10)switch(e.role){case p11:case v11:case w10:break;case E14:i.rowheaders.push(...n);break;case z14:i.rowfooters.push(...n);break;case _11:i.colheaders.push(...n);break;case D11:i.colfooters.push(...n);break;case A14:i.rowtitle=n[0];break;case B13:i.coltitle=n[0];break;default:i.marks.push(...n);}return i;}(e),d=l.marks,h=n.bounds===L11?ht6:ft5,f=n.offset,m=n.columns||d.length,y=m<=0?1:Math.ceil(d.length/m),b=y*m;const k=lt6(t,d,n);k.empty()&&k.set(0,0,0,0),l.rowheaders&&(c=ct6(n.headerBand,R12,null),o=mt4(t,l.rowheaders,d,m,y,-ct6(f,"rowHeader"),at7,0,h,"x1",0,m,1,c)),l.colheaders&&(c=ct6(n.headerBand,P11,null),a=mt4(t,l.colheaders,d,m,m,-ct6(f,"columnHeader"),at7,1,h,"y1",0,1,m,c)),l.rowfooters&&(c=ct6(n.footerBand,R12,null),r=mt4(t,l.rowfooters,d,m,y,ct6(f,"rowFooter"),rt7,0,h,"x2",m-1,m,1,c)),l.colfooters&&(c=ct6(n.footerBand,P11,null),i=mt4(t,l.colfooters,d,m,m,ct6(f,"columnFooter"),rt7,1,h,"y2",b-m,1,m,c)),l.rowtitle&&(s=ct6(n.titleAnchor,R12),u=ct6(f,"rowTitle"),u=s===x11?r+u:o-u,c=ct6(n.titleBand,R12,.5),yt4(t,l.rowtitle,u,0,k,c)),l.coltitle&&(s=ct6(n.titleAnchor,P11),u=ct6(f,"columnTitle"),u=s===x11?i+u:a-u,c=ct6(n.titleBand,P11,.5),yt4(t,l.coltitle,u,1,k,c));}function ht6(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0;}function ft5(t,e){return t.bounds[e];}function mt4(t,e,n,o,a,r,i,s,c,u,l,d,h,f){var m,y,b,x,g,p,w,k,M,v=n.length,E=0,z=0;if(!v)return E;for(m=l;m<v;m+=d)n[m]&&(E=i(E,c(n[m],u)));if(!e.length)return E;for(e.length>a&&(t.warn("Grid headers exceed limit: "+a),e=e.slice(0,a)),E+=r,y=0,x=e.length;y<x;++y)t.dirty(e[y]),e[y].mark.bounds.clear();for(m=l,y=0,x=e.length;y<x;++y,m+=d){for(g=(p=e[y]).mark.bounds,b=m;b>=0&&null==(w=n[b]);b-=h);s?(k=null==f?w.x:Math.round(w.bounds.x1+f*w.bounds.width()),M=E):(k=E,M=null==f?w.y:Math.round(w.bounds.y1+f*w.bounds.height())),g.union(p.bounds.translate(k-(p.x||0),M-(p.y||0))),p.x=k,p.y=M,t.dirty(p),z=i(z,g[u]);}return z;}function yt4(t,e,n,o,a,r){if(e){t.dirty(e);var i=n,s=n;o?i=Math.round(a.x1+r*a.width()):s=Math.round(a.y1+r*a.height()),e.bounds.translate(i-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=i,e.y=s,t.dirty(e);}}function bt4(t,e,n,o,a,r,i){const s=function(t,e){const n=t[e]||{};return(e,o)=>null!=n[e]?n[e]:null!=t[e]?t[e]:o;}(n,e),c=function(t,e){let n=-1/0;return t.forEach(t=>{null!=t.offset&&(n=Math.max(n,t.offset));}),n>-1/0?n:e;}(t,s("offset",0)),u=s("anchor",y8),l=u===x11?1:u===b10?.5:0,g={align:H13,bounds:s("bounds",L11),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case h11:g.anchor={x:Math.floor(o.x1)-c,column:x11,y:l*(i||o.height()+2*o.y1),row:u};break;case f8:g.anchor={x:Math.ceil(o.x2)+c,y:l*(i||o.height()+2*o.y1),row:u};break;case d9:g.anchor={y:Math.floor(a.y1)-c,row:x11,x:l*(r||a.width()+2*a.x1),column:u};break;case m11:g.anchor={y:Math.ceil(a.y2)+c,x:l*(r||a.width()+2*a.x1),column:u};break;case"top-left":g.anchor={x:c,y:c};break;case"top-right":g.anchor={x:r-c,y:c,column:x11};break;case"bottom-left":g.anchor={x:c,y:i-c,row:x11};break;case"bottom-right":g.anchor={x:r-c,y:i-c,column:x11,row:x11};}return g;}function xt4(t,e){var n,o,a=e.items[0],r=a.datum,i=a.orient,c=a.bounds,u=a.x,l=a.y;return a._bounds?a._bounds.clear().union(c):a._bounds=c.clone(),c.clear(),function(t,e,n){var o=e.padding,a=o-n.x,r=o-n.y;if(e.datum.title){var i=e.items[1].items[0],s=i.anchor,c=e.titlePadding||0,u=o-i.x,l=o-i.y;switch(i.orient){case h11:a+=Math.ceil(i.bounds.width())+c;break;case f8:case m11:break;default:r+=i.bounds.height()+c;}switch((a||r)&&pt4(t,n,a,r),i.orient){case h11:l+=gt6(e,n,i,s,1,1);break;case f8:u+=gt6(e,n,i,x11,0,0)+c,l+=gt6(e,n,i,s,1,1);break;case m11:u+=gt6(e,n,i,s,0,0),l+=gt6(e,n,i,x11,-1,0,1)+c;break;default:u+=gt6(e,n,i,s,0,0);}(u||l)&&pt4(t,i,u,l),(u=Math.round(i.bounds.x1-o))<0&&(pt4(t,n,-u,0),pt4(t,i,-u,0));}else(a||r)&&pt4(t,n,a,r);}(t,a,a.items[0].items[0]),c=function(t,e){return t.items.forEach(t=>e.union(t.bounds)),e.x1=t.padding,e.y1=t.padding,e;}(a,c),n=2*a.padding,o=2*a.padding,c.empty()||(n=Math.ceil(c.width()+n),o=Math.ceil(c.height()+o)),"symbol"===r.type&&function(t){const e=t.reduce((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t),{});t.forEach(t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y;});}(a.items[0].items[0].items[0].items),i!==q11&&(a.x=u=0,a.y=l=0),a.width=n,a.height=o,Gt1(c.set(u,l,u+n,l+o),a),a.mark.bounds.clear().union(c),a;}function gt6(t,e,n,o,a,r,s){const c="symbol"!==t.datum.type,u=n.datum.vgrad,l=(!c||!r&&u||s?e:e.items[0]).bounds[a?"y2":"x2"]-t.padding,d=u&&r?l:0,h=u&&r?0:l,f=a<=0?0:Cn2(n);return Math.round(o===y8?d:o===x11?h-f:.5*(l-f));}function pt4(t,e,n,o){e.x+=n,e.y+=o,e.bounds.translate(n,o),e.mark.bounds.translate(n,o),t.dirty(e);}function wt4(e){st2.call(this,null,e);}an(wt4,st2,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&dt4(n,e,t.layout),function(t,e,n){var o,a,i,s,c,u=e.items,l=Math.max(0,e.width||0),b=Math.max(0,e.height||0),F=(new Bt3).set(0,0,l,b),H=F.clone(),L=F.clone(),P=[];for(s=0,c=u.length;s<c;++s)switch((a=u[s]).role){case p11:(et6(a)?H:L).union(nt7(t,a,l,b));break;case w10:o=a;break;case v11:P.push(xt4(t,a));break;case k11:case M11:case E14:case z14:case A14:case _11:case D11:case B13:H.union(a.bounds),L.union(a.bounds);break;default:F.union(a.bounds);}if(P.length){const e={};P.forEach(t=>{(i=t.orient||f8)!==q11&&(e[i]||(e[i]=[])).push(t);});for(const o in e){const a=e[o];lt6(t,a,bt4(a,o,n.legends,H,L,l,b));}P.forEach(e=>{const o=e.bounds;if(o.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=o,t.dirty(e)),!n.autosize||n.autosize.type!==T11&&n.autosize.type!==S12&&n.autosize.type!==j12)F.union(o);else switch(e.orient){case h11:case f8:F.add(o.x1,0).add(o.x2,0);break;case d9:case m11:F.add(0,o.y1).add(0,o.y2);}});}F.union(H).union(L),o&&F.union(function(t,e,n,o,a){var r,i=e.items[0],s=i.frame,c=i.orient,u=i.anchor,l=i.offset,b=i.padding,p=i.items[0].items[0],w=i.items[1]&&i.items[1].items[0],k=c===h11||c===f8?o:n,M=0,v=0,E=0,z=0,A=0;if(s!==g10?c===h11?(M=a.y2,k=a.y1):c===f8?(M=a.y1,k=a.y2):(M=a.x1,k=a.x2):c===h11&&(M=o,k=0),r=u===y8?M:u===x11?k:(M+k)/2,w&&w.text){switch(c){case d9:case m11:A=p.bounds.height()+b;break;case h11:z=p.bounds.width()+b;break;case f8:z=-p.bounds.width()-b;}$12.clear().union(w.bounds),$12.translate(z-(w.x||0),A-(w.y||0)),tt7(w,"x",z)|tt7(w,"y",A)&&(t.dirty(w),w.bounds.clear().union($12),w.mark.bounds.clear().union($12),t.dirty(w)),$12.clear().union(w.bounds);}else $12.clear();switch($12.union(p.bounds),c){case d9:v=r,E=a.y1-$12.height()-l;break;case h11:v=a.x1-$12.width()-l,E=r;break;case f8:v=a.x2+$12.width()+l,E=r;break;case m11:v=r,E=a.y2+l;break;default:v=i.x,E=i.y;}return tt7(i,"x",v)|tt7(i,"y",E)&&($12.translate(v,E),t.dirty(i),i.bounds.clear().union($12),e.bounds.clear().union($12),t.dirty(i)),i.bounds;}(t,o,l,b,F));e.clip&&F.set(0,0,e.width||0,e.height||0);!function(t,e,n,o){const a=o.autosize||{},r=a.type;if(t._autosize<1||!r)return;let i=t._width,s=t._height,c=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),d=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-c)),f=Math.max(0,Math.ceil(n.y2-l));if(a.contains===O11){const e=t.padding();i-=e.left+e.right,s-=e.top+e.bottom;}r===q11?(u=0,d=0,c=i,l=s):r===T11?(c=Math.max(0,i-u-h),l=Math.max(0,s-d-f)):r===S12?(c=Math.max(0,i-u-h),s=l+d+f):r===j12?(i=c+u+h,l=Math.max(0,s-d-f)):"pad"===r&&(i=c+u+h,s=l+d+f);t._resizeView(i,s,c,l,[u,d],a.resize);}(t,e,F,n);}(n,e,t);}),(o=t.mark.group)&&"legend-entry"!==o.mark.role?e.reflow():e;var o;}});const mod2=function(){return{bound:C13,identifier:U11,mark:V12,overlap:W14,render:Z15,viewlayout:wt4,default:null};}();function le4(t){st2.call(this,null,t);}function se4(t){st2.call(this,null,t);}function ue4(){return O6({});}function de3(t){st2.call(this,null,t);}function me4(t){st2.call(this,[],t);}an(le4,st2,{transform(e,n){if(this.value&&!e.modified())return n.StopPropagation;var a=n.dataflow.locale(),s=n.fork(n.NO_SOURCE|n.NO_FIELDS),u=this.value,d=e.scale,m=null==e.count?e.values?e.values.length:10:e.count,c=Le1(d,m,e.minstep),f=e.format||Pe1(a,d,c,e.formatSpecifier,e.formatType,!!e.values),p=e.values?Te2(d,e.values,c):De1(d,c);return u&&(s.rem=u),u=p.map((e,n)=>O6({index:n/(p.length-1||1),value:e,label:f(e)})),e.extra&&u.length&&u.push(O6({index:-1,extra:{value:u[0].value},label:""})),s.source=u,s.add=u,this.value=u,s;}}),an(se4,st2,{transform(e,t){var a=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.item||ue4,o=e.key||E7,l1=this.value;return w(i.encode)&&(i.encode=null),l1&&(e.modified("key")||t.modified(o))&&l("DataJoin does not support modified key function or fields."),l1||(t=t.addAll(),this.value=l1=function(e){const t=fn().test(e=>e.exit);return t.lookup=n=>t.get(e(n)),t;}(o)),t.visit(t.ADD,e=>{const t=o(e);let n=l1.get(t);n?n.exit?(l1.empty--,i.add.push(n)):i.mod.push(n):(n=r(e),l1.set(t,n),i.add.push(n)),n.datum=e,n.exit=!1;}),t.visit(t.MOD,e=>{const t=o(e),n=l1.get(t);n&&(n.datum=e,i.mod.push(n));}),t.visit(t.REM,e=>{const t=o(e),n=l1.get(t);e!==n.datum||n.exit||(i.rem.push(n),n.exit=!0,++l1.empty);}),t.changed(t.ADD_MOD)&&i.modifies("datum"),(t.clean()||e.clean&&l1.empty>a.cleanThreshold)&&a.runAfter(l1.clean),i;}}),an(de3,st2,{transform(e,t){var n=t.fork(t.ADD_REM),a=e.mod||!1,i=e.encoders,r=t.encode;if(w(r)){if(!n.changed()&&!r.every(e=>i[e]))return t.StopPropagation;r=r[0],n.encode=null;}var o="enter"===r,l=i.update||p,s=i.enter||p,u=i.exit||p,d=(r&&!o?i[r]:l)||p;if(t.changed(t.ADD)&&(t.visit(t.ADD,t=>{s(t,e),l(t,e);}),n.modifies(s.output),n.modifies(l.output),d!==p&&d!==l&&(t.visit(t.ADD,t=>{d(t,e);}),n.modifies(d.output))),t.changed(t.REM)&&u!==p&&(t.visit(t.REM,t=>{u(t,e);}),n.modifies(u.output)),o||d!==p){const i=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(i,t=>{const i=s(t,e)||a;(d(t,e)||i)&&n.mod.push(t);}),n.mod.length&&n.modifies(s.output)):t.visit(i,t=>{(d(t,e)||a)&&n.mod.push(t);}),n.mod.length&&n.modifies(d.output);}return n.changed()?n:t.StopPropagation;}}),an(me4,st2,{transform(e,n){if(null!=this.value&&!e.modified())return n.StopPropagation;var a,r,o,l,p,h=n.dataflow.locale(),g=n.fork(n.NO_SOURCE|n.NO_FIELDS),v=this.value,M=e.type||Be1,y=e.scale,x=+e.limit,b=Le1(y,null==e.count?5:e.count,e.minstep),D1=!!e.values||M===Be1,S=e.format||ze1(h,y,b,M,e.formatSpecifier,e.formatType,D1),w=e.values||Ee1(y,b);return v&&(g.rem=v),M===Be1?(x&&w.length>x?(n.dataflow.warn("Symbol legend count exceeds limit, filtering items."),v=w.slice(0,x-1),p=!0):v=w,L(o=e.size)?(e.values||0!==y(v[0])||(v=v.slice(1)),l=v.reduce((t,n)=>Math.max(t,o(n,e)),0)):o=tn(l=o||8),v=v.map((n,a)=>O6({index:a,label:S(n,a,v),value:n,offset:l,size:o(n,e)})),p&&(p=w[v.length],v.push(O6({index:v.length,label:`â€¦${w.length-v.length} entries`,value:p,offset:l,size:o(p,e)})))):M===Re1?(a=y.domain(),r=Me2(y,a[0],D(a)),w.length<3&&!e.values&&a[0]!==D(a)&&(w=[a[0],D(a)]),v=w.map((e,n)=>O6({index:n,label:S(e,n,w),value:e,perc:r(e)}))):(o=w.length-1,r=He1(y),v=w.map((e,n)=>O6({index:n,label:S(e,n,w),value:e,perc:n?r(e):0,perc2:n===o?1:r(w[n+1])}))),g.source=v,g.add=v,this.value=v,g;}});const ce4=e=>e.source.x,fe3=e=>e.source.y,pe3=e=>e.target.x,he4=e=>e.target.y;function ge4(t){st2.call(this,{},t);}ge4.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},an(ge4,st2,{transform(e,t){var n=e.sourceX||ce4,a=e.sourceY||fe3,i=e.targetX||pe3,r=e.targetY||he4,o=e.as||"path",l1=e.orient||"vertical",s=e.shape||"line",u=xe3.get(s+"-"+l1)||xe3.get(s);return u||l("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,e=>{e[o]=u(n(e),a(e),i(e),r(e));}),t.reflow(e.modified()).modifies(o);}});const ve3=(e,t,n,a)=>"M"+e+","+t+"L"+n+","+a,Me4=(e,t,n,a)=>{var i=n-e,r=a-t,o=Math.hypot(i,r)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(r,i)/Math.PI+" 0 1 "+n+","+a;},ye3=(e,t,n,a)=>{const i=n-e,r=a-t,o=.2*(i+r),l=.2*(r-i);return"M"+e+","+t+"C"+(e+o)+","+(t+l)+" "+(n+l)+","+(a-o)+" "+n+","+a;},xe3=fn({line:ve3,"line-radial":(e,t,n,a)=>ve3(t*Math.cos(e),t*Math.sin(e),a*Math.cos(n),a*Math.sin(n)),arc:Me4,"arc-radial":(e,t,n,a)=>Me4(t*Math.cos(e),t*Math.sin(e),a*Math.cos(n),a*Math.sin(n)),curve:ye3,"curve-radial":(e,t,n,a)=>ye3(t*Math.cos(e),t*Math.sin(e),a*Math.cos(n),a*Math.sin(n)),"orthogonal-horizontal":(e,t,n,a)=>"M"+e+","+t+"V"+a+"H"+n,"orthogonal-vertical":(e,t,n,a)=>"M"+e+","+t+"H"+n+"V"+a,"orthogonal-radial":(e,t,n,a)=>{const i=Math.cos(e),r=Math.sin(e),o=Math.cos(n),l=Math.sin(n);return"M"+t*i+","+t*r+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*l+"L"+a*o+","+a*l;},"diagonal-horizontal":(e,t,n,a)=>{const i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+a+" "+n+","+a;},"diagonal-vertical":(e,t,n,a)=>{const i=(t+a)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+a;},"diagonal-radial":(e,t,n,a)=>{const i=Math.cos(e),r=Math.sin(e),o=Math.cos(n),l=Math.sin(n),s=(t+a)/2;return"M"+t*i+","+t*r+"C"+s*i+","+s*r+" "+s*o+","+s*l+" "+a*o+","+a*l;}});function be3(t){st2.call(this,null,t);}be3.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},an(be3,st2,{transform(e,t){var n,a,i,r=e.as||["startAngle","endAngle"],o=r[0],l=r[1],s=e.field||h,u=e.startAngle||0,d=null!=e.endAngle?e.endAngle:2*Math.PI,m=t.source,c=m.map(s),f=c.length,p=u,h1=(d-u)/jt(c),g=Nt(f);for(e.sort&&g.sort((e,t)=>c[e]-c[t]),n=0;n<f;++n)i=c[g[n]],(a=m[g[n]])[o]=p,a[l]=p+=i*h1;return this.value=c,t.reflow(e.modified()).modifies(r);}});function De3(e){return ie2(e)&&e!==j10;}const Se3=Sn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function we3(t){st2.call(this,null,t),this.modified(!0);}function Ae3(e,t,n){se2(e)&&Math.abs(t.reduce((e,t)=>e+(t<0?-1:t>0?1:0),0))!==t.length&&n.warn("Log scale domain includes zero: "+xn(t));return t;}function Oe3(e,t,n){return L(e)&&(t||n)?ye1(e,ke3(t||[0,1],n)):e;}function ke3(e,t){return t?e.slice().reverse():e;}function Ee3(t){st2.call(this,null,t);}an(we3,st2,{transform(e,t){var n=t.dataflow,a=this.value,r=function(e){var t,n=e.type,a="";if(n===j10)return j10+"-"+A13;(function(e){const t=e.type;return ie2(t)&&t!==P10&&t!==Y12&&(e.scheme||e.range&&e.range.length&&e.range.every(Mn));})(e)&&(a=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?j10+"-":3===t?C12+"-":"");return(a+n||A13).toLowerCase();}(e);for(r in a&&r===a.type||(this.value=a=be1(r)()),e)if(!Se3[r]){if("padding"===r&&De3(a.type))continue;L(a[r])?a[r](e[r]):n.warn("Unsupported scale property: "+r);}return function(e,t,n){var a=e.type,i=t.round||!1,r=t.range;if(null!=t.rangeStep)r=function(e,t,n){e!==X13&&e!==Q9&&l("Only band and point scales support rangeStep.");var a=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===Q9?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*R11(n,i,a)];}(a,t,n);else if(t.scheme&&(r=function(e,t,n){var a,i,r=t.schemeExtent;w(t.scheme)?i=ve1(t.scheme,t.interpolate,t.interpolateGamma):(a=t.scheme.toLowerCase(),(i=ke1(a))||l(`Unrecognized scheme name: ${t.scheme}`));return n=e===U9?n+1:e===_10?n-1:e===E13||e===z13?+t.schemeCount||5:n,ge2(e)?Oe3(i,r,t.reverse):L(i)?we1(Oe3(i,r),n):e===N12?i:i.slice(0,n);}(a,t,n),L(r))){if(e.interpolator)return e.interpolator(r);l(`Scale type ${a} does not support interpolating color schemes.`);}if(r&&ge2(a))return e.interpolator(ve1(ke3(r,t.reverse),t.interpolate,t.interpolateGamma));r&&t.interpolate&&e.interpolate?e.interpolate(xe1(t.interpolate,t.interpolateGamma)):L(e.round)?e.round(i):L(e.rangeRound)&&e.interpolate(i?j8:R9);r&&e.range(ke3(r,t.reverse));}(a,e,function(e,t,n){let a=t.bins;if(a&&!w(a)){const t=e.domain(),n=t[0],i=D(t),r=a.step;let o=null==a.start?n:a.start,l1=null==a.stop?i:a.stop;r||l("Scale bins parameter missing step property."),o<n&&(o=r*Math.ceil(n/r)),l1>i&&(l1=r*Math.floor(i/r)),a=Nt(o,l1+r/2,r);}a?e.bins=a:e.bins&&delete e.bins;e.type===_10&&(a?t.domain||t.domainRaw||(e.domain(a),n=a.length):e.bins=e.domain());return n;}(a,e,function(e,t,n){const a=function(e,t,n){return t?(e.domain(Ae3(e.type,t,n)),t.length):-1;}(e,t.domainRaw,n);if(a>-1)return a;var r,o,l=t.domain,s=e.type,u=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===A13||t===L10||t===T10);}(e);if(!l)return 0;if((u||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(r=(l=l.slice()).length-1||1,u&&(l[0]>0&&(l[0]=0),l[r]<0&&(l[r]=0)),null!=t.domainMin&&(l[0]=t.domainMin),null!=t.domainMax&&(l[r]=t.domainMax),null!=t.domainMid)){const e=(o=t.domainMid)>l[r]?r+1:o<l[0]?0:r;e!==r&&n.warn("Scale domainMid exceeds domain min or max.",o),l.splice(e,0,o);}De3(s)&&t.padding&&l[0]!==D(l)&&(l=function(e,t,n,a,i,r){var o=Math.abs(D(n)-n[0]),l=o/(o-2*a),s=e===I10?I(t,null,l):e===T10?J(t,null,l,.5):e===L10?J(t,null,l,i||1):e===D10?V(t,null,l,r||1):G(t,null,l);return t=t.slice(),t[0]=s[0],t[t.length-1]=s[1],t;}(s,l,t.range,t.padding,t.exponent,t.constant));e.domain(Ae3(s,l,n)),s===N12&&e.unknown(t.domainImplicit?z11:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&Le1(e,t.nice)||null);return l.length;}(a,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS);}}),an(Ee3,st2,{transform(e,t){const n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(b5(e.sort)),this.modified(n),t;}});const Re3="zero",ze3="center",Ce4="normalize",Le3=["y0","y1"];function Ie3(t){st2.call(this,null,t);}function Pe3(e,t,n,a,i){for(var r,o=(t-e.sum)/2,l=e.length,s=0;s<l;++s)(r=e[s])[a]=o,r[i]=o+=Math.abs(n(r));}function _e3(e,t,n,a,i){for(var r,o=1/e.sum,l=0,s=e.length,u=0,d=0;u<s;++u)(r=e[u])[a]=l,r[i]=l=o*(d+=Math.abs(n(r)));}function Ne3(e,t,n,a,i){for(var r,o,l=0,s=0,u=e.length,d=0;d<u;++d)(r=+n(o=e[d]))<0?(o[a]=s,o[i]=s+=r):(o[a]=l,o[i]=l+=r);}Ie3.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Re3,values:[Re3,ze3,Ce4]},{name:"as",type:"string",array:!0,length:2,default:Le3}]},an(Ie3,st2,{transform(e,t){var n,i,r,o,l=e.as||Le3,s=l[0],u=l[1],d=b5(e.sort),m=e.field||h,c=e.offset===ze3?Pe3:e.offset===Ce4?_e3:Ne3;for(n=function(e,t,n,a){var i,r,o,l,s,u,d,m,c,f=[],p=e=>e(s);if(null==t)f.push(e.slice());else for(i={},r=0,o=e.length;r<o;++r)s=e[r],(d=i[u=t.map(p)])||(i[u]=d=[],f.push(d)),d.push(s);for(u=0,c=0,l=f.length;u<l;++u){for(r=0,m=0,o=(d=f[u]).length;r<o;++r)m+=Math.abs(a(d[r]));d.sum=m,m>c&&(c=m),n&&d.sort(n);}return f.max=c,f;}(t.source,e.groupby,d,m),i=0,r=n.length,o=n.max;i<r;++i)c(n[i],o,m,s,u);return t.reflow(e.modified()).modifies(l);}});const mod3=function(){return{axisticks:le4,datajoin:se4,encode:de3,legendentries:me4,linkpath:ge4,pie:be3,scale:we3,sortitems:Ee3,stack:Ie3,default:null};}();var i12=1e-6,e10=1e-12,o9=Math.PI,u12=o9/2,a9=o9/4,c10=2*o9,l11=180/o9,f9=o9/180,s12=Math.abs,p12=Math.atan,h12=Math.atan2,g11=Math.cos,v12=Math.ceil,d10=Math.exp,E15=Math.hypot,y9=Math.log,S13=Math.pow,m12=Math.sin,M12=Math.sign||function(n){return n>0?1:n<0?-1:0;},w11=Math.sqrt,x12=Math.tan;function _12(n){return n>1?0:n<-1?o9:Math.acos(n);}function N14(n){return n>1?u12:n<-1?-u12:Math.asin(n);}function C14(){}function P12(n,t){n&&$13.hasOwnProperty(n.type)&&$13[n.type](n,t);}var A15={Feature:function(n,t){P12(n.geometry,t);},FeatureCollection:function(n,t){for(var r=n.features,i=-1,e=r.length;++i<e;)P12(r[i].geometry,t);}},$13={Sphere:function(n,t){t.sphere();},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2]);},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)n=r[i],t.point(n[0],n[1],n[2]);},LineString:function(n,t){q12(n.coordinates,t,0);},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)q12(r[i],t,0);},Polygon:function(n,t){z15(n.coordinates,t);},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)z15(r[i],t);},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,e=r.length;++i<e;)P12(r[i],t);}};function q12(n,t,r){var i,e=-1,o=n.length-r;for(t.lineStart();++e<o;)i=n[e],t.point(i[0],i[1],i[2]);t.lineEnd();}function z15(n,t){var r=-1,i=n.length;for(t.polygonStart();++r<i;)q12(n[r],t,1);t.polygonEnd();}function j13(n,t){n&&A15.hasOwnProperty(n.type)?A15[n.type](n,t):P12(n,t);}var L12,b11,G14,O12,T12,k12,F13,H14,I12,W15,X16,Y15,B14,D12,U12,Z16,J16=new F1,K16=new F1,Q12={point:C14,lineStart:C14,lineEnd:C14,polygonStart:function(){J16=new F1,Q12.lineStart=V13,Q12.lineEnd=nn5;},polygonEnd:function(){var n=+J16;K16.add(n<0?c10+n:n),this.lineStart=this.lineEnd=this.point=C14;},sphere:function(){K16.add(c10);}};function V13(){Q12.point=tn5;}function nn5(){rn5(L12,b11);}function tn5(n,t){Q12.point=rn5,L12=n,b11=t,G14=n*=f9,O12=g11(t=(t*=f9)/2+a9),T12=m12(t);}function rn5(n,t){var r=(n*=f9)-G14,i=r>=0?1:-1,e=i*r,o=g11(t=(t*=f9)/2+a9),u=m12(t),c=T12*u,l=O12*o+c*g11(e),s=c*i*m12(e);J16.add(h12(s,l)),G14=n,O12=o,T12=u;}function en5(t){return K16=new F1,j13(t,Q12),2*K16;}function on5(n){return[h12(n[1],n[0]),N14(n[2])];}function un5(n){var t=n[0],r=n[1],i=g11(r);return[i*g11(t),i*m12(t),m12(r)];}function an5(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2];}function cn5(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]];}function ln5(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2];}function fn5(n,t){return[n[0]*t,n[1]*t,n[2]*t];}function sn5(n){var t=w11(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t;}var pn4,hn5,gn4,vn4,dn4,En3,yn4,Sn4,mn4,Mn4,wn4,xn4,_n3,Nn3,Rn3,Cn3,Pn2={point:An3,lineStart:qn2,lineEnd:zn3,polygonStart:function(){Pn2.point=jn4,Pn2.lineStart=Ln3,Pn2.lineEnd=bn4,D12=new F1,Q12.polygonStart();},polygonEnd:function(){Q12.polygonEnd(),Pn2.point=An3,Pn2.lineStart=qn2,Pn2.lineEnd=zn3,J16<0?(k12=-(H14=180),F13=-(I12=90)):D12>i12?I12=90:D12<-i12&&(F13=-90),Z16[0]=k12,Z16[1]=H14;},sphere:function(){k12=-(H14=180),F13=-(I12=90);}};function An3(n,t){U12.push(Z16=[k12=n,H14=n]),t<F13&&(F13=t),t>I12&&(I12=t);}function $n1(n,t){var r=un5([n*f9,t*f9]);if(B14){var i=cn5(B14,r),e=cn5([i[1],-i[0],0],i);sn5(e),e=on5(e);var o,u=n-W15,a=u>0?1:-1,c=e[0]*l11*a,p=s12(u)>180;p^(a*W15<c&&c<a*n)?(o=e[1]*l11)>I12&&(I12=o):p^(a*W15<(c=(c+360)%360-180)&&c<a*n)?(o=-e[1]*l11)<F13&&(F13=o):(t<F13&&(F13=t),t>I12&&(I12=t)),p?n<W15?Gn2(k12,n)>Gn2(k12,H14)&&(H14=n):Gn2(n,H14)>Gn2(k12,H14)&&(k12=n):H14>=k12?(n<k12&&(k12=n),n>H14&&(H14=n)):n>W15?Gn2(k12,n)>Gn2(k12,H14)&&(H14=n):Gn2(n,H14)>Gn2(k12,H14)&&(k12=n);}else U12.push(Z16=[k12=n,H14=n]);t<F13&&(F13=t),t>I12&&(I12=t),B14=r,W15=n;}function qn2(){Pn2.point=$n1;}function zn3(){Z16[0]=k12,Z16[1]=H14,Pn2.point=An3,B14=null;}function jn4(n,t){if(B14){var r=n-W15;D12.add(s12(r)>180?r+(r>0?360:-360):r);}else X16=n,Y15=t;Q12.point(n,t),$n1(n,t);}function Ln3(){Q12.lineStart();}function bn4(){jn4(X16,Y15),Q12.lineEnd(),s12(D12)>i12&&(k12=-(H14=180)),Z16[0]=k12,Z16[1]=H14,B14=null;}function Gn2(n,t){return(t-=n)<0?t+360:t;}function On3(n,t){return n[0]-t[0];}function Tn3(n,t){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t;}function kn3(n){var t,r,i,e,o,u,a;if(I12=H14=-(k12=F13=1/0),U12=[],j13(n,Pn2),r=U12.length){for(U12.sort(On3),t=1,o=[i=U12[0]];t<r;++t)Tn3(i,(e=U12[t])[0])||Tn3(i,e[1])?(Gn2(i[0],e[1])>Gn2(i[0],i[1])&&(i[1]=e[1]),Gn2(e[0],i[1])>Gn2(i[0],i[1])&&(i[0]=e[0])):o.push(i=e);for(u=-1/0,t=0,i=o[r=o.length-1];t<=r;i=e,++t)e=o[t],(a=Gn2(i[1],e[0]))>u&&(u=a,k12=e[0],H14=i[1]);}return U12=Z16=null,k12===1/0||F13===1/0?[[NaN,NaN],[NaN,NaN]]:[[k12,F13],[H14,I12]];}var Fn3={sphere:C14,point:Hn3,lineStart:Wn2,lineEnd:Bn2,polygonStart:function(){Fn3.lineStart=Dn4,Fn3.lineEnd=Un3;},polygonEnd:function(){Fn3.lineStart=Wn2,Fn3.lineEnd=Bn2;}};function Hn3(n,t){n*=f9;var r=g11(t*=f9);In3(r*g11(n),r*m12(n),m12(t));}function In3(n,t,r){++pn4,gn4+=(n-gn4)/pn4,vn4+=(t-vn4)/pn4,dn4+=(r-dn4)/pn4;}function Wn2(){Fn3.point=Xn1;}function Xn1(n,t){n*=f9;var r=g11(t*=f9);Nn3=r*g11(n),Rn3=r*m12(n),Cn3=m12(t),Fn3.point=Yn2,In3(Nn3,Rn3,Cn3);}function Yn2(n,t){n*=f9;var r=g11(t*=f9),i=r*g11(n),e=r*m12(n),o=m12(t),u=h12(w11((u=Rn3*o-Cn3*e)*u+(u=Cn3*i-Nn3*o)*u+(u=Nn3*e-Rn3*i)*u),Nn3*i+Rn3*e+Cn3*o);hn5+=u,En3+=u*(Nn3+(Nn3=i)),yn4+=u*(Rn3+(Rn3=e)),Sn4+=u*(Cn3+(Cn3=o)),In3(Nn3,Rn3,Cn3);}function Bn2(){Fn3.point=Hn3;}function Dn4(){Fn3.point=Zn2;}function Un3(){Jn2(xn4,_n3),Fn3.point=Hn3;}function Zn2(n,t){xn4=n,_n3=t,n*=f9,t*=f9,Fn3.point=Jn2;var r=g11(t);Nn3=r*g11(n),Rn3=r*m12(n),Cn3=m12(t),In3(Nn3,Rn3,Cn3);}function Jn2(n,t){n*=f9;var r=g11(t*=f9),i=r*g11(n),e=r*m12(n),o=m12(t),u=Rn3*o-Cn3*e,a=Cn3*i-Nn3*o,c=Nn3*e-Rn3*i,l=E15(u,a,c),s=N14(l),p=l&&-s/l;mn4.add(p*u),Mn4.add(p*a),wn4.add(p*c),hn5+=s,En3+=s*(Nn3+(Nn3=i)),yn4+=s*(Rn3+(Rn3=e)),Sn4+=s*(Cn3+(Cn3=o)),In3(Nn3,Rn3,Cn3);}function Kn2(t){pn4=hn5=gn4=vn4=dn4=En3=yn4=Sn4=0,mn4=new F1,Mn4=new F1,wn4=new F1,j13(t,Fn3);var r=+mn4,o=+Mn4,u=+wn4,a=E15(r,o,u);return a<e10&&(r=En3,o=yn4,u=Sn4,hn5<i12&&(r=gn4,o=vn4,u=dn4),(a=E15(r,o,u))<e10)?[NaN,NaN]:[h12(o,r)*l11,N14(u/a)*l11];}function Vn3(n,t){function r(r,i){return r=n(r,i),t(r[0],r[1]);}return n.invert&&t.invert&&(r.invert=function(r,i){return(r=t.invert(r,i))&&n.invert(r[0],r[1]);}),r;}function nt8(n,t){return s12(n)>o9&&(n-=Math.round(n/c10)*c10),[n,t];}function tt8(n,t,r){return(n%=c10)?t||r?Vn3(it7(n),et7(t,r)):it7(n):t||r?et7(t,r):nt8;}function rt8(n){return function(t,r){return s12(t+=n)>o9&&(t-=Math.round(t/c10)*c10),[t,r];};}function it7(n){var t=rt8(n);return t.invert=rt8(-n),t;}function et7(n,t){var r=g11(n),i=m12(n),e=g11(t),o=m12(t);function u(n,t){var u=g11(t),a=g11(n)*u,c=m12(n)*u,l=m12(t),f=l*r+a*i;return[h12(c*e-f*o,a*r-l*i),N14(f*e+c*o)];}return u.invert=function(n,t){var u=g11(t),a=g11(n)*u,c=m12(n)*u,l=m12(t),f=l*e-c*o;return[h12(c*e+l*o,a*r+f*i),N14(f*r-a*i)];},u;}function ot7(n){function t(t){return(t=n(t[0]*f9,t[1]*f9))[0]*=l11,t[1]*=l11,t;}return n=tt8(n[0]*f9,n[1]*f9,n.length>2?n[2]*f9:0),t.invert=function(t){return(t=n.invert(t[0]*f9,t[1]*f9))[0]*=l11,t[1]*=l11,t;},t;}function ut7(n,t,r,i,e,o){if(r){var u=g11(t),a=m12(t),l=i*r;null==e?(e=t+i*c10,o=t-l/2):(e=at8(u,e),o=at8(u,o),(i>0?e<o:e>o)&&(e+=i*c10));for(var f,s=e;i>0?s>o:s<o;s-=l)f=on5([u,-a*g11(s),-a*m12(s)]),n.point(f[0],f[1]);}}function at8(n,t){(t=un5(t))[0]-=n,sn5(t);var r=_12(-t[1]);return((-t[2]<0?-r:r)+c10-i12)%c10;}function lt7(){var n,t=[];return{point:function(t,r,i){n.push([t,r,i]);},lineStart:function(){t.push(n=[]);},lineEnd:C14,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()));},result:function(){var r=t;return t=[],n=null,r;}};}function ft6(n,t){return s12(n[0]-t[0])<i12&&s12(n[1]-t[1])<i12;}function st7(n,t,r,i){this.x=n,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null;}function pt5(n,t,r,i,e){var o,u,a=[],c=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,r,i=n[0],u=n[t];if(ft6(i,u)){if(!i[2]&&!u[2]){for(e.lineStart(),o=0;o<t;++o)e.point((i=n[o])[0],i[1]);return void e.lineEnd();}u[0]+=2e-6;}a.push(r=new st7(i,n,null,!0)),c.push(r.o=new st7(i,null,r,!1)),a.push(r=new st7(u,n,null,!1)),c.push(r.o=new st7(u,null,r,!0));}}),a.length){for(c.sort(t),ht7(a),ht7(c),o=0,u=c.length;o<u;++o)c[o].e=r=!r;for(var l,f,s=a[0];;){for(var p=s,h=!0;p.v;)if((p=p.n)===s)return;l=p.z,e.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(o=0,u=l.length;o<u;++o)e.point((f=l[o])[0],f[1]);else i(p.x,p.n.x,1,e);p=p.n;}else{if(h)for(l=p.p.z,o=l.length-1;o>=0;--o)e.point((f=l[o])[0],f[1]);else i(p.x,p.p.x,-1,e);p=p.p;}l=(p=p.o).z,h=!h;}while(!p.v)e.lineEnd();}}}function ht7(n){if(t=n.length){for(var t,r,i=0,e=n[0];++i<t;)e.n=r=n[i],r.p=e,e=r;e.n=r=n[0],r.p=e;}}function gt7(n){return s12(n[0])<=o9?n[0]:M12(n[0])*((s12(n[0])+o9)%c10-o9);}function vt5(t,r){var e=gt7(r),l=r[1],f=m12(l),s=[m12(e),-g11(e),0],p=0,v=0,d=new F1;1===f?l=u12+i12:-1===f&&(l=-u12-i12);for(var E=0,y=t.length;E<y;++E)if(M=(S=t[E]).length)for(var S,M,w=S[M-1],x=gt7(w),_=w[1]/2+a9,R=m12(_),C=g11(_),P=0;P<M;++P,x=$,R=z,C=j,w=A){var A=S[P],$=gt7(A),q=A[1]/2+a9,z=m12(q),j=g11(q),L=$-x,b=L>=0?1:-1,G=b*L,O=G>o9,T=R*z;if(d.add(h12(T*b*m12(G),C*j+T*g11(G))),p+=O?L+b*c10:L,O^x>=e^$>=e){var k=cn5(un5(w),un5(A));sn5(k);var F=cn5(s,k);sn5(F);var H=(O^L>=0?-1:1)*N14(F[2]);(l>H||l===H&&(k[0]||k[1]))&&(v+=O^L>=0?1:-1);}}return(p<-i12||p<i12&&d<-1e-12)^1&v;}function dt5(n,r,i,e){return function(o){var u,a,c,l=r(o),f=lt7(),s=r(f),p=!1,h={point:g,lineStart:d,lineEnd:E,polygonStart:function(){h.point=y,h.lineStart=S,h.lineEnd=m,a=[],u=[];},polygonEnd:function(){h.point=g,h.lineStart=d,h.lineEnd=E,a=gt(a);var n=vt5(u,e);a.length?(p||(o.polygonStart(),p=!0),pt5(a,yt5,n,i,o)):n&&(p||(o.polygonStart(),p=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),p&&(o.polygonEnd(),p=!1),a=u=null;},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd();}};function g(t,r){n(t,r)&&o.point(t,r);}function v(n,t){l.point(n,t);}function d(){h.point=v,l.lineStart();}function E(){h.point=g,l.lineEnd();}function y(n,t){c.push([n,t]),s.point(n,t);}function S(){s.lineStart(),c=[];}function m(){y(c[0][0],c[0][1]),s.lineEnd();var n,t,r,i,e=s.clean(),l=f.result(),h=l.length;if(c.pop(),u.push(c),c=null,h)if(1&e){if((t=(r=l[0]).length-1)>0){for(p||(o.polygonStart(),p=!0),o.lineStart(),n=0;n<t;++n)o.point((i=r[n])[0],i[1]);o.lineEnd();}}else h>1&&2&e&&l.push(l.pop().concat(l.shift())),a.push(l.filter(Et4));}return h;};}function Et4(n){return n.length>1;}function yt5(n,t){return((n=n.x)[0]<0?n[1]-u12-i12:u12-n[1])-((t=t.x)[0]<0?t[1]-u12-i12:u12-t[1]);}nt8.invert=nt8;var St4=dt5(function(){return!0;},function(n){var t,r=NaN,e=NaN,a=NaN;return{lineStart:function(){n.lineStart(),t=1;},point:function(c,l){var f=c>0?o9:-o9,h=s12(c-r);s12(h-o9)<i12?(n.point(r,e=(e+l)/2>0?u12:-u12),n.point(a,e),n.lineEnd(),n.lineStart(),n.point(f,e),n.point(c,e),t=0):a!==f&&h>=o9&&(s12(r-a)<i12&&(r-=a*i12),s12(c-f)<i12&&(c-=f*i12),e=function(n,t,r,e){var o,u,a=m12(n-r);return s12(a)>i12?p12((m12(t)*(u=g11(e))*m12(r)-m12(e)*(o=g11(t))*m12(n))/(o*u*a)):(t+e)/2;}(r,e,c,l),n.point(a,e),n.lineEnd(),n.lineStart(),n.point(f,e),t=0),n.point(r=c,e=l),a=f;},lineEnd:function(){n.lineEnd(),r=e=NaN;},clean:function(){return 2-t;}};},function(n,t,r,e){var a;if(null==n)a=r*u12,e.point(-o9,a),e.point(0,a),e.point(o9,a),e.point(o9,0),e.point(o9,-a),e.point(0,-a),e.point(-o9,-a),e.point(-o9,0),e.point(-o9,a);else if(s12(n[0]-t[0])>i12){var c=n[0]<t[0]?o9:-o9;a=r*c/2,e.point(-c,a),e.point(0,a),e.point(c,a);}else e.point(t[0],t[1]);},[-o9,-u12]);function mt5(n){var t=g11(n),r=2*f9,e=t>0,u=s12(t)>i12;function a(n,r){return g11(n)*g11(r)>t;}function c(n,r,e){var u=[1,0,0],a=cn5(un5(n),un5(r)),c=an5(a,a),l=a[0],f=c-l*l;if(!f)return!e&&n;var p=t*c/f,h=-t*l/f,g=cn5(u,a),v=fn5(u,p);ln5(v,fn5(a,h));var d=g,E=an5(v,d),y=an5(d,d),S=E*E-y*(an5(v,v)-1);if(!(S<0)){var m=w11(S),M=fn5(d,(-E-m)/y);if(ln5(M,v),M=on5(M),!e)return M;var x,_=n[0],N=r[0],R=n[1],C=r[1];N<_&&(x=_,_=N,N=x);var P=N-_,A=s12(P-o9)<i12;if(!A&&C<R&&(x=R,R=C,C=x),A||P<i12?A?R+C>0^M[1]<(s12(M[0]-_)<i12?R:C):R<=M[1]&&M[1]<=C:P>o9^(_<=M[0]&&M[0]<=N)){var $=fn5(d,(-E+m)/y);return ln5($,v),[M,on5($)];}}}function l(t,r){var i=e?n:o9-n,u=0;return t<-i?u|=1:t>i&&(u|=2),r<-i?u|=4:r>i&&(u|=8),u;}return dt5(a,function(n){var t,r,i,f,s;return{lineStart:function(){f=i=!1,s=1;},point:function(p,h){var g,v=[p,h],d=a(p,h),E=e?d?0:l(p,h):d?l(p+(p<0?o9:-o9),h):0;if(!t&&(f=i=d)&&n.lineStart(),d!==i&&(!(g=c(t,v))||ft6(t,g)||ft6(v,g))&&(v[2]=1),d!==i)s=0,d?(n.lineStart(),g=c(v,t),n.point(g[0],g[1])):(g=c(t,v),n.point(g[0],g[1],2),n.lineEnd()),t=g;else if(u&&t&&e^d){var y;E&r||!(y=c(v,t,!0))||(s=0,e?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1],3)));}!d||t&&ft6(t,v)||n.point(v[0],v[1]),t=v,i=d,r=E;},lineEnd:function(){i&&n.lineEnd(),t=null;},clean:function(){return s|(f&&i)<<1;}};},function(t,i,e,o){ut7(o,n,r,e,t,i);},e?[0,-n]:[-o9,n-o9]);}var Mt5,wt5,xt5,_t3,Nt4=1e9,Rt4=-Nt4;function Ct4(n,r,e,o){function u(t,i){return n<=t&&t<=e&&r<=i&&i<=o;}function a(t,i,u,a){var l=0,s=0;if(null==t||(l=c(t,u))!==(s=c(i,u))||f(t,i)<0^u>0)do{a.point(0===l||3===l?n:e,l>1?o:r);}while((l=(l+u+4)%4)!==s)else a.point(i[0],i[1]);}function c(t,o){return s12(t[0]-n)<i12?o>0?0:3:s12(t[0]-e)<i12?o>0?2:1:s12(t[1]-r)<i12?o>0?1:0:o>0?3:2;}function l(n,t){return f(n.x,t.x);}function f(n,t){var r=c(n,1),i=c(t,1);return r!==i?r-i:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0];}return function(i){var c,f,s,p,h,g,v,d,E,y,S,m=i,M=lt7(),w={point:x,lineStart:function(){w.point=_,f&&f.push(s=[]);y=!0,E=!1,v=d=NaN;},lineEnd:function(){c&&(_(p,h),g&&E&&M.rejoin(),c.push(M.result()));w.point=x,E&&m.lineEnd();},polygonStart:function(){m=M,c=[],f=[],S=!0;},polygonEnd:function(){var r=function(){for(var t=0,r=0,i=f.length;r<i;++r)for(var e,u,a=f[r],c=1,l=a.length,s=a[0],p=s[0],h=s[1];c<l;++c)e=p,u=h,p=(s=a[c])[0],h=s[1],u<=o?h>o&&(p-e)*(o-u)>(h-u)*(n-e)&&++t:h<=o&&(p-e)*(o-u)<(h-u)*(n-e)&&--t;return t;}(),e=S&&r,u=(c=gt(c)).length;(e||u)&&(i.polygonStart(),e&&(i.lineStart(),a(null,null,1,i),i.lineEnd()),u&&pt5(c,l,r,a,i),i.polygonEnd());m=i,c=f=s=null;}};function x(n,t){u(n,t)&&m.point(n,t);}function _(t,i){var a=u(t,i);if(f&&s.push([t,i]),y)p=t,h=i,g=a,y=!1,a&&(m.lineStart(),m.point(t,i));else if(a&&E)m.point(t,i);else{var c=[v=Math.max(Rt4,Math.min(Nt4,v)),d=Math.max(Rt4,Math.min(Nt4,d))],l=[t=Math.max(Rt4,Math.min(Nt4,t)),i=Math.max(Rt4,Math.min(Nt4,i))];!function(n,t,r,i,e,o){var u,a=n[0],c=n[1],l=0,f=1,s=t[0]-a,p=t[1]-c;if(u=r-a,s||!(u>0)){if(u/=s,s<0){if(u<l)return;u<f&&(f=u);}else if(s>0){if(u>f)return;u>l&&(l=u);}if(u=e-a,s||!(u<0)){if(u/=s,s<0){if(u>f)return;u>l&&(l=u);}else if(s>0){if(u<l)return;u<f&&(f=u);}if(u=i-c,p||!(u>0)){if(u/=p,p<0){if(u<l)return;u<f&&(f=u);}else if(p>0){if(u>f)return;u>l&&(l=u);}if(u=o-c,p||!(u<0)){if(u/=p,p<0){if(u>f)return;u>l&&(l=u);}else if(p>0){if(u<l)return;u<f&&(f=u);}return l>0&&(n[0]=a+l*s,n[1]=c+l*p),f<1&&(t[0]=a+f*s,t[1]=c+f*p),!0;}}}}}(c,l,n,r,e,o)?a&&(m.lineStart(),m.point(t,i),S=!1):(E||(m.lineStart(),m.point(c[0],c[1])),m.point(l[0],l[1]),a||m.lineEnd(),S=!1);}v=t,d=i,E=a;}return w;};}var At3={sphere:C14,point:C14,lineStart:function(){At3.point=qt5,At3.lineEnd=$t3;},lineEnd:C14,polygonStart:C14,polygonEnd:C14};function $t3(){At3.point=At3.lineEnd=C14;}function qt5(n,t){wt5=n*=f9,xt5=m12(t*=f9),_t3=g11(t),At3.point=zt3;}function zt3(n,t){n*=f9;var r=m12(t*=f9),i=g11(t),e=s12(n-wt5),o=g11(e),u=i*m12(e),a=_t3*r-xt5*i*o,c=xt5*r+_t3*i*o;Mt5.add(h12(w11(u*u+a*a),c)),wt5=n,xt5=r,_t3=i;}function jt5(t){return Mt5=new F1,j13(t,At3),+Mt5;}var Lt3=[null,null],bt5={type:"LineString",coordinates:Lt3};function Gt2(n,t){return Lt3[0]=n,Lt3[1]=t,jt5(bt5);}var Tt3={Sphere:function(){return!0;},Point:function(n,t){return Ft3(n.coordinates,t);},MultiPoint:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)if(Ft3(r[i],t))return!0;return!1;},LineString:function(n,t){return Ht3(n.coordinates,t);},MultiLineString:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)if(Ht3(r[i],t))return!0;return!1;},Polygon:function(n,t){return It4(n.coordinates,t);},MultiPolygon:function(n,t){for(var r=n.coordinates,i=-1,e=r.length;++i<e;)if(It4(r[i],t))return!0;return!1;},GeometryCollection:function(n,t){for(var r=n.geometries,i=-1,e=r.length;++i<e;)if(kt5(r[i],t))return!0;return!1;}};function kt5(n,t){return!(!n||!Tt3.hasOwnProperty(n.type))&&Tt3[n.type](n,t);}function Ft3(n,t){return 0===Gt2(n,t);}function Ht3(n,t){for(var r,i,o,u=0,a=n.length;u<a;u++){if(0===(i=Gt2(n[u],t)))return!0;if(u>0&&(o=Gt2(n[u],n[u-1]))>0&&r<=o&&i<=o&&(r+i-o)*(1-Math.pow((r-i)/o,2))<e10*o)return!0;r=i;}return!1;}function It4(n,t){return!!vt5(n.map(Wt3),Xt2(t));}function Wt3(n){return(n=n.map(Xt2)).pop(),n;}function Xt2(n){return[n[0]*f9,n[1]*f9];}function Bt4(n,t,e){var o=Nt(n,t-i12,e).concat(t);return function(n){return o.map(function(t){return[n,t];});};}function Dt5(n,t,e){var o=Nt(n,t-i12,e).concat(t);return function(n){return o.map(function(t){return[t,n];});};}function Ut4(){var n,t,e,o,u,a,c,l,f,p,h,g,d=10,E=d,y=90,S=360,m=2.5;function M(){return{type:"MultiLineString",coordinates:w()};}function w(){return Nt(v12(o/y)*y,e,y).map(h).concat(Nt(v12(l/S)*S,c,S).map(g)).concat(Nt(v12(t/d)*d,n,d).filter(function(n){return s12(n%y)>i12;}).map(f)).concat(Nt(v12(a/E)*E,u,E).filter(function(n){return s12(n%S)>i12;}).map(p));}return M.lines=function(){return w().map(function(n){return{type:"LineString",coordinates:n};});},M.outline=function(){return{type:"Polygon",coordinates:[h(o).concat(g(c).slice(1),h(e).reverse().slice(1),g(l).reverse().slice(1))]};},M.extent=function(n){return arguments.length?M.extentMajor(n).extentMinor(n):M.extentMinor();},M.extentMajor=function(n){return arguments.length?(o=+n[0][0],e=+n[1][0],l=+n[0][1],c=+n[1][1],o>e&&(n=o,o=e,e=n),l>c&&(n=l,l=c,c=n),M.precision(m)):[[o,l],[e,c]];},M.extentMinor=function(r){return arguments.length?(t=+r[0][0],n=+r[1][0],a=+r[0][1],u=+r[1][1],t>n&&(r=t,t=n,n=r),a>u&&(r=a,a=u,u=r),M.precision(m)):[[t,a],[n,u]];},M.step=function(n){return arguments.length?M.stepMajor(n).stepMinor(n):M.stepMinor();},M.stepMajor=function(n){return arguments.length?(y=+n[0],S=+n[1],M):[y,S];},M.stepMinor=function(n){return arguments.length?(d=+n[0],E=+n[1],M):[d,E];},M.precision=function(r){return arguments.length?(m=+r,f=Bt4(a,u,90),p=Dt5(t,n,m),h=Bt4(l,c,90),g=Dt5(o,e,m),M):m;},M.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]]);}var Kt3,Qt2,Vt2,nr1,tr1=n=>n,rr1=new F1,ir1=new F1,er1={point:C14,lineStart:C14,lineEnd:C14,polygonStart:function(){er1.lineStart=or1,er1.lineEnd=cr1;},polygonEnd:function(){er1.lineStart=er1.lineEnd=er1.point=C14,rr1.add(s12(ir1)),ir1=new F1;},result:function(){var t=rr1/2;return rr1=new F1,t;}};function or1(){er1.point=ur1;}function ur1(n,t){er1.point=ar1,Kt3=Vt2=n,Qt2=nr1=t;}function ar1(n,t){ir1.add(nr1*n-Vt2*t),Vt2=n,nr1=t;}function cr1(){ar1(Kt3,Qt2);}var lr1=1/0,fr1=lr1,sr1=-lr1,pr1=sr1,hr1={point:function(n,t){n<lr1&&(lr1=n);n>sr1&&(sr1=n);t<fr1&&(fr1=t);t>pr1&&(pr1=t);},lineStart:C14,lineEnd:C14,polygonStart:C14,polygonEnd:C14,result:function(){var n=[[lr1,fr1],[sr1,pr1]];return sr1=pr1=-(fr1=lr1=1/0),n;}};var gr1,vr1,dr1,Er1,yr1=0,Sr1=0,mr1=0,Mr1=0,wr1=0,xr1=0,_r1=0,Nr1=0,Rr1=0,Cr1={point:Pr1,lineStart:Ar1,lineEnd:zr1,polygonStart:function(){Cr1.lineStart=jr,Cr1.lineEnd=Lr1;},polygonEnd:function(){Cr1.point=Pr1,Cr1.lineStart=Ar1,Cr1.lineEnd=zr1;},result:function(){var n=Rr1?[_r1/Rr1,Nr1/Rr1]:xr1?[Mr1/xr1,wr1/xr1]:mr1?[yr1/mr1,Sr1/mr1]:[NaN,NaN];return yr1=Sr1=mr1=Mr1=wr1=xr1=_r1=Nr1=Rr1=0,n;}};function Pr1(n,t){yr1+=n,Sr1+=t,++mr1;}function Ar1(){Cr1.point=$r;}function $r(n,t){Cr1.point=qr,Pr1(dr1=n,Er1=t);}function qr(n,t){var r=n-dr1,i=t-Er1,e=w11(r*r+i*i);Mr1+=e*(dr1+n)/2,wr1+=e*(Er1+t)/2,xr1+=e,Pr1(dr1=n,Er1=t);}function zr1(){Cr1.point=Pr1;}function jr(){Cr1.point=br1;}function Lr1(){Gr(gr1,vr1);}function br1(n,t){Cr1.point=Gr,Pr1(gr1=dr1=n,vr1=Er1=t);}function Gr(n,t){var r=n-dr1,i=t-Er1,e=w11(r*r+i*i);Mr1+=e*(dr1+n)/2,wr1+=e*(Er1+t)/2,xr1+=e,_r1+=(e=Er1*n-dr1*t)*(dr1+n),Nr1+=e*(Er1+t),Rr1+=3*e,Pr1(dr1=n,Er1=t);}function Or1(n){this._context=n;}Or1.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this;},polygonStart:function(){this._line=0;},polygonEnd:function(){this._line=NaN;},lineStart:function(){this._point=0;},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN;},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,c10);}},result:C14};var Tr1,kr1,Fr,Hr,Ir1,Wr=new F1,Xr={point:C14,lineStart:function(){Xr.point=Yr;},lineEnd:function(){Tr1&&Br(kr1,Fr),Xr.point=C14;},polygonStart:function(){Tr1=!0;},polygonEnd:function(){Tr1=null;},result:function(){var t=+Wr;return Wr=new F1,t;}};function Yr(n,t){Xr.point=Br,kr1=Hr=n,Fr=Ir1=t;}function Br(n,t){Hr-=n,Ir1-=t,Wr.add(w11(Hr*Hr+Ir1*Ir1)),Hr=n,Ir1=t;}let Dr1,Ur,Zr,Jr;class Kr{constructor(n){this._append=null==n?Qr:function(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return Qr;if(t!==Dr1){const n=10**t;Dr1=t,Ur=function(t){let r=1;this._+=t[0];for(const i=t.length;r<i;++r)this._+=Math.round(arguments[r]*n)/n+t[r];};}return Ur;}(n),this._radius=4.5,this._="";}pointRadius(n){return this._radius=+n,this;}polygonStart(){this._line=0;}polygonEnd(){this._line=NaN;}lineStart(){this._point=0;}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN;}point(n,t){switch(this._point){case 0:this._append`M${n},${t}`,this._point=1;break;case 1:this._append`L${n},${t}`;break;default:if(this._append`M${n},${t}`,this._radius!==Zr||this._append!==Ur){const n=this._radius,t=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,Zr=n,Ur=this._append,Jr=this._,this._=t;}this._+=Jr;}}result(){const n=this._;return this._="",n.length?n:null;}}function Qr(n){let t=1;this._+=n[0];for(const r=n.length;t<r;++t)this._+=arguments[t]+n[t];}function Vr(n,t){let r,i,e=3,o=4.5;function u(n){return n&&("function"==typeof o&&i.pointRadius(+o.apply(this,arguments)),j13(n,r(i))),i.result();}return u.area=function(n){return j13(n,r(er1)),er1.result();},u.measure=function(n){return j13(n,r(Xr)),Xr.result();},u.bounds=function(n){return j13(n,r(hr1)),hr1.result();},u.centroid=function(n){return j13(n,r(Cr1)),Cr1.result();},u.projection=function(t){return arguments.length?(r=null==t?(n=null,tr1):(n=t).stream,u):n;},u.context=function(n){return arguments.length?(i=null==n?(t=null,new Kr(e)):new Or1(t=n),"function"!=typeof o&&i.pointRadius(o),u):t;},u.pointRadius=function(n){return arguments.length?(o="function"==typeof n?n:(i.pointRadius(+n),+n),u):o;},u.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t;}return null===t&&(i=new Kr(e)),u;},u.projection(n).digits(e).context(t);}function ti1(n){return function(t){var r=new ri1;for(var i in n)r[i]=n[i];return r.stream=t,r;};}function ri1(){}function ii1(n,t,r){var i=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),null!=i&&n.clipExtent(null),j13(r,n.stream(hr1)),t(hr1.result()),null!=i&&n.clipExtent(i),n;}function ei1(n,t,r){return ii1(n,function(r){var i=t[1][0]-t[0][0],e=t[1][1]-t[0][1],o=Math.min(i/(r[1][0]-r[0][0]),e/(r[1][1]-r[0][1])),u=+t[0][0]+(i-o*(r[1][0]+r[0][0]))/2,a=+t[0][1]+(e-o*(r[1][1]+r[0][1]))/2;n.scale(150*o).translate([u,a]);},r);}function oi1(n,t,r){return ei1(n,[[0,0],t],r);}function ui1(n,t,r){return ii1(n,function(r){var i=+t,e=i/(r[1][0]-r[0][0]),o=(i-e*(r[1][0]+r[0][0]))/2,u=-e*r[0][1];n.scale(150*e).translate([o,u]);},r);}function ai1(n,t,r){return ii1(n,function(r){var i=+t,e=i/(r[1][1]-r[0][1]),o=-e*r[0][0],u=(i-e*(r[1][1]+r[0][1]))/2;n.scale(150*e).translate([o,u]);},r);}ri1.prototype={constructor:ri1,point:function(n,t){this.stream.point(n,t);},sphere:function(){this.stream.sphere();},lineStart:function(){this.stream.lineStart();},lineEnd:function(){this.stream.lineEnd();},polygonStart:function(){this.stream.polygonStart();},polygonEnd:function(){this.stream.polygonEnd();}};var ci1=g11(30*f9);function li1(n,t){return+t?function(n,t){function r(e,o,u,a,c,l,f,p,g,v,d,E,y,S){var m=f-e,M=p-o,x=m*m+M*M;if(x>4*t&&y--){var _=a+v,R=c+d,C=l+E,P=w11(_*_+R*R+C*C),A=N14(C/=P),$=s12(s12(C)-1)<i12||s12(u-g)<i12?(u+g)/2:h12(R,_),q=n($,A),z=q[0],j=q[1],L=z-e,b=j-o,G=M*L-m*b;(G*G/x>t||s12((m*L+M*b)/x-.5)>.3||a*v+c*d+l*E<ci1)&&(r(e,o,u,a,c,l,z,j,$,_/=P,R/=P,C,y,S),S.point(z,j),r(z,j,$,_,R,C,f,p,g,v,d,E,y,S));}}return function(t){var i,e,o,u,a,c,l,f,s,p,h,g,v={point:d,lineStart:E,lineEnd:S,polygonStart:function(){t.polygonStart(),v.lineStart=m;},polygonEnd:function(){t.polygonEnd(),v.lineStart=E;}};function d(r,i){r=n(r,i),t.point(r[0],r[1]);}function E(){f=NaN,v.point=y,t.lineStart();}function y(i,e){var o=un5([i,e]),u=n(i,e);r(f,s,l,p,h,g,f=u[0],s=u[1],l=i,p=o[0],h=o[1],g=o[2],16,t),t.point(f,s);}function S(){v.point=d,t.lineEnd();}function m(){E(),v.point=M,v.lineEnd=w;}function M(n,t){y(i=n,t),e=f,o=s,u=p,a=h,c=g,v.point=y;}function w(){r(f,s,l,p,h,g,e,o,i,u,a,c,16,t),v.lineEnd=S,S();}return v;};}(n,t):function(n){return ti1({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1]);}});}(n);}var fi1=ti1({point:function(n,t){this.stream.point(n*f9,t*f9);}});function si1(n,t,r,i,e,o){if(!o)return function(n,t,r,i,e){function o(o,u){return[t+n*(o*=i),r-n*(u*=e)];}return o.invert=function(o,u){return[(o-t)/n*i,(r-u)/n*e];},o;}(n,t,r,i,e);var u=g11(o),a=m12(o),c=u*n,l=a*n,f=u/n,s=a/n,p=(a*r-u*t)/n,h=(a*t+u*r)/n;function v(n,o){return[c*(n*=i)-l*(o*=e)+t,r-l*n-c*o];}return v.invert=function(n,t){return[i*(f*n-s*t+p),e*(h-s*n-f*t)];},v;}function pi1(n){return hi1(function(){return n;})();}function hi1(n){var t,r,i,e,o,u,a,c,s,p,h=150,g=480,v=250,d=0,E=0,y=0,S=0,m=0,M=0,x=1,_=1,N=null,R=St4,C=null,P=tr1,A=.5;function $(n){return c(n[0]*f9,n[1]*f9);}function q(n){return(n=c.invert(n[0],n[1]))&&[n[0]*l11,n[1]*l11];}function z(){var n=si1(h,0,0,x,_,M).apply(null,t(d,E)),i=si1(h,g-n[0],v-n[1],x,_,M);return r=tt8(y,S,m),a=Vn3(t,i),c=Vn3(r,a),u=li1(a,A),j();}function j(){return s=p=null,$;}return $.stream=function(n){return s&&p===n?s:s=fi1((function(n){return ti1({point:function(t,r){var i=n(t,r);return this.stream.point(i[0],i[1]);}});})(r)(R(u(P(p=n)))));},$.preclip=function(n){return arguments.length?(R=n,N=void 0,j()):R;},$.postclip=function(n){return arguments.length?(P=n,C=i=e=o=null,j()):P;},$.clipAngle=function(n){return arguments.length?(R=+n?mt5(N=n*f9):(N=null,St4),j()):N*l11;},$.clipExtent=function(n){return arguments.length?(P=null==n?(C=i=e=o=null,tr1):Ct4(C=+n[0][0],i=+n[0][1],e=+n[1][0],o=+n[1][1]),j()):null==C?null:[[C,i],[e,o]];},$.scale=function(n){return arguments.length?(h=+n,z()):h;},$.translate=function(n){return arguments.length?(g=+n[0],v=+n[1],z()):[g,v];},$.center=function(n){return arguments.length?(d=n[0]%360*f9,E=n[1]%360*f9,z()):[d*l11,E*l11];},$.rotate=function(n){return arguments.length?(y=n[0]%360*f9,S=n[1]%360*f9,m=n.length>2?n[2]%360*f9:0,z()):[y*l11,S*l11,m*l11];},$.angle=function(n){return arguments.length?(M=n%360*f9,z()):M*l11;},$.reflectX=function(n){return arguments.length?(x=n?-1:1,z()):x<0;},$.reflectY=function(n){return arguments.length?(_=n?-1:1,z()):_<0;},$.precision=function(n){return arguments.length?(u=li1(a,A=n*n),j()):w11(A);},$.fitExtent=function(n,t){return ei1($,n,t);},$.fitSize=function(n,t){return oi1($,n,t);},$.fitWidth=function(n,t){return ui1($,n,t);},$.fitHeight=function(n,t){return ai1($,n,t);},function(){return t=n.apply(this,arguments),$.invert=t.invert&&q,z();};}function gi1(n){var t=0,r=o9/3,i=hi1(n),e=i(t,r);return e.parallels=function(n){return arguments.length?i(t=n[0]*f9,r=n[1]*f9):[t*l11,r*l11];},e;}function vi1(n,t){var r=m12(n),e=(r+m12(t))/2;if(s12(e)<i12)return function(n){var t=g11(n);function r(n,r){return[n*t,m12(r)/t];}return r.invert=function(n,r){return[n/t,N14(r*t)];},r;}(n);var u=1+r*(2*e-r),a=w11(u)/e;function c(n,t){var r=w11(u-2*e*m12(t))/e;return[r*m12(n*=e),a-r*g11(n)];}return c.invert=function(n,t){var r=a-t,i=h12(n,s12(r))*M12(r);return r*e<0&&(i-=o9*M12(n)*M12(r)),[i/e,N14((u-(n*n+r*r)*e*e)/(2*e))];},c;}function di1(){return gi1(vi1).scale(155.424).center([0,33.6442]);}function Ei1(){return di1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7]);}function yi1(){var n,t,r,e,o,u,a=Ei1(),c=di1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=di1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),f={point:function(n,t){u=[n,t];}};function s(n){var t=n[0],i=n[1];return u=null,r.point(t,i),u||(e.point(t,i),u)||(o.point(t,i),u);}function p(){return n=t=null,s;}return s.invert=function(n){var t=a.scale(),r=a.translate(),i=(n[0]-r[0])/t,e=(n[1]-r[1])/t;return(e>=.12&&e<.234&&i>=-.425&&i<-.214?c:e>=.166&&e<.234&&i>=-.214&&i<-.115?l:a).invert(n);},s.stream=function(r){return n&&t===r?n:(i=[a.stream(t=r),c.stream(r),l.stream(r)],e=i.length,n={point:function(n,t){for(var r=-1;++r<e;)i[r].point(n,t);},sphere:function(){for(var n=-1;++n<e;)i[n].sphere();},lineStart:function(){for(var n=-1;++n<e;)i[n].lineStart();},lineEnd:function(){for(var n=-1;++n<e;)i[n].lineEnd();},polygonStart:function(){for(var n=-1;++n<e;)i[n].polygonStart();},polygonEnd:function(){for(var n=-1;++n<e;)i[n].polygonEnd();}});var i,e;},s.precision=function(n){return arguments.length?(a.precision(n),c.precision(n),l.precision(n),p()):a.precision();},s.scale=function(n){return arguments.length?(a.scale(n),c.scale(.35*n),l.scale(n),s.translate(a.translate())):a.scale();},s.translate=function(n){if(!arguments.length)return a.translate();var t=a.scale(),u=+n[0],s=+n[1];return r=a.translate(n).clipExtent([[u-.455*t,s-.238*t],[u+.455*t,s+.238*t]]).stream(f),e=c.translate([u-.307*t,s+.201*t]).clipExtent([[u-.425*t+i12,s+.12*t+i12],[u-.214*t-i12,s+.234*t-i12]]).stream(f),o=l.translate([u-.205*t,s+.212*t]).clipExtent([[u-.214*t+i12,s+.166*t+i12],[u-.115*t-i12,s+.234*t-i12]]).stream(f),p();},s.fitExtent=function(n,t){return ei1(s,n,t);},s.fitSize=function(n,t){return oi1(s,n,t);},s.fitWidth=function(n,t){return ui1(s,n,t);},s.fitHeight=function(n,t){return ai1(s,n,t);},s.scale(1070);}function Si1(n){return function(t,r){var i=g11(t),e=g11(r),o=n(i*e);return o===1/0?[2,0]:[o*e*m12(t),o*m12(r)];};}function mi1(n){return function(t,r){var i=w11(t*t+r*r),e=n(i),o=m12(e),u=g11(e);return[h12(t*o,i*u),N14(i&&r*o/i)];};}var Mi1=Si1(function(n){return w11(2/(1+n));});function wi1(){return pi1(Mi1).scale(124.75).clipAngle(179.999);}Mi1.invert=mi1(function(n){return 2*N14(n/2);});var xi1=Si1(function(n){return(n=_12(n))&&n/m12(n);});function _i1(){return pi1(xi1).scale(79.4188).clipAngle(179.999);}function Ni1(n,t){return[n,y9(x12((u12+t)/2))];}function Ri1(){return Ci1(Ni1).scale(961/c10);}function Ci1(n){var t,r,i,e=pi1(n),u=e.center,a=e.scale,c=e.translate,l=e.clipExtent,f=null;function s(){var u=o9*a(),c=e(ot7(e.rotate()).invert([0,0]));return l(null==f?[[c[0]-u,c[1]-u],[c[0]+u,c[1]+u]]:n===Ni1?[[Math.max(c[0]-u,f),t],[Math.min(c[0]+u,r),i]]:[[f,Math.max(c[1]-u,t)],[r,Math.min(c[1]+u,i)]]);}return e.scale=function(n){return arguments.length?(a(n),s()):a();},e.translate=function(n){return arguments.length?(c(n),s()):c();},e.center=function(n){return arguments.length?(u(n),s()):u();},e.clipExtent=function(n){return arguments.length?(null==n?f=t=r=i=null:(f=+n[0][0],t=+n[0][1],r=+n[1][0],i=+n[1][1]),s()):null==f?null:[[f,t],[r,i]];},s();}function Pi1(n){return x12((u12+n)/2);}function Ai1(n,t){var r=g11(n),e=n===t?m12(n):y9(r/g11(t))/y9(Pi1(t)/Pi1(n)),a=r*S13(Pi1(n),e)/e;if(!e)return Ni1;function c(n,t){a>0?t<-u12+i12&&(t=-u12+i12):t>u12-i12&&(t=u12-i12);var r=a/S13(Pi1(t),e);return[r*m12(e*n),a-r*g11(e*n)];}return c.invert=function(n,t){var r=a-t,i=M12(e)*w11(n*n+r*r),c=h12(n,s12(r))*M12(r);return r*e<0&&(c-=o9*M12(n)*M12(r)),[c/e,2*p12(S13(a/i,1/e))-u12];},c;}function $i1(){return gi1(Ai1).scale(109.5).parallels([30,30]);}function qi1(n,t){return[n,t];}function zi1(){return pi1(qi1).scale(152.63);}function ji1(n,t){var r=g11(n),e=n===t?m12(n):(r-g11(t))/(t-n),u=r/e+n;if(s12(e)<i12)return qi1;function a(n,t){var r=u-t,i=e*n;return[r*m12(i),u-r*g11(i)];}return a.invert=function(n,t){var r=u-t,i=h12(n,s12(r))*M12(r);return r*e<0&&(i-=o9*M12(n)*M12(r)),[i/e,u-M12(e)*w11(n*n+r*r)];},a;}function Li1(){return gi1(ji1).scale(131.154).center([0,13.9389]);}xi1.invert=mi1(function(n){return n;}),Ni1.invert=function(n,t){return[n,2*p12(d10(t))-u12];},qi1.invert=qi1;var bi1=1.340264,Gi1=-.081106,Oi1=893e-6,Ti1=.003796,ki1=w11(3)/2;function Fi1(n,t){var r=N14(ki1*m12(t)),i=r*r,e=i*i*i;return[n*g11(r)/(ki1*(bi1+3*Gi1*i+e*(7*Oi1+9*Ti1*i))),r*(bi1+Gi1*i+e*(Oi1+Ti1*i))];}function Hi1(){return pi1(Fi1).scale(177.158);}function Ii1(n,t){var r=g11(t),i=g11(n)*r;return[r*m12(n)/i,m12(t)/i];}function Wi1(){return pi1(Ii1).scale(144.049).clipAngle(60);}function Xi1(){var n,t,r,i,e,o,u,a=1,c=0,s=0,p=1,h=1,v=0,d=null,E=1,y=1,S=ti1({point:function(n,t){var r=x([n,t]);this.stream.point(r[0],r[1]);}}),M=tr1;function w(){return E=a*p,y=a*h,o=u=null,x;}function x(r){var i=r[0]*E,e=r[1]*y;if(v){var o=e*n-i*t;i=i*n+e*t,e=o;}return[i+c,e+s];}return x.invert=function(r){var i=r[0]-c,e=r[1]-s;if(v){var o=e*n+i*t;i=i*n-e*t,e=o;}return[i/E,e/y];},x.stream=function(n){return o&&u===n?o:o=S(M(u=n));},x.postclip=function(n){return arguments.length?(M=n,d=r=i=e=null,w()):M;},x.clipExtent=function(n){return arguments.length?(M=null==n?(d=r=i=e=null,tr1):Ct4(d=+n[0][0],r=+n[0][1],i=+n[1][0],e=+n[1][1]),w()):null==d?null:[[d,r],[i,e]];},x.scale=function(n){return arguments.length?(a=+n,w()):a;},x.translate=function(n){return arguments.length?(c=+n[0],s=+n[1],w()):[c,s];},x.angle=function(r){return arguments.length?(t=m12(v=r%360*f9),n=g11(v),w()):v*l11;},x.reflectX=function(n){return arguments.length?(p=n?-1:1,w()):p<0;},x.reflectY=function(n){return arguments.length?(h=n?-1:1,w()):h<0;},x.fitExtent=function(n,t){return ei1(x,n,t);},x.fitSize=function(n,t){return oi1(x,n,t);},x.fitWidth=function(n,t){return ui1(x,n,t);},x.fitHeight=function(n,t){return ai1(x,n,t);},x;}function Yi1(n,t){var r=t*t,i=r*r;return[n*(.8707-.131979*r+i*(i*(.003971*r-.001529*i)-.013791)),t*(1.007226+r*(.015085+i*(.028874*r-.044475-.005916*i)))];}function Bi1(){return pi1(Yi1).scale(175.295);}function Di1(n,t){return[g11(t)*m12(n),m12(t)];}function Ui1(){return pi1(Di1).scale(249.5).clipAngle(90.000001);}function Zi1(n,t){var r=g11(t),i=1+g11(n)*r;return[r*m12(n)/i,m12(t)/i];}function Ji1(){return pi1(Zi1).scale(250).clipAngle(142);}function Ki1(n,t){return[y9(x12((u12+t)/2)),-n];}function Qi1(){var n=Ci1(Ki1),t=n.center,r=n.rotate;return n.center=function(n){return arguments.length?t([-n[1],n[0]]):[(n=t())[1],-n[0]];},n.rotate=function(n){return arguments.length?r([n[0],n[1],n.length>2?n[2]+90:90]):[(n=r())[0],n[1],n[2]-90];},r([0,0,90]).scale(159.155);}Fi1.invert=function(n,t){for(var r,i=t,o=i*i,u=o*o*o,a=0;a<12&&(u=(o=(i-=r=(i*(bi1+Gi1*o+u*(Oi1+Ti1*o))-t)/(bi1+3*Gi1*o+u*(7*Oi1+9*Ti1*o)))*i)*o*o,!(s12(r)<e10));++a);return[ki1*n*(bi1+3*Gi1*o+u*(7*Oi1+9*Ti1*o))/g11(i),N14(m12(i)/ki1)];},Ii1.invert=mi1(p12),Yi1.invert=function(n,t){var r,e=t,o=25;do{var u=e*e,a=u*u;e-=r=(e*(1.007226+u*(.015085+a*(.028874*u-.044475-.005916*a)))-t)/(1.007226+u*(.045255+a*(.259866*u-.311325-.005916*11*a)));}while(s12(r)>i12&&--o>0)return[n/(.8707+(u=e*e)*(u*(u*u*u*(.003971-.001529*u)-.013791)-.131979)),e];},Di1.invert=mi1(N14),Zi1.invert=mi1(function(n){return 2*p12(n);}),Ki1.invert=function(n,t){return[-t,2*p12(d10(n))-u12];};var d11=Math.abs,w12=Math.atan,y10=Math.atan2,m13=Math.cos,b12=Math.exp,R13=Math.floor,M13=Math.log,E16=Math.max,P13=Math.min,k13=Math.pow,x13=Math.sign||function(n){return n>0?1:n<0?-1:0;},A16=Math.sin,G15=Math.tan,C15=1e-6,F14=1e-12,N15=Math.PI,L13=N15/2,H15=N15/4,z16=Math.SQRT1_2,B15=V14(2),W16=V14(N15),j14=2*N15,D13=180/N15,I13=N15/180;function T13(n){return n>1?L13:n<-1?-L13:Math.asin(n);}function Q13(n){return n>1?0:n<-1?N15:Math.acos(n);}function V14(n){return n>0?Math.sqrt(n):0;}function q13(n){return(b12(n)-b12(-n))/2;}function K17(n){return(b12(n)+b12(-n))/2;}function J17(n,r){var e=m13(r),t=function(n){return n?n/Math.sin(n):1;}(Q13(e*m13(n/=2)));return[2*e*A16(n)*t,A16(r)*t];}function Z17(n,r){var e=G15(r/2),t=V14(1-e*e),a=1+t*m13(n/=2),o=A16(n)*t/a,i=e/a,u=o*o,c=i*i;return[4/3*o*(3+u-3*c),4/3*i*(3+3*u-c)];}J17.invert=function(n,r){if(!(n*n+4*r*r>N15*N15+C15)){var e=n,t=r,a=25;do{var o,i=A16(e),u=A16(e/2),c=m13(e/2),f=A16(t),l=m13(t),s=A16(2*t),v=f*f,g=l*l,p=u*u,h=1-g*c*c,w=h?Q13(l*c)*V14(o=1/h):o=0,y=2*w*l*u-n,b=w*f-r,R=o*(g*p+w*l*c*v),M=o*(.5*i*s-2*w*f*u),E=.25*o*(s*u-w*f*g*i),P=o*(v*c+w*p*l),k=M*E-P*R;if(!k)break;var S=(b*M-y*P)/k,x=(y*E-b*R)/k;e-=S,t-=x;}while((d11(S)>C15||d11(x)>C15)&&--a>0)return[e,t];}},Z17.invert=function(n,r){if(r*=3/8,!(n*=3/8)&&d11(r)>1)return null;var e=1+n*n+r*r,t=V14((e-V14(e*e-4*r*r))/2),a=T13(t)/3,o=t?function(n){return M13(n+V14(n*n-1));}(d11(r/t))/3:function(n){return M13(n+V14(n*n+1));}(d11(n))/3,i=m13(a),u=K17(o),c=u*u-i*i;return[2*x13(n)*y10(q13(o)*i,.25-c),2*x13(r)*y10(u*A16(a),.25+c)];};var nn6=V14(8),rn6=M13(1+B15);function en6(n,r){var e=d11(r);return e<H15?[n,M13(G15(H15+r/2))]:[n*m13(e)*(2*B15-1/A16(e)),x13(r)*(2*B15*(e-H15)-M13(G15(e/2)))];}function cn6(n,r){return[n*m13(r)/m13(r/=2),2*A16(r)];}function ln6(n,r,e){var t,a,o,i=100;e=void 0===e?0:+e,r=+r;do{(a=n(e))===(o=n(e+C15))&&(o=a+C15),e-=t=-1e-6*(a-r)/(a-o);}while(i-- >0&&d11(t)>C15)return i<0?NaN:e;}function pn5(n,r){var e,t=n*A16(r),a=30;do{r-=e=(r+A16(r)-t)/(1+m13(r));}while(d11(e)>C15&&--a>0)return r/2;}function hn6(n,r,e){function t(t,a){return[n*t*m13(a=pn5(e,a)),r*A16(a)];}return t.invert=function(t,a){return a=T13(a/r),[t/(n*m13(a)),T13((2*a+A16(2*a))/e)];},t;}en6.invert=function(n,r){if((t=d11(r))<rn6)return[n,2*w12(b12(r))-L13];var e,t,a=H15,o=25;do{var i=m13(a/2),u=G15(a/2);a-=e=(nn6*(a-H15)-M13(u)-t)/(nn6-i*i/(2*u));}while(d11(e)>F14&&--o>0)return[n/(m13(a)*(nn6-1/A16(a))),x13(r)*a];},cn6.invert=function(n,r){var e=2*T13(r/2);return[n*m13(e/2)/m13(e),e];};var dn5=hn6(B15/L13,B15,N15);function wn5(){return pi1(dn5).scale(169.529);}var yn5=2.00276,mn5=1.11072;function bn5(n,r){var e=pn5(N15,r);return[yn5*n/(1/m13(r)+mn5/m13(e)),(r+B15*A16(e))/yn5];}function En4(n,r){return[n*m13(r),r];}bn5.invert=function(n,r){var e,t,a=yn5*r,o=r<0?-H15:H15,i=25;do{t=a-B15*A16(o),o-=e=(A16(2*o)+2*o-N15*A16(t))/(2*m13(2*o)+2+N15*m13(t)*B15*m13(o));}while(d11(e)>C15&&--i>0)return t=a-B15*A16(o),[n*(1/m13(t)+mn5/m13(o))/yn5,t];},En4.invert=function(n,r){return[n/m13(r),r];};hn6(1,4/N15,N15);function jn5(n,r){var e=V14(1-A16(r));return[2/W16*n*e,W16*(1-e)];}jn5.invert=function(n,r){var e=(e=r/W16-1)*e;return[e>0?n*V14(N15/e)/2:0,T13(1-e)];};var Qn2=V14(3);function Vn4(n,r){return[Qn2*n*(2*m13(2*r/3)-1)/W16,Qn2*W16*A16(r/3)];}function Kn3(n){var r=m13(n);function e(n,e){return[n*r,A16(e)/r];}return e.invert=function(n,e){return[n/r,T13(e*r)];},e;}function On4(n,r){var e=V14(8/(3*N15));return[e*n*(1-d11(r)/N15),e*r];}function Yn3(n,r){var e=V14(4-3*A16(d11(r)));return[2/V14(6*N15)*n*e,x13(r)*V14(2*N15/3)*(2-e)];}function $n2(n,r){var e=V14(N15*(4+N15));return[2/e*n*(1+V14(1-4*r*r/(N15*N15))),4/e*r];}function rr2(n,r){var e=(2+L13)*A16(r);r/=2;for(var t=0,a=1/0;t<10&&d11(a)>C15;t++){var o=m13(r);r-=a=(r+A16(r)*(o+2)-e)/(2*o*(1+o));}return[2/V14(N15*(4+N15))*n*(1+m13(r)),2*V14(N15/(4+N15))*A16(r)];}function tr2(n,r){return[n*(1+m13(r))/V14(2+N15),2*r/V14(2+N15)];}function or2(n,r){for(var e=(1+L13)*A16(r),t=0,a=1/0;t<10&&d11(a)>C15;t++)r-=a=(r+A16(r)-e)/(1+m13(r));return e=V14(2+N15),[n*(1+m13(r))/e,2*r/e];}Vn4.invert=function(n,r){var e=3*T13(r/(Qn2*W16));return[W16*n/(Qn2*(2*m13(2*e/3)-1)),e];},On4.invert=function(n,r){var e=V14(8/(3*N15)),t=r/e;return[n/(e*(1-d11(t)/N15)),t];},Yn3.invert=function(n,r){var e=2-d11(r)/V14(2*N15/3);return[n*V14(6*N15)/(2*e),x13(r)*T13((4-e*e)/3)];},$n2.invert=function(n,r){var e=V14(N15*(4+N15))/2;return[n*e/(1+V14(1-r*r*(4+N15)/(4*N15))),r*e/2];},rr2.invert=function(n,r){var e=r*V14((4+N15)/N15)/2,t=T13(e),a=m13(t);return[n/(2/V14(N15*(4+N15))*(1+a)),T13((t+e*(a+2))/(2+L13))];},tr2.invert=function(n,r){var e=V14(2+N15),t=r*e/2;return[e*n/(1+m13(t)),t];},or2.invert=function(n,r){var e=1+L13,t=V14(e/2);return[2*n*t/(1+m13(r*=t)),T13((r+A16(r))/e)];};var ur2=3+2*B15;function cr2(n,r){var e=A16(n/=2),t=m13(n),a=V14(m13(r)),o=m13(r/=2),i=A16(r)/(o+B15*t*a),u=V14(2/(1+i*i)),c=V14((B15*o+(t+e)*a)/(B15*o+(t-e)*a));return[ur2*(u*(c-1/c)-2*M13(c)),ur2*(u*i*(c+1/c)-2*w12(i))];}cr2.invert=function(n,r){if(!(e=Z17.invert(n/1.2,1.065*r)))return null;var e,t=e[0],a=e[1],o=20;n/=ur2,r/=ur2;do{var i=t/2,u=a/2,c=A16(i),f=m13(i),l=A16(u),s=m13(u),v=m13(a),g=V14(v),p=l/(s+B15*f*g),h=p*p,y=V14(2/(1+h)),b=(B15*s+(f+c)*g)/(B15*s+(f-c)*g),R=V14(b),k=R-1/R,S=R+1/R,x=y*k-2*M13(R)-n,G=y*p*S-2*w12(p)-r,F=l&&z16*g*c*h/l,N=(B15*f*s+g)/(2*(s+B15*f*g)*(s+B15*f*g)*g),H=-.5*p*y*y*y,W=H*F,j=H*N,D=(D=2*s+B15*g*(f-c))*D*R,I=(B15*f*s*g+v)/D,T=-B15*c*l/(g*D),Q=k*W-2*I/R+y*(I+I/b),q=k*j-2*T/R+y*(T+T/b),K=p*S*W-2*F/(1+h)+y*S*F+y*p*(I-I/b),U=p*S*j-2*N/(1+h)+y*S*N+y*p*(T-T/b),_=q*K-U*Q;if(!_)break;var J=(G*q-x*U)/_,O=(x*K-G*Q)/_;t-=J,a=E16(-L13,P13(L13,a-O));}while((d11(J)>C15||d11(O)>C15)&&--o>0)return d11(d11(a)-L13)<C15?[0,a]:o&&[t,a];};var lr2=m13(35*I13);function sr2(n,r){var e=G15(r/2);return[n*lr2*V14(1-e*e),(1+lr2)*e];}function gr2(n,r){var e=r/2,t=m13(e);return[2*n/W16*m13(r)*t*t,W16*G15(e)];}function Pr2(n,r,e,t,a,o,i,u){function c(c,f){if(!f)return[n*c/N15,0];var l=f*f,s=n+l*(r+l*(e+l*t)),v=f*(a-1+l*(o-u+l*i)),g=(s*s+v*v)/(2*v),p=c*T13(s/g)/N15;return[g*A16(p),f*(1+l*u)+g*(1-m13(p))];}return arguments.length<8&&(u=0),c.invert=function(c,f){var l,s,v=N15*c/n,g=f,p=50;do{var h=g*g,w=n+h*(r+h*(e+h*t)),y=g*(a-1+h*(o-u+h*i)),b=w*w+y*y,R=2*y,M=b/R,E=M*M,P=T13(w/M)/N15,k=v*P,S=w*w,x=(2*r+h*(4*e+6*h*t))*g,G=a+h*(3*o+5*h*i),F=(2*(w*x+y*(G-1))*R-b*(2*(G-1)))/(R*R),L=m13(k),H=A16(k),z=M*L,B=M*H,W=v/N15*(1/V14(1-S/E))*(x*M-w*F)/E,j=B-c,D=g*(1+h*u)+M-z-f,I=F*H+z*W,Q=z*P,q=1+F-(F*L-B*W),K=B*P,U=I*K-q*Q;if(!U)break;v-=l=(D*I-j*q)/U,g-=s=(j*K-D*Q)/U;}while((d11(l)>C15||d11(s)>C15)&&--p>0)return[v,g];},c;}sr2.invert=function(n,r){var e=r/(1+lr2);return[n&&n/(lr2*V14(1-e*e)),2*w12(e)];},gr2.invert=function(n,r){var e=w12(r/W16),t=m13(e),a=2*e;return[n*W16/2/(m13(a)*t*t),a];};Pr2(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);Pr2(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);Pr2(5/6*N15,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Fr1(n,r){var e=n*n,t=r*r;return[n*(1-.162388*t)*(.87-952426e-9*e*e),r*(1+t/12)];}Fr1.invert=function(n,r){var e,t=n,a=r,o=50;do{var i=a*a;a-=e=(a*(1+i/12)-r)/(1+i/4);}while(d11(e)>C15&&--o>0)o=50,n/=1-.162388*i;do{var u=(u=t*t)*u;t-=e=(t*(.87-952426e-9*u)-n)/(.87-.00476213*u);}while(d11(e)>C15&&--o>0)return[t,a];};Pr2(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Br1(n,r){var e=x13(n),t=x13(r),a=m13(r),o=m13(n)*a,i=A16(n)*a,u=A16(t*r);n=d11(y10(i,u)),r=T13(o),d11(n-L13)>C15&&(n%=L13);var c=function(n,r){if(r===L13)return[0,0];var e,t,a=A16(r),o=a*a,i=o*o,u=1+i,c=1+3*i,f=1-i,l=T13(1/V14(u)),s=f+o*u*l,v=(1-a)/s,g=V14(v),p=v*u,h=V14(p),w=g*f;if(0===n)return[0,-(w+o*h)];var y,b=m13(r),R=1/b,M=2*a*b,E=(-3*o+l*c)*M,P=(-s*b-(1-a)*E)/(s*s),k=o*u*P+v*c*M,S=-R*M,x=-R*k,G=-2*R*(f*(.5*P/g)-2*o*g*M),F=4*n/N15;if(n>.222*N15||r<N15/4&&n>.175*N15){if(e=(w+o*V14(p*(1+i)-w*w))/(1+i),n>N15/4)return[e,e];var H=e,z=.5*e;e=.5*(z+H),t=50;do{var B=e*(G+S*V14(p-e*e))+x*T13(e/h)-F;if(!B)break;B<0?z=e:H=e,e=.5*(z+H);}while(d11(H-z)>C15&&--t>0)}else{e=C15,t=25;do{var W=e*e,j=V14(p-W),D=G+S*j,I=e*D+x*T13(e/h)-F;e-=y=j?I/(D+(x-S*W)/j):0;}while(d11(y)>C15&&--t>0)}return[e,-w-o*V14(p-e*e)];}(n>N15/4?L13-n:n,r);return n>N15/4&&(u=c[0],c[0]=-c[1],c[1]=-u),c[0]*=e,c[1]*=-t,c;}function jr1(n,r){var e,t,a,o,i,u;if(r<C15)return[(o=A16(n))-(e=r*(n-o*(t=m13(n)))/4)*t,t+e*o,1-r*o*o/2,n-e];if(r>=.999999)return e=(1-r)/4,a=1/(t=K17(n)),[(o=((u=b12(2*(u=n)))-1)/(u+1))+e*((i=t*q13(n))-n)/(t*t),a-e*o*a*(i-n),a+e*o*a*(i+n),2*w12(b12(n))-L13+e*(i-n)/t];var c=[1,0,0,0,0,0,0,0,0],f=[V14(r),0,0,0,0,0,0,0,0],l=0;for(t=V14(1-r),i=1;d11(f[l]/c[l])>C15&&l<8;)e=c[l++],f[l]=(e-t)/2,c[l]=(e+t)/2,t=V14(e*t),i*=2;a=i*c[l]*n;do{a=(T13(o=f[l]*A16(t=a)/c[l])+a)/2;}while(--l)return[A16(a),o=m13(a),o/m13(a-t),a];}function Dr2(n,r){if(!r)return n;if(1===r)return M13(G15(n/2+H15));for(var e=1,t=V14(1-r),a=V14(r),o=0;d11(a)>C15;o++){if(n%N15){var i=w12(t*G15(n)/e);i<0&&(i+=N15),n+=i+~~(n/N15)*N15;}else n+=n;a=(e+t)/2,t=V14(e*t),a=((e=a)-t)/2;}return n/(k13(2,o)*e);}function Ir2(n,r){var e=(B15-1)/(B15+1),t=V14(1-e*e),a=Dr2(L13,t*t),o=M13(G15(N15/4+d11(r)/2)),i=b12(-1*o)/V14(e),u=function(n,r){var e=n*n,t=r+1,a=1-e-r*r;return[.5*((n>=0?L13:-L13)-y10(a,2*n)),-.25*M13(a*a+4*e)+.5*M13(t*t+e)];}(i*m13(-1*n),i*A16(-1*n)),c=function(n,r,e){var t=d11(n),a=q13(d11(r));if(t){var o=1/A16(t),i=1/(G15(t)*G15(t)),u=-(i+e*(a*a*o*o)-1+e),c=(-u+V14(u*u-(e-1)*i*4))/2;return[Dr2(w12(1/V14(c)),e)*x13(n),Dr2(w12(V14((c/i-1)/e)),1-e)*x13(r)];}return[0,Dr2(w12(a),1-e)*x13(r)];}(u[0],u[1],t*t);return[-c[1],(r>=0?1:-1)*(.5*a-c[0])];}Br1.invert=function(n,r){d11(n)>1&&(n=2*x13(n)-n),d11(r)>1&&(r=2*x13(r)-r);var e=x13(n),t=x13(r),a=-e*n,o=-t*r,i=o/a<1,u=function(n,r){var e=0,t=1,a=.5,o=50;for(;;){var i=a*a,u=V14(a),c=T13(1/V14(1+i)),f=1-i+a*(1+i)*c,l=(1-u)/f,s=V14(l),v=l*(1+i),g=s*(1-i),p=V14(v-n*n),h=r+g+a*p;if(d11(t-e)<F14||0==--o||0===h)break;h>0?e=a:t=a,a=.5*(e+t);}if(!o)return null;var w=T13(u),y=m13(w),b=1/y,R=2*u*y,M=(-f*y-(-3*a+c*(1+3*i))*R*(1-u))/(f*f),E=.5*M/s,P=(1-i)*E-2*a*s*R;return[N15/4*(n*(-2*b*P+-b*R*p)+-b*(a*(1+i)*M+l*(1+3*i)*R)*T13(n/V14(v))),w];}(i?o:a,i?a:o),c=u[0],f=u[1],l=m13(f);return i&&(c=-L13-c),[e*(y10(A16(c)*l,-A16(f))+N15),t*T13(m13(c)*l)];},Ir2.invert=function(n,r){var e,t,a,o,i,u,c=(B15-1)/(B15+1),f=V14(1-c*c),l=Dr2(L13,f*f),s=(t=-n,a=f*f,(e=.5*l-r)?(o=jr1(e,a),t?(u=(i=jr1(t,1-a))[1]*i[1]+a*o[0]*o[0]*i[0]*i[0],[[o[0]*i[2]/u,o[1]*o[2]*i[0]*i[1]/u],[o[1]*i[1]/u,-o[0]*o[2]*i[0]*i[2]/u],[o[2]*i[1]*i[2]/u,-a*o[0]*o[1]*i[0]/u]]):[[o[0],0],[o[1],0],[o[2],0]]):[[0,(i=jr1(t,1-a))[0]/i[1]],[1/i[1],0],[i[2]/i[1],0]]),v=function(n,r){var e=r[0]*r[0]+r[1]*r[1];return[(n[0]*r[0]+n[1]*r[1])/e,(n[1]*r[0]-n[0]*r[1])/e];}(s[0],s[1]);return[y10(v[1],v[0])/-1,2*w12(b12(-.5*M13(c*v[0]*v[0]+c*v[1]*v[1])))-L13];};T13(1-1/3)*D13,Kn3(0);var ne3=.7109889596207567,re4=.0528035274542;function ee3(n,r){return r>-ne3?((n=dn5(n,r))[1]+=re4,n):En4(n,r);}function ae4(n,r){return d11(r)>ne3?((n=dn5(n,r))[1]-=r>0?re4:-re4,n):En4(n,r);}ee3.invert=function(n,r){return r>-ne3?dn5.invert(n,r-re4):En4.invert(n,r);},ae4.invert=function(n,r){return d11(r)>ne3?dn5.invert(n,r+(r>0?re4:-re4)):En4.invert(n,r);};function xe4(n,r){return[3/j14*n*V14(N15*N15/3-r*r),r];}xe4.invert=function(n,r){return[j14/3*n/V14(N15*N15/3-r*r),r];};var Fe3=N15/B15;function Ne4(n,r){return[n*(1+V14(m13(r)))/2,r/(m13(r/2)*m13(n/6))];}function He3(n,r){var e=n*n,t=r*r;return[n*(.975534+t*(-.0143059*e-.119161+-.0547009*t)),r*(1.00384+e*(.0802894+-.02855*t+199025e-9*e)+t*(.0998909+-.0491032*t))];}function Be3(n,r){return[A16(n)/m13(r),G15(r)*m13(n)];}function Ie4(n,r){return[n,1.25*M13(G15(H15+.4*r))];}Ne4.invert=function(n,r){var e=d11(n),t=d11(r),a=C15,o=L13;t<Fe3?o*=t/Fe3:a+=6*Q13(Fe3/t);for(var i=0;i<25;i++){var u=A16(o),c=V14(m13(o)),f=A16(o/2),l=m13(o/2),s=A16(a/6),v=m13(a/6),g=.5*a*(1+c)-e,p=o/(l*v)-t,h=c?-.25*a*u/c:0,w=.5*(1+c),y=(1+.5*o*f/l)/(l*v),b=o/l*(s/6)/(v*v),R=h*b-y*w,M=(g*b-p*w)/R,E=(p*h-g*y)/R;if(o-=M,a-=E,d11(M)<C15&&d11(E)<C15)break;}return[n<0?-a:a,r<0?-o:o];},He3.invert=function(n,r){var e=x13(n)*N15,t=r/2,a=50;do{var o=e*e,i=t*t,u=e*t,c=e*(.975534+i*(-.0143059*o-.119161+-.0547009*i))-n,f=t*(1.00384+o*(.0802894+-.02855*i+199025e-9*o)+i*(.0998909+-.0491032*i))-r,l=.975534-i*(.119161+3*o*.0143059+.0547009*i),s=-u*(.238322+.2188036*i+.0286118*o),v=u*(.1605788+7961e-7*o+-.0571*i),g=1.00384+o*(.0802894+199025e-9*o)+i*(3*(.0998909-.02855*o)-.245516*i),p=s*v-g*l,h=(f*s-c*g)/p,w=(c*v-f*l)/p;e-=h,t-=w;}while((d11(h)>C15||d11(w)>C15)&&--a>0)return a&&[e,t];},Be3.invert=function(n,r){var e=n*n,t=r*r+1,a=e+t,o=n?z16*V14((a-V14(a*a-4*e))/e):1/V14(t);return[T13(n*o),x13(r)*Q13(o)];},Ie4.invert=function(n,r){return[n,2.5*w12(b12(.8*r))-.625*N15];};var nt9=V14(6),rt9=V14(7);function et8(n,r){var e=T13(7*A16(r)/(3*nt9));return[nt9*n*(2*m13(2*e/3)-1)/rt9,9*A16(e/3)/rt9];}function at9(n,r){for(var e,t=(1+z16)*A16(r),a=r,o=0;o<25&&(a-=e=(A16(a/2)+A16(a)-t)/(.5*m13(a/2)+m13(a)),!(d11(e)<C15));o++);return[n*(1+2*m13(a)/m13(a/2))/(3*B15),2*V14(3)*A16(a/2)/V14(2+B15)];}function it8(n,r){for(var e,t=V14(6/(4+N15)),a=(1+N15/4)*A16(r),o=r/2,i=0;i<25&&(o-=e=(o/2+A16(o)-a)/(.5+m13(o)),!(d11(e)<C15));i++);return[t*(.5+m13(o))*n/1.5,t*o];}function ct7(n,r){var e=r*r,t=e*e,a=e*t;return[n*(.84719-.13063*e+a*a*(.05494*e-.04515-.02326*t+.00331*a)),r*(1.01183+t*t*(.01926*e-.02625-.00396*t))];}function lt8(n,r){return[n*(1+m13(r))/2,2*(r-G15(r/2))];}et8.invert=function(n,r){var e=3*T13(r*rt9/9);return[n*rt9/(nt9*(2*m13(2*e/3)-1)),T13(3*A16(e)*nt9/7)];},at9.invert=function(n,r){var e=r*V14(2+B15)/(2*V14(3)),t=2*T13(e);return[3*B15*n/(1+2*m13(t)/m13(t/2)),T13((e+A16(t))/(1+z16))];},it8.invert=function(n,r){var e=V14(6/(4+N15)),t=r/e;return d11(d11(t)-L13)<C15&&(t=t<0?-L13:L13),[1.5*n/(e*(.5+m13(t))),T13((t/2+A16(t))/(1+N15/4))];},ct7.invert=function(n,r){var e,t,a,o,i=r,u=25;do{i-=e=(i*(1.01183+(a=(t=i*i)*t)*a*(.01926*t-.02625-.00396*a))-r)/(1.01183+a*a*(.21186*t-.23625+-.05148*a));}while(d11(e)>F14&&--u>0)return[n/(.84719-.13063*(t=i*i)+(o=t*(a=t*t))*o*(.05494*t-.04515-.02326*a+.00331*o)),i];},lt8.invert=function(n,r){for(var e=r/2,t=0,a=1/0;t<10&&d11(a)>C15;++t){var o=m13(r/2);r-=a=(r-G15(r/2)-e)/(1-.5/(o*o));}return[2*n/(1+m13(r)),r];};function pt6(n,r){var e=A16(r),t=m13(r),a=x13(n);if(0===n||d11(r)===L13)return[0,r];if(0===r)return[n,0];if(d11(n)===L13)return[n*t,L13*e];var o=N15/(2*n)-2*n/N15,i=2*r/N15,u=(1-i*i)/(e-i),c=o*o,f=u*u,l=1+c/f,s=1+f/c,v=(o*e/u-o/2)/l,g=(f*e/c+u/2)/s,p=g*g-(f*e*e/c+u*e-1)/s;return[L13*(v+V14(v*v+t*t/l)*a),L13*(g+V14(p<0?0:p)*x13(-r*o)*a)];}pt6.invert=function(n,r){var e=(n/=L13)*n,t=e+(r/=L13)*r,a=N15*N15;return[n?(t-1+V14((1-t)*(1-t)+4*e))/(2*n)*L13:0,ln6(function(n){return t*(N15*A16(n)-2*n)*N15+4*n*n*(r-A16(n))+2*N15*n-a*r;},0)];};var dt6=1.0148,wt6=.23185,yt6=-.14499,mt6=.02406,bt6=dt6,Rt5=5*wt6,Mt6=1.790857183;function Et5(n,r){var e=r*r;return[n,r*(dt6+e*e*(wt6+e*(yt6+mt6*e)))];}function kt6(n,r){if(d11(r)<C15)return[n,0];var e=G15(r),t=n*A16(r);return[A16(t)/e,r+(1-m13(t))/e];}Et5.invert=function(n,r){r>Mt6?r=Mt6:r<-1.790857183&&(r=-1.790857183);var e,t=r;do{var a=t*t;t-=e=(t*(dt6+a*a*(wt6+a*(yt6+mt6*a)))-r)/(bt6+a*a*(Rt5+a*(.21654*a-1.01493)));}while(d11(e)>C15)return[n,t];},kt6.invert=function(n,r){if(d11(r)<C15)return[n,0];var e,t=n*n+r*r,a=.5*r,o=10;do{var i=G15(a),u=1/m13(a),c=t-2*r*a+a*a;a-=e=(i*c+2*(a-r))/(2+c*u*u+2*(a-r)*i);}while(d11(e)>C15&&--o>0)return i=G15(a),[(d11(r)<d11(a+1/i)?T13(n*i):x13(r)*x13(n)*(Q13(d11(n*i))+L13))/A16(a),a];};var zt4=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Bt5=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(n){return n.map(function(n){return zt4[n];});});var jt6=2/V14(3);function Dt6(n,r){var e=jn5(n,r);return[e[0]*jt6,e[1]];}Dt6.invert=function(n,r){return jn5.invert(n/jt6,r);};var ua=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function ca(n,r){var e,t=P13(18,36*d11(r)/N15),a=R13(t),o=t-a,i=(e=ua[a])[0],u=e[1],c=(e=ua[++a])[0],f=e[1],l=(e=ua[P13(19,++a)])[0],s=e[1];return[n*(c+o*(l-i)/2+o*o*(l-2*c+i)/2),x13(r)*(f+o*(s-u)/2+o*o*(s-2*f+u)/2)];}ua.forEach(function(n){n[1]*=1.593415793900743;}),ca.invert=function(n,r){var e=90*r,t=P13(18,d11(e/5)),a=E16(0,R13(t));do{var o=ua[a][1],i=ua[a+1][1],u=ua[P13(19,a+2)][1],c=u-o,f=u-2*i+o,l=2*(d11(r)-i)/c,s=f/c,v=l*(1-s*l*(1-2*s*l));if(v>=0||1===a){e=(r>=0?5:-5)*(v+t);var g,p=50;do{v=(t=P13(18,d11(e)/5))-(a=R13(t)),o=ua[a][1],i=ua[a+1][1],u=ua[P13(19,a+2)][1],e-=(g=x13(r)*(i+v*(u-o)/2+v*v*(u-2*i+o)/2)-r)*D13;}while(d11(g)>F14&&--p>0)break;}}while(--a>=0)var h=ua[a][0],w=ua[a+1][0],y=ua[P13(19,a+2)][0];return[n/(w+v*(y-h)/2+v*v*(y-2*w+h)/2),e*I13];};function Sa(n,r){var e=G15(r/2),t=A16(H15*e);return[n*(.74482-.34588*t*t),1.70711*e];}function za(n,r){if(d11(r)<C15)return[n,0];var e=d11(r/L13),t=T13(e);if(d11(n)<C15||d11(d11(r)-L13)<C15)return[0,x13(r)*N15*G15(t/2)];var a=m13(t),o=d11(N15/n-n/N15)/2,i=o*o,u=a/(e+a-1),c=u*(2/e-1),f=c*c,l=f+i,s=u-f,v=i+u;return[x13(n)*N15*(o*s+V14(i*s*s-l*(u*u-f)))/l,x13(r)*N15*(c*v-o*V14((i+1)*l-v*v))/l];}function Wa(n,r){if(d11(r)<C15)return[n,0];var e=d11(r/L13),t=T13(e);if(d11(n)<C15||d11(d11(r)-L13)<C15)return[0,x13(r)*N15*G15(t/2)];var a=m13(t),o=d11(N15/n-n/N15)/2,i=o*o,u=a*(V14(1+i)-o*a)/(1+i*e*e);return[x13(n)*N15*u,x13(r)*N15*V14(1-u*(2*o+u))];}function Da(n,r){if(d11(r)<C15)return[n,0];var e=r/L13,t=T13(e);if(d11(n)<C15||d11(d11(r)-L13)<C15)return[0,N15*G15(t/2)];var a=(N15/n-n/N15)/2,o=e/(1+m13(t));return[N15*(x13(n)*V14(a*a+1-o*o)-a),N15*o];}function Ta(n,r){if(!r)return[n,0];var e=d11(r);if(!n||e===L13)return[0,r];var t=e/L13,a=t*t,o=(8*t-a*(a+2)-5)/(2*a*(t-1)),i=o*o,u=t*o,c=a+i+2*u,f=t+3*o,l=n/L13,s=l+1/l,v=x13(d11(n)-L13)*V14(s*s-4),g=v*v,p=(v*(c+i-1)+2*V14(c*(a+i*g-1)+(1-a)*(a*(f*f+4*i)+12*u*i+4*i*i)))/(4*c+g);return[x13(n)*L13*p,x13(r)*L13*V14(1+v*d11(p)-p*p)];}Sa.invert=function(n,r){var e=r/1.70711,t=A16(H15*e);return[n/(.74482-.34588*t*t),2*w12(e)];},za.invert=function(n,r){if(d11(r)<C15)return[n,0];if(d11(n)<C15)return[0,L13*A16(2*w12(r/N15))];var e=(n/=N15)*n,t=(r/=N15)*r,a=e+t,o=a*a,i=-d11(r)*(1+a),u=i-2*t+e,c=-2*i+1+2*t+o,f=t/c+(2*u*u*u/(c*c*c)-9*i*u/(c*c))/27,l=(i-u*u/(3*c))/c,s=2*V14(-l/3),v=Q13(3*f/(l*s))/3;return[N15*(a-1+V14(1+2*(e-t)+o))/(2*n),x13(r)*N15*(-s*m13(v+N15/3)-u/(3*c))];},Wa.invert=function(n,r){if(!n)return[0,L13*A16(2*w12(r/N15))];var e=d11(n/N15),t=(1-e*e-(r/=N15)*r)/(2*e),a=V14(t*t+1);return[x13(n)*N15*(a-t),x13(r)*L13*A16(2*y10(V14((1-2*t*e)*(t+a)-e),V14(a+t+e)))];},Da.invert=function(n,r){if(!r)return[n,0];var e=r/N15,t=(N15*N15*(1-e*e)-n*n)/(2*N15*n);return[n?N15*(x13(n)*V14(t*t+1)-t):0,L13*A16(2*w12(e))];},Ta.invert=function(n,r){var e;if(!n||!r)return[n,r];var t=x13(r);r=d11(r)/N15;var a=x13(n)*n/L13,o=(a*a-1+4*r*r)/d11(a),i=o*o,u=r*(2-(r>.5?P13(r,d11(n)):0)),c=n*n+r*r,f=50;do{var l=u*u,s=(8*u-l*(l+2)-5)/(2*l*(u-1)),v=(3*u-l*u-10)/(2*l*u),g=s*s,p=u*s,h=u+s,w=h*h,y=u+3*s,m=-2*h*(4*p*g+(1-4*l+3*l*l)*(1+v)+g*(14*l-6-i+(8*l-8-2*i)*v)+p*(12*l-8+(10*l-10-i)*v)),b=V14(w*(l+g*i-1)+(1-l)*(l*(y*y+4*g)+g*(12*p+4*g)));u-=e=(o*(w+g-1)+2*b-a*(4*w+i))/(o*(2*s*v+2*h*(1+v))+m/b-8*h*(o*(-1+g+w)+2*b)*(1+v)/(i+4*w));}while(e*c*c>C15&&--f>0)return[x13(n)*(V14(o*o+4)+o)*N15/4,t*L13*u];};var Ua=4*N15+3*V14(3),_a=2*V14(2*N15*V14(3)/Ua),Ja=hn6(_a*V14(3)/N15,_a,Ua/6);function Xa(n,r){return[n*V14(1-3*r*r/(N15*N15)),r];}function Za(n,r){var e=m13(r),t=m13(n)*e,a=1-t,o=m13(n=y10(A16(n)*e,-A16(r))),i=A16(n);return[i*(e=V14(1-t*t))-o*a,-o*e-i*a];}function no(n,r){var e=J17(n,r);return[(e[0]+n/L13)/2,(e[1]+r)/2];}Xa.invert=function(n,r){return[n/V14(1-3*r*r/(N15*N15)),r];},Za.invert=function(n,r){var e=(n*n+r*r)/-2,t=V14(-e*(2+e)),a=r*e+n*t,o=n*e-r*t,i=V14(o*o+a*a);return[y10(t*a,i*(1+e)),i?-T13(t*o/i):0];},no.invert=function(n,r){var e=n,t=r,a=25;do{var o,i=m13(t),u=A16(t),c=A16(2*t),f=u*u,l=i*i,s=A16(e),v=m13(e/2),g=A16(e/2),p=g*g,h=1-l*v*v,w=h?Q13(i*v)*V14(o=1/h):o=0,y=.5*(2*w*i*g+e/L13)-n,b=.5*(w*u+t)-r,R=.5*o*(l*p+w*i*v*f)+.5/L13,M=o*(s*c/4-w*u*g),E=.125*o*(c*g-w*u*l*s),P=.5*o*(f*v+w*p*i)+.5,k=M*E-P*R,S=(b*M-y*P)/k,x=(y*E-b*R)/k;e-=S,t-=x;}while((d11(S)>C15||d11(x)>C15)&&--a>0)return[e,t];};const E17=Vr(),b13=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function w13(e,r){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(x14[e]=function(e,r){return function n(){const o=r();return o.type=e,o.path=Vr().projection(o),o.copy=o.copy||function(){const t=n();return b13.forEach(e=>{o[e]&&t[e](o[e]());}),t.path.pointRadius(o.path.pointRadius()),t;},de1(o);};}(e,r),this):x14[e]||null;}function j15(t){return t&&t.path||E17;}const x14={albers:Ei1,albersusa:yi1,azimuthalequalarea:wi1,azimuthalequidistant:_i1,conicconformal:$i1,conicequalarea:di1,conicequidistant:Li1,equalEarth:Hi1,equirectangular:zi1,gnomonic:Wi1,identity:Xi1,mercator:Ri1,mollweide:wn5,naturalEarth1:Bi1,orthographic:Ui1,stereographic:Ji1,transversemercator:Qi1};for(const t in x14)w13(t,x14[t]);function $14(){}const _13=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function U13(){var e=1,t=1,n=o;function a(e,t){return t.map(t=>r(e,t));}function r(a,r){var o=[],u=[];return function(n,a,r){var o,u,s,l,f,d,m=[],c=[];o=u=-1,l=n[0]>=a,_13[l<<1].forEach(p);for(;++o<e-1;)s=l,l=n[o+1]>=a,_13[s|l<<1].forEach(p);_13[l|0].forEach(p);for(;++u<t-1;){for(o=-1,l=n[u*e+e]>=a,f=n[u*e]>=a,_13[l<<1|f<<2].forEach(p);++o<e-1;)s=l,l=n[u*e+e+o+1]>=a,d=f,f=n[u*e+o+1]>=a,_13[s|l<<1|f<<2|d<<3].forEach(p);_13[l|f<<3].forEach(p);}o=-1,f=n[u*e]>=a,_13[f<<2].forEach(p);for(;++o<e-1;)d=f,f=n[u*e+o+1]>=a,_13[f<<2|d<<3].forEach(p);function p(e){var t,n,a=[e[0][0]+o,e[0][1]+u],s=[e[1][0]+o,e[1][1]+u],l=i(a),f=i(s);(t=c[l])?(n=m[f])?(delete c[t.end],delete m[n.start],t===n?(t.ring.push(s),r(t.ring)):m[t.start]=c[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete c[t.end],t.ring.push(s),c[t.end=f]=t):(t=m[f])?(n=c[l])?(delete m[t.start],delete c[n.end],t===n?(t.ring.push(s),r(t.ring)):m[n.start]=c[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete m[t.start],t.ring.unshift(a),m[t.start=l]=t):m[l]=c[f]={start:l,end:f,ring:[a,s]};}_13[f<<3].forEach(p);}(a,r,e=>{n(e,a,r),function(e){var t=0,n=e.length,a=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)a+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return a;}(e)>0?o.push([e]):u.push(e);}),u.forEach(e=>{for(var t,n=0,a=o.length;n<a;++n)if(-1!==A17((t=o[n])[0],e))return void t.push(e);}),{type:"MultiPolygon",value:r,coordinates:o};}function i(t){return 2*t[0]+t[1]*(e+1)*4;}function o(n,a,r){n.forEach(n=>{var i,o=n[0],u=n[1],s=0|o,l=0|u,f=a[l*e+s];o>0&&o<e&&s===o&&(i=a[l*e+s-1],n[0]=o+(r-i)/(f-i)-.5),u>0&&u<t&&l===u&&(i=a[(l-1)*e+s],n[1]=u+(r-i)/(f-i)-.5);});}return a.contour=r,a.size=function(n){if(!arguments.length)return[e,t];var r=Math.floor(n[0]),i=Math.floor(n[1]);return r>=0&&i>=0||l("invalid size"),e=r,t=i,a;},a.smooth=function(e){return arguments.length?(n=e?o:$14,a):n===o;},a;}function A17(e,t){for(var n,a=-1,r=t.length;++a<r;)if(n=L14(e,t[a]))return n;return 0;}function L14(e,t){for(var n=t[0],a=t[1],r=-1,i=0,o=e.length,u=o-1;i<o;u=i++){var s=e[i],l=s[0],f=s[1],d=e[u],m=d[0],c=d[1];if(N16(s,d,t))return 0;f>a!=c>a&&n<(m-l)*(a-f)/(c-f)+l&&(r=-r);}return r;}function N16(e,t,n){var a,r,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1]);}(e,t,n)&&(r=e[a=+(e[0]===t[0])],i=n[a],o=t[a],r<=i&&i<=o||o<=i&&i<=r);}function F15(e,t,n){return function(a){var r=un(a),i=n?Math.min(r[0],0):r[0],o=r[1],u=o-i,s=t?nt(i,o,e):u/(e+1);return Nt(i+s,o,s);};}function P14(t){st2.call(this,null,t);}function k14(e,t,n,a,r){const i=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(l);}function l(e){u&&e.reverse(),e.forEach(f);}function f(e){e[0]=(e[0]-i)*t+a,e[1]=(e[1]-o)*n+r;}return function(e){return e.coordinates.forEach(s),e;};}function q14(e,t,n){const a=e>=0?e:f4(t,n);return Math.round((Math.sqrt(4*a*a+1)-1)/2);}function I14(e){return L(e)?e:tn(+e);}function G16(){var e=e=>e[0],t=e=>e[1],n=h,a=[-1,-1],r=960,i=500,o=2;function u(u,s){const l=q14(a[0],u,e)>>o,f=q14(a[1],u,t)>>o,d=l?l+2:0,m=f?f+2:0,c=2*d+(r>>o),p=2*m+(i>>o),h=new Float32Array(c*p),y=new Float32Array(c*p);let g=h;u.forEach(a=>{const r=d+(+e(a)>>o),i=m+(+t(a)>>o);r>=0&&r<c&&i>=0&&i<p&&(h[r+i*c]+=+n(a));}),l>0&&f>0?(J18(c,p,h,y,l),K18(c,p,y,h,f),J18(c,p,h,y,l),K18(c,p,y,h,f),J18(c,p,h,y,l),K18(c,p,y,h,f)):l>0?(J18(c,p,h,y,l),J18(c,p,y,h,l),J18(c,p,h,y,l),g=y):f>0&&(K18(c,p,h,y,f),K18(c,p,y,h,f),K18(c,p,h,y,f),g=y);const v=s?Math.pow(2,-2*o):1/jt(g);for(let e=0,t=c*p;e<t;++e)g[e]*=v;return{values:g,scale:1<<o,width:c,height:p,x1:d,y1:m,x2:d+(r>>o),y2:m+(i>>o)};}return u.x=function(t){return arguments.length?(e=I14(t),u):e;},u.y=function(e){return arguments.length?(t=I14(e),u):t;},u.weight=function(e){return arguments.length?(n=I14(e),u):n;},u.size=function(e){if(!arguments.length)return[r,i];var t=+e[0],n=+e[1];return t>=0&&n>=0||l("invalid size"),r=t,i=n,u;},u.cellSize=function(e){return arguments.length?((e=+e)>=1||l("invalid cell size"),o=Math.floor(Math.log(e)/Math.LN2),u):1<<o;},u.bandwidth=function(e){return arguments.length?(1===(e=H(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&l("invalid bandwidth"),a=e,u):a;},u;}function J18(e,t,n,a,r){const i=1+(r<<1);for(let o=0;o<t;++o)for(let t=0,u=0;t<e+r;++t)t<e&&(u+=n[t+o*e]),t>=r&&(t>=i&&(u-=n[t-i+o*e]),a[t-r+o*e]=u/Math.min(t+1,e-1+i-t,i));}function K18(e,t,n,a,r){const i=1+(r<<1);for(let o=0;o<e;++o)for(let u=0,s=0;u<t+r;++u)u<t&&(s+=n[o+u*e]),u>=r&&(u>=i&&(s-=n[o+(u-i)*e]),a[o+(u-r)*e]=s/Math.min(u+1,t-1+i-u,i));}function B16(t){st2.call(this,null,t);}P14.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},an(P14,st2,{transform(e,a){if(this.value&&!a.changed()&&!e.modified())return a.StopPropagation;var r=a.fork(a.NO_SOURCE|a.NO_FIELDS),l=a.materialize(a.SOURCE).source,f=e.field||s,d=U13().smooth(!1!==e.smooth),m=e.thresholds||function(e,t,n){const a=F15(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?a:a(e.map(e=>ft(t(e).values)));}(l,f,e),c=null===e.as?null:e.as||"contour",p=[];return l.forEach(a=>{const r=f(a),i=d.size([r.width,r.height])(r.values,w(m)?m:m(r.values));!function(e,t,n,a){let r=a.scale||t.scale,i=a.translate||t.translate;L(r)&&(r=r(n,a));L(i)&&(i=i(n,a));if((1===r||null==r)&&!i)return;const o=(yn(r)?r:r[0])||1,l=(yn(r)?r:r[1])||1,f=i&&i[0]||0,d=i&&i[1]||0;e.forEach(k14(t,o,l,f,d));}(i,r,a,e),i.forEach(e=>{p.push(q6(a,O6(null!=c?{[c]:e}:e)));});}),this.value&&(r.rem=this.value),this.value=r.source=r.add=p,r;}}),B16.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const H16=["x","y","weight","size","cellSize","bandwidth"];function Q14(e,t){return H16.forEach(n=>null!=t[n]?e[n](t[n]):0),e;}function T14(t){st2.call(this,null,t);}an(B16,st2,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=function(e,t){var n,a,r,i,o,u,s=[],l=e=>e(i);if(null==t)s.push(e);else for(n={},a=0,r=e.length;a<r;++a)i=e[a],(u=n[o=t.map(l)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s;}(t.materialize(t.SOURCE).source,e.groupby),o=(e.groupby||[]).map(t1),u=Q14(G16(),e),s=e.as||"grid";return a=i.map(t=>O6(function(e,t){for(let n=0;n<o.length;++n)e[o[n]]=t[n];return e;}({[s]:u(t,e.counts)},t.dims))),this.value&&(r.rem=this.value),this.value=r.source=r.add=a,r;}}),T14.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},an(T14,st2,{transform(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var a,r,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=U13().smooth(!1!==e.smooth),s=e.values,l=e.thresholds||F15(e.count||10,e.nice,!!s),f=e.size;return s||(s=t.materialize(t.SOURCE).source,r=k14(a=Q14(G16(),e)(s,!0),a.scale||1,a.scale||1,0,0),f=[a.width,a.height],s=a.values),l=w(l)?l:l(s),s=u.size(f)(s,l),r&&s.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(s||[]).map(O6),i;}});const V15="Feature",W17="FeatureCollection";function X17(t){st2.call(this,null,t);}function Y16(t){st2.call(this,null,t);}function Z18(t){st2.call(this,null,t);}function ee4(t){st2.call(this,null,t);}function te3(t){st2.call(this,[],t),this.generator=Ut4();}function ne4(t){st2.call(this,null,t);}function ae5(e1){if(!L(e1))return!1;const t=Sn(e(e1));return t.$x||t.$y||t.$value||t.$max;}function re5(t){st2.call(this,null,t),this.modified(!0);}function ie4(e,t,n){L(e[t])&&e[t](n);}X17.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},an(X17,st2,{transform(e1,t){var n,a=this._features,r=this._points,o=e1.fields,u=o&&o[0],s1=o&&o[1],l=e1.geojson||!o&&s,d=t.ADD;n=e1.modified()||t.changed(t.REM)||t.modified(e(l))||u&&t.modified(e(u))||s1&&t.modified(e(s1)),this.value&&!n||(d=t.SOURCE,this._features=a=[],this._points=r=[]),l&&t.visit(d,e=>a.push(l(e))),u&&s1&&(t.visit(d,e=>{var t=u(e),n=s1(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&r.push([t,n]);}),a=a.concat({type:V15,geometry:{type:"MultiPoint",coordinates:r}})),this.value={type:W17,features:a};}}),Y16.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},an(Y16,st2,{transform(e,t){var n=t.fork(t.ALL),a=this.value,r=e.field||s,o=e.as||"path",u=n.SOURCE;!a||e.modified()?(this.value=a=j15(e.projection),n.materialize().reflow()):u=r===s||t.modified(r.fields)?n.ADD_MOD:n.ADD;const s1=function(e,t){const n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n;}(a,e.pointRadius);return n.visit(u,e=>e[o]=a(r(e))),a.pointRadius(s1),n.modifies(o);}}),Z18.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},an(Z18,st2,{transform(e,t){var n,a=e.projection,r=e.fields[0],i=e.fields[1],o=e.as||["x","y"],u=o[0],s=o[1];function l(e){const t=a([r(e),i(e)]);t?(e[u]=t[0],e[s]=t[1]):(e[u]=void 0,e[s]=void 0);}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(n=t.modified(r.fields)||t.modified(i.fields),t.visit(n?t.ADD_MOD:t.ADD,l)),t.modifies(o);}}),ee4.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},an(ee4,st2,{transform(e,t){var n=t.fork(t.ALL),a=this.value,r=e.as||"shape",i1=n.ADD;return a&&!e.modified()||(this.value=a=function(e,t,n){const a=null==n?n=>e(t(n)):a=>{var r=e.pointRadius(),i=e.pointRadius(n)(t(a));return e.pointRadius(r),i;};return a.context=t=>(e.context(t),a),a;}(j15(e.projection),e.field||i("datum"),e.pointRadius),n.materialize().reflow(),i1=n.SOURCE),n.visit(i1,e=>e[r]=a),n.modifies(r);}}),te3.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},an(te3,st2,{transform(e,t){var r,i=this.value,o=this.generator;if(!i.length||e.modified())for(const t in e)L(o[t])&&o[t](e[t]);return r=o(),i.length?t.mod.push(M5(i[0],r)):t.add.push(O6(r)),i[0]=r,t;}}),ne4.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},an(ne4,st2,{transform(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,a1="shared"===e.resolve,r=e.field||s,o=function(e,t){let n;L(e)?(n=n=>e(n,t),n.dep=ae5(e)):e?n=tn(e):(n=e=>e.$value/e.$max||0,n.dep=!0);return n;}(e.opacity,e),s1=function(e,t){let n;L(e)?(n=n=>k8(e(n,t)),n.dep=ae5(e)):n=tn(k8(e||"#888"));return n;}(e.color,e),l=e.as||"image",f={$x:0,$y:0,$value:0,$max:a1?ft(n.map(e=>ft(r(e).values))):0};return n.forEach(e=>{const t=r(e),n=rn({},e,f);a1||(n.$max=ft(t.values||[])),e[l]=function(e,t,n,a1){const r=e.width,i=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||r,l=e.y2||i,f=e.values,d=f?e=>f[e]:a,m=e8(s-o,l-u),c=m.getContext("2d"),p=c.getImageData(0,0,s-o,l-u),h=p.data;for(let e=u,i=0;e<l;++e){t.$y=e-u;for(let u=o,l=e*r;u<s;++u,i+=4){t.$x=u-o,t.$value=d(u+l);const e=n(t);h[i+0]=e.r,h[i+1]=e.g,h[i+2]=e.b,h[i+3]=~~(255*a1(t));}}return c.putImageData(p,0,0),m;}(t,n,s1.dep?s1:tn(s1(n)),o.dep?o:tn(o(n)));}),t.reflow(!0).modifies(l);}}),an(re5,st2,{transform(e,t){let n=this.value;return!n||e.modified("type")?(this.value=n=function(e){const t=w13((e||"mercator").toLowerCase());t||l("Unrecognized projection type: "+e);return t();}(e.type),b13.forEach(t=>{null!=e[t]&&ie4(n,t,e[t]);})):b13.forEach(t=>{e.modified(t)&&ie4(n,t,e[t]);}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){const n=function(e){return e=H(e),1===e.length?e[0]:{type:W17,features:e.reduce((e,t)=>e.concat(function(e){return e.type===W17?e.features:H(e).filter(e=>null!=e).map(e=>e.type===V15?e:{type:V15,geometry:e});}(t)),[])};}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n);}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS);}});const mod4=function(){return{contour:T14,geojson:X17,geopath:Y16,geopoint:Z18,geoshape:ee4,graticule:te3,heatmap:ne4,isocontour:P14,kde2d:B16,projection:re5,default:null};}();function t10(t,i,r,n){if(isNaN(i)||isNaN(r))return t;var e,h,s,o,a,u,l,_,f,x=t._root,c={data:n},y=t._x0,v=t._y0,d=t._x1,p=t._y1;if(!x)return t._root=c,t;for(;x.length;)if((u=i>=(h=(y+d)/2))?y=h:d=h,(l=r>=(s=(v+p)/2))?v=s:p=s,e=x,!(x=x[_=l<<1|u]))return e[_]=c,t;if(o=+t._x.call(null,x.data),a=+t._y.call(null,x.data),i===o&&r===a)return c.next=x,e?e[_]=c:t._root=c,t;do{e=e?e[_]=new Array(4):t._root=new Array(4),(u=i>=(h=(y+d)/2))?y=h:d=h,(l=r>=(s=(v+p)/2))?v=s:p=s;}while((_=l<<1|u)==(f=(a>=s)<<1|o>=h))return e[f]=x,e[_]=c,t;}function i13(t,i,r,n,e){this.node=t,this.x0=i,this.y0=r,this.x1=n,this.y1=e;}function r10(t){return t[0];}function n10(t){return t[1];}function e11(t,i,e){var s=new h13(null==i?r10:i,null==e?n10:e,NaN,NaN,NaN,NaN);return null==t?s:s.addAll(t);}function h13(t,i,r,n,e,h){this._x=t,this._y=i,this._x0=r,this._y0=n,this._x1=e,this._y1=h,this._root=void 0;}function s13(t){for(var i={data:t.data},r=i;t=t.next;)r=r.next={data:t.data};return i;}var o10=e11.prototype=h13.prototype;o10.copy=function(){var t,i,r=new h13(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root;if(!n)return r;if(!n.length)return r._root=s13(n),r;for(t=[{source:n,target:r._root=new Array(4)}];n=t.pop();)for(var e=0;e<4;++e)(i=n.source[e])&&(i.length?t.push({source:i,target:n.target[e]=new Array(4)}):n.target[e]=s13(i));return r;},o10.add=function(i){const r=+this._x.call(null,i),n=+this._y.call(null,i);return t10(this.cover(r,n),r,n,i);},o10.addAll=function(i){var r,n,e,h,s=i.length,o=new Array(s),a=new Array(s),u=1/0,l=1/0,_=-1/0,f=-1/0;for(n=0;n<s;++n)isNaN(e=+this._x.call(null,r=i[n]))||isNaN(h=+this._y.call(null,r))||(o[n]=e,a[n]=h,e<u&&(u=e),e>_&&(_=e),h<l&&(l=h),h>f&&(f=h));if(u>_||l>f)return this;for(this.cover(u,l).cover(_,f),n=0;n<s;++n)t10(this,o[n],a[n],i[n]);return this;},o10.cover=function(t,i){if(isNaN(t=+t)||isNaN(i=+i))return this;var r=this._x0,n=this._y0,e=this._x1,h=this._y1;if(isNaN(r))e=(r=Math.floor(t))+1,h=(n=Math.floor(i))+1;else{for(var s,o,a=e-r||1,u=this._root;r>t||t>=e||n>i||i>=h;)switch(o=(i<n)<<1|t<r,(s=new Array(4))[o]=u,u=s,a*=2,o){case 0:e=r+a,h=n+a;break;case 1:r=e-a,h=n+a;break;case 2:e=r+a,n=h-a;break;case 3:r=e-a,n=h-a;}this._root&&this._root.length&&(this._root=u);}return this._x0=r,this._y0=n,this._x1=e,this._y1=h,this;},o10.data=function(){var t=[];return this.visit(function(i){if(!i.length)do{t.push(i.data);}while(i=i.next)}),t;},o10.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]];},o10.find=function(t,r,n){var e,h,s,o,a,u,l,_=this._x0,f=this._y0,x=this._x1,c=this._y1,y=[],v=this._root;for(v&&y.push(new i13(v,_,f,x,c)),null==n?n=1/0:(_=t-n,f=r-n,x=t+n,c=r+n,n*=n);u=y.pop();)if(!(!(v=u.node)||(h=u.x0)>x||(s=u.y0)>c||(o=u.x1)<_||(a=u.y1)<f))if(v.length){var d=(h+o)/2,p=(s+a)/2;y.push(new i13(v[3],d,p,o,a),new i13(v[2],h,p,d,a),new i13(v[1],d,s,o,p),new i13(v[0],h,s,d,p)),(l=(r>=p)<<1|t>=d)&&(u=y[y.length-1],y[y.length-1]=y[y.length-1-l],y[y.length-1-l]=u);}else{var w=t-+this._x.call(null,v.data),N=r-+this._y.call(null,v.data),g=w*w+N*N;if(g<n){var A=Math.sqrt(n=g);_=t-A,f=r-A,x=t+A,c=r+A,e=v.data;}}return e;},o10.remove=function(t){if(isNaN(h=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var i,r,n,e,h,s,o,a,u,l,_,f,x=this._root,c=this._x0,y=this._y0,v=this._x1,d=this._y1;if(!x)return this;if(x.length)for(;;){if((u=h>=(o=(c+v)/2))?c=o:v=o,(l=s>=(a=(y+d)/2))?y=a:d=a,i=x,!(x=x[_=l<<1|u]))return this;if(!x.length)break;(i[_+1&3]||i[_+2&3]||i[_+3&3])&&(r=i,f=_);}for(;x.data!==t;)if(n=x,!(x=x.next))return this;return(e=x.next)&&delete x.next,n?(e?n.next=e:delete n.next,this):i?(e?i[_]=e:delete i[_],(x=i[0]||i[1]||i[2]||i[3])&&x===(i[3]||i[2]||i[1]||i[0])&&!x.length&&(r?r[f]=x:this._root=x),this):(this._root=e,this);},o10.removeAll=function(t){for(var i=0,r=t.length;i<r;++i)this.remove(t[i]);return this;},o10.root=function(){return this._root;},o10.size=function(){var t=0;return this.visit(function(i){if(!i.length)do{++t;}while(i=i.next)}),t;},o10.visit=function(t){var r,n,e,h,s,o,a=[],u=this._root;for(u&&a.push(new i13(u,this._x0,this._y0,this._x1,this._y1));r=a.pop();)if(!t(u=r.node,e=r.x0,h=r.y0,s=r.x1,o=r.y1)&&u.length){var l=(e+s)/2,_=(h+o)/2;(n=u[3])&&a.push(new i13(n,l,_,s,o)),(n=u[2])&&a.push(new i13(n,e,_,l,o)),(n=u[1])&&a.push(new i13(n,l,h,s,_)),(n=u[0])&&a.push(new i13(n,e,h,l,_));}return this;},o10.visitAfter=function(t){var r,n=[],e=[];for(this._root&&n.push(new i13(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var h=r.node;if(h.length){var s,o=r.x0,a=r.y0,u=r.x1,l=r.y1,_=(o+u)/2,f=(a+l)/2;(s=h[0])&&n.push(new i13(s,o,a,_,f)),(s=h[1])&&n.push(new i13(s,_,a,u,f)),(s=h[2])&&n.push(new i13(s,o,f,_,l)),(s=h[3])&&n.push(new i13(s,_,f,u,l));}e.push(r);}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this;},o10.x=function(t){return arguments.length?(this._x=t,this):this._x;},o10.y=function(t){return arguments.length?(this._y=t,this):this._y;};var n11={value:()=>{}};function r11(){for(var n,r=0,e=arguments.length,o={};r<e;++r){if(!(n=arguments[r]+"")||n in o||/[\s.]/.test(n))throw new Error("illegal type: "+n);o[n]=[];}return new t11(o);}function t11(n){this._=n;}function e12(n,r){for(var t,e=0,o=n.length;e<o;++e)if((t=n[e]).name===r)return t.value;}function o11(r,t,e){for(var o=0,i=r.length;o<i;++o)if(r[o].name===t){r[o]=n11,r=r.slice(0,o).concat(r.slice(o+1));break;}return null!=e&&r.push({name:t,value:e}),r;}t11.prototype=r11.prototype={constructor:t11,on:function(n,r){var t,i,l=this._,a=(i=l,(n+"").trim().split(/^|\s+/).map(function(n){var r="",t=n.indexOf(".");if(t>=0&&(r=n.slice(t+1),n=n.slice(0,t)),n&&!i.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r};})),f=-1,u=a.length;if(!(arguments.length<2)){if(null!=r&&"function"!=typeof r)throw new Error("invalid callback: "+r);for(;++f<u;)if(t=(n=a[f]).type)l[t]=o11(l[t],n.name,r);else if(null==r)for(t in l)l[t]=o11(l[t],n.name,null);return this;}for(;++f<u;)if((t=(n=a[f]).type)&&(t=e12(l[t],n.name)))return t;},copy:function(){var n={},r=this._;for(var e in r)n[e]=r[e].slice();return new t11(n);},call:function(n,r){if((t=arguments.length-2)>0)for(var t,e,o=new Array(t),i=0;i<t;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(i=0,t=(e=this._[n]).length;i<t;++i)e[i].value.apply(r,o);},apply:function(n,r,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var e=this._[n],o=0,i=e.length;o<i;++o)e[o].value.apply(r,t);}};var t12,n12,e13=0,r12=0,o12=0,i14=0,a10=0,l12=0,u13="object"==typeof performance&&performance.now?performance:Date,c11="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17);};function s14(){return a10||(c11(f10),a10=u13.now()+l12);}function f10(){a10=0;}function _14(){this._call=this._time=this._next=null;}function w14(t,n,e){var r=new _14;return r.restart(t,n,e),r;}function m14(){s14(),++e13;for(var n,r=t12;r;)(n=a10-r._time)>=0&&r._call.call(void 0,n),r=r._next;--e13;}function p13(){a10=(i14=u13.now())+l12,e13=r12=0;try{m14();}finally{e13=0,function(){var e,r,o=t12,i=1/0;for(;o;)o._call?(i>o._time&&(i=o._time),e=o,o=o._next):(r=o._next,o._next=null,o=e?e._next=r:t12=r);n12=e,v13(i);}(),a10=0;}}function h14(){var t=u13.now(),n=t-i14;n>1e3&&(l12-=n,i14=t);}function v13(t){e13||(r12&&(r12=clearTimeout(r12)),t-a10>24?(t<1/0&&(r12=setTimeout(p13,t-u13.now()-l12)),o12&&(o12=clearInterval(o12))):(o12||(i14=u13.now(),o12=setInterval(h14,1e3)),e13=1,c11(p13)));}function y11(t,n,e){var r=new _14,o=n;return null==n?(r.restart(t,n,e),r):(r._restart=r.restart,r.restart=function(t,n,e){n=+n,e=null==e?s14():+e,r._restart(function i(a){a+=o,r._restart(i,o+=n,e),t(a);},n,e);},r.restart(t,n,e),r);}_14.prototype=w14.prototype={constructor:_14,restart:function(e,r,o){if("function"!=typeof e)throw new TypeError("callback is not a function");o=(null==o?s14():+o)+(null==r?0:+r),this._next||n12===this||(n12?n12._next=this:t12=this,n12=this),this._call=e,this._time=o,v13();},stop:function(){this._call&&(this._call=null,this._time=1/0,v13());}};function e14(n,t){var r,e=1;function i(){var i,o,u=r.length,f=0,a=0;for(i=0;i<u;++i)f+=(o=r[i]).x,a+=o.y;for(f=(f/u-n)*e,a=(a/u-t)*e,i=0;i<u;++i)(o=r[i]).x-=f,o.y-=a;}return null==n&&(n=0),null==t&&(t=0),i.initialize=function(n){r=n;},i.x=function(t){return arguments.length?(n=+t,i):n;},i.y=function(n){return arguments.length?(t=+n,i):t;},i.strength=function(n){return arguments.length?(e=+n,i):e;},i;}function i15(n){return function(){return n;};}function o13(n){return 1e-6*(n()-.5);}function u14(n){return n.x+n.vx;}function f11(n){return n.y+n.vy;}function a11(t){var r,e,a,c=1,l=1;function h(){for(var t,i,h,y,x,g,s,d=r.length,p=0;p<l;++p)for(i=e11(r,u14,f11).visitAfter(v),t=0;t<d;++t)h=r[t],g=e[h.index],s=g*g,y=h.x+h.vx,x=h.y+h.vy,i.visit(M);function M(n,t,r,e,i){var u=n.data,f=n.r,l=g+f;if(!u)return t>y+l||e<y-l||r>x+l||i<x-l;if(u.index>h.index){var v=y-u.x-u.vx,d=x-u.y-u.vy,p=v*v+d*d;p<l*l&&(0===v&&(p+=(v=o13(a))*v),0===d&&(p+=(d=o13(a))*d),p=(l-(p=Math.sqrt(p)))/p*c,h.vx+=(v*=p)*(l=(f*=f)/(s+f)),h.vy+=(d*=p)*l,u.vx-=v*(l=1-l),u.vy-=d*l);}}}function v(n){if(n.data)return n.r=e[n.data.index];for(var t=n.r=0;t<4;++t)n[t]&&n[t].r>n.r&&(n.r=n[t].r);}function y(){if(r){var n,i,o=r.length;for(e=new Array(o),n=0;n<o;++n)i=r[n],e[i.index]=+t(i,n,r);}}return"function"!=typeof t&&(t=i15(null==t?1:+t)),h.initialize=function(n,t){r=n,a=t,y();},h.iterations=function(n){return arguments.length?(l=+n,h):l;},h.strength=function(n){return arguments.length?(c=+n,h):c;},h.radius=function(n){return arguments.length?(t="function"==typeof n?n:i15(+n),y(),h):t;},h;}function c12(n){return n.index;}function l13(n,t){var r=n.get(t);if(!r)throw new Error("node not found: "+t);return r;}function h15(n){var t,r,e,u,f,a,h=c12,v=function(n){return 1/Math.min(u[n.source.index],u[n.target.index]);},y=i15(30),x=1;function g(e){for(var i=0,u=n.length;i<x;++i)for(var c,l,h,v,y,g,s,d=0;d<u;++d)l=(c=n[d]).source,v=(h=c.target).x+h.vx-l.x-l.vx||o13(a),y=h.y+h.vy-l.y-l.vy||o13(a),v*=g=((g=Math.sqrt(v*v+y*y))-r[d])/g*e*t[d],y*=g,h.vx-=v*(s=f[d]),h.vy-=y*s,l.vx+=v*(s=1-s),l.vy+=y*s;}function s(){if(e){var i,o,a=e.length,c=n.length,v=new Map(e.map((n,t)=>[h(n,t,e),n]));for(i=0,u=new Array(a);i<c;++i)(o=n[i]).index=i,"object"!=typeof o.source&&(o.source=l13(v,o.source)),"object"!=typeof o.target&&(o.target=l13(v,o.target)),u[o.source.index]=(u[o.source.index]||0)+1,u[o.target.index]=(u[o.target.index]||0)+1;for(i=0,f=new Array(c);i<c;++i)o=n[i],f[i]=u[o.source.index]/(u[o.source.index]+u[o.target.index]);t=new Array(c),d(),r=new Array(c),p();}}function d(){if(e)for(var r=0,i=n.length;r<i;++r)t[r]=+v(n[r],r,n);}function p(){if(e)for(var t=0,i=n.length;t<i;++t)r[t]=+y(n[t],t,n);}return null==n&&(n=[]),g.initialize=function(n,t){e=n,a=t,s();},g.links=function(t){return arguments.length?(n=t,s(),g):n;},g.id=function(n){return arguments.length?(h=n,g):h;},g.iterations=function(n){return arguments.length?(x=+n,g):x;},g.strength=function(n){return arguments.length?(v="function"==typeof n?n:i15(+n),d(),g):v;},g.distance=function(n){return arguments.length?(y="function"==typeof n?n:i15(+n),p(),g):y;},g;}const v14=4294967296;function y12(n){return n.x;}function x15(n){return n.y;}var g12=Math.PI*(3-Math.sqrt(5));function s15(n){var e,i=1,o=.001,u=1-Math.pow(o,1/300),f=0,a=.6,c=new Map,l=w14(x),h=r11("tick","end"),y=function(){let n=1;return()=>(n=(1664525*n+1013904223)%v14)/4294967296;}();function x(){s(),h.call("tick",e),i<o&&(l.stop(),h.call("end",e));}function s(t){var r,o,l=n.length;void 0===t&&(t=1);for(var h=0;h<t;++h)for(i+=(f-i)*u,c.forEach(function(n){n(i);}),r=0;r<l;++r)null==(o=n[r]).fx?o.x+=o.vx*=a:(o.x=o.fx,o.vx=0),null==o.fy?o.y+=o.vy*=a:(o.y=o.fy,o.vy=0);return e;}function d(){for(var t,r=0,e=n.length;r<e;++r){if((t=n[r]).index=r,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=10*Math.sqrt(.5+r),o=r*g12;t.x=i*Math.cos(o),t.y=i*Math.sin(o);}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0);}}function p(t){return t.initialize&&t.initialize(n,y),t;}return null==n&&(n=[]),d(),e={tick:s,restart:function(){return l.restart(x),e;},stop:function(){return l.stop(),e;},nodes:function(t){return arguments.length?(n=t,d(),c.forEach(p),e):n;},alpha:function(n){return arguments.length?(i=+n,e):i;},alphaMin:function(n){return arguments.length?(o=+n,e):o;},alphaDecay:function(n){return arguments.length?(u=+n,e):+u;},alphaTarget:function(n){return arguments.length?(f=+n,e):f;},velocityDecay:function(n){return arguments.length?(a=1-n,e):1-a;},randomSource:function(n){return arguments.length?(y=n,c.forEach(p),e):y;},force:function(n,t){return arguments.length>1?(null==t?c.delete(n):c.set(n,p(t)),e):c.get(n);},find:function(t,r,e){var i,o,u,f,a,c=0,l=n.length;for(null==e?e=1/0:e*=e,c=0;c<l;++c)(u=(i=t-(f=n[c]).x)*i+(o=r-f.y)*o)<e&&(a=f,e=u);return a;},on:function(n,t){return arguments.length>1?(h.on(n,t),e):h.on(n);}};}function d12(){var t,r,e,u,f,a=i15(-30),c=1,l=1/0,h=.81;function v(e){var i,o=t.length,f=e11(t,y12,x15).visitAfter(s);for(u=e,i=0;i<o;++i)r=t[i],f.visit(d);}function g(){if(t){var n,r,e=t.length;for(f=new Array(e),n=0;n<e;++n)r=t[n],f[r.index]=+a(r,n,t);}}function s(n){var t,r,e,i,o,u=0,a=0;if(n.length){for(e=i=o=0;o<4;++o)(t=n[o])&&(r=Math.abs(t.value))&&(u+=t.value,a+=r,e+=r*t.x,i+=r*t.y);n.x=e/a,n.y=i/a;}else{(t=n).x=t.data.x,t.y=t.data.y;do{u+=f[t.data.index];}while(t=t.next)}n.value=u;}function d(n,t,i,a){if(!n.value)return!0;var v=n.x-r.x,y=n.y-r.y,x=a-t,g=v*v+y*y;if(x*x/h<g)return g<l&&(0===v&&(g+=(v=o13(e))*v),0===y&&(g+=(y=o13(e))*y),g<c&&(g=Math.sqrt(c*g)),r.vx+=v*n.value*u/g,r.vy+=y*n.value*u/g),!0;if(!(n.length||g>=l)){(n.data!==r||n.next)&&(0===v&&(g+=(v=o13(e))*v),0===y&&(g+=(y=o13(e))*y),g<c&&(g=Math.sqrt(c*g)));do{n.data!==r&&(x=f[n.data.index]*u/g,r.vx+=v*x,r.vy+=y*x);}while(n=n.next)}}return v.initialize=function(n,r){t=n,e=r,g();},v.strength=function(n){return arguments.length?(a="function"==typeof n?n:i15(+n),g(),v):a;},v.distanceMin=function(n){return arguments.length?(c=n*n,v):Math.sqrt(c);},v.distanceMax=function(n){return arguments.length?(l=n*n,v):Math.sqrt(l);},v.theta=function(n){return arguments.length?(h=n*n,v):Math.sqrt(h);},v;}function M14(n){var t,r,e,o=i15(.1);function u(n){for(var i,o=0,u=t.length;o<u;++o)(i=t[o]).vx+=(e[o]-i.x)*r[o]*n;}function f(){if(t){var i,u=t.length;for(r=new Array(u),e=new Array(u),i=0;i<u;++i)r[i]=isNaN(e[i]=+n(t[i],i,t))?0:+o(t[i],i,t);}}return"function"!=typeof n&&(n=i15(null==n?0:+n)),u.initialize=function(n){t=n,f();},u.strength=function(n){return arguments.length?(o="function"==typeof n?n:i15(+n),f(),u):o;},u.x=function(t){return arguments.length?(n="function"==typeof t?t:i15(+t),f(),u):n;},u;}function w15(n){var t,r,e,o=i15(.1);function u(n){for(var i,o=0,u=t.length;o<u;++o)(i=t[o]).vy+=(e[o]-i.y)*r[o]*n;}function f(){if(t){var i,u=t.length;for(r=new Array(u),e=new Array(u),i=0;i<u;++i)r[i]=isNaN(e[i]=+n(t[i],i,t))?0:+o(t[i],i,t);}}return"function"!=typeof n&&(n=i15(null==n?0:+n)),u.initialize=function(n){t=n,f();},u.strength=function(n){return arguments.length?(o="function"==typeof n?n:i15(+n),f(),u):o;},u.y=function(t){return arguments.length?(n="function"==typeof t?t:i15(+t),f(),u):n;},u;}const c13={center:e14,collide:a11,nbody:d12,link:h15,x:M14,y:w15},y13="forces",h16=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],b14=["static","iterations"],g13=["x","y","vx","vy"];function x16(a){st2.call(this,null,a);}function k15(e,a,r,n){var o,i,f,m,p=H(a.forces);for(o=0,i=h16.length;o<i;++o)(f=h16[o])!==y13&&a.modified(f)&&e[f](a[f]);for(o=0,i=p.length;o<i;++o)m=y13+o,(f=r||a.modified(y13,o)?M15(p[o]):n&&v15(p[o],n)?e.force(m):null)&&e.force(m,f);for(i=e.numForces||0;o<i;++o)e.force(y13+o,null);return e.numForces=p.length,e;}function v15(e1,a){var t,o;for(t in e1)if(L(o=e1[t])&&a.modified(e(o)))return 1;return 0;}function M15(e){var a,t;for(t in ln(c13,e.force)||l("Unrecognized force: "+e.force),a=c13[e.force](),e)L(a[t])&&D14(a[t],e[t],e);return a;}function D14(e,a,t){e(L(a)?e=>a(e,t):a);}x16.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:g13}]},an(x16,st2,{transform(e,a){var t,r,n=this.value,o=a.changed(a.ADD_REM),i=e.modified(h16),m=e.iterations||300;if(n?(o&&(a.modifies("index"),n.nodes(a.source)),(i||a.changed(a.MOD))&&k15(n,e,0,a)):(this.value=n=function(e,a){const t=s15(e),r=t.stop,n=t.restart;let o=!1;return t.stopped=()=>o,t.restart=()=>(o=!1,n()),t.stop=()=>(o=!0,r()),k15(t,a,!0).on("end",()=>o=!0);}(a.source,e),n.on("tick",(t=a.dataflow,r=this,()=>t.touch(r).run())),e.static||(o=!0,n.tick()),a.modifies("index")),i||o||e.modified(b14)||a.changed()&&e.restart){if(n.alpha(Math.max(n.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/m)),e.static)for(n.stop();--m>=0;)n.tick();else if(n.stopped()&&n.restart(),!o)return a.StopPropagation;}return this.finish(e,a);},finish(e,a){const t=a.dataflow;for(let e,a=this._argops,f=0,m=a.length;f<m;++f)if(e=a[f],e.name===y13&&"link"===e.op._argval.force){for(var r,n=e.op._argops,o=0,i=n.length;o<i;++o)if("links"===n[o].name&&(r=n[o].op.source)){t.pulse(r,t.changeset().reflow());break;}}return a.reflow(e.modified()).modifies(g13);}});const mod5=function(){return{force:x16,default:null};}();function n13(n,r){return n.parent===r.parent?1:2;}function r13(n,r){return n+r.x;}function t13(n,r){return Math.max(n,r.y);}function e15(){var e=n13,u=1,i=1,o=!1;function a(n){var a,f=0;n.eachAfter(function(n){var u=n.children;u?(n.x=function(n){return n.reduce(r13,0)/n.length;}(u),n.y=function(n){return 1+n.reduce(t13,0);}(u)):(n.x=a?f+=e(n,a):0,n.y=0,a=n);});var c=function(n){for(var r;r=n.children;)n=r[0];return n;}(n),h=function(n){for(var r;r=n.children;)n=r[r.length-1];return n;}(n),l=c.x-e(c,h)/2,p=h.x+e(h,c)/2;return n.eachAfter(o?function(r){r.x=(r.x-n.x)*u,r.y=(n.y-r.y)*i;}:function(r){r.x=(r.x-l)/(p-l)*u,r.y=(1-(n.y?r.y/n.y:1))*i;});}return a.separation=function(n){return arguments.length?(e=n,a):e;},a.size=function(n){return arguments.length?(o=!1,u=+n[0],i=+n[1],a):o?null:[u,i];},a.nodeSize=function(n){return arguments.length?(o=!0,u=+n[0],i=+n[1],a):o?[u,i]:null;},a;}function u15(n){var r=0,t=n.children,e=t&&t.length;if(e)for(;--e>=0;)r+=t[e].value;else r=1;n.value=r;}function i16(n,r){n instanceof Map?(n=[void 0,n],void 0===r&&(r=a12)):void 0===r&&(r=o14);for(var t,e,u,i,f,l=new h17(n),p=[l];t=p.pop();)if((u=r(t.data))&&(f=(u=Array.from(u)).length))for(t.children=u,i=f-1;i>=0;--i)p.push(e=u[i]=new h17(u[i])),e.parent=t,e.depth=t.depth+1;return l.eachBefore(c14);}function o14(n){return n.children;}function a12(n){return Array.isArray(n)?n[1]:null;}function f12(n){void 0!==n.data.value&&(n.value=n.data.value),n.data=n.data.data;}function c14(n){var r=0;do{n.height=r;}while((n=n.parent)&&n.height<++r)}function h17(n){this.data=n,this.depth=this.height=0,this.parent=null;}function l14(n){return null==n?null:p14(n);}function p14(n){if("function"!=typeof n)throw new Error;return n;}function s16(){return 0;}function d13(n){return function(){return n;};}h17.prototype=i16.prototype={constructor:h17,count:function(){return this.eachAfter(u15);},each:function(n,r){let t=-1;for(const e of this)n.call(r,e,++t,this);return this;},eachAfter:function(n,r){for(var t,e,u,i=this,o=[i],a=[],f=-1;i=o.pop();)if(a.push(i),t=i.children)for(e=0,u=t.length;e<u;++e)o.push(t[e]);for(;i=a.pop();)n.call(r,i,++f,this);return this;},eachBefore:function(n,r){for(var t,e,u=this,i=[u],o=-1;u=i.pop();)if(n.call(r,u,++o,this),t=u.children)for(e=t.length-1;e>=0;--e)i.push(t[e]);return this;},find:function(n,r){let t=-1;for(const e of this)if(n.call(r,e,++t,this))return e;},sum:function(n){return this.eachAfter(function(r){for(var t=+n(r.data)||0,e=r.children,u=e&&e.length;--u>=0;)t+=e[u].value;r.value=t;});},sort:function(n){return this.eachBefore(function(r){r.children&&r.children.sort(n);});},path:function(n){for(var r=this,t=function(n,r){if(n===r)return n;var t=n.ancestors(),e=r.ancestors(),u=null;n=t.pop(),r=e.pop();for(;n===r;)u=n,n=t.pop(),r=e.pop();return u;}(r,n),e=[r];r!==t;)r=r.parent,e.push(r);for(var u=e.length;n!==t;)e.splice(u,0,n),n=n.parent;return e;},ancestors:function(){for(var n=this,r=[n];n=n.parent;)r.push(n);return r;},descendants:function(){return Array.from(this);},leaves:function(){var n=[];return this.eachBefore(function(r){r.children||n.push(r);}),n;},links:function(){var n=this,r=[];return n.each(function(t){t!==n&&r.push({source:t.parent,target:t});}),r;},copy:function(){return i16(this).eachBefore(f12);},[Symbol.iterator]:function*(){var n,r,t,e,u=this,i=[u];do{for(n=i.reverse(),i=[];u=n.pop();)if(yield u,r=u.children)for(t=0,e=r.length;t<e;++t)i.push(r[t]);}while(i.length)}};const v16=4294967296;function x17(){let n=1;return()=>(n=(1664525*n+1013904223)%v16)/4294967296;}function g14(n,r){for(var t,e,u=0,i=(n=function(n,r){let t,e,u=n.length;for(;u;)e=r()*u--|0,t=n[u],n[u]=n[e],n[e]=t;return n;}(Array.from(n),r)).length,o=[];u<i;)t=n[u],e&&_15(e,t)?++u:(e=z17(o=m15(o,t)),u=0);return e;}function m15(n,r){var t,e;if(M16(r,n))return[r];for(t=0;t<n.length;++t)if(w16(r,n[t])&&M16(B17(n[t],r),n))return[n[t],r];for(t=0;t<n.length-1;++t)for(e=t+1;e<n.length;++e)if(w16(B17(n[t],n[e]),r)&&w16(B17(n[t],r),n[e])&&w16(B17(n[e],r),n[t])&&M16(A18(n[t],n[e],r),n))return[n[t],n[e],r];throw new Error;}function w16(n,r){var t=n.r-r.r,e=r.x-n.x,u=r.y-n.y;return t<0||t*t<e*e+u*u;}function _15(n,r){var t=n.r-r.r+1e-9*Math.max(n.r,r.r,1),e=r.x-n.x,u=r.y-n.y;return t>0&&t*t>e*e+u*u;}function M16(n,r){for(var t=0;t<r.length;++t)if(!_15(n,r[t]))return!1;return!0;}function z17(n){switch(n.length){case 1:return function(n){return{x:n.x,y:n.y,r:n.r};}(n[0]);case 2:return B17(n[0],n[1]);case 3:return A18(n[0],n[1],n[2]);}}function B17(n,r){var t=n.x,e=n.y,u=n.r,i=r.x,o=r.y,a=r.r,f=i-t,c=o-e,h=a-u,l=Math.sqrt(f*f+c*c);return{x:(t+i+f/l*h)/2,y:(e+o+c/l*h)/2,r:(l+u+a)/2};}function A18(n,r,t){var e=n.x,u=n.y,i=n.r,o=r.x,a=r.y,f=r.r,c=t.x,h=t.y,l=t.r,p=e-o,s=e-c,d=u-a,v=u-h,x=f-i,y=l-i,g=e*e+u*u-i*i,m=g-o*o-a*a+f*f,w=g-c*c-h*h+l*l,_=s*d-p*v,M=(d*w-v*m)/(2*_)-e,z=(v*x-d*y)/_,B=(s*m-p*w)/(2*_)-u,A=(p*y-s*x)/_,q=z*z+A*A-1,E=2*(i+M*z+B*A),b=M*M+B*B-i*i,S=-(Math.abs(q)>1e-6?(E+Math.sqrt(E*E-4*q*b))/(2*q):b/E);return{x:e+M+z*S,y:u+B+A*S,r:S};}function q15(n,r,t){var e,u,i,o,a=n.x-r.x,f=n.y-r.y,c=a*a+f*f;c?(u=r.r+t.r,u*=u,o=n.r+t.r,u>(o*=o)?(e=(c+o-u)/(2*c),i=Math.sqrt(Math.max(0,o/c-e*e)),t.x=n.x-e*a-i*f,t.y=n.y-e*f+i*a):(e=(c+u-o)/(2*c),i=Math.sqrt(Math.max(0,u/c-e*e)),t.x=r.x+e*a-i*f,t.y=r.y+e*f+i*a)):(t.x=r.x+t.r,t.y=r.y);}function E18(n,r){var t=n.r+r.r-1e-6,e=r.x-n.x,u=r.y-n.y;return t>0&&t*t>e*e+u*u;}function b15(n){var r=n._,t=n.next._,e=r.r+t.r,u=(r.x*t.r+t.x*r.r)/e,i=(r.y*t.r+t.y*r.r)/e;return u*u+i*i;}function S14(n){this._=n,this.next=null,this.previous=null;}function k16(n,r){if(!(o=(t=n,n="object"==typeof t&&"length"in t?t:Array.from(t)).length))return 0;var t,e,u,i,o,a,f,c,h,l,p,s;if((e=n[0]).x=0,e.y=0,!(o>1))return e.r;if(u=n[1],e.x=-u.r,u.x=e.r,u.y=0,!(o>2))return e.r+u.r;q15(u,e,i=n[2]),e=new S14(e),u=new S14(u),i=new S14(i),e.next=i.previous=u,u.next=e.previous=i,i.next=u.previous=e;n:for(c=3;c<o;++c){q15(e._,u._,i=n[c]),i=new S14(i),h=u.next,l=e.previous,p=u._.r,s=e._.r;do{if(p<=s){if(E18(h._,i._)){u=h,e.next=u,u.previous=e,--c;continue n;}p+=h._.r,h=h.next;}else{if(E18(l._,i._)){(e=l).next=u,u.previous=e,--c;continue n;}s+=l._.r,l=l.previous;}}while(h!==l.next)for(i.previous=e,i.next=u,e.next=u.previous=u=i,a=b15(e);(i=i.next)!==u;)(f=b15(i))<a&&(e=i,a=f);u=e.next;}for(e=[u._],i=u;(i=i.next)!==u;)e.push(i._);for(i=g14(e,r),c=0;c<o;++c)(e=n[c]).x-=i.x,e.y-=i.y;return i.r;}function O13(n){return Math.sqrt(n.value);}function R14(){var n=null,r=1,t=1,e=s16;function u(u){const i=x17();return u.x=r/2,u.y=t/2,n?u.eachBefore(T15(n)).eachAfter(j16(e,.5,i)).eachBefore(L15(1)):u.eachBefore(T15(O13)).eachAfter(j16(s16,1,i)).eachAfter(j16(e,u.r/Math.min(r,t),i)).eachBefore(L15(Math.min(r,t)/(2*u.r))),u;}return u.radius=function(r){return arguments.length?(n=l14(r),u):n;},u.size=function(n){return arguments.length?(r=+n[0],t=+n[1],u):[r,t];},u.padding=function(n){return arguments.length?(e="function"==typeof n?n:d13(+n),u):e;},u;}function T15(n){return function(r){r.children||(r.r=Math.max(0,+n(r)||0));};}function j16(n,r,t){return function(e){if(u=e.children){var u,i,o,a=u.length,f=n(e)*r||0;if(f)for(i=0;i<a;++i)u[i].r+=f;if(o=k16(u,t),f)for(i=0;i<a;++i)u[i].r-=f;e.r=o+f;}};}function L15(n){return function(r){var t=r.parent;r.r*=n,t&&(r.x=t.x+n*r.x,r.y=t.y+n*r.y);};}function $15(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1);}function D15(n,r,t,e,u){for(var i,o=n.children,a=-1,f=o.length,c=n.value&&(e-r)/n.value;++a<f;)(i=o[a]).y0=t,i.y1=u,i.x0=r,i.x1=r+=i.value*c;}function N17(){var n=1,r=1,t=0,e=!1;function u(u){var i=u.height+1;return u.x0=u.y0=t,u.x1=n,u.y1=r/i,u.eachBefore(function(n,r){return function(e){e.children&&D15(e,e.x0,n*(e.depth+1)/r,e.x1,n*(e.depth+2)/r);var u=e.x0,i=e.y0,o=e.x1-t,a=e.y1-t;o<u&&(u=o=(u+o)/2),a<i&&(i=a=(i+a)/2),e.x0=u,e.y0=i,e.x1=o,e.y1=a;};}(r,i)),e&&u.eachBefore($15),u;}return u.round=function(n){return arguments.length?(e=!!n,u):e;},u.size=function(t){return arguments.length?(n=+t[0],r=+t[1],u):[n,r];},u.padding=function(n){return arguments.length?(t=+n,u):t;},u;}var C16={depth:-1},F16={},G17={};function H17(n){return n.id;}function J19(n){return n.parentId;}function K19(){var n,r=H17,t=J19;function e(e){var u,i,o,a,f,l,p,s,d=Array.from(e),v=r,x=t,y=new Map;if(null!=n){const r=d.map((r,t)=>(function(n){n=`${n}`;let r=n.length;Q15(n,r-1)&&!Q15(n,r-2)&&(n=n.slice(0,-1));return"/"===n[0]?n:`/${n}`;})(n(r,t,e))),t=r.map(P15),u=new Set(r).add("");for(const n of t)u.has(n)||(u.add(n),r.push(n),t.push(P15(n)),d.push(G17));v=(n,t)=>r[t],x=(n,r)=>t[r];}for(o=0,u=d.length;o<u;++o)i=d[o],l=d[o]=new h17(i),null!=(p=v(i,o,e))&&(p+="")&&(s=l.id=p,y.set(s,y.has(s)?F16:l)),null!=(p=x(i,o,e))&&(p+="")&&(l.parent=p);for(o=0;o<u;++o)if(p=(l=d[o]).parent){if(!(f=y.get(p)))throw new Error("missing: "+p);if(f===F16)throw new Error("ambiguous: "+p);f.children?f.children.push(l):f.children=[l],l.parent=f;}else{if(a)throw new Error("multiple roots");a=l;}if(!a)throw new Error("no root");if(null!=n){for(;a.data===G17&&1===a.children.length;)a=a.children[0],--u;for(let n=d.length-1;n>=0&&(l=d[n]).data===G17;--n)l.data=null;}if(a.parent=C16,a.eachBefore(function(n){n.depth=n.parent.depth+1,--u;}).eachBefore(c14),a.parent=null,u>0)throw new Error("cycle");return a;}return e.id=function(n){return arguments.length?(r=l14(n),e):r;},e.parentId=function(n){return arguments.length?(t=l14(n),e):t;},e.path=function(r){return arguments.length?(n=l14(r),e):n;},e;}function P15(n){let r=n.length;if(r<2)return"";for(;--r>1&&!Q15(n,r););return n.slice(0,r);}function Q15(n,r){if("/"===n[r]){let t=0;for(;r>0&&"\\"===n[--r];)++t;if(!(1&t))return!0;}return!1;}function U14(n,r){return n.parent===r.parent?1:2;}function V16(n){var r=n.children;return r?r[0]:n.t;}function W18(n){var r=n.children;return r?r[r.length-1]:n.t;}function X18(n,r,t){var e=t/(r.i-n.i);r.c-=e,r.s+=t,n.c+=e,r.z+=t,r.m+=t;}function Y17(n,r,t){return n.a.parent===r.parent?n.a:t;}function Z19(n,r){this._=n,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=r;}function nn7(){var n=U14,r=1,t=1,e=null;function u(u){var f=function(n){for(var r,t,e,u,i,o=new Z19(n,0),a=[o];r=a.pop();)if(e=r._.children)for(r.children=new Array(i=e.length),u=i-1;u>=0;--u)a.push(t=r.children[u]=new Z19(e[u],u)),t.parent=r;return(o.parent=new Z19(null,0)).children=[o],o;}(u);if(f.eachAfter(i),f.parent.m=-f.z,f.eachBefore(o),e)u.eachBefore(a);else{var c=u,h=u,l=u;u.eachBefore(function(n){n.x<c.x&&(c=n),n.x>h.x&&(h=n),n.depth>l.depth&&(l=n);});var p=c===h?1:n(c,h)/2,s=p-c.x,d=r/(h.x+p+s),v=t/(l.depth||1);u.eachBefore(function(n){n.x=(n.x+s)*d,n.y=n.depth*v;});}return u;}function i(r){var t=r.children,e=r.parent.children,u=r.i?e[r.i-1]:null;if(t){!function(n){for(var r,t=0,e=0,u=n.children,i=u.length;--i>=0;)(r=u[i]).z+=t,r.m+=t,t+=r.s+(e+=r.c);}(r);var i=(t[0].z+t[t.length-1].z)/2;u?(r.z=u.z+n(r._,u._),r.m=r.z-i):r.z=i;}else u&&(r.z=u.z+n(r._,u._));r.parent.A=function(r,t,e){if(t){for(var u,i=r,o=r,a=t,f=i.parent.children[0],c=i.m,h=o.m,l=a.m,p=f.m;a=W18(a),i=V16(i),a&&i;)f=V16(f),(o=W18(o)).a=r,(u=a.z+l-i.z-c+n(a._,i._))>0&&(X18(Y17(a,r,e),r,u),c+=u,h+=u),l+=a.m,c+=i.m,p+=f.m,h+=o.m;a&&!W18(o)&&(o.t=a,o.m+=l-h),i&&!V16(f)&&(f.t=i,f.m+=c-p,e=r);}return e;}(r,u,r.parent.A||e[0]);}function o(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m;}function a(n){n.x*=r,n.y=n.depth*t;}return u.separation=function(r){return arguments.length?(n=r,u):n;},u.size=function(n){return arguments.length?(e=!1,r=+n[0],t=+n[1],u):e?null:[r,t];},u.nodeSize=function(n){return arguments.length?(e=!0,r=+n[0],t=+n[1],u):e?[r,t]:null;},u;}function rn7(n,r,t,e,u){for(var i,o=n.children,a=-1,f=o.length,c=n.value&&(u-t)/n.value;++a<f;)(i=o[a]).x0=r,i.x1=e,i.y0=t,i.y1=t+=i.value*c;}Z19.prototype=Object.create(h17.prototype);var tn6=(1+Math.sqrt(5))/2;function en7(n,r,t,e,u,i){for(var o,a,f,c,h,l,p,s,d,v,x,y=[],g=r.children,m=0,w=0,_=g.length,M=r.value;m<_;){f=u-t,c=i-e;do{h=g[w++].value;}while(!h&&w<_)for(l=p=h,x=h*h*(v=Math.max(c/f,f/c)/(M*n)),d=Math.max(p/x,x/l);w<_;++w){if(h+=a=g[w].value,a<l&&(l=a),a>p&&(p=a),x=h*h*v,(s=Math.max(p/x,x/l))>d){h-=a;break;}d=s;}y.push(o={value:h,dice:f<c,children:g.slice(m,w)}),o.dice?D15(o,t,e,u,M?e+=c*h/M:i):rn7(o,t,e,M?t+=f*h/M:u,i),M-=h,m=w;}return y;}var un6=function n(r){function t(n,t,e,u,i){en7(r,n,t,e,u,i);}return t.ratio=function(r){return n((r=+r)>1?r:1);},t;}(tn6);function on6(){var n=un6,r=!1,t=1,e=1,u=[0],i=s16,o=s16,a=s16,f=s16,c=s16;function h(n){return n.x0=n.y0=0,n.x1=t,n.y1=e,n.eachBefore(l),u=[0],r&&n.eachBefore($15),n;}function l(r){var t=u[r.depth],e=r.x0+t,h=r.y0+t,l=r.x1-t,p=r.y1-t;l<e&&(e=l=(e+l)/2),p<h&&(h=p=(h+p)/2),r.x0=e,r.y0=h,r.x1=l,r.y1=p,r.children&&(t=u[r.depth+1]=i(r)/2,e+=c(r)-t,h+=o(r)-t,(l-=a(r)-t)<e&&(e=l=(e+l)/2),(p-=f(r)-t)<h&&(h=p=(h+p)/2),n(r,e,h,l,p));}return h.round=function(n){return arguments.length?(r=!!n,h):r;},h.size=function(n){return arguments.length?(t=+n[0],e=+n[1],h):[t,e];},h.tile=function(r){return arguments.length?(n=p14(r),h):n;},h.padding=function(n){return arguments.length?h.paddingInner(n).paddingOuter(n):h.paddingInner();},h.paddingInner=function(n){return arguments.length?(i="function"==typeof n?n:d13(+n),h):i;},h.paddingOuter=function(n){return arguments.length?h.paddingTop(n).paddingRight(n).paddingBottom(n).paddingLeft(n):h.paddingTop();},h.paddingTop=function(n){return arguments.length?(o="function"==typeof n?n:d13(+n),h):o;},h.paddingRight=function(n){return arguments.length?(a="function"==typeof n?n:d13(+n),h):a;},h.paddingBottom=function(n){return arguments.length?(f="function"==typeof n?n:d13(+n),h):f;},h.paddingLeft=function(n){return arguments.length?(c="function"==typeof n?n:d13(+n),h):c;},h;}function an6(n,r,t,e,u){var i,o,a=n.children,f=a.length,c=new Array(f+1);for(c[0]=o=i=0;i<f;++i)c[i+1]=o+=a[i].value;!function n(r,t,e,u,i,o,f){if(r>=t-1){var h=a[r];return h.x0=u,h.y0=i,h.x1=o,void(h.y1=f);}var l=c[r],p=e/2+l,s=r+1,d=t-1;for(;s<d;){var v=s+d>>>1;c[v]<p?s=v+1:d=v;}p-c[s-1]<c[s]-p&&r+1<s&&--s;var x=c[s]-l,y=e-x;if(o-u>f-i){var g=e?(u*y+o*x)/e:o;n(r,s,x,u,i,g,f),n(s,t,y,g,i,o,f);}else{var m=e?(i*y+f*x)/e:f;n(r,s,x,u,i,o,m),n(s,t,y,u,m,o,f);}}(0,f,n.value,r,t,e,u);}function fn6(n,r,t,e,u){(1&n.depth?rn7:D15)(n,r,t,e,u);}var cn7=function n(r){function t(n,t,e,u,i){if((o=n._squarify)&&o.ratio===r)for(var o,a,f,c,h,l=-1,p=o.length,s=n.value;++l<p;){for(f=(a=o[l]).children,c=a.value=0,h=f.length;c<h;++c)a.value+=f[c].value;a.dice?D15(a,t,e,u,s?e+=(i-e)*a.value/s:i):rn7(a,t,e,s?t+=(u-t)*a.value/s:u,i),s-=a.value;}else n._squarify=o=en7(r,n,t,e,u,i),o.ratio=r;}return t.ratio=function(r){return n((r=+r)>1?r:1);},t;}(tn6);function x18(e,t,a){const n={};return e.each(e=>{const r=e.data;a(r)&&(n[t(r)]=e);}),e.lookup=n,e;}function O14(t){st2.call(this,null,t);}O14.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const T16=e=>e.values;function R15(){const e=[],t={entries:e=>n(a(e,0),0),key:a=>(e.push(a),t)};function a(t,n){if(n>=e.length)return t;const r=t.length,i=e[n++],s={},o={};let d,u,l,m=-1;for(;++m<r;)d=i(u=t[m])+"",(l=s[d])?l.push(u):s[d]=[u];for(d in s)o[d]=a(s[d],n);return o;}function n(t,a){if(++a>e.length)return t;const r=[];for(const e in t)r.push({key:e,values:n(t[e],a)});return r;}return t;}function S15(t){st2.call(this,null,t);}an(O14,st2,{transform(e,n){n.source||l("Nest transform requires an upstream data source.");var i=e.generate,d=e.modified(),u=n.clone(),l1=this.value;return(!l1||d||n.changed())&&(l1&&l1.each(e=>{e.children&&D5(e.data)&&u.rem.push(e.data);}),this.value=l1=i16({values:H(e.keys).reduce((e,t)=>(e.key(t),e),R15()).entries(u.source)},T16),i&&l1.each(e=>{e.children&&(e=O6(e.data),u.add.push(e),u.source.push(e));}),x18(l1,E7,E7)),u.source.root=l1,u;}});const E19=(e,t)=>e.parent===t.parent?1:2;an(S15,st2,{transform(e,t){t.source&&t.source.root||l(this.constructor.name+" transform requires a backing tree data source.");const a=this.layout(e.method),r=this.fields,i=t.source.root,o=e.as||r;e.field?i.sum(e.field):i.count(),e.sort&&i.sort(b5(e.sort,e=>e.data)),function(e,t,a){for(let n,r=0,i=t.length;r<i;++r)n=t[r],n in a&&e[n](a[n]);}(a,this.params,e),a.separation&&a.separation(!1!==e.separation?E19:h);try{this.value=a(i);}catch(e){l(e);}return i.each(e=>(function(e,t,a){const n=e.data,r=t.length-1;for(let i=0;i<r;++i)n[a[i]]=e[t[i]];n[a[r]]=e.children?e.children.length:0;})(e,r,o)),t.reflow(e.modified()).modifies(o).modifies("leaf");}});const L16=["x","y","r","depth","children"];function U15(e){S15.call(this,e);}U15.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:L16.length,default:L16}]},an(U15,S15,{layout:R14,params:["radius","size","padding"],fields:L16});const M17=["x0","y0","x1","y1","depth","children"];function A19(e){S15.call(this,e);}function C17(t){st2.call(this,null,t);}A19.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:M17.length,default:M17}]},an(A19,S15,{layout:N17,params:["size","round","padding"],fields:M17}),C17.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},an(C17,st2,{transform(e,t){t.source||l("Stratify transform requires an upstream data source.");let a=this.value;const n=e.modified(),r=t.fork(t.ALL).materialize(t.SOURCE),i=!a||n||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return r.source=r.source.slice(),i&&(a=r.source.length?x18(K19().id(e.key).parentId(e.parentKey)(r.source),e.key,g):x18(K19()([{}]),e.key,e.key)),r.source.root=this.value=a,r;}});const I15={tidy:nn7,cluster:e15},K20=["x","y","depth","children"];function N18(e){S15.call(this,e);}function _16(t){st2.call(this,[],t);}N18.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:K20.length,default:K20}]},an(N18,S15,{layout(e){const t=e||"tidy";if(ln(I15,t))return I15[t]();l("Unrecognized Tree layout method: "+t);},params:["size","nodeSize"],fields:K20}),_16.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},an(_16,st2,{transform(e,t){const n=this.value,i=t.source&&t.source.root,o=t.fork(t.NO_SOURCE),d={};return i||l("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(o.rem=n,t.visit(t.SOURCE,e=>d[E7(e)]=1),i.each(e=>{const t=e.data,n=e.parent&&e.parent.data;n&&d[E7(t)]&&d[E7(n)]&&o.add.push(O6({source:n,target:t}));}),this.value=o.add):t.changed(t.MOD)&&(t.visit(t.MOD,e=>d[E7(e)]=1),n.forEach(e=>{(d[E7(e.source)]||d[E7(e.target)])&&o.mod.push(e);})),o;}});const w17={binary:an6,dice:D15,slice:rn7,slicedice:fn6,squarify:un6,resquarify:cn7},B18=["x0","y0","x1","y1","depth","children"];function P16(e){S15.call(this,e);}P16.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:B18.length,default:B18}]},an(P16,S15,{layout(){const e=on6();return e.ratio=t=>{const a=e.tile();a.ratio&&e.tile(a.ratio(t));},e.method=t=>{ln(w17,t)?e.tile(w17[t]):l("Unrecognized Treemap layout method: "+t);},e;},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:B18});const mod6=function(){return{nest:O14,pack:U15,partition:A19,stratify:C17,tree:N18,treelinks:_16,treemap:P16,default:null};}();const f13=4278190080;function s17(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer);}function d14(t,n,r){if(!n.length)return;const a=n[0].mark.marktype;"group"===a?n.forEach(e=>{e.items.forEach(e=>d14(t,e.items,r));}):Vn2[a].draw(t,{items:r?n.map(m16):n});}function m16(t){const e=q6(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e;}const c15=31,h18=new Uint32Array(33),g15=new Uint32Array(33);g15[0]=0,h18[0]=~g15[0];for(let t=1;t<=32;++t)g15[t]=g15[t-1]<<1|1,h18[t]=~g15[t];function y14(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),a=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),i=t=>~~((t+n)/r);return i.invert=t=>t*r-n,i.bitmap=()=>(function(t,e){const n=new Uint32Array(~~((t*e+32)/32));function r(t,e){n[t]|=e;}function a(t,e){n[t]&=e;}return{array:n,get:(e,r)=>{const a=r*t+e;return n[a>>>5]&1<<(a&c15);},set:(e,n)=>{const a=n*t+e;r(a>>>5,1<<(a&c15));},clear:(e,n)=>{const r=n*t+e;a(r>>>5,~(1<<(r&c15)));},getRange:(e,r,a,o)=>{let i,u,l,f,s=o;for(;s>=r;--s)if(i=s*t+e,u=s*t+a,l=i>>>5,f=u>>>5,l===f){if(n[l]&h18[i&c15]&g15[1+(u&c15)])return!0;}else{if(n[l]&h18[i&c15])return!0;if(n[f]&g15[1+(u&c15)])return!0;for(let t=l+1;t<f;++t)if(n[t])return!0;}return!1;},setRange:(e,n,a,o)=>{let i,u,l,f,s;for(;n<=o;++n)if(i=n*t+e,u=n*t+a,l=i>>>5,f=u>>>5,l===f)r(l,h18[i&c15]&g15[1+(u&c15)]);else for(r(l,h18[i&c15]),r(f,g15[1+(u&c15)]),s=l+1;s<f;++s)r(s,4294967295);},clearRange:(e,n,r,o)=>{let i,u,l,f,s;for(;n<=o;++n)if(i=n*t+e,u=n*t+r,l=i>>>5,f=u>>>5,l===f)a(l,g15[i&c15]|h18[1+(u&c15)]);else for(a(l,g15[i&c15]),a(f,h18[1+(u&c15)]),s=l+1;s<f;++s)a(s,0);},outOfBounds:(n,r,a,o)=>n<0||r<0||o>=e||a>=t};})(a,o),i.ratio=r,i.padding=n,i.width=t,i.height=e,i;}function p15(t,e,n,r,a,o){let i=n/2;return t-i<0||t+i>a||e-(i=r/2)<0||e+i>o;}function x19(t,e,n,r,a,o,i,u){const l=a*o/(2*r),f=t(e-l),s=t(e+l),d=t(n-(o/=2)),m=t(n+o);return i.outOfBounds(f,d,s,m)||i.getRange(f,d,s,m)||u&&u.getRange(f,d,s,m);}const b16=[-1,-1,1,1],v17=[-1,1,-1,1];const w18=["right","center","left"],k17=["bottom","middle","top"];function M18(t,e,n,r,a,o,i,u,l,f,s,d){return!(a.outOfBounds(t,n,e,r)||(d&&o||a).getRange(t,n,e,r));}const R16={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},z18={naive:function(e,n,r,a){const o=e.width,i=e.height;return function(e){const n=e.datum.datum.items[a].items,r=n.length,u=e.datum.fontSize,l=xn3.width(e.datum,e.datum.text);let f,s,d,m,c,h,g,y=0;for(let t=0;t<r;++t)f=n[t].x,d=n[t].y,s=void 0===n[t].x2?f:n[t].x2,m=void 0===n[t].y2?d:n[t].y2,c=(f+s)/2,h=(d+m)/2,g=Math.abs(s-f+m-d),g>=y&&(y=g,e.x=c,e.y=h);return c=l/2,h=u/2,f=e.x-c,s=e.x+c,d=e.y-h,m=e.y+h,e.align="center",f<0&&s<=o?e.align="left":0<=f&&o<s&&(e.align="right"),e.baseline="middle",d<0&&m<=i?e.baseline="top":0<=d&&i<m&&(e.baseline="bottom"),!0;};},"reduced-search":function(e,n,r,a){const o=e.width,i=e.height,u=n[0],l=n[1];function f(t,n,r,a,f){const s=e.invert(t),d=e.invert(n);let m,c=r,h=i;if(!p15(s,d,a,f,o,i)&&!x19(e,s,d,f,a,c,u,l)&&!x19(e,s,d,f,a,f,u,null)){for(;h-c>=1;)m=(c+h)/2,x19(e,s,d,f,a,m,u,l)?h=m:c=m;if(c>r)return[s,d,c,!0];}}return function(n){const l=n.datum.datum.items[a].items,s=l.length,d=n.datum.fontSize,m=xn3.width(n.datum,n.datum.text);let c,h,g,y,b,v,w,k,M,R,z,A,O,E,S,B,U,C=r?d:0,D=!1,I=!1,N=0;for(let t=0;t<s;++t){for(c=l[t].x,g=l[t].y,h=void 0===l[t].x2?c:l[t].x2,y=void 0===l[t].y2?g:l[t].y2,c>h&&(U=c,c=h,h=U),g>y&&(U=g,g=y,y=U),M=e(c),z=e(h),R=~~((M+z)/2),A=e(g),E=e(y),O=~~((A+E)/2),w=R;w>=M;--w)for(k=O;k>=A;--k)B=f(w,k,C,m,d),B&&([n.x,n.y,C,D]=B);for(w=R;w<=z;++w)for(k=O;k<=E;++k)B=f(w,k,C,m,d),B&&([n.x,n.y,C,D]=B);D||r||(S=Math.abs(h-c+y-g),b=(c+h)/2,v=(g+y)/2,S>=N&&!p15(b,v,m,d,o,i)&&!x19(e,b,v,d,m,d,u,null)&&(N=S,n.x=b,n.y=v,I=!0));}return!(!D&&!I)&&(b=m/2,v=d/2,u.setRange(e(n.x-b),e(n.y-v),e(n.x+b),e(n.y+v)),n.align="center",n.baseline="middle",!0);};},floodfill:function(e,n,r,a){const o=e.width,i=e.height,u=n[0],l=n[1],f=e.bitmap();return function(n){const s=n.datum.datum.items[a].items,d=s.length,m=n.datum.fontSize,c=xn3.width(n.datum,n.datum.text),h=[];let g,y,w,k,M,R,z,A,O,E,S,B,U=r?m:0,C=!1,D=!1,I=0;for(let t=0;t<d;++t){for(g=s[t].x,w=s[t].y,y=void 0===s[t].x2?g:s[t].x2,k=void 0===s[t].y2?w:s[t].y2,h.push([e((g+y)/2),e((w+k)/2)]);h.length;)if([z,A]=h.pop(),!(u.get(z,A)||l.get(z,A)||f.get(z,A))){f.set(z,A);for(let t=0;t<4;++t)M=z+b16[t],R=A+v17[t],f.outOfBounds(M,R,M,R)||h.push([M,R]);if(M=e.invert(z),R=e.invert(A),O=U,E=i,!p15(M,R,c,m,o,i)&&!x19(e,M,R,m,c,O,u,l)&&!x19(e,M,R,m,c,m,u,null)){for(;E-O>=1;)S=(O+E)/2,x19(e,M,R,m,c,S,u,l)?E=S:O=S;O>U&&(n.x=M,n.y=R,U=O,C=!0);}}C||r||(B=Math.abs(y-g+k-w),M=(g+y)/2,R=(w+k)/2,B>=I&&!p15(M,R,c,m,o,i)&&!x19(e,M,R,m,c,m,u,null)&&(I=B,n.x=M,n.y=R,D=!0));}return!(!C&&!D)&&(M=c/2,R=m/2,u.setRange(e(n.x-M),e(n.y-R),e(n.x+M),e(n.y+R)),n.align="center",n.baseline="middle",!0);};}};function A20(e,r,a,o,i,u,l,m,c,h,g){if(!e.length)return e;const p=Math.max(o.length,i.length),x=function(t,e){const n=new Float64Array(e),r=t.length;for(let e=0;e<r;++e)n[e]=t[e]||0;for(let t=r;t<e;++t)n[t]=n[r-1];return n;}(o,p),b=function(t,e){const n=new Int8Array(e),r=t.length;for(let e=0;e<r;++e)n[e]|=R16[t[e]];for(let t=r;t<e;++t)n[t]=n[r-1];return n;}(i,p),v=(U=e[0].datum)&&U.mark&&U.mark.marktype,A="group"===v&&e[0].datum.items[c].marktype,O="area"===A,E=function(t,e,n,r){const a=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>a(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return a(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN});}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2];}:a;}(v,A,m,c),S=null===h||h===1/0,B=O&&"naive"===g;var U;let C=-1,D=-1;const I=e.map(e=>{const n=S?xn3.width(e,e.text):void 0;return C=Math.max(C,n),D=Math.max(D,e.fontSize),{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:E(e),textWidth:n};});h=null===h||h===1/0?Math.max(C,D)+Math.max(...o):h;const N=y14(r[0],r[1],h);let q;if(!B){a&&I.sort((t,e)=>a(t.datum,e.datum));let t=!1;for(let e=0;e<b.length&&!t;++e)t=5===b[e]||x[e]<0;const r=(v&&l||O)&&e.map(t=>t.datum);q=u.length||r?function(t,e,r,a,o){const i=t.width,u=t.height,l=a||o,m=e8(i,u).getContext("2d"),c=e8(i,u).getContext("2d"),h=l&&e8(i,u).getContext("2d");r.forEach(t=>d14(m,t,!1)),d14(c,e,!1),l&&d14(h,e,!0);const g=s17(m,i,u),y=s17(c,i,u),p=l&&s17(h,i,u),x=t.bitmap(),b=l&&t.bitmap();let v,w,k,M,R,z,A,O;for(w=0;w<u;++w)for(v=0;v<i;++v)R=w*i+v,z=g[R]&f13,O=y[R]&f13,A=l&&p[R]&f13,(z||A||O)&&(k=t(v),M=t(w),o||!z&&!O||x.set(k,M),l&&(z||A)&&b.set(k,M));return[x,b];}(N,r||[],u,t,O):function(t,e){const n=t.bitmap();return(e||[]).forEach(e=>n.set(t(e.boundary[0]),t(e.boundary[3]))),[n,void 0];}(N,l&&I);}const W=O?z18[g](N,q,l,c):function(e,n,r,a){const o=e.width,i=e.height,u=n[0],l=n[1],f=a.length;return function(n){const s=n.boundary,d=n.datum.fontSize;if(s[2]<0||s[5]<0||s[0]>o||s[3]>i)return!1;let m,c,h,g,y,p,x,b,v,R,z,A,O,E,S,B=n.textWidth??0;for(let o=0;o<f;++o){if(m=(3&r[o])-1,c=(r[o]>>>2&3)-1,h=0===m&&0===c||a[o]<0,g=m&&c?Math.SQRT1_2:1,y=a[o]<0?-1:1,p=s[1+m]+a[o]*m*g,z=s[4+c]+y*d*c/2+a[o]*c*g,b=z-d/2,v=z+d/2,A=e(p),E=e(b),S=e(v),!B){if(!M18(A,A,E,S,u,l,0,0,0,0,0,h))continue;B=xn3.width(n.datum,n.datum.text);}if(R=p+y*B*m/2,p=R-B/2,x=R+B/2,A=e(p),O=e(x),M18(A,O,E,S,u,l,0,0,0,0,0,h))return n.x=m?m*y<0?x:p:R,n.y=c?c*y<0?v:b:z,n.align=w18[m*y+1],n.baseline=k17[c*y+1],u.setRange(A,E,O,S),!0;}return!1;};}(N,q,b,x);return I.forEach(t=>t.opacity=+W(t)),I;}const O15=["x","y","opacity","align","baseline"],E20=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function S16(t){st2.call(this,null,t);}S16.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:E20},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:O15.length,default:O15}]},an(S16,st2,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t[n];return L(r)&&e.modified(r.fields);}("sort")))return;t.size&&2===t.size.length||l("Size parameter should be specified as a [width, height] array.");const r=t.as||O15;return A20(e.materialize(e.SOURCE).source||[],t.size,t.sort,H(null==t.offset?1:t.offset),H(t.anchor||E20),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach(t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline;}),e.reflow(n).modifies(r);}});const mod7=function(){return{label:S16,default:null};}();function c16(e,a){var r,t,n,o,s,i,l=[],u=function(e){return e(o);};if(null==a)l.push(e);else for(r={},t=0,n=e.length;t<n;++t)o=e[t],(i=r[s=a.map(u)])||(r[s]=i=[],i.dims=s,l.push(i)),i.push(o);return l;}function g16(e){st2.call(this,null,e);}g16.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},an(g16,st2,{transform(a,r){const t=r.fork(r.NO_SOURCE|r.NO_FIELDS);if(!this.value||r.changed()||a.modified()){const n=c16(r.materialize(r.SOURCE).source,a.groupby),o=(a.groupby||[]).map(t1),s=o.length,i=a.as||[t1(a.x),t1(a.y)],l=[];n.forEach(r=>{W7(r,a.x,a.y,a.bandwidth||.3).forEach(e=>{const a={};for(let e=0;e<s;++e)a[o[e]]=r.dims[e];a[i[0]]=e[0],a[i[1]]=e[1],l.push(O6(a));});}),this.value&&(t.rem=this.value),this.value=t.add=t.source=l;}return t;}});const v18={constant:Q6,linear:j6,log:z7,exp:B7,pow:H7,quad:J8,poly:O7};function b17(e){st2.call(this,null,e);}b17.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(v18)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},an(b17,st2,{transform(e,r){const t=r.fork(r.NO_SOURCE|r.NO_FIELDS);if(!this.value||r.changed()||e.modified()){const n=c16(r.materialize(r.SOURCE).source,e.groupby),o=(e.groupby||[]).map(t1),s=e.method||"linear",i=null==e.order?3:e.order,l1=((e,a)=>"poly"===e?a:"quad"===e?2:1)(s,i),u=e.as||[t1(e.x),t1(e.y)],m=v18[s],g=[];let b=e.extent;ln(v18,s)||l("Invalid regression method: "+s),null!=b&&"log"===s&&b[0]<=0&&(r.dataflow.warn("Ignoring extent with values <= 0 for log regression."),b=null),n.forEach(t=>{if(t.length<=l1)return void r.dataflow.warn("Skipping regression with more parameters than data points.");const n=m(t,e.x,e.y,i);if(e.params)return void g.push(O6({keys:t.dims,coef:n.coef,rSquared:n.rSquared}));const p=b||un(t,e.x),f=e=>{const a={};for(let e=0;e<o.length;++e)a[o[e]]=t.dims[e];a[u[0]]=e[0],a[u[1]]=e[1],g.push(O6(a));};"linear"===s||"constant"===s?p.forEach(e=>f([e,n.predict(e)])):$7(n.predict,p,25,200).forEach(f);}),this.value&&(t.rem=this.value),this.value=t.add=t.source=g;}return t;}});const mod8=function(){return{loess:g16,regression:b17,default:null};}();const t14=11102230246251565e-32,n14=134217729,r14=(3+8*t14)*t14;function s18(t,n,r,s,a){let e,o,c,u,f=n[0],i=s[0],b=0,h=0;i>f==i>-f?(e=f,f=n[++b]):(e=i,i=s[++h]);let M=0;if(b<t&&h<r)for(i>f==i>-f?(o=f+e,c=e-(o-f),f=n[++b]):(o=i+e,c=e-(o-i),i=s[++h]),e=o,0!==c&&(a[M++]=c);b<t&&h<r;)i>f==i>-f?(o=e+f,u=o-e,c=e-(o-u)+(f-u),f=n[++b]):(o=e+i,u=o-e,c=e-(o-u)+(i-u),i=s[++h]),e=o,0!==c&&(a[M++]=c);for(;b<t;)o=e+f,u=o-e,c=e-(o-u)+(f-u),f=n[++b],e=o,0!==c&&(a[M++]=c);for(;h<r;)o=e+i,u=o-e,c=e-(o-u)+(i-u),i=s[++h],e=o,0!==c&&(a[M++]=c);return 0===e&&0!==M||(a[M++]=e),M;}function c17(t,n){let r=n[0];for(let s=1;s<t;s++)r+=n[s];return r;}function u16(t){return new Float64Array(t);}const f14=u16(4),i17=u16(8),b18=u16(12),h19=u16(16),M19=u16(4);function l15(t,a,e,o,u,l){const p=(a-l)*(e-u),x=(t-u)*(o-l),d=p-x,w=Math.abs(p+x);return Math.abs(d)>=33306690738754716e-32*w?d:-function(t,a,e,o,u,l,p){let x,d,w,y,A,F,g,j,k,m,q,v,z,B,C,D,E,G;const H=t-u,I=e-u,J=a-l,K=o-l;B=H*K,F=n14*H,g=F-(F-H),j=H-g,F=n14*K,k=F-(F-K),m=K-k,C=j*m-(B-g*k-j*k-g*m),D=J*I,F=n14*J,g=F-(F-J),j=J-g,F=n14*I,k=F-(F-I),m=I-k,E=j*m-(D-g*k-j*k-g*m),q=C-E,A=C-q,f14[0]=C-(q+A)+(A-E),v=B+q,A=v-B,z=B-(v-A)+(q-A),q=z-D,A=z-q,f14[1]=z-(q+A)+(A-D),G=v+q,A=G-v,f14[2]=v-(G-A)+(q-A),f14[3]=G;let L=c17(4,f14),N=22204460492503146e-32*p;if(L>=N||-L>=N)return L;if(A=t-H,x=t-(H+A)+(A-u),A=e-I,w=e-(I+A)+(A-u),A=a-J,d=a-(J+A)+(A-l),A=o-K,y=o-(K+A)+(A-l),0===x&&0===d&&0===w&&0===y)return L;if(N=11093356479670487e-47*p+r14*Math.abs(L),L+=H*y+K*x-(J*w+I*d),L>=N||-L>=N)return L;B=x*K,F=n14*x,g=F-(F-x),j=x-g,F=n14*K,k=F-(F-K),m=K-k,C=j*m-(B-g*k-j*k-g*m),D=d*I,F=n14*d,g=F-(F-d),j=d-g,F=n14*I,k=F-(F-I),m=I-k,E=j*m-(D-g*k-j*k-g*m),q=C-E,A=C-q,M19[0]=C-(q+A)+(A-E),v=B+q,A=v-B,z=B-(v-A)+(q-A),q=z-D,A=z-q,M19[1]=z-(q+A)+(A-D),G=v+q,A=G-v,M19[2]=v-(G-A)+(q-A),M19[3]=G;const O=s18(4,f14,4,M19,i17);B=H*y,F=n14*H,g=F-(F-H),j=H-g,F=n14*y,k=F-(F-y),m=y-k,C=j*m-(B-g*k-j*k-g*m),D=J*w,F=n14*J,g=F-(F-J),j=J-g,F=n14*w,k=F-(F-w),m=w-k,E=j*m-(D-g*k-j*k-g*m),q=C-E,A=C-q,M19[0]=C-(q+A)+(A-E),v=B+q,A=v-B,z=B-(v-A)+(q-A),q=z-D,A=z-q,M19[1]=z-(q+A)+(A-D),G=v+q,A=G-v,M19[2]=v-(G-A)+(q-A),M19[3]=G;const P=s18(O,i17,4,M19,b18);B=x*y,F=n14*x,g=F-(F-x),j=x-g,F=n14*y,k=F-(F-y),m=y-k,C=j*m-(B-g*k-j*k-g*m),D=d*w,F=n14*d,g=F-(F-d),j=d-g,F=n14*w,k=F-(F-w),m=w-k,E=j*m-(D-g*k-j*k-g*m),q=C-E,A=C-q,M19[0]=C-(q+A)+(A-E),v=B+q,A=v-B,z=B-(v-A)+(q-A),q=z-D,A=z-q,M19[1]=z-(q+A)+(A-D),G=v+q,A=G-v,M19[2]=v-(G-A)+(q-A),M19[3]=G;const Q=s18(P,b18,4,M19,h19);return h19[Q-1];}(t,a,e,o,u,l,w);}u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(8),u16(8),u16(8),u16(4),u16(8),u16(8),u16(8),u16(12);u16(192),u16(192);u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(8),u16(8),u16(8),u16(8),u16(8),u16(8),u16(8),u16(8),u16(8),u16(4),u16(4),u16(4),u16(8),u16(16),u16(16),u16(16),u16(32),u16(32),u16(48),u16(64);u16(1152),u16(1152);u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(4),u16(24),u16(24),u16(24),u16(24),u16(24),u16(24),u16(24),u16(24),u16(24),u16(24),u16(1152),u16(1152),u16(1152),u16(1152),u16(1152),u16(2304),u16(2304),u16(3456),u16(5760),u16(8),u16(8),u16(8),u16(16),u16(24),u16(48),u16(48),u16(96),u16(192),u16(384),u16(384),u16(384),u16(768);u16(96),u16(96),u16(96),u16(1152);const s19=Math.pow(2,-52),i18=new Uint32Array(512);class e16{static from(t,s=o15,i=_17){const h=t.length,n=new Float64Array(2*h);for(let e=0;e<h;e++){const h=t[e];n[2*e]=s(h),n[2*e+1]=i(h);}return new e16(n);}constructor(t){const s=t.length>>1;if(s>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*s-5,0);this._triangles=new Uint32Array(3*i),this._halfedges=new Int32Array(3*i),this._hashSize=Math.ceil(Math.sqrt(s)),this._hullPrev=new Uint32Array(s),this._hullNext=new Uint32Array(s),this._hullTri=new Uint32Array(s),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(s),this._dists=new Float64Array(s),this.update();}update(){const{coords:i,_hullPrev:e,_hullNext:n,_hullTri:a,_hullHash:o}=this,_=i.length>>1;let c=1/0,f=1/0,u=-1/0,d=-1/0;for(let t=0;t<_;t++){const s=i[2*t],e=i[2*t+1];s<c&&(c=s),e<f&&(f=e),s>u&&(u=s),e>d&&(d=e),this._ids[t]=t;}const g=(c+u)/2,y=(f+d)/2;let w,b,A;for(let t=0,s=1/0;t<_;t++){const e=h20(g,y,i[2*t],i[2*t+1]);e<s&&(w=t,s=e);}const k=i[2*w],S=i[2*w+1];for(let t=0,s=1/0;t<_;t++){if(t===w)continue;const e=h20(k,S,i[2*t],i[2*t+1]);e<s&&e>0&&(b=t,s=e);}let x=i[2*b],z=i[2*b+1],U=1/0;for(let t=0;t<_;t++){if(t===w||t===b)continue;const s=r15(k,S,x,z,i[2*t],i[2*t+1]);s<U&&(A=t,U=s);}let p=i[2*A],M=i[2*A+1];if(U===1/0){for(let t=0;t<_;t++)this._dists[t]=i[2*t]-i[0]||i[2*t+1]-i[1];l16(this._ids,this._dists,0,_-1);const t=new Uint32Array(_);let s=0;for(let i=0,e=-1/0;i<_;i++){const h=this._ids[i],n=this._dists[h];n>e&&(t[s++]=h,e=n);}return this.hull=t.subarray(0,s),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0));}if(l15(k,S,x,z,p,M)<0){const t=b,s=x,i=z;b=A,x=p,z=M,A=t,p=s,M=i;}const T=function(t,s,i,e,h,n){const r=i-t,l=e-s,a=h-t,o=n-s,_=r*r+l*l,c=a*a+o*o,f=.5/(r*o-l*a);return{x:t+(o*_-l*c)*f,y:s+(r*c-a*_)*f};}(k,S,x,z,p,M);this._cx=T.x,this._cy=T.y;for(let t=0;t<_;t++)this._dists[t]=h20(i[2*t],i[2*t+1],T.x,T.y);l16(this._ids,this._dists,0,_-1),this._hullStart=w;let m=3;n[w]=e[A]=b,n[b]=e[w]=A,n[A]=e[b]=w,a[w]=0,a[b]=1,a[A]=2,o.fill(-1),o[this._hashKey(k,S)]=w,o[this._hashKey(x,z)]=b,o[this._hashKey(p,M)]=A,this.trianglesLen=0,this._addTriangle(w,b,A,-1,-1,-1);for(let h,r,l=0;l<this._ids.length;l++){const _=this._ids[l],c=i[2*_],f=i[2*_+1];if(l>0&&Math.abs(c-h)<=s19&&Math.abs(f-r)<=s19)continue;if(h=c,r=f,_===w||_===b||_===A)continue;let u=0;for(let t=0,s=this._hashKey(c,f);t<this._hashSize&&(u=o[(s+t)%this._hashSize],-1===u||u===n[u]);t++);u=e[u];let d,g=u;for(;d=n[g],l15(c,f,i[2*g],i[2*g+1],i[2*d],i[2*d+1])>=0;)if(g=d,g===u){g=-1;break;}if(-1===g)continue;let y=this._addTriangle(g,_,n[g],-1,-1,a[g]);a[_]=this._legalize(y+2),a[g]=y,m++;let k=n[g];for(;d=n[k],l15(c,f,i[2*k],i[2*k+1],i[2*d],i[2*d+1])<0;)y=this._addTriangle(k,_,d,a[_],-1,a[k]),a[_]=this._legalize(y+2),n[k]=k,m--,k=d;if(g===u)for(;d=e[g],l15(c,f,i[2*d],i[2*d+1],i[2*g],i[2*g+1])<0;)y=this._addTriangle(d,_,g,-1,a[g],a[d]),this._legalize(y+2),a[d]=y,n[g]=g,m--,g=d;this._hullStart=e[_]=g,n[g]=e[k]=_,n[_]=k,o[this._hashKey(c,f)]=_,o[this._hashKey(i[2*g],i[2*g+1])]=g;}this.hull=new Uint32Array(m);for(let t=0,s=this._hullStart;t<m;t++)this.hull[t]=s,s=n[s];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen);}_hashKey(t,s){return Math.floor(function(t,s){const i=t/(Math.abs(t)+Math.abs(s));return(s>0?3-i:1+i)/4;}(t-this._cx,s-this._cy)*this._hashSize)%this._hashSize;}_legalize(t){const{_triangles:s,_halfedges:e,coords:h}=this;let r=0,l=0;for(;;){const a=e[t],o=t-t%3;if(l=o+(t+2)%3,-1===a){if(0===r)break;t=i18[--r];continue;}const _=a-a%3,c=o+(t+1)%3,f=_+(a+2)%3,u=s[l],d=s[t],g=s[c],y=s[f];if(n15(h[2*u],h[2*u+1],h[2*d],h[2*d+1],h[2*g],h[2*g+1],h[2*y],h[2*y+1])){s[t]=y,s[a]=u;const h=e[f];if(-1===h){let s=this._hullStart;do{if(this._hullTri[s]===f){this._hullTri[s]=t;break;}s=this._hullPrev[s];}while(s!==this._hullStart)}this._link(t,h),this._link(a,e[l]),this._link(l,f);const n=_+(a+1)%3;r<i18.length&&(i18[r++]=n);}else{if(0===r)break;t=i18[--r];}}return l;}_link(t,s){this._halfedges[t]=s,-1!==s&&(this._halfedges[s]=t);}_addTriangle(t,s,i,e,h,n){const r=this.trianglesLen;return this._triangles[r]=t,this._triangles[r+1]=s,this._triangles[r+2]=i,this._link(r,e),this._link(r+1,h),this._link(r+2,n),this.trianglesLen+=3,r;}}function h20(t,s,i,e){const h=t-i,n=s-e;return h*h+n*n;}function n15(t,s,i,e,h,n,r,l){const a=t-r,o=s-l,_=i-r,c=e-l,f=h-r,u=n-l,d=_*_+c*c,g=f*f+u*u;return a*(c*g-d*u)-o*(_*g-d*f)+(a*a+o*o)*(_*u-c*f)<0;}function r15(t,s,i,e,h,n){const r=i-t,l=e-s,a=h-t,o=n-s,_=r*r+l*l,c=a*a+o*o,f=.5/(r*o-l*a),u=(o*_-l*c)*f,d=(r*c-a*_)*f;return u*u+d*d;}function l16(t,s,i,e){if(e-i<=20)for(let h=i+1;h<=e;h++){const e=t[h],n=s[e];let r=h-1;for(;r>=i&&s[t[r]]>n;)t[r+1]=t[r--];t[r+1]=e;}else{let h=i+1,n=e;a13(t,i+e>>1,h),s[t[i]]>s[t[e]]&&a13(t,i,e),s[t[h]]>s[t[e]]&&a13(t,h,e),s[t[i]]>s[t[h]]&&a13(t,i,h);const r=t[h],o=s[r];for(;;){do{h++;}while(s[t[h]]<o)do{n--;}while(s[t[n]]>o)if(n<h)break;a13(t,h,n);}t[i+1]=t[n],t[n]=r,e-h+1>=n-i?(l16(t,s,h,e),l16(t,s,i,n-1)):(l16(t,s,i,n-1),l16(t,s,h,e));}}function a13(t,s,i){const e=t[s];t[s]=t[i],t[i]=e;}function o15(t){return t[0];}function _17(t){return t[1];}class i19{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._="";}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`;}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z");}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`;}arc(t,i,n){const s=(t=+t)+(n=+n),l=i=+i;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${s},${l}`:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+s+","+l),n&&(this._+=`A${n},${n},0,1,1,${t-n},${i}A${n},${n},0,1,1,${this._x1=s},${this._y1=l}`);}rect(t,e,i,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+i}v${+n}h${-i}Z`;}value(){return this._||null;}}class n16{constructor(){this._=[];}moveTo(t,e){this._.push([t,e]);}closePath(){this._.push(this._[0].slice());}lineTo(t,e){this._.push([t,e]);}value(){return this._.length?this._:null;}}class s20{constructor(t,[e,i,n,s]=[0,0,960,500]){if(!((n=+n)>=(e=+e)&&(s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=n,this.xmin=e,this.ymax=s,this.ymin=i,this._init();}update(){return this.delaunay.update(),this._init(),this;}_init(){const{delaunay:{points:t,hull:e,triangles:i},vectors:n}=this;let s,l;const h=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let n,r,o=0,a=0,c=i.length;o<c;o+=3,a+=2){const c=2*i[o],u=2*i[o+1],g=2*i[o+2],d=t[c],f=t[c+1],m=t[u],_=t[u+1],x=t[g],y=t[g+1],p=m-d,v=_-f,w=x-d,T=y-f,$=2*(p*T-v*w);if(Math.abs($)<1e-9){if(void 0===s){s=l=0;for(const i of e)s+=t[2*i],l+=t[2*i+1];s/=e.length,l/=e.length;}const i=1e9*Math.sign((s-d)*T-(l-f)*w);n=(d+x)/2-i*T,r=(f+y)/2+i*w;}else{const t=1/$,e=p*p+v*v,i=w*w+T*T;n=d+(T*e-v*i)*t,r=f+(p*i-w*e)*t;}h[a]=n,h[a+1]=r;}let r,o,a,c=e[e.length-1],u=4*c,g=t[2*c],d=t[2*c+1];n.fill(0);for(let i=0;i<e.length;++i)c=e[i],r=u,o=g,a=d,u=4*c,g=t[2*c],d=t[2*c+1],n[r+2]=n[u]=a-d,n[r+3]=n[u+1]=g-o;}render(t){const e=null==t?t=new i19:void 0,{delaunay:{halfedges:n,inedges:s,hull:l},circumcenters:h,vectors:r}=this;if(l.length<=1)return null;for(let e=0,i=n.length;e<i;++e){const i=n[e];if(i<e)continue;const s=2*Math.floor(e/3),l=2*Math.floor(i/3),r=h[s],o=h[s+1],a=h[l],c=h[l+1];this._renderSegment(r,o,a,c,t);}let o,a=l[l.length-1];for(let e=0;e<l.length;++e){o=a,a=l[e];const i=2*Math.floor(s[a]/3),n=h[i],c=h[i+1],u=4*o,g=this._project(n,c,r[u+2],r[u+3]);g&&this._renderSegment(n,c,g[0],g[1],t);}return e&&e.value();}renderBounds(t){const e=null==t?t=new i19:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value();}renderCell(t,e){const n=null==e?e=new i19:void 0,s=this._clip(t);if(null===s||!s.length)return;e.moveTo(s[0],s[1]);let l=s.length;for(;s[0]===s[l-2]&&s[1]===s[l-1]&&l>1;)l-=2;for(let t=2;t<l;t+=2)s[t]===s[t-2]&&s[t+1]===s[t-1]||e.lineTo(s[t],s[t+1]);return e.closePath(),n&&n.value();}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,i=t.length/2;e<i;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t);}}cellPolygon(t){const e=new n16;return this.renderCell(t,e),e.value();}_renderSegment(t,e,i,n,s){let l;const h=this._regioncode(t,e),r=this._regioncode(i,n);0===h&&0===r?(s.moveTo(t,e),s.lineTo(i,n)):(l=this._clipSegment(t,e,i,n,h,r))&&(s.moveTo(l[0],l[1]),s.lineTo(l[2],l[3]));}contains(t,e,i){return(e=+e)==e&&(i=+i)==i&&this.delaunay._step(t,e,i)===t;}*neighbors(t){const e=this._clip(t);if(e)for(const i of this.delaunay.neighbors(t)){const t=this._clip(i);if(t){t:for(let n=0,s=e.length;n<s;n+=2)for(let l=0,h=t.length;l<h;l+=2)if(e[n]===t[l]&&e[n+1]===t[l+1]&&e[(n+2)%s]===t[(l+h-2)%h]&&e[(n+3)%s]===t[(l+h-1)%h]){yield i;break t;}}}}_cell(t){const{circumcenters:e,delaunay:{inedges:i,halfedges:n,triangles:s}}=this,l=i[t];if(-1===l)return null;const h=[];let r=l;do{const i=Math.floor(r/3);if(h.push(e[2*i],e[2*i+1]),r=r%3==2?r-2:r+1,s[r]!==t)break;r=n[r];}while(r!==l&&-1!==r)return h;}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:i}=this,n=4*t;return this._simplify(i[n]||i[n+1]?this._clipInfinite(t,e,i[n],i[n+1],i[n+2],i[n+3]):this._clipFinite(t,e));}_clipFinite(t,e){const i=e.length;let n,s,l,h,r=null,o=e[i-2],a=e[i-1],c=this._regioncode(o,a),u=0;for(let g=0;g<i;g+=2)if(n=o,s=a,o=e[g],a=e[g+1],l=c,c=this._regioncode(o,a),0===l&&0===c)h=u,u=0,r?r.push(o,a):r=[o,a];else{let e,i,g,d,f;if(0===l){if(null===(e=this._clipSegment(n,s,o,a,l,c)))continue;[i,g,d,f]=e;}else{if(null===(e=this._clipSegment(o,a,n,s,c,l)))continue;[d,f,i,g]=e,h=u,u=this._edgecode(i,g),h&&u&&this._edge(t,h,u,r,r.length),r?r.push(i,g):r=[i,g];}h=u,u=this._edgecode(d,f),h&&u&&this._edge(t,h,u,r,r.length),r?r.push(d,f):r=[d,f];}if(r)h=u,u=this._edgecode(r[0],r[1]),h&&u&&this._edge(t,h,u,r,r.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r;}_clipSegment(t,e,i,n,s,l){const h=s<l;for(h&&([t,e,i,n,s,l]=[i,n,t,e,l,s]);;){if(0===s&&0===l)return h?[i,n,t,e]:[t,e,i,n];if(s&l)return null;let r,o,a=s||l;8&a?(r=t+(i-t)*(this.ymax-e)/(n-e),o=this.ymax):4&a?(r=t+(i-t)*(this.ymin-e)/(n-e),o=this.ymin):2&a?(o=e+(n-e)*(this.xmax-t)/(i-t),r=this.xmax):(o=e+(n-e)*(this.xmin-t)/(i-t),r=this.xmin),s?(t=r,e=o,s=this._regioncode(t,e)):(i=r,n=o,l=this._regioncode(i,n));}}_clipInfinite(t,e,i,n,s,l){let h,r=Array.from(e);if((h=this._project(r[0],r[1],i,n))&&r.unshift(h[0],h[1]),(h=this._project(r[r.length-2],r[r.length-1],s,l))&&r.push(h[0],h[1]),r=this._clipFinite(t,r))for(let e,i=0,n=r.length,s=this._edgecode(r[n-2],r[n-1]);i<n;i+=2)e=s,s=this._edgecode(r[i],r[i+1]),e&&s&&(i=this._edge(t,e,s,r,i),n=r.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(r=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return r;}_edge(t,e,i,n,s){for(;e!==i;){let i,l;switch(e){case 5:e=4;continue;case 4:e=6,i=this.xmax,l=this.ymin;break;case 6:e=2;continue;case 2:e=10,i=this.xmax,l=this.ymax;break;case 10:e=8;continue;case 8:e=9,i=this.xmin,l=this.ymax;break;case 9:e=1;continue;case 1:e=5,i=this.xmin,l=this.ymin;}n[s]===i&&n[s+1]===l||!this.contains(t,i,l)||(n.splice(s,0,i,l),s+=2);}return s;}_project(t,e,i,n){let s,l,h,r=1/0;if(n<0){if(e<=this.ymin)return null;(s=(this.ymin-e)/n)<r&&(h=this.ymin,l=t+(r=s)*i);}else if(n>0){if(e>=this.ymax)return null;(s=(this.ymax-e)/n)<r&&(h=this.ymax,l=t+(r=s)*i);}if(i>0){if(t>=this.xmax)return null;(s=(this.xmax-t)/i)<r&&(l=this.xmax,h=e+(r=s)*n);}else if(i<0){if(t<=this.xmin)return null;(s=(this.xmin-t)/i)<r&&(l=this.xmin,h=e+(r=s)*n);}return[l,h];}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0);}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0);}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const i=(e+2)%t.length,n=(e+4)%t.length;(t[e]===t[i]&&t[i]===t[n]||t[e+1]===t[i+1]&&t[i+1]===t[n+1])&&(t.splice(i,2),e-=2);}t.length||(t=null);}return t;}}const l17=2*Math.PI,h21=Math.pow;function r16(t){return t[0];}function o16(t){return t[1];}function a14(t,e,i){return[t+Math.sin(t+e)*i,e+Math.cos(t-e)*i];}class c18{static from(t,e=r16,i=o16,n){return new c18("length"in t?function(t,e,i,n){const s=t.length,l=new Float64Array(2*s);for(let h=0;h<s;++h){const s=t[h];l[2*h]=e.call(n,s,h,t),l[2*h+1]=i.call(n,s,h,t);}return l;}(t,e,i,n):Float64Array.from(function*(t,e,i,n){let s=0;for(const l of t)yield e.call(n,l,s,t),yield i.call(n,l,s,t),++s;}(t,e,i,n)));}constructor(e){this._delaunator=new e16(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init();}update(){return this._delaunator.update(),this._init(),this;}_init(){const e=this._delaunator,i=this.points;if(e.hull&&e.hull.length>2&&function(t){const{triangles:e,coords:i}=t;for(let t=0;t<e.length;t+=3){const n=2*e[t],s=2*e[t+1],l=2*e[t+2];if((i[l]-i[n])*(i[s+1]-i[n+1])-(i[s]-i[n])*(i[l+1]-i[n+1])>1e-10)return!1;}return!0;}(e)){this.collinear=Int32Array.from({length:i.length/2},(t,e)=>e).sort((t,e)=>i[2*t]-i[2*e]||i[2*t+1]-i[2*e+1]);const e=this.collinear[0],n=this.collinear[this.collinear.length-1],s=[i[2*e],i[2*e+1],i[2*n],i[2*n+1]],l=1e-8*Math.hypot(s[3]-s[1],s[2]-s[0]);for(let t=0,e=i.length/2;t<e;++t){const e=a14(i[2*t],i[2*t+1],l);i[2*t]=e[0],i[2*t+1]=e[1];}this._delaunator=new e16(i);}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,l=this.triangles=this._delaunator.triangles,h=this.inedges.fill(-1),r=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=l[t%3==2?t-2:t+1];-1!==n[t]&&-1!==h[e]||(h[e]=t);}for(let t=0,e=s.length;t<e;++t)r[s[t]]=t;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],h[s[0]]=1,2===s.length&&(h[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]));}voronoi(t){return new s20(this,t);}*neighbors(t){const{inedges:e,hull:i,_hullIndex:n,halfedges:s,triangles:l,collinear:h}=this;if(h){const e=h.indexOf(t);return e>0&&(yield h[e-1]),void(e<h.length-1&&(yield h[e+1]));}const r=e[t];if(-1===r)return;let o=r,a=-1;do{if(yield a=l[o],o=o%3==2?o-2:o+1,l[o]!==t)return;if(o=s[o],-1===o){const e=i[(n[t]+1)%i.length];return void(e!==a&&(yield e));}}while(o!==r)}find(t,e,i=0){if((t=+t)!=t||(e=+e)!=e)return-1;const n=i;let s;for(;(s=this._step(i,t,e))>=0&&s!==i&&s!==n;)i=s;return s;}_step(t,e,i){const{inedges:n,hull:s,_hullIndex:l,halfedges:r,triangles:o,points:a}=this;if(-1===n[t]||!a.length)return(t+1)%(a.length>>1);let c=t,u=h21(e-a[2*t],2)+h21(i-a[2*t+1],2);const g=n[t];let d=g;do{let n=o[d];const g=h21(e-a[2*n],2)+h21(i-a[2*n+1],2);if(g<u&&(u=g,c=n),d=d%3==2?d-2:d+1,o[d]!==t)break;if(d=r[d],-1===d){if(d=s[(l[t]+1)%s.length],d!==n&&h21(e-a[2*d],2)+h21(i-a[2*d+1],2)<u)return d;break;}}while(d!==g)return c;}render(t){const e=null==t?t=new i19:void 0,{points:n,halfedges:s,triangles:l}=this;for(let e=0,i=s.length;e<i;++e){const i=s[e];if(i<e)continue;const h=2*l[e],r=2*l[i];t.moveTo(n[h],n[h+1]),t.lineTo(n[r],n[r+1]);}return this.renderHull(t),e&&e.value();}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new i19:void 0,{points:s}=this;for(let i=0,n=s.length;i<n;i+=2){const n=s[i],h=s[i+1];t.moveTo(n+e,h),t.arc(n,h,e,0,l17);}return n&&n.value();}renderHull(t){const e=null==t?t=new i19:void 0,{hull:n,points:s}=this,l=2*n[0],h=n.length;t.moveTo(s[l],s[l+1]);for(let e=1;e<h;++e){const i=2*n[e];t.lineTo(s[i],s[i+1]);}return t.closePath(),e&&e.value();}hullPolygon(){const t=new n16;return this.renderHull(t),t.value();}renderTriangle(t,e){const n=null==e?e=new i19:void 0,{points:s,triangles:l}=this,h=2*l[t*=3],r=2*l[t+1],o=2*l[t+2];return e.moveTo(s[h],s[h+1]),e.lineTo(s[r],s[r+1]),e.lineTo(s[o],s[o+1]),e.closePath(),n&&n.value();}*trianglePolygons(){const{triangles:t}=this;for(let e=0,i=t.length/3;e<i;++e)yield this.trianglePolygon(e);}trianglePolygon(t){const e=new n16;return this.renderTriangle(t,e),e.value();}}function r17(t){st2.call(this,null,t);}r17.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const o17=[-1e5,-1e5,1e5,1e5];function a15(e){const t=e[0][0],n=e[0][1];let r=e.length-1;for(;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z";}an(r17,st2,{transform(e,t){const r=e.as||"path",l=t.source;if(!l||!l.length)return t;let i=e.size;i=i?[0,0,i[0],i[1]]:(i=e.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:o17;const m=this.value=c18.from(l,e.x,e.y).voronoi(i);for(let e=0,t=l.length;e<t;++e){const t=m.cellPolygon(e);l[e][r]=t&&(2!==(s=t).length||s[0][0]!==s[1][0]||s[0][1]!==s[1][1])?a15(t):null;}var s;return t.reflow(e.modified()).modifies(r);}});const mod9=function(){return{voronoi:r17,default:null};}();var u17=Math.PI/180,l18=2048;function y15(){var e,n,r,a,o,i,f,s=[256,256],u=d15,y=[],p=Math.random,v={};function z(t,e,n){for(var r,a,o,i,f,l=e.x,y=e.y,x=Math.hypot(s[0],s[1]),m=u(s),d=p()<.5?1:-1,c=-d;(r=m(c+=d))&&(a=~~r[0],o=~~r[1],!(Math.min(Math.abs(a),Math.abs(o))>=x));)if(e.x=l+a,e.y=y+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1]||n&&h22(e,t,s[0])||n&&(f=n,!((i=e).x+i.x1>f[0].x&&i.x+i.x0<f[1].x&&i.y+i.y1>f[0].y&&i.y+i.y0<f[1].y)))){for(var g,v=e.sprite,z=e.width>>5,M=s[0]>>5,b=e.x-(z<<4),S=127&b,w=32-S,W=e.y1-e.y0,T=(e.y+e.y0)*M+(b>>5),k=0;k<W;k++){g=0;for(var D=0;D<=z;D++)t[T+D]|=g<<w|(D<z?(g=v[k*z+D])>>>S:0);T+=M;}return e.sprite=null,!0;}return!1;}return v.layout=function(){for(var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=l18/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e};}(e8()),h=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e;}((s[0]>>5)*s[1]),d=null,c=y.length,g=-1,v=[],M=y.map(t=>({text:e(t),font:n(t),style:a(t),weight:o(t),rotate:i(t),size:~~(r(t)+1e-14),padding:f(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t})).sort((t,e)=>e.size-t.size);++g<c;){var b=M[g];b.x=s[0]*(p()+.5)>>1,b.y=s[1]*(p()+.5)>>1,x20(u,b,M,g),b.hasText&&z(h,b,d)&&(v.push(b),d?m17(d,b):d=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=s[0]>>1,b.y-=s[1]>>1);}return v;},v.words=function(t){return arguments.length?(y=t,v):y;},v.size=function(t){return arguments.length?(s=[+t[0],+t[1]],v):s;},v.font=function(t){return arguments.length?(n=c19(t),v):n;},v.fontStyle=function(t){return arguments.length?(a=c19(t),v):a;},v.fontWeight=function(t){return arguments.length?(o=c19(t),v):o;},v.rotate=function(t){return arguments.length?(i=c19(t),v):i;},v.text=function(t){return arguments.length?(e=c19(t),v):e;},v.spiral=function(t){return arguments.length?(u=g17[t]||t,v):u;},v.fontSize=function(t){return arguments.length?(r=c19(t),v):r;},v.padding=function(t){return arguments.length?(f=c19(t),v):f;},v.random=function(t){return arguments.length?(p=t,v):p;},v;}function x20(t,e,n,r){if(!e.sprite){var a=t.context,o=t.ratio;a.clearRect(0,0,2048/o,l18/o);var i,f,s,y,x,h=0,m=0,d=0,c=n.length;for(--r;++r<c;){if(e=n[r],a.save(),a.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,i=a.measureText(e.text+"m").width*o,s=e.size<<1,e.rotate){var g=Math.sin(e.rotate*u17),p=Math.cos(e.rotate*u17),v=i*p,z=i*g,M=s*p,b=s*g;i=Math.max(Math.abs(v+b),Math.abs(v-b))+31>>5<<5,s=~~Math.max(Math.abs(z+M),Math.abs(z-M));}else i=i+31>>5<<5;if(s>d&&(d=s),h+i>=2048&&(h=0,m+=d,d=0),m+s>=l18)break;a.translate((h+(i>>1))/o,(m+(s>>1))/o),e.rotate&&a.rotate(e.rotate*u17),a.fillText(e.text,0,0),e.padding&&(a.lineWidth=2*e.padding,a.strokeText(e.text,0,0)),a.restore(),e.width=i,e.height=s,e.xoff=h,e.yoff=m,e.x1=i>>1,e.y1=s>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=i;}for(var S=a.getImageData(0,0,2048/o,l18/o).data,w=[];--r>=0;)if((e=n[r]).hasText){for(f=(i=e.width)>>5,s=e.y1-e.y0,y=0;y<s*f;y++)w[y]=0;if(null==(h=e.xoff))return;m=e.yoff;var W=0,T=-1;for(x=0;x<s;x++){for(y=0;y<i;y++){var k=f*x+(y>>5),D=S[2048*(m+x)+(h+y)<<2]?1<<31-y%32:0;w[k]|=D,W|=D;}W?T=x:(e.y0++,s--,x--,m++);}e.y1=e.y0+T,e.sprite=w.slice(0,(e.y1-e.y0)*f);}}}function h22(t,e,n){n>>=5;for(var r,a=t.sprite,o=t.width>>5,i=t.x-(o<<4),f=127&i,s=32-f,u=t.y1-t.y0,l=(t.y+t.y0)*n+(i>>5),y=0;y<u;y++){r=0;for(var x=0;x<=o;x++)if((r<<s|(x<o?(r=a[y*o+x])>>>f:0))&e[l+x])return!0;l+=n;}return!1;}function m17(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1);}function d15(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)];};}function c19(t){return"function"==typeof t?t:function(){return t;};}var g17={archimedean:d15,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var a=t<0?-1:1;switch(Math.sqrt(1+4*a*t)-a&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4;}return[n,r];};}};const p16=["x","y","font","fontSize","fontStyle","fontWeight","angle"],v19=["text","font","rotate","fontSize","fontStyle","fontWeight"];function z19(t){st2.call(this,y15(),t);}z19.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:p16}]},an(z19,st2,{transform(t,e){!t.size||t.size[0]&&t.size[1]||l("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||v19.some(function(n){const r=t[n];return L(r)&&e.modified(r.fields);})))return;const u=e.materialize(e.SOURCE).source,l1=this.value,y=t.as||p16;let x,h=t.fontSize||14;if(L(h)?x=t.fontSizeRange:h=tn(h),x){const t=h,e=be1("sqrt")().domain(un(u,t)).range(x);h=n=>e(t(n));}u.forEach(t=>{t[y[0]]=NaN,t[y[1]]=NaN,t[y[3]]=0;});const m=l1.words(u).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(h).random(c5).layout(),d=l1.size(),c=d[0]>>1,g=d[1]>>1,z=m.length;for(let t,e,n=0;n<z;++n)t=m[n],e=t.datum,e[y[0]]=t.x+c,e[y[1]]=t.y+g,e[y[2]]=t.font,e[y[3]]=t.size,e[y[4]]=t.style,e[y[5]]=t.weight,e[y[6]]=t.rotate;return e.reflow(n).modifies(y);}});const mod10=function(){return{wordcloud:z19,default:null};}();const s21=e=>new Uint8Array(e),o18=e=>new Uint16Array(e),l19=e=>new Uint32Array(e);function a16(e,t,r){const i=(t<257?s21:t<65537?o18:l19)(e);return r&&i.set(r),i;}function d16(e,t,r){const i=1<<t;return{one:i,zero:~i,range:r.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd(e,t){const r=this,n=r.bisect(r.range,e.value),s=e.index,o=n[0],l=n[1],a=s.length;let d;for(d=0;d<o;++d)t[s[d]]|=i;for(d=l;d<a;++d)t[s[d]]|=i;return r;}};}function f15(){let i=l19(0),n=[],s=0;return{insert:function(e,t,o){if(!t.length)return[];const a=s,d=t.length,f=l19(d);let u,h,m,c=Array(d);for(m=0;m<d;++m)c[m]=e(t[m]),f[m]=m;if(c=function(e,t){return e.sort.call(t,(t,r)=>{const i=e[t],n=e[r];return i<n?-1:i>n?1:0;}),G1(e,t);}(c,f),a)u=n,h=i,n=Array(a+d),i=l19(a+d),function(e,t,r,i,n,s,o,l,a){let d,f=0,u=0;for(d=0;f<i&&u<o;++d)t[f]<n[u]?(l[d]=t[f],a[d]=r[f++]):(l[d]=n[u],a[d]=s[u++]+e);for(;f<i;++f,++d)l[d]=t[f],a[d]=r[f];for(;u<o;++u,++d)l[d]=n[u],a[d]=s[u]+e;}(o,u,h,a,c,f,d,n,i);else{if(o>0)for(m=0;m<d;++m)f[m]+=o;n=c,i=f;}return s=a+d,{index:f,value:c};},remove:function(e,t){const r=s;let o,l,a;for(l=0;!t[i[l]]&&l<r;++l);for(a=l;l<r;++l)t[o=i[l]]||(i[a]=o,n[a]=n[l],++a);s=r-e;},bisect:function(r,i){let o;return i?o=i.length:(i=n,o=s),[c3(i,r[0],0,o),l2(i,r[1],0,o)];},reindex:function(e){for(let t=0,r=s;t<r;++t)i[t]=e[i[t]];},index:()=>i,size:()=>s};}function u18(e){st2.call(this,function(){let e=8,t=[],r=l19(0),i=a16(0,e),n=a16(0,e);return{data:()=>t,seen:()=>r=function(e,t,r){return e.length>=t?e:((r=r||new e.constructor(t)).set(e),r);}(r,t.length),add(e){for(let r,i=0,n=t.length,s=e.length;i<s;++i)r=e[i],r._index=n++,t.push(r);},remove(e,r){const s=t.length,o=Array(s-e),l=t;let a,d,f;for(d=0;!r[d]&&d<s;++d)o[d]=t[d],l[d]=d;for(f=d;d<s;++d)a=t[d],r[d]?l[d]=-1:(l[d]=f,i[f]=i[d],n[f]=n[d],o[f]=a,a._index=f++),i[d]=0;return t=o,l;},size:()=>t.length,curr:()=>i,prev:()=>n,reset:e=>n[e]=i[e],all:()=>e<257?255:e<65537?65535:4294967295,set(e,t){i[e]|=t;},clear(e,t){i[e]&=~t;},resize(t,r){(t>i.length||r>e)&&(e=Math.max(r,e),i=a16(t,e,i),n=a16(t,e));}};}(),e),this._indices=null,this._dims=null;}function h23(e){st2.call(this,null,e);}u18.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},an(u18,st2,{transform(e,t){return this._dims?e.modified("fields")||e.fields.some(e=>t.modified(e.fields))?this.reinit(e,t):this.eval(e,t):this.init(e,t);},init(e,t){const r=e.fields,i=e.query,n=this._indices={},s=this._dims=[],o=i.length;let l,a,u=0;for(;u<o;++u)l=r[u].fname,a=n[l]||(n[l]=f15()),s.push(d16(a,u,i[u]));return this.eval(e,t);},reinit(e,t){const r=t.materialize().fork(),i=e.fields,n=e.query,s=this._indices,o=this._dims,l=this.value,a=l.curr(),u=l.prev(),h=l.all(),m=r.rem=r.add,c=r.mod,p=n.length,g={};let v,y,x,_,A,b,M,q,z;if(u.set(a),t.rem.length&&(A=this.remove(e,t,r)),t.add.length&&l.add(t.add),t.mod.length)for(b={},_=t.mod,M=0,q=_.length;M<q;++M)b[_[M]._index]=1;for(M=0;M<p;++M)z=i[M],(!o[M]||e.modified("fields",M)||t.modified(z.fields))&&(x=z.fname,(v=g[x])||(s[x]=y=f15(),g[x]=v=y.insert(z,t.source,0)),o[M]=d16(y,M,n[M]).onAdd(v,a));for(M=0,q=l.data().length;M<q;++M)A[M]||(u[M]!==a[M]?m.push(M):b[M]&&a[M]!==h&&c.push(M));return l.mask=(1<<p)-1,r;},eval(e,t){const r=t.materialize().fork(),i=this._dims.length;let n=0;return t.rem.length&&(this.remove(e,t,r),n|=(1<<i)-1),e.modified("query")&&!e.modified("fields")&&(n|=this.update(e,t,r)),t.add.length&&(this.insert(e,t,r),n|=(1<<i)-1),t.mod.length&&(this.modify(t,r),n|=(1<<i)-1),this.value.mask=n,r;},insert(e,t,r){const i=t.add,n=this.value,s=this._dims,o=this._indices,l=e.fields,a={},d=r.add,f=n.size()+i.length,u=s.length;let h,m,c,p=n.size();n.resize(f,u),n.add(i);const g=n.curr(),v=n.prev(),y=n.all();for(h=0;h<u;++h)m=l[h].fname,c=a[m]||(a[m]=o[m].insert(l[h],i,p)),s[h].onAdd(c,g);for(;p<f;++p)v[p]=y,g[p]!==y&&d.push(p);},modify(e,t){const r=t.mod,i=this.value,n=i.curr(),s=i.all(),o=e.mod;let l,a,d;for(l=0,a=o.length;l<a;++l)d=o[l]._index,n[d]!==s&&r.push(d);},remove(e,t,r){const i=this._indices,n=this.value,s=n.curr(),o=n.prev(),l=n.all(),a={},d=r.rem,f=t.rem;let u,h,m,c;for(u=0,h=f.length;u<h;++u)m=f[u]._index,a[m]=1,o[m]=c=s[m],s[m]=l,c!==l&&d.push(m);for(m in i)i[m].remove(h,a);return this.reindex(t,h,a),a;},reindex(e,t,r){const i=this._indices,n=this.value;e.runAfter(()=>{const e=n.remove(t,r);for(const t in i)i[t].reindex(e);});},update(e,t,r){const i=this._dims,n=e.query,s=t.stamp,o=i.length;let l,a,d=0;for(r.filters=0,a=0;a<o;++a)e.modified("query",a)&&(l=a,++d);if(1===d)d=i[l].one,this.incrementOne(i[l],n[l],r.add,r.rem);else for(a=0,d=0;a<o;++a)e.modified("query",a)&&(d|=i[a].one,this.incrementAll(i[a],n[a],s,r.add),r.rem=r.add);return d;},incrementAll(e,t,r,i){const n=this.value,s=n.seen(),o=n.curr(),l=n.prev(),a=e.index(),d=e.bisect(e.range),f=e.bisect(t),u=f[0],h=f[1],m=d[0],c=d[1],p=e.one;let g,v,y;if(u<m)for(g=u,v=Math.min(m,h);g<v;++g)y=a[g],s[y]!==r&&(l[y]=o[y],s[y]=r,i.push(y)),o[y]^=p;else if(u>m)for(g=m,v=Math.min(u,c);g<v;++g)y=a[g],s[y]!==r&&(l[y]=o[y],s[y]=r,i.push(y)),o[y]^=p;if(h>c)for(g=Math.max(u,c),v=h;g<v;++g)y=a[g],s[y]!==r&&(l[y]=o[y],s[y]=r,i.push(y)),o[y]^=p;else if(h<c)for(g=Math.max(m,h),v=c;g<v;++g)y=a[g],s[y]!==r&&(l[y]=o[y],s[y]=r,i.push(y)),o[y]^=p;e.range=t.slice();},incrementOne(e,t,r,i){const n=this.value.curr(),s=e.index(),o=e.bisect(e.range),l=e.bisect(t),a=l[0],d=l[1],f=o[0],u=o[1],h=e.one;let m,c,p;if(a<f)for(m=a,c=Math.min(f,d);m<c;++m)p=s[m],n[p]^=h,r.push(p);else if(a>f)for(m=f,c=Math.min(a,u);m<c;++m)p=s[m],n[p]^=h,i.push(p);if(d>u)for(m=Math.max(a,u),c=d;m<c;++m)p=s[m],n[p]^=h,r.push(p);else if(d<u)for(m=Math.max(f,d),c=u;m<c;++m)p=s[m],n[p]^=h,i.push(p);e.range=t.slice();}}),h23.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},an(h23,st2,{transform(e,t){const r=~(e.ignore||0),i=e.filter,n=i.mask;if(!(n&r))return t.StopPropagation;const s=t.fork(t.ALL),o=i.data(),l=i.curr(),a=i.prev(),d=e=>l[e]&r?null:o[e];return s.filter(s.MOD,d),n&n-1?(s.filter(s.ADD,e=>{const t=l[e]&r;return!t&&t^a[e]&r?o[e]:null;}),s.filter(s.REM,e=>{const t=l[e]&r;return t&&!(0^a[e]&r)?o[e]:null;})):(s.filter(s.ADD,d),s.filter(s.REM,e=>(l[e]&r)===n?o[e]:null)),s.filter(s.SOURCE,e=>d(e._index));}});const mod11=function(){return{crossfilter:u18,resolvefilter:h23,default:null};}();const a17="Literal",F17="Property",C18="ArrayExpression",s22="BinaryExpression",i20="CallExpression",D16="ConditionalExpression",B19="LogicalExpression",c20="MemberExpression",E21="ObjectExpression",l20="UnaryExpression";function f16(u){this.type=u;}var p17,d17,h24,g18,y16;f16.prototype.visit=function(u){let e,t,r;if(u(this))return 1;for(e=function(u){switch(u.type){case C18:return u.elements;case s22:case B19:return[u.left,u.right];case i20:return[u.callee].concat(u.arguments);case D16:return[u.test,u.consequent,u.alternate];case c20:return[u.object,u.property];case E21:return u.properties;case F17:return[u.key,u.value];case l20:return[u.argument];default:return[];}}(this),t=0,r=e.length;t<r;++t)if(e[t].visit(u))return 1;};(p17={})[1]="Boolean",p17[2]="<end>",p17[3]="Identifier",p17[4]="Keyword",p17[5]="Null",p17[6]="Numeric",p17[7]="Punctuator",p17[8]="String",p17[9]="RegularExpression";var m18="Identifier",x21="Unexpected token %0",v20="Invalid regular expression",b19="Invalid regular expression: missing /",w19="Octal literals are not allowed in strict mode.",M20="ILLEGAL",k18="Disabled.",U16=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),L17=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function S17(u,e){if(!u)throw new Error("ASSERT: "+e);}function N19(u){return u>=48&&u<=57;}function I16(u){return"0123456789abcdefABCDEF".includes(u);}function O16(u){return"01234567".includes(u);}function T17(u){return 32===u||9===u||11===u||12===u||160===u||u>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].includes(u);}function j17(u){return 10===u||13===u||8232===u||8233===u;}function R17(u){return 36===u||95===u||u>=65&&u<=90||u>=97&&u<=122||92===u||u>=128&&U16.test(String.fromCharCode(u));}function P17(u){return 36===u||95===u||u>=65&&u<=90||u>=97&&u<=122||u>=48&&u<=57||92===u||u>=128&&L17.test(String.fromCharCode(u));}const q16={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function _18(){for(;h24<g18;){const u=d17.charCodeAt(h24);if(!T17(u)&&!j17(u))break;++h24;}}function G18(u){var e,t,r,n=0;for(t="u"===u?4:2,e=0;e<t;++e)h24<g18&&I16(d17[h24])?(r=d17[h24++],n=16*n+"0123456789abcdef".indexOf(r.toLowerCase())):nu({},x21,M20);return String.fromCharCode(n);}function Q16(){var u,e,t,r;for(e=0,"}"===(u=d17[h24])&&nu({},x21,M20);h24<g18&&I16(u=d17[h24++]);)e=16*e+"0123456789abcdef".indexOf(u.toLowerCase());return(e>1114111||"}"!==u)&&nu({},x21,M20),e<=65535?String.fromCharCode(e):(t=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(t,r));}function V17(){var u,e;for(u=d17.charCodeAt(h24++),e=String.fromCharCode(u),92===u&&(117!==d17.charCodeAt(h24)&&nu({},x21,M20),++h24,(u=G18("u"))&&"\\"!==u&&R17(u.charCodeAt(0))||nu({},x21,M20),e=u);h24<g18&&P17(u=d17.charCodeAt(h24));)++h24,e+=String.fromCharCode(u),92===u&&(e=e.substr(0,e.length-1),117!==d17.charCodeAt(h24)&&nu({},x21,M20),++h24,(u=G18("u"))&&"\\"!==u&&P17(u.charCodeAt(0))||nu({},x21,M20),e+=u);return e;}function z20(){var u,e;return u=h24,e=92===d17.charCodeAt(h24)?V17():function(){var u,e;for(u=h24++;h24<g18;){if(92===(e=d17.charCodeAt(h24)))return h24=u,V17();if(!P17(e))break;++h24;}return d17.slice(u,h24);}(),{type:1===e.length?3:q16.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:u,end:h24};}function X19(){var u,e,t,r,n=h24,A=d17.charCodeAt(h24),a=d17[h24];switch(A){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++h24,{type:7,value:String.fromCharCode(A),start:n,end:h24};default:if(61===(u=d17.charCodeAt(h24+1)))switch(A){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return h24+=2,{type:7,value:String.fromCharCode(A)+String.fromCharCode(u),start:n,end:h24};case 33:case 61:return h24+=2,61===d17.charCodeAt(h24)&&++h24,{type:7,value:d17.slice(n,h24),start:n,end:h24};}}return">>>="===(r=d17.substr(h24,4))?{type:7,value:r,start:n,end:h24+=4}:">>>"===(t=r.substr(0,3))||"<<="===t||">>="===t?{type:7,value:t,start:n,end:h24+=3}:a===(e=t.substr(0,2))[1]&&"+-<>&|".includes(a)||"=>"===e?{type:7,value:e,start:n,end:h24+=2}:("//"===e&&nu({},x21,M20),"<>=!+-*%&|^/".includes(a)?{type:7,value:a,start:n,end:++h24}:void nu({},x21,M20));}function $16(){var u,e,t;if(S17(N19((t=d17[h24]).charCodeAt(0))||"."===t,"Numeric literal must start with a decimal digit or a decimal point"),e=h24,u="","."!==t){if(u=d17[h24++],t=d17[h24],"0"===u){if("x"===t||"X"===t)return++h24,function(u){let e="";for(;h24<g18&&I16(d17[h24]);)e+=d17[h24++];return 0===e.length&&nu({},x21,M20),R17(d17.charCodeAt(h24))&&nu({},x21,M20),{type:6,value:parseInt("0x"+e,16),start:u,end:h24};}(e);if(O16(t))return function(u){let e="0"+d17[h24++];for(;h24<g18&&O16(d17[h24]);)e+=d17[h24++];return(R17(d17.charCodeAt(h24))||N19(d17.charCodeAt(h24)))&&nu({},x21,M20),{type:6,value:parseInt(e,8),octal:!0,start:u,end:h24};}(e);t&&N19(t.charCodeAt(0))&&nu({},x21,M20);}for(;N19(d17.charCodeAt(h24));)u+=d17[h24++];t=d17[h24];}if("."===t){for(u+=d17[h24++];N19(d17.charCodeAt(h24));)u+=d17[h24++];t=d17[h24];}if("e"===t||"E"===t)if(u+=d17[h24++],"+"!==(t=d17[h24])&&"-"!==t||(u+=d17[h24++]),N19(d17.charCodeAt(h24)))for(;N19(d17.charCodeAt(h24));)u+=d17[h24++];else nu({},x21,M20);return R17(d17.charCodeAt(h24))&&nu({},x21,M20),{type:6,value:parseFloat(u),start:e,end:h24};}function H18(){var u,e,t,r;return y16=null,_18(),u=h24,e=function(){var u,e,t,r;for(S17("/"===(u=d17[h24]),"Regular expression literal must start with a slash"),e=d17[h24++],t=!1,r=!1;h24<g18;)if(e+=u=d17[h24++],"\\"===u)j17((u=d17[h24++]).charCodeAt(0))&&nu({},b19),e+=u;else if(j17(u.charCodeAt(0)))nu({},b19);else if(t)"]"===u&&(t=!1);else{if("/"===u){r=!0;break;}"["===u&&(t=!0);}return r||nu({},b19),{value:e.substr(1,e.length-2),literal:e};}(),t=function(){var u,e,t;for(e="",t="";h24<g18&&P17((u=d17[h24]).charCodeAt(0));)++h24,"\\"===u&&h24<g18?nu({},x21,M20):(t+=u,e+=u);return t.search(/[^gimuy]/g)>=0&&nu({},v20,t),{value:t,literal:e};}(),r=function(u,e){let t=u;e.includes("u")&&(t=t.replace(/\\u\{([0-9a-fA-F]+)\}/g,(u,e)=>{if(parseInt(e,16)<=1114111)return"x";nu({},v20);}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(t);}catch(u){nu({},v20);}try{return new RegExp(u,e);}catch(u){return null;}}(e.value,t.value),{literal:e.literal+t.literal,value:r,regex:{pattern:e.value,flags:t.value},start:u,end:h24};}function Y18(){if(_18(),h24>=g18)return{type:2,start:h24,end:h24};const u=d17.charCodeAt(h24);return R17(u)?z20():40===u||41===u||59===u?X19():39===u||34===u?function(){var u,e,t,r,n="",A=!1;for(S17("'"===(u=d17[h24])||'"'===u,"String literal must starts with a quote"),e=h24,++h24;h24<g18;){if((t=d17[h24++])===u){u="";break;}if("\\"===t)if((t=d17[h24++])&&j17(t.charCodeAt(0)))"\r"===t&&"\n"===d17[h24]&&++h24;else switch(t){case"u":case"x":"{"===d17[h24]?(++h24,n+=Q16()):n+=G18(t);break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="	";break;case"b":n+="\b";break;case"f":n+="\f";break;case"v":n+="\v";break;default:O16(t)?(0!==(r="01234567".indexOf(t))&&(A=!0),h24<g18&&O16(d17[h24])&&(A=!0,r=8*r+"01234567".indexOf(d17[h24++]),"0123".includes(t)&&h24<g18&&O16(d17[h24])&&(r=8*r+"01234567".indexOf(d17[h24++]))),n+=String.fromCharCode(r)):n+=t;}else{if(j17(t.charCodeAt(0)))break;n+=t;}}return""!==u&&nu({},x21,M20),{type:8,value:n,octal:A,start:e,end:h24};}():46===u?N19(d17.charCodeAt(h24+1))?$16():X19():N19(u)?$16():X19();}function K21(){const u=y16;return h24=u.end,y16=Y18(),h24=u.end,u;}function J20(){const u=h24;y16=Y18(),h24=u;}function W19(u,e,t){const r=new f16("||"===u||"&&"===u?"LogicalExpression":"BinaryExpression");return r.operator=u,r.left=e,r.right=t,r;}function Z20(u,e){const t=new f16("CallExpression");return t.callee=u,t.arguments=e,t;}function uu(u){const e=new f16(m18);return e.name=u,e;}function eu(u){const e=new f16("Literal");return e.value=u.value,e.raw=d17.slice(u.start,u.end),u.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=u.regex),e;}function tu(u,e,t){const r=new f16("MemberExpression");return r.computed="["===u,r.object=e,r.property=t,r.computed||(t.member=!0),r;}function ru(u,e,t){const r=new f16("Property");return r.key=e,r.value=t,r.kind=u,r;}function nu(u,e){var t,r=Array.prototype.slice.call(arguments,2),n=e.replace(/%(\d)/g,(u,e)=>(S17(e<r.length,"Message reference must be in range"),r[e]));throw(t=new Error(n)).index=h24,t.description=n,t;}function Au(u){2===u.type&&nu(u,"Unexpected end of input"),6===u.type&&nu(u,"Unexpected number"),8===u.type&&nu(u,"Unexpected string"),3===u.type&&nu(u,"Unexpected identifier"),4===u.type&&nu(u,"Unexpected reserved word"),nu(u,x21,u.value);}function au(u){const e=K21();7===e.type&&e.value===u||Au(e);}function Fu(u){return 7===y16.type&&y16.value===u;}function ou(u){return 4===y16.type&&y16.value===u;}function Cu(){const u=[];for(h24=y16.start,au("[");!Fu("]");)Fu(",")?(K21(),u.push(null)):(u.push(gu()),Fu("]")||au(","));return K21(),function(u){const e=new f16("ArrayExpression");return e.elements=u,e;}(u);}function su(){h24=y16.start;const u=K21();return 8===u.type||6===u.type?(u.octal&&nu(u,w19),eu(u)):uu(u.value);}function iu(){var u,e,t;return h24=y16.start,3===(u=y16).type?(t=su(),au(":"),ru("init",t,gu())):2!==u.type&&7!==u.type?(e=su(),au(":"),ru("init",e,gu())):void Au(u);}function Du(){var u,e,t=[],r={},n=String;for(h24=y16.start,au("{");!Fu("}");)e="$"+((u=iu()).key.type===m18?u.key.name:n(u.key.value)),Object.prototype.hasOwnProperty.call(r,e)?nu({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,t.push(u),Fu("}")||au(",");return au("}"),function(u){const e=new f16("ObjectExpression");return e.properties=u,e;}(t);}const Bu={if:1};function cu(){var u,e,t;if(Fu("("))return function(){au("(");const u=yu();return au(")"),u;}();if(Fu("["))return Cu();if(Fu("{"))return Du();if(u=y16.type,h24=y16.start,3===u||Bu[y16.value])t=uu(K21().value);else if(8===u||6===u)y16.octal&&nu(y16,w19),t=eu(K21());else{if(4===u)throw new Error(k18);1===u?((e=K21()).value="true"===e.value,t=eu(e)):5===u?((e=K21()).value=null,t=eu(e)):Fu("/")||Fu("/=")?(t=eu(H18()),J20()):Au(K21());}return t;}function Eu(){const u=[];if(au("("),!Fu(")"))for(;h24<g18&&(u.push(gu()),!Fu(")"));)au(",");return au(")"),u;}function lu(){return au("."),function(){h24=y16.start;const u=K21();return function(u){return 3===u.type||4===u.type||1===u.type||5===u.type;}(u)||Au(u),uu(u.value);}();}function fu(){au("[");const u=yu();return au("]"),u;}function pu(){const u=function(){var u;for(u=cu();;)if(Fu("."))u=tu(".",u,lu());else if(Fu("("))u=Z20(u,Eu());else{if(!Fu("["))break;u=tu("[",u,fu());}return u;}();if(7===y16.type&&(Fu("++")||Fu("--")))throw new Error(k18);return u;}function du(){var u,e;if(7!==y16.type&&4!==y16.type)e=pu();else{if(Fu("++")||Fu("--"))throw new Error(k18);if(Fu("+")||Fu("-")||Fu("~")||Fu("!"))u=K21(),e=du(),e=function(u,e){const t=new f16("UnaryExpression");return t.operator=u,t.argument=e,t.prefix=!0,t;}(u.value,e);else{if(ou("delete")||ou("void")||ou("typeof"))throw new Error(k18);e=pu();}}return e;}function hu(u){let e=0;if(7!==u.type&&4!==u.type)return 0;switch(u.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;}return e;}function gu(){var u,e;return u=function(){var u,e,t,r,n,A,a,F,o,C;if(u=y16,o=du(),0===(n=hu(r=y16)))return o;for(r.prec=n,K21(),e=[u,y16],A=[o,r,a=du()];(n=hu(y16))>0;){for(;A.length>2&&n<=A[A.length-2].prec;)a=A.pop(),F=A.pop().value,o=A.pop(),e.pop(),t=W19(F,o,a),A.push(t);(r=K21()).prec=n,A.push(r),e.push(y16),t=du(),A.push(t);}for(t=A[C=A.length-1],e.pop();C>1;)e.pop(),t=W19(A[C-1].value,A[C-2],t),C-=2;return t;}(),Fu("?")&&(K21(),e=gu(),au(":"),u=function(u,e,t){const r=new f16("ConditionalExpression");return r.test=u,r.consequent=e,r.alternate=t,r;}(u,e,gu())),u;}function yu(){const u=gu();if(Fu(","))throw new Error(k18);return u;}function mu(u){h24=0,g18=(d17=u).length,y16=null,J20();const e=yu();if(2!==y16.type)throw new Error("Unexpect token after expression.");return e;}var xu={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function vu(e){function t(u,t,r){return n=>(function(u,t,r,n){let A=e(t[0]);return r&&(A=r+"("+A+")",0===r.lastIndexOf("new ",0)&&(A="("+A+")")),A+"."+u+(n<0?"":0===n?"()":"("+t.slice(1).map(e).join(",")+")");})(u,n,t,r);}const r="new Date",n="String",A="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&l("Missing arguments to clamp function."),t.length>3&&l("Too many arguments to clamp function.");const r=t.map(e);return"Math.max("+r[1]+", Math.min("+r[2]+","+r[0]+"))";},now:"Date.now",utc:"Date.UTC",datetime:r,date:t("getDate",r,0),day:t("getDay",r,0),year:t("getFullYear",r,0),month:t("getMonth",r,0),hours:t("getHours",r,0),minutes:t("getMinutes",r,0),seconds:t("getSeconds",r,0),milliseconds:t("getMilliseconds",r,0),time:t("getTime",r,0),timezoneoffset:t("getTimezoneOffset",r,0),utcdate:t("getUTCDate",r,0),utcday:t("getUTCDay",r,0),utcyear:t("getUTCFullYear",r,0),utcmonth:t("getUTCMonth",r,0),utchours:t("getUTCHours",r,0),utcminutes:t("getUTCMinutes",r,0),utcseconds:t("getUTCSeconds",r,0),utcmilliseconds:t("getUTCMilliseconds",r,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",n,0),lower:t("toLowerCase",n,0),substring:t("substring",n),split:t("split",n),trim:t("trim",n,0),btoa:"btoa",atob:"atob",regexp:A,test:t("test",A),if:function(t){t.length<3&&l("Missing arguments to if function."),t.length>3&&l("Too many arguments to if function.");const r=t.map(e);return"("+r[0]+"?"+r[1]+":"+r[2]+")";}};}function bu(A){const a=(A=A||{}).allowed?Sn(A.allowed):{},F=A.forbidden?Sn(A.forbidden):{},o=A.constants||xu,C=(A.functions||vu)(l1),s=A.globalvar,i=A.fieldvar,D=L(s)?s:u=>`${s}["${u}"]`;let B={},c={},E=0;function l1(e){if(Mn(e))return e;const t=f[e.type];return null==t&&l("Unsupported type: "+e.type),t(e);}const f={Literal:u=>u.raw,Identifier:e=>{const t=e.name;return E>0?t:ln(F,t)?l("Illegal identifier: "+t):ln(o,t)?o[t]:ln(a,t)?t:(B[t]=1,D(t));},MemberExpression:u=>{const e=!u.computed,t=l1(u.object);e&&(E+=1);const r=l1(u.property);return t===i&&(c[function(u){const e=u&&u.length-1;return e&&('"'===u[0]&&'"'===u[e]||"'"===u[0]&&"'"===u[e])?u.slice(1,-1):u;}(r)]=1),e&&(E-=1),t+(e?"."+r:"["+r+"]");},CallExpression:e=>{"Identifier"!==e.callee.type&&l("Illegal callee type: "+e.callee.type);const r=e.callee.name,A=e.arguments,a=ln(C,r)&&C[r];return a||l("Unrecognized function: "+r),L(a)?a(A):a+"("+A.map(l1).join(",")+")";},ArrayExpression:u=>"["+u.elements.map(l1).join(",")+"]",BinaryExpression:u=>"("+l1(u.left)+" "+u.operator+" "+l1(u.right)+")",UnaryExpression:u=>"("+u.operator+l1(u.argument)+")",ConditionalExpression:u=>"("+l1(u.test)+"?"+l1(u.consequent)+":"+l1(u.alternate)+")",LogicalExpression:u=>"("+l1(u.left)+u.operator+l1(u.right)+")",ObjectExpression:u=>"{"+u.properties.map(l1).join(",")+"}",Property:u=>{E+=1;const e=l1(u.key);return E-=1,e+":"+l1(u.value);}};function p(u){const e={code:l1(u),globals:Object.keys(B),fields:Object.keys(c)};return B={},c={},e;}return p.functions=C,p.constants=o,p;}const v21=Symbol("vega_selection_getter");function g19(e){return e.getter&&e.getter[v21]||(e.getter=i(e.field),e.getter[v21]=!0),e.getter;}const h25="intersect",m19="union",y17="or",E22="and",_19="_vgsid_",R18=i(_19),x22="index:unit";function $17(e,t){for(var n,r,i=t.fields,u=t.values,l=i.length,s=0;s<l;++s)if(n=g19(r=i[s])(e),pn(n)&&(n=z(n)),pn(u[s])&&(u[s]=z(u[s])),w(u[s])&&pn(u[s][0])&&(u[s]=u[s].map(z)),"E"===r.type){if(w(u[s])?!u[s].includes(n):n!==u[s])return!1;}else if("R"===r.type){if(!hn(n,u[s]))return!1;}else if("R-RE"===r.type){if(!hn(n,u[s],!0,!1))return!1;}else if("R-E"===r.type){if(!hn(n,u[s],!1,!1))return!1;}else if("R-LE"===r.type){if(!hn(n,u[s],!1,!0))return!1;}else if("E-LT"===r.type){if(n>=u[s])return!1;}else if("E-LTE"===r.type){if(n>u[s])return!1;}else if("E-GT"===r.type){if(n<=u[s])return!1;}else if("E-GTE"===r.type){if(n<u[s])return!1;}else if("E-VALID"===r.type){if(null===n||isNaN(n))return!1;}else if("E-ONE"===r.type&&-1===u[s].indexOf(n))return!1;return!0;}function b20(e,t,n){for(var r,i,u,f,l,s=this.context.data[e],a=s?s.values.value:[],o=s?s[x22]&&s[x22].value:void 0,c=n===h25,p=a.length,d=0;d<p;++d)if(r=a[d],o&&c){if(-1===(u=(i=i||{})[f=r.unit]||0))continue;if(l=$17(t,r),i[f]=l?-1:++u,l&&1===o.size)return!0;if(!l&&u===o.get(f).count)return!1;}else if(c^(l=$17(t,r)))return l;return p&&c;}const O17=e4(R18),j18=O17.left,L18=O17.right;function T18(e,t,n){const r=this.context.data[e],i=r?r.values.value:[],u=r?r[x22]&&r[x22].value:void 0,f=n===h25,l=R18(t),s=j18(i,l);if(s===i.length)return!1;if(R18(i[s])!==l)return!1;if(u&&f){if(1===u.size)return!0;if(L18(i,l)-s<u.size)return!1;}return!0;}function k19(e,t){return e.map(e=>rn(t.fields?{values:t.fields.map(t=>g19(t)(e.datum))}:{[_19]:R18(e.datum)},t));}function z21(e,t,n,r){for(var i,f,l,s,a,o,c,p,d,v,g,h,x=this.context.data[e],$=x?x.values.value:[],b={},O={},j={},L=$.length,T=0;T<L;++T)if(s=(i=$[T]).unit,f=i.fields,l=i.values,f&&l){for(g=0,h=f.length;g<h;++g)a=f[g],p=(c=b[a.field]||(b[a.field]={}))[s]||(c[s]=[]),j[a.field]=d=a.type.charAt(0),v=D17[`${d}_union`],c[s]=v(p,H(l[g]));n&&(p=O[s]||(O[s]=[])).push(H(l).reduce((e,t,n)=>(e[f[n].field]=t,e),{}));}else a=_19,o=R18(i),(p=(c=b[a]||(b[a]={}))[s]||(c[s]=[])).push(o),n&&(p=O[s]||(O[s]=[])).push({[_19]:o});if(t=t||m19,b[_19]?b[_19]=D17[`${_19}_${t}`](...Object.values(b[_19])):Object.keys(b).forEach(e=>{b[e]=Object.keys(b[e]).map(t=>b[e][t]).reduce((n,r)=>void 0===n?r:D17[`${j[e]}_${t}`](n,r));}),$=Object.keys(O),n&&$.length){b[r?"vlPoint":"vlMulti"]=t===m19?{[y17]:$.reduce((e,t)=>(e.push(...O[t]),e),[])}:{[E22]:$.map(e=>({[y17]:O[e]}))};}return b;}var D17={[`${_19}_union`]:Wt,[`${_19}_intersect`]:Jt,E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.includes(t[n])||e.push(t[n]);return e;},E_intersect:function(e,t){return e.length?e.filter(e=>t.includes(e)):t;},R_union:function(e,t){var n=z(t[0]),r=z(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r];},R_intersect:function(e,t){var n=z(t[0]),r=z(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r];}};function N20(e,t,n,r){t[0].type!==a17&&l("First argument to selection functions must be a string literal.");const i=t[0].value,u="unit",f="@"+u,o=":"+i;(t.length>=2&&D(t).value)!==h25||ln(r,f)||(r[f]=n.getData(i).indataRef(n,u)),ln(r,o)||(r[o]=n.getData(i).tuplesRef());}function Tt4(t){const n=this.context.data[t];return n?n.values.value:[];}function Xt3(t,n,e){const r=this.context.data[t]["index:"+n],o=r?r.value.get(e):void 0;return o?o.count:o;}function zt5(n,e){const r=this.context.dataflow,o=this.context.data[n].input;return r.pulse(o,r.changeset().remove(g).insert(e)),1;}function Bt6(t,n,e){if(t){const e=this.context.dataflow,r=t.mark.source;e.pulse(r,e.changeset().encode(t,n));}return void 0!==e?e:t;}const Ot4=t=>function(n,e){const r=this.context.dataflow.locale();return null===n?"null":r[t](e)(n);},Ut5=Ot4("format"),Yt4=Ot4("timeFormat"),Gt3=Ot4("utcFormat"),jt7=Ot4("timeParse"),Ct5=Ot4("utcParse"),Ht4=new Date(2e3,0,1);function Vt3(t,n,e){return Number.isInteger(t)&&Number.isInteger(n)?(Ht4.setYear(2e3),Ht4.setMonth(t),Ht4.setDate(n),Yt4.call(this,Ht4,e)):"";}function Wt4(t){return Vt3.call(this,t,1,"%B");}function Zt2(t){return Vt3.call(this,t,1,"%b");}function Jt3(t){return Vt3.call(this,0,2+t,"%A");}function Kt4(t){return Vt3.call(this,0,2+t,"%a");}const nn8="%";function rn8(t,r,o,i){r[0].type!==a17&&l("First argument to data functions must be a string literal.");const a=r[0].value,c=":"+a;if(!ln(c,i))try{i[c]=o.getData(a).tuplesRef();}catch(t){}}function on7(t,r,o,i){r[0].type!==a17&&l("First argument to indata must be a string literal."),r[1].type!==a17&&l("Second argument to indata must be a string literal.");const a=r[0].value,c=r[1].value,s="@"+c;ln(s,i)||(i[s]=o.getData(a).indataRef(o,c));}function an7(t,n,e,r){if(n[0].type===a17)cn8(e,r,n[0].value);else for(t in e.scales)cn8(e,r,t);}function cn8(t,n,r){const o=nn8+r;if(!ln(n,o))try{n[o]=t.scaleRef(r);}catch(t){}}function sn6(t,n){if(Mn(t)){const e=n.scales[t];return e&&te1(e.value)?e.value:void 0;}if(L(t))return te1(t)?t:void 0;}function un7(t,n,e){n.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,e._bandwidth=an7,e._range=an7,e._scale=an7;const r=n=>"_["+(n.type===a17?xn(nn8+n.value):xn(nn8)+"+"+t(n))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>`${r(t[0])}.range()`,_scale:n=>`${r(n[0])}(${t(n[1])})`};}function ln7(t,n){return function(e,r,o){if(e){const n=sn6(e,(o||this).context);return n&&n.path[t](r);}return n(r);};}const fn7=ln7("area",en5),mn6=ln7("bounds",kn3),dn6=ln7("centroid",Kn2);function pn6(t,n){const e=sn6(t,(n||this).context);return e&&e.scale();}function hn7(t){const n=this.context.group;let e=!1;if(n)for(;t;){if(t===n){e=!0;break;}t=t.mark.group;}return e;}function gn5(t,n,e){try{t[n].apply(t,["EXPRESSION"].concat([].slice.call(e)));}catch(n){t.warn(n);}return e[e.length-1];}function vn5(){return gn5(this.context.dataflow,"warn",arguments);}function xn5(){return gn5(this.context.dataflow,"info",arguments);}function yn6(){return gn5(this.context.dataflow,"debug",arguments);}function wn6(t){const n=t/255;return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4);}function bn6(t){const n=k8(t);return .2126*wn6(n.r)+.7152*wn6(n.g)+.0722*wn6(n.b);}function Sn5(t,n){const e=bn6(t),r=bn6(n);return(Math.max(e,r)+.05)/(Math.min(e,r)+.05);}function Nn4(){const t=[].slice.call(arguments);return t.unshift({}),rn(...t);}function En5(t,n){return t===n||t!=t&&n!=n||(w(t)?!(!w(n)||t.length!==n.length)&&function(t,n){for(let e=0,r=t.length;e<r;++e)if(!En5(t[e],n[e]))return!1;return!0;}(t,n):!(!E(t)||!E(n))&&_n4(t,n));}function _n4(t,n){for(const e in t)if(!En5(t[e],n[e]))return!1;return!0;}function An4(t){return n=>_n4(t,n);}function Fn4(n,e,r,i,a,c){const s=this.context.dataflow,u=this.context.data[n],l=u.input,f=s.stamp();let m,d,p=u.changes;if(!1===s._trigger||!(l.value.length||e||i))return 0;if((!p||p.stamp<f)&&(u.changes=p=s.changeset(),p.stamp=f,s.runAfter(()=>{u.modified=!0,s.pulse(l,p).run();},!0,1)),r&&(m=!0===r?g:w(r)||D5(r)?r:An4(r),p.remove(m)),e&&p.insert(e),i&&(m=An4(i),l.value.some(m)?p.remove(m):p.insert(i)),a)for(d in c)p.modify(a,d,c[d]);return 1;}function $n3(t){const n=t.touches,e=n[0].clientX-n[1].clientX,r=n[0].clientY-n[1].clientY;return Math.hypot(e,r);}function kn4(t){const n=t.touches;return Math.atan2(n[0].clientY-n[1].clientY,n[0].clientX-n[1].clientX);}const Rn4={};function Mn5(t,n){const e=Rn4[n]||(Rn4[n]=i(n));return w(t)?t.map(e):e(t);}function In4(t){return w(t)||ArrayBuffer.isView(t)?t:null;}function Ln4(t){return In4(t)||(Mn(t)?t:null);}function Pn3(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return In4(t).join(...e);}function qn3(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return Ln4(t).indexOf(...e);}function Dn5(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return Ln4(t).lastIndexOf(...e);}function Tn4(t){for(var n=arguments.length,e=new Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];return Ln4(t).slice(...e);}function Xn2(t,e,r){return L(r)&&l("Function argument passed to replace."),Mn(e)||mn(e)||l("Please pass a string or RegExp argument to replace."),String(t).replace(e,r);}function zn4(t){return In4(t).slice().reverse();}function Bn3(t){return In4(t).slice().sort(X);}function On5(t,n,e){return R11(t||0,n||0,e||0);}function Un4(t,n){const e=sn6(t,(n||this).context);return e&&e.bandwidth?e.bandwidth():0;}function Yn4(t,n){const e=sn6(t,(n||this).context);return e?e.copy():void 0;}function Gn3(t,n){const e=sn6(t,(n||this).context);return e?e.domain():[];}function jn6(t,n,e){const r=sn6(t,(e||this).context);return r?w(n)?(r.invertRange||r.invert)(n):(r.invert||r.invertExtent)(n):void 0;}function Cn4(t,n){const e=sn6(t,(n||this).context);return e&&e.range?e.range():[];}function Hn4(t,n,e){const r=sn6(t,(e||this).context);return r?r(n):void 0;}function Vn5(t,n,e,r,o){t=sn6(t,(o||this).context);const i=X14(n,e);let a=t.domain(),c=a[0],s1=D(a),u=s;return s1-c?u=Me2(t,c,s1):t=(t.interpolator?be1("sequential")().interpolator(t.interpolator()):be1("linear")().interpolate(t.interpolate()).range(t.range())).domain([c=0,s1=1]),t.ticks&&(a=t.ticks(+r||15),c!==a[0]&&a.unshift(c),s1!==D(a)&&a.push(s1)),a.forEach(n=>i.stop(u(n),t(n))),i;}function Wn3(t,n,e){const r=sn6(t,(e||this).context);return function(t){return r?r.path.context(t)(n):"";};}function Zn3(t){let n=null;return function(e){return e?ut5(e,n=n||tt6(t)):t;};}const Jn3=t=>t.data;function Kn4(t,n){const e=Tt4.call(n,t);return e.root&&e.root.lookup||{};}function Qn3(t,n,e){const r=Kn4(t,this),o=r[n],i=r[e];return o&&i?o.path(i).map(Jn3):void 0;}function te4(t,n){const e=Kn4(t,this)[n];return e?e.ancestors().map(Jn3):void 0;}const ne5=()=>"undefined"!=typeof window&&window||null;function ee5(){const t=ne5();return t?t.screen:{};}function re6(){const t=ne5();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0];}function oe4(){const t=this.context.dataflow,n=t.container&&t.container();return n?[n.clientWidth,n.clientHeight]:[void 0,void 0];}function ie5(t,n,e){if(!t)return[];const[r,o]=t,i=(new Bt3).set(r[0],r[1],o[0],o[1]),a=e||this.context.dataflow.scenegraph().root;return Cr(a,i,function(t){let n=null;if(t){const e=H(t.marktype),r=H(t.markname);n=t=>(!e.length||e.some(n=>t.marktype===n))&&(!r.length||r.some(n=>t.name===n));}return n;}(n));}const ae6={random:()=>c5(),cumulativeNormal:N7,cumulativeLogNormal:S7,cumulativeUniform:I6,densityNormal:b6,densityLogNormal:v6,densityUniform:D6,quantileNormal:y3,quantileLogNormal:E8,quantileUniform:C7,sampleNormal:x6,sampleLogNormal:F6,sampleUniform:k6,isArray:w,isBoolean:gn,isDate:pn,isDefined:t=>void 0!==t,isNumber:yn,isObject:E,isRegExp:mn,isString:Mn,isTuple:D5,isValid:t=>null!=t&&t==t,toBoolean:An,toDate:t=>zn(t),toNumber:z,toString:Rn,indexof:qn3,join:Pn3,lastindexof:Dn5,replace:Xn2,reverse:zn4,sort:Bn3,slice:Tn4,flush:sn,lerp:jn,merge:Nn4,pad:vn,peek:D,pluck:Mn5,span:kn,inrange:hn,truncate:_n,rgb:k8,lab:T7,hcl:tt5,hsl:I7,luminance:bn6,contrast:Sn5,sequence:Nt,format:Ut5,utcFormat:Gt3,utcParse:Ct5,utcOffset:Ct,utcSequence:yt1,timeFormat:Yt4,timeParse:jt7,timeOffset:ht1,timeSequence:Mt1,timeUnitSpecifier:G3,monthFormat:Wt4,monthAbbrevFormat:Zt2,dayFormat:Jt3,dayAbbrevFormat:Kt4,quarter:W,utcquarter:$,week:O2,utcweek:_2,dayofyear:N3,utcdayofyear:Z3,warn:vn5,info:xn5,debug:yn6,extent:t=>un(t),inScope:hn7,intersect:ie5,clampRange:K,pinchDistance:$n3,pinchAngle:kn4,screen:ee5,containerSize:oe4,windowSize:re6,bandspace:On5,setdata:zt5,pathShape:Zn3,panLinear:U,panLog:q,panPow:B,panSymlog:C,zoomLinear:G,zoomLog:I,zoomPow:J,zoomSymlog:V,encode:Bt6,modify:Fn4,lassoAppend:function(t,n,e){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const o=(t=H(t))[t.length-1];return void 0===o||Math.hypot(o[0]-n,o[1]-e)>r?[...t,[n,e]]:t;},lassoPath:function(t){return H(t).reduce((n,e,r)=>{let[o,i]=e;return n+(0==r?`M ${o},${i} `:r===t.length-1?" Z":`L ${o},${i} `);},"");},intersectLasso:function(t,n,e){const{x:r,y:o,mark:i}=e,a=(new Bt3).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[t,e]of n)t<a.x1&&(a.x1=t),t>a.x2&&(a.x2=t),e<a.y1&&(a.y1=e),e>a.y2&&(a.y2=e);return a.translate(r,o),ie5([[a.x1,a.y1],[a.x2,a.y2]],t,i).filter(t=>(function(t,n,e){let r=0;for(let o=0,i=e.length-1;o<e.length;i=o++){const[a,c]=e[i],[s,u]=e[o];u>n!=c>n&&t<(a-s)*(n-u)/(c-u)+s&&r++;}return 1&r;})(t.x,t.y,n));}},ce5=["view","item","group","xy","x","y"],se5="this.",ue5={},le5={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${xn("$"+t)}]`,functions:function(t){const n=vu(t);ce5.forEach(t=>n[t]="event.vega."+t);for(const t in ae6)n[t]=se5+t;return rn(n,un7(t,ae6,ue5)),n;},constants:xu,visitors:ue5},fe4=bu(le5);function me5(t,n,e){return 1===arguments.length?ae6[t]:(ae6[t]=n,e&&(ue5[t]=e),fe4&&(fe4.functions[t]=se5+t),this);}function de4(t,o){const i={};let a;try{t=Mn(t)?t:xn(t)+"",a=mu(t);}catch(e){l("Expression parse error: "+t);}a.visit(t=>{if(t.type!==i20)return;const n=t.callee.name,e=le5.visitors[n];e&&e(n,t.arguments,o,i);});const s=fe4(a);return s.globals.forEach(t=>{const n="$"+t;!ln(i,n)&&o.getSignal(t)&&(i[n]=o.signalRef(t));}),{$expr:rn({code:s.code},o.options.ast?{ast:a}:null),$fields:s.fields,$params:i};}me5("bandwidth",Un4,an7),me5("copy",Yn4,an7),me5("domain",Gn3,an7),me5("range",Cn4,an7),me5("invert",jn6,an7),me5("scale",Hn4,an7),me5("gradient",Vn5,an7),me5("geoArea",fn7,an7),me5("geoBounds",mn6,an7),me5("geoCentroid",dn6,an7),me5("geoShape",Wn3,an7),me5("geoScale",pn6,an7),me5("indata",Xt3,on7),me5("data",Tt4,rn8),me5("treePath",Qn3,rn8),me5("treeAncestors",te4,rn8),me5("vlSelectionTest",b20,N20),me5("vlSelectionIdTest",T18,N20),me5("vlSelectionResolve",z21,N20),me5("vlSelectionTuples",k19);const l21=Sn(["rule"]),h26=Sn(["group","image","rect"]);function m20(e){return(e+"").toLowerCase();}function $18(e,t,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...t.concat(n));return e&&e.functions?r.bind(e.functions):r;}var g20={operator:(e,t)=>$18(e,["_"],t.code),parameter:(e,t)=>$18(e,["datum","_"],t.code),event:(e,t)=>$18(e,["event"],t.code),handler:(e,t)=>$18(e,["_","event"],`var datum=event.item&&event.item.datum;return ${t.code};`),encode:(e,n)=>{const{marktype:r,channels:s}=n;let o="var o=item,datum=o.datum,m=0,$;";for(const e in s){const n="o["+xn(e)+"]";o+=`$=${s[e].code};if(${n}!==$)${n}=$,m=1;`;}return o+=function(e,t){let n="";return l21[t]||(e.x2&&(e.x?(h26[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(h26[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n;}(s,r),o+="return m;",$18(e,["item","_"],o);},codegen:{get(e){const n=`[${e.map(xn).join("][")}]`,r=Function("_",`return _${n};`);return r.path=n,r;},comparator(e,t){let n;const r=Function("a","b","var u, v; return "+e.map((e,r)=>{const s=t[r];let o,a;return e.path?(o=`a${e.path}`,a=`b${e.path}`):((n=n||{})["f"+r]=e,o=`this.f${r}(a)`,a=`this.f${r}(b)`),function(e,t,n,r){return`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${n}
  : (u > v || v == null) && u != null ? ${r}
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}
  : v !== v && u === u ? ${r} : `;}(o,a,-s,s);}).join("")+"0;");return n?r.bind(n):r;}}};function v22(e,t,n){if(!e||!E(e))return e;for(let r,s=0,a=x23.length;s<a;++s)if(r=x23[s],ln(e,r.key))return r.parse(e,t,n);return e;}var x23=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||l("Operator not defined: "+e.$ref);}},{key:"$key",parse:function(e,t){const n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=dn(e.$key,e.$flat,t.expr.codegen));}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);const r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=n1(t.parameterExpression(e.$expr),e.$fields));}},{key:"$field",parse:function(e,t){if(!e.$field)return null;const n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=i(e.$field,e.$name,t.expr.codegen));}},{key:"$encode",parse:function(e,t){const n=e.$encode,r={};for(const e in n){const s=n[e];r[e]=n1(t.encodeExpression(s.$expr),s.$fields),r[e].output=s.$output;}return r;}},{key:"$compare",parse:function(e,t){const n="c:"+e.$compare+"_"+e.$order,r=H(e.$compare).map(e=>e&&e.$tupleid?E7:e);return t.fn[n]||(t.fn[n]=Q(r,e.$order,t.expr.codegen));}},{key:"$context",parse:function(e,t){return t;}},{key:"$subflow",parse:function(e,t){const n=e.$subflow;return function(e,r,s){const o=t.fork().parse(n),a=o.get(n.operators[0].id),i=o.signals.parent;return i&&i.set(s),a.detachSubflow=()=>t.detach(o),a;};}},{key:"$tupleid",parse:function(){return E7;}}];const y18={skip:!0};function b21(e,t,n,r){return new k20(e,t,n,r);}function k20(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||g20,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this);}function w20(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this);}k20.prototype=w20.prototype={fork(){const e=new w20(this);return(this.subcontext||(this.subcontext=[])).push(e),e;},detach(e){this.subcontext=this.subcontext.filter(t=>t!==e);const t=Object.keys(e.nodes);for(const n of t)e.nodes[n]._targets=null;for(const n of t)e.nodes[n].detach();e.nodes=null;},get(e){return this.nodes[e];},set(e,t){return this.nodes[e]=t;},add(e,t){const n=this,r=n.dataflow,s=e.value;if(n.set(e.id,t),"collect"===m20(e.type)&&s&&(s.$ingest?r.ingest(t,s.$ingest,s.$format):s.$request?r.preload(t,s.$request,s.$format):r.pulse(t,r.changeset().insert(s))),e.root&&(n.root=t),e.parent){let s=n.get(e.parent.$ref);s?(r.connect(s,[t]),t.targets().add(s)):(n.unresolved=n.unresolved||[]).push(()=>{s=n.get(e.parent.$ref),r.connect(s,[t]),t.targets().add(s);});}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(const r in e.data){const s=n.data[r]||(n.data[r]={});e.data[r].forEach(e=>s[e]=t);}},resolve(){return(this.unresolved||[]).forEach(e=>e()),delete this.unresolved,this;},operator(e,t){this.add(e,this.dataflow.add(e.value,t));},transform(e,t){this.add(e,this.dataflow.add(this.transforms[m20(t)]));},stream(e,t){this.set(e.id,t);},update(e,t,n,r,s){this.dataflow.on(t,n,r,s,e.options);},operatorExpression(e){return this.expr.operator(this,e);},parameterExpression(e){return this.expr.parameter(this,e);},eventExpression(e){return this.expr.event(this,e);},handlerExpression(e){return this.expr.handler(this,e);},encodeExpression(e){return this.expr.encode(this,e);},parse:function(e){const t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach(e=>t.parseOperator(e)),n.forEach(e=>t.parseOperatorParameters(e)),(e.streams||[]).forEach(e=>t.parseStream(e)),(e.updates||[]).forEach(e=>t.parseUpdate(e)),t.resolve();},parseOperator:function(e){const t=this;"operator"!==m20(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null);},parseOperatorParameters:function(e){const t=this;if(e.params){const r=t.get(e.id);r||l("Invalid operator id: "+e.id),t.dataflow.connect(r,r.parameters(t.parseParameters(e.params),e.react,e.initonly));}},parseParameters:function(e,t){t=t||{};const n=this;for(const s in e){const o=e[s];t[s]=w(o)?o.map(e=>v22(e,n,t)):v22(o,n,t);}return t;},parseStream:function(e){var t,r=this,s=null!=e.filter?r.eventExpression(e.filter):void 0,o=null!=e.stream?r.get(e.stream):void 0;e.source?o=r.events(e.source,e.type,s):e.merge&&(o=(t=e.merge.map(e=>r.get(e)))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map(e=>r.get(e)),o=o.between(t[0],t[1])),e.filter&&(o=o.filter(s)),null!=e.throttle&&(o=o.throttle(+e.throttle)),null!=e.debounce&&(o=o.debounce(+e.debounce)),null==o&&l("Invalid stream definition: "+JSON.stringify(e)),e.consume&&o.consume(!0),r.stream(e,o);},parseUpdate:function(e){var t,r=this,o=E(o=e.source)?o.$ref:o,a=r.get(o),i=e.update,c=void 0;a||l("Source not defined: "+e.source),t=e.target&&e.target.$expr?r.eventExpression(e.target.$expr):r.get(e.target),i&&i.$expr&&(i.$params&&(c=r.parseParameters(i.$params)),i=r.handlerExpression(i.$expr)),r.update(e,a,t,i,c);},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(n=>{const s=t.signals[n];e.signals(n,s)&&(r[n]=s.value);});}if(e.data){var s=n.data={};Object.keys(t.data).forEach(n=>{const r=t.data[n];e.data(n,r)&&(s[n]=r.input.value);});}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(t=>t.getState(e))),n;},setState:function(e){var t=this,n=t.dataflow,r=e.data,s=e.signals;Object.keys(s||{}).forEach(e=>{n.update(t.signals[e],s[e],y18);}),Object.keys(r||{}).forEach(e=>{n.pulse(t.data[e].input,n.changeset().remove(g).insert(r[e]));}),(e.subcontext||[]).forEach((e,n)=>{const r=t.subcontext[n];r&&r.setState(e);});}};function S18(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t));}const D18="default";function U17(e,t){const n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t;}function W20(e,r){var i=e._runtime.data;return ln(i,r)||l("Unrecognized data set: "+r),i[r];}function H19(e,n){S6(n)||l("Second argument to changes must be a changeset.");const r=W20(this,e);return r.modified=!0,this.pulse(r.input,n);}function P18(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right);}function T19(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom);}function M21(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]];}function j19(e,t,n){var r,i,s,a=e._renderer,o=a&&a.canvas();return o&&(s=M21(e),i=t.changedTouches?t.changedTouches[0]:t,(r=ei(i,o))[0]-=s[0],r[1]-=s[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){const r=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var n,i=r;if(e){for(n=t;n;n=n.mark.group)if(n.mark.name===e){i=n;break;}}return i&&i.mark&&i.mark.interactive?i:{};}function s(e){if(!e)return n;Mn(e)&&(e=i(e));const t=n.slice();for(;e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t;}return{view:tn(e),item:tn(t||{}),group:i,xy:s,x:e=>s(e)[0],y:e=>s(e)[1]};}(e,n,r),t;}const B20="view",G19={trap:!1};function V18(e,t,n,r){e._eventListeners.push({type:n,sources:H(t),handler:r});}function O18(e,t,n){const r=e._eventConfig&&e._eventConfig[t];return!(!1===r||E(r)&&!r[n])||(e.warn(`Blocked ${t} ${n} event listener.`),!1);}function I17(e){return e.item;}function $19(e){return e.item.mark.source;}function q17(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e);};}function N21(e,t,n){const r=document.createElement(e);for(const e in t)r.setAttribute(e,t[e]);return null!=n&&(r.textContent=n),r;}function F18(e,t,n,r){const i=n.event||"input",s=()=>e.update(t.value);r.signal(n.signal,t.value),t.addEventListener(i,s),V18(r,t,i,s),e.set=e=>{t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e};}(i));};}function J21(e,t,n,r){const i=r.signal(n.signal),s=N21("div",{class:"vega-bind"}),a="radio"===n.input?s:s.appendChild(N21("label"));a.appendChild(N21("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(s);let o=K22;switch(n.input){case"checkbox":o=Q17;break;case"select":o=X20;break;case"radio":o=Y19;break;case"range":o=Z21;}o(e,a,n,i);}function K22(e,t,n,r){const i=N21("input");for(const e in n)"signal"!==e&&"element"!==e&&i.setAttribute("input"===e?"type":e,n[e]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",()=>e.update(i.value)),e.elements=[i],e.set=e=>i.value=e;}function Q17(e,t,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const s=N21("input",i);t.appendChild(s),s.addEventListener("change",()=>e.update(s.checked)),e.elements=[s],e.set=e=>s.checked=!!e||null;}function X20(e,t,n,r){const i=N21("select",{name:n.signal}),s=n.labels||[];n.options.forEach((e,t)=>{const n={value:e};ee6(e,r)&&(n.selected=!0),i.appendChild(N21("option",n,(s[t]||e)+""));}),t.appendChild(i),i.addEventListener("change",()=>{e.update(n.options[i.selectedIndex]);}),e.elements=[i],e.set=e=>{for(let t=0,r=n.options.length;t<r;++t)if(ee6(n.options[t],e))return void(i.selectedIndex=t);};}function Y19(e,t,n,r){const i=N21("span",{class:"vega-bind-radio"}),s=n.labels||[];t.appendChild(i),e.elements=n.options.map((t,a)=>{const o={type:"radio",name:n.signal,value:t};ee6(t,r)&&(o.checked=!0);const l=N21("input",o);l.addEventListener("change",()=>e.update(t));const u=N21("label",{},(s[a]||t)+"");return u.prepend(l),i.appendChild(u),l;}),e.set=t=>{const n=e.elements,r=n.length;for(let e=0;e<r;++e)ee6(n[e].value,t)&&(n[e].checked=!0);};}function Z21(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,s=n.min||Math.min(0,i,+r)||0,a=n.step||nt(s,i,100),o=N21("input",{type:"range",name:n.signal,min:s,max:i,step:a});o.value=r;const l=N21("span",{},+r);t.appendChild(o),t.appendChild(l);const u=()=>{l.textContent=o.value,e.update(+o.value);};o.addEventListener("input",u),o.addEventListener("change",u),e.elements=[o],e.set=e=>{o.value=e,l.textContent=e;};}function ee6(e,t){return e===t||e+""==t+"";}function te5(e,t,n,r,i,s){return(t=t||new r(e.loader())).initialize(n,P18(e),T19(e),M21(e),i,s).background(e.background());}function ne6(e,t){return t?function(){try{t.apply(this,arguments);}catch(t){e.error(t);}}:null;}function re7(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null;}if(t&&n)try{t.textContent="";}catch(n){t=null,e.error(n);}return t;}const ie6=e=>+e||0;function se6(e){return E(e)?{top:ie6(e.top),bottom:ie6(e.bottom),left:ie6(e.left),right:ie6(e.right)}:(e=>({top:e,bottom:e,left:e,right:e}))(ie6(e));}async function ae7(e,n,r,i){const s=Ar(n),a=s&&s.headless;return a||l("Unrecognized renderer type: "+n),await e.runAsync(),te5(e,null,null,a,r,i).renderAsync(e._scenegraph.root);}var oe5="width",le6="height",ue6="padding",ce6={skip:!0};function de5(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===ue6?r.left+r.right:0);}function he5(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===ue6?r.top+r.bottom:0);}function ge5(e,t){return t.modified&&w(t.input.value)&&!e.startsWith("_:vega:_");}function pe4(e,t){return!("parent"===e||t instanceof rt2.proxy);}function fe5(e,t,n,r){const a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":w(e)?ve4(e):E(e)&&!pn(e)?(t=e,Object.keys(t).map(e=>{const n=t[e];return e+": "+(w(n)?ve4(n):me6(n));}).join("\n")):e+"";var t;}(r));}function ve4(e){return"["+e.map(me6).join(", ")+"]";}function me6(e){return w(e)?"[â€¦]":E(e)&&!pn(e)?"{â€¦}":e;}function _e4(e,t){const n=this;if(t=t||{},et2.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){const r=rn({},e.locale,t.locale);n.locale(H4(r.number,r.time));}n._el=null,n._elBind=null,n._renderType=t.renderer||zr.Canvas,n._scenegraph=new Yn1;const r=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||fe5,n._redraw=!0,n._handler=(new Mi).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){const t=rn({defaults:{}},e),n=(e,t)=>{t.forEach(t=>{w(e[t])&&(e[t]=Sn(e[t]));});};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t;}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(e,t,n){return b21(e,rt2,ae6,n).parse(t);}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(e=>({state:null,param:rn({},e)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=de5(n,n._width),n._viewHeight=he5(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t[oe5],r=t[le6],i=t[ue6];function s(){e._autosize=e._resize=1;}e._resizeWidth=e.add(null,t=>{e._width=t.size,e._viewWidth=de5(e,t.size),s();},{size:n}),e._resizeHeight=e.add(null,t=>{e._height=t.size,e._viewHeight=he5(e,t.size),s();},{size:r});const a=e.add(null,s,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,a.rank=i.rank+1;}(n),function(e){e.add(null,t=>(e._background=t.bg,e._resize=1,t.bg),{bg:e._signals.background});}(n),function(e){const t=e._signals.cursor||(e._signals.cursor=e.add({user:D18,item:null}));e.on(e.events("view","pointermove"),t,(e,n)=>{const r=t.value,i=r?Mn(r)?r:r.user:D18,s=n.item&&n.item.cursor||null;return r&&i===r.user&&s==r.item?r:{user:i,item:s};}),e.add(null,function(t){let n=t.cursor,r=this.value;return Mn(n)||(r=n.item,n=n.user),U17(e,n&&n!==D18?n:r||n),r;},{cursor:t});}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind),t.watchPixelRatio&&n._watchPixelRatio();}function we4(e,r){return ln(e._signals,r)?e._signals[r]:l("Unrecognized signal name: "+xn(r));}function be4(e,t){const n=(e._targets||[]).filter(e=>e._update&&e._update.handler===t);return n.length?n[0]:null;}function ye4(e,t,n,r){let i=be4(n,r);return i||(i=ne6(e,()=>r(t,n.value)),i.handler=r,e.on(n,null,i)),e;}function ze4(e,t,n){const r=be4(t,n);return r&&t._targets.remove(r),e;}an(_e4,et2,{async evaluate(e,t,n){if(await et2.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=M21(r=this),s=P18(r),a=T19(r),r._renderer.background(r.background()),r._renderer.resize(s,a,i),r._handler.origin(i),r._resizeListeners.forEach(e=>{try{e(s,a);}catch(e){r.error(e);}})),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1;}catch(e){this.error(e);}var r,i,s,a;return n&&w4(this,n),this;},dirty(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e);},description(e){if(arguments.length){const t=null!=e?e+"":null;return t!==this._desc&&S18(this._el,this._desc=t),this;}return this._desc;},container(){return this._el;},scenegraph(){return this._scenegraph;},origin(){return this._origin.slice();},signal(e,t,n){const r=we4(this,e);return 1===arguments.length?r.value:this.update(r,t,n);},width(e){return arguments.length?this.signal("width",e):this.signal("width");},height(e){return arguments.length?this.signal("height",e):this.signal("height");},padding(e){return arguments.length?this.signal("padding",se6(e)):se6(this.signal("padding"));},autosize(e){return arguments.length?this.signal("autosize",e):this.signal("autosize");},background(e){return arguments.length?this.signal("background",e):this.signal("background");},renderer(e){return arguments.length?(Ar(e)||l("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType;},tooltip(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip;},loader(e){return arguments.length?(e!==this._loader&&(et2.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader;},resize(){return this._autosize=1,this.touch(we4(this,"autosize"));},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind));},_resizeView:function(e,t,n,r,i,s){this.runAfter(a=>{let o=0;a._autosize=0,a.width()!==n&&(o=1,a.signal(oe5,n,ce6),a._resizeWidth.skip(!0)),a.height()!==r&&(o=1,a.signal(le6,r,ce6),a._resizeHeight.skip(!0)),a._viewWidth!==e&&(a._resize=1,a._viewWidth=e),a._viewHeight!==t&&(a._resize=1,a._viewHeight=t),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),o&&a.run("enter"),s&&a.runAfter(e=>e.resize());},!1,1);},addEventListener(e,t,n){let r=t;return n&&!1===n.trap||(r=ne6(this,t),r.raw=t),this._handler.on(e,r),this;},removeEventListener(e,t){for(var n,r,i=this._handler.handlers(e),s=i.length;--s>=0;)if(r=i[s].type,n=i[s].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break;}return this;},addResizeListener(e){const t=this._resizeListeners;return t.includes(e)||t.push(e),this;},removeResizeListener(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this;},addSignalListener(e,t){return ye4(this,e,we4(this,e),t);},removeSignalListener(e,t){return ze4(this,we4(this,e),t);},addDataListener(e,t){return ye4(this,e,W20(this,e).values,t);},removeDataListener(e,t){return ze4(this,W20(this,e).values,t);},globalCursor(e){if(arguments.length){if(this._globalCursor!==!!e){const t=U17(this,null);this._globalCursor=!!e,t&&U17(this,t);}return this;}return this._globalCursor;},preventDefault(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault;},timer:function(e,t){this._timers.push(y11(function(t){e({timestamp:Date.now(),elapsed:t});},t));},events:function(e,t,n){var r,i=this,s=new I5(n),a=function(n,r){i.runAsync(null,()=>{e===B20&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()));}(i,t)&&n.preventDefault(),s.receive(j19(i,n,r));});};if("timer"===e)O18(i,"timer",t)&&i.timer(a,t);else if(e===B20)O18(i,"view",t)&&i.addEventListener(t,a,G19);else if("window"===e?O18(i,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&O18(i,"selector",t)&&(r=Array.from(document.querySelectorAll(e))),r){for(var o=0,l=r.length;o<l;++o)r[o].addEventListener(t,a);V18(i,r,t,a);}else i.warn("Can not resolve event source: "+e);return s;},finalize:function(){var e,t,n,r,i,s=this._tooltip,a=this._timers,o=this._handler.handlers(),l=this._eventListeners;for(e=a.length;--e>=0;)a[e].stop();for(e=l.length;--e>=0;)for(t=(n=l[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);for(s&&s.call(this,this._handler,null,null,null),e=o.length;--e>=0;)i=o[e].type,r=o[e].handler,this._handler.off(i,r);return this;},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","pointerover",I17),$19,q17(e)),this.on(this.events("view","pointerout",I17),$19,q17(t)),this;},data:function(e,t){return arguments.length<2?W20(this,e).values.value:H19.call(this,e,L5().remove(g).insert(t));},change:H19,insert:function(e,t){return H19.call(this,e,L5().insert(t));},remove:function(e,t){return H19.call(this,e,L5().remove(t));},scale:function(e){var r=this._runtime.scales;return ln(r,e)||l("Unrecognized scale or projection: "+e),r[e].value;},initialize:function(e,t){const n=this,r=n._renderType,i=n._eventConfig.bind,s=Ar(r);e=n._el=e?re7(n,e,!0):null,function(e){const t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),S18(t,e.description()));}(n),s||n.error("Unrecognized renderer type: "+r);const a=s.handler||Mi,o=e?s.renderer:s.headless;return n._renderer=o?te5(n,n._renderer,e,o):null,n._handler=function(e,t,n,r){const i=new r(e.loader(),ne6(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,M21(e),e);return t&&t.handlers().forEach(e=>{i.on(e.type,e.handler);}),i;}(n,n._handler,e,a),n._redraw=!0,e&&"none"!==i&&(t=t?n._elBind=re7(n,t,!0):e.appendChild(N21("form",{class:"vega-bindings"})),n._bind.forEach(e=>{e.param.element&&"container"!==i&&(e.element=re7(n,e.param.element,!!e.param.input));}),n._bind.forEach(e=>{!function(e,t,n){if(!t)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:t=>{t!=e.signal(r.signal)&&e.runAsync(null,()=>{i.source=!0,e.signal(r.signal,t);});}},r.debounce&&(i.update=en(r.debounce,i.update))),(null==r.input&&r.element?F18:J21)(i,t,r,e),i.active||(e.on(e._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(e.signal(r.signal));}),i.active=!0);}(n,e.element||t,e);})),n;},toImageURL:async function(e,n){e!==zr.Canvas&&e!==zr.SVG&&e!==zr.PNG&&l("Unrecognized image type: "+e);const r=await ae7(this,e,n);return e===zr.SVG?function(e,t){const n=new Blob([e],{type:t});return window.URL.createObjectURL(n);}(r.svg(),"image/svg+xml"):r.canvas().toDataURL("image/png");},toCanvas:async function(e,t){return(await ae7(this,zr.Canvas,e,t)).canvas();},toSVG:async function(e){return(await ae7(this,zr.SVG,e)).svg();},getState:function(e){return this._runtime.getState(e||{data:ge5,signals:pe4,recurse:!0});},setState:function(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e);},e=>{e._trigger=!0;}),this;},_watchPixelRatio:function(){if("canvas"===this.renderer()&&this._renderer._canvas){let e=null;const t=()=>{null!=e&&e();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",t),e=()=>{n.removeEventListener("change",t);},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync();};t();}}});const t15="[",e17="]",r18=/[[\]{}]/,n17={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let i21,s23;function l22(t,e,r){return i21=e||"view",s23=r||n17,c21(t.trim()).map(u19);}function o19(t,e,r,n,i){const s=t.length;let l,o=0;for(;e<s;++e){if(l=t[e],!o&&l===r)return e;i&&i.includes(l)?--o:n&&n.includes(l)&&++o;}return e;}function c21(t){const e=[],r=t.length;let n=0,i=0;for(;i<r;)i=o19(t,i,",","[{","]}"),e.push(t.substring(n,i).trim()),n=++i;if(0===e.length)throw"Empty event selector: "+t;return e;}function u19(n){return"["===n[0]?function(r){const n=r.length;let i,s=1;if(s=o19(r,s,e17,t15,e17),s===n)throw"Empty between selector: "+r;if(i=c21(r.substring(1,s)),2!==i.length)throw"Between selector must have two elements: "+r;if(r=r.slice(s+1).trim(),">"!==r[0])throw"Expected '>' after between selector: "+r;i=i.map(u19);const l=u19(r.slice(1).trim());if(l.between)return{between:i,stream:l};l.between=i;return l;}(n):function(n){const l={source:i21},c=[];let u,h,f=[0,0],a=0,m=0,p=n.length,w=0;if("}"===n[p-1]){if(w=n.lastIndexOf("{"),!(w>=0))throw"Unmatched right brace: "+n;try{f=function(t){const e=t.split(",");if(!t.length||e.length>2)throw t;return e.map(e=>{const r=+e;if(r!=r)throw t;return r;});}(n.substring(w+1,p-1));}catch(t){throw"Invalid throttle specification: "+n;}p=(n=n.slice(0,w).trim()).length,w=0;}if(!p)throw n;"@"===n[0]&&(a=++w);u=o19(n,w,":"),u<p&&(c.push(n.substring(m,u).trim()),m=w=++u);if(w=o19(n,w,t15),w===p)c.push(n.substring(m,p).trim());else if(c.push(n.substring(m,w).trim()),h=[],m=++w,m===p)throw"Unmatched left bracket: "+n;for(;w<p;){if(w=o19(n,w,e17),w===p)throw"Unmatched left bracket: "+n;if(h.push(n.substring(m,w).trim()),w<p-1&&n[++w]!==t15)throw"Expected left bracket: "+n;m=++w;}if(!(p=c.length)||r18.test(c[p-1]))throw"Invalid event selector: "+n;p>1?(l.type=c[1],a?l.markname=c[0].slice(1):(g=c[0],s23[g]?l.marktype=c[0]:l.source=c[0])):l.type=c[0];var g;"!"===l.type.slice(-1)&&(l.consume=!0,l.type=l.type.slice(0,-1));null!=h&&(l.filter=h);f[0]&&(l.throttle=f[0]);f[1]&&(l.debounce=f[1]);return l;}(n);}function x24(e){return E(e)?e:{type:e||"pad"};}const k21=e=>+e||0;function v23(e){return E(e)?e.signal?e:{top:k21(e.top),bottom:k21(e.bottom),left:k21(e.left),right:k21(e.right)}:{top:t=k21(e),bottom:t,left:t,right:t};var t;}const $20=e=>E(e)&&!w(e)?rn({},e):{value:e};function S19(e,t,n,i){if(null!=n){return E(n)&&!w(n)||w(n)&&n.length&&E(n[0])?e.update[t]=n:e[i||"enter"][t]={value:n},1;}return 0;}function R19(e,t,n){for(const n in t)S19(e,n,t[n]);for(const t in n)S19(e,t,n[t],"update");}function O19(e,t,n){for(const i in t)n&&ln(n,i)||(e[i]=rn(e[i]||{},t[i]));return e;}function z22(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e]);}const w21="mark",W21="frame",j20="scope",_20="axis",C19="axis-domain",D19="axis-grid",E23="axis-label",F19="axis-tick",L19="axis-title",P19="legend",T20="legend-entry",B21="legend-label",U18="legend-symbol",A21="legend-title",H20="title-text",M22="title-subtitle";function V19(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n};}const q18=t=>Mn(t)?xn(t):t.signal?`(${t.signal})`:N22(t);function I18(t){if(null!=t.gradient)return function(t){const i=[t.start,t.stop,t.count].map(t=>null==t?null:xn(t));for(;i.length&&null==D(i);)i.pop();return i.unshift(q18(t.gradient)),`gradient(${i.join(",")})`;}(t);let i=t.signal?`(${t.signal})`:t.color?function(e){return e.c?X21("hcl",e.h,e.c,e.l):e.h||e.s?X21("hsl",e.h,e.s,e.l):e.l||e.a?X21("lab",e.l,e.a,e.b):e.r||e.g||e.b?X21("rgb",e.r,e.g,e.b):null;}(t.color):null!=t.field?N22(t.field):void 0!==t.value?xn(t.value):void 0;return null!=t.scale&&(i=function(e,t){const n=q18(e.scale);null!=e.range?t=`lerp(_range(${n}), ${+e.range})`:(void 0!==t&&(t=`_scale(${n}, ${t})`),e.band&&(t=(t?t+"+":"")+`_bandwidth(${n})`+(1==+e.band?"":"*"+Y20(e.band)),e.extra&&(t=`(datum.extra ? _scale(${n}, datum.extra.value) : ${t})`)),null==t&&(t="0"));return t;}(t,i)),void 0===i&&(i=null),null!=t.exponent&&(i=`pow(${i},${Y20(t.exponent)})`),null!=t.mult&&(i+=`*${Y20(t.mult)}`),null!=t.offset&&(i+=`+${Y20(t.offset)}`),t.round&&(i=`round(${i})`),i;}const X21=(e,t,n,i)=>`(${e}(${[t,n,i].map(I18).join(",")})+'')`;function Y20(e){return E(e)?"("+I18(e)+")":e;}function N22(e){return G20(E(e)?e:{datum:e});}function G20(n){let a,l1,o;if(n.signal)a="datum",o=n.signal;else if(n.group||n.parent){for(l1=Math.max(1,n.level||1),a="item";l1-- >0;)a+=".mark.group";n.parent?(o=n.parent,a+=".datum"):o=n.group;}else n.datum?(a="datum",o=n.datum):l("Invalid field reference: "+xn(n));return n.signal||(o=Mn(o)?c(o).map(xn).join("]["):G20(o)),a+"["+o+"]";}function J22(e,t,n,i,l,o){const r={};(o=o||{}).encoders={$encode:r},e=function(e,t,n,i,l){const o={},r={};let u,c,d,f;for(c in c="lineBreak","text"!==t||null==l[c]||z22(c,e)||V19(o,c,l[c]),("legend"==n||String(n).startsWith("axis"))&&(n=null),f=n===W21?l.group:n===w21?rn({},l.mark,l[t]):null,f)d=z22(c,e)||("fill"===c||"stroke"===c)&&(z22("fill",e)||z22("stroke",e)),d||V19(o,c,f[c]);for(c in H(i).forEach(t=>{const n=l.style&&l.style[t];for(const t in n)z22(t,e)||V19(o,t,n[t]);}),e=rn({},e),o)f=o[c],f.signal?(u=u||{})[c]=f:r[c]=f;return e.enter=rn(r,e.enter),u&&(e.update=rn(u,e.update)),e;}(e,t,n,i,l.config);for(const n in e)r[n]=K23(e[n],t,o,l);return o;}function K23(e,t,i,a){const l={},o={};for(const t in e)null!=e[t]&&(l[t]=Q18((s=e[t],w(s)?function(e){let t="";return e.forEach(e=>{const n=I18(e);t+=e.test?`(${e.test})?${n}:`:n;}),":"===D(t)&&(t+="null"),t;}(s):I18(s)),a,i,o));var s;return{$expr:{marktype:t,channels:l},$fields:Object.keys(o),$output:Object.keys(e)};}function Q18(e,t,n,i){const a=de4(e,t);return a.$fields.forEach(e=>i[e]=1),rn(n,a.$params),a.$expr;}const Z22=["value","update","init","react","bind"];function ee7(n,i){l(n+' for "outer" push: '+xn(i));}function te6(e,t){const n=e.name;if("outer"===e.push)t.signals[n]||ee7("No prior signal definition",n),Z22.forEach(t=>{void 0!==e[t]&&ee7("Invalid property ",t);});else{const i=t.addSignal(n,e.value);!1===e.react&&(i.react=!1),e.bind&&t.addBinding(n,e.bind);}}function ne7(e,t,n,i){this.id=-1,this.type=e,this.value=t,this.params=n,i&&(this.parent=i);}function ie7(e,t,n,i){return new ne7(e,t,n,i);}function ae8(e,t){return ie7("operator",e,t);}function le7(e){const t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t;}function oe6(e,t){return t?{$field:e,$name:t}:{$field:e};}const se7=oe6("key");function re8(e,t){return{$compare:e,$order:t};}function ue7(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"");}const ce7="scope",de6="view";function fe6(e){return e&&e.signal;}function pe5(e){if(fe6(e))return!0;if(E(e)){for(const t in e)if(pe5(e[t]))return!0;}return!1;}function ge6(e,t){return null!=e?e:t;}function me7(e){return e&&e.signal||e;}const he6="timer";function ye5(n,i){return(n.merge?be5:n.stream?xe5:n.type?ke4:l("Invalid stream specification: "+xn(n)))(n,i);}function be5(e,t){const n=ve5({merge:e.merge.map(e=>ye5(e,t))},e,t);return t.addStream(n).id;}function xe5(e,t){const n=ve5({stream:ye5(e.stream,t)},e,t);return t.addStream(n).id;}function ke4(e,t){let n;var i;e.type===he6?(n=t.event(he6,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((i=e.source)===ce7?de6:i||de6,e.type);const a=ve5({stream:n},e,t);return 1===Object.keys(a).length?n:t.addStream(a).id;}function ve5(n,i,a){let l1=i.between;return l1&&(2!==l1.length&&l('Stream "between" parameter must have 2 entries: '+xn(i)),n.between=[ye5(l1[0],a),ye5(l1[1],a)]),l1=i.filter?[].concat(i.filter):[],(i.marktype||i.markname||i.markrole)&&l1.push(function(e,t,n){const i="event.item";return i+(e&&"*"!==e?"&&"+i+".mark.marktype==='"+e+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(t?"&&"+i+".mark.name==='"+t+"'":"");}(i.marktype,i.markname,i.markrole)),i.source===ce7&&l1.push("inScope(event.item)"),l1.length&&(n.filter=de4("("+l1.join(")&&(")+")",a).$expr),null!=(l1=i.throttle)&&(n.throttle=+l1),null!=(l1=i.debounce)&&(n.debounce=+l1),i.consume&&(n.consume=!0),n;}const $e2={code:"_.$value",ast:{type:"Identifier",value:"value"}};function Se4(n,l1,o){const r=n.encode,u={target:o};let c=n.events,p=n.update,g=[];c||l("Signal update missing events specification."),Mn(c)&&(c=l22(c,l1.isSubscope()?ce7:de6)),c=H(c).filter(e=>e.signal||e.scale?(g.push(e),0):1),g.length>1&&(g=[Re4(g)]),c.length&&g.push(c.length>1?{merge:c}:c[0]),null!=r&&(p&&l("Signal encode and update are mutually exclusive."),p="encode(item(),"+xn(r)+")"),u.update=Mn(p)?de4(p,l1):null!=p.expr?de4(p.expr,l1):null!=p.value?p.value:null!=p.signal?{$expr:$e2,$params:{$value:l1.signalRef(p.signal)}}:l("Invalid signal update specification."),n.force&&(u.options={force:!0}),g.forEach(e=>l1.addUpdate(rn(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):ye5(e,t)};}(e,l1),u)));}function Re4(e){return{signal:"["+e.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"};}function Oe4(e,n){const i=n.getSignal(e.name);let a=e.update;e.init&&(a?l("Signals can not include both init and update expressions."):(a=e.init,i.initonly=!0)),a&&(a=de4(a,n),i.update=a.$expr,i.params=a.$params),e.on&&e.on.forEach(e=>Se4(e,n,i.id));}const ze5=e=>(t,n,i)=>ie7(e,n,t||void 0,i),we5=ze5("aggregate"),We2=ze5("axisticks"),je3=ze5("bound"),_e5=ze5("collect"),Ce5=ze5("compare"),De4=ze5("datajoin"),Ee4=ze5("encode"),Fe4=ze5("expression"),Le4=ze5("facet"),Pe4=ze5("field"),Te4=ze5("key"),Be4=ze5("legendentries"),Ue4=ze5("load"),Ae4=ze5("mark"),He4=ze5("multiextent"),Me5=ze5("multivalues"),Ve2=ze5("overlap"),qe3=ze5("params"),Ie5=ze5("prefacet"),Xe3=ze5("projection"),Ye3=ze5("proxy"),Ne5=ze5("relay"),Ge3=ze5("render"),Je3=ze5("scale"),Ke2=ze5("sieve"),Qe3=ze5("sortitems"),Ze2=ze5("viewlayout"),et9=ze5("values");let tt9=0;const nt10={min:"min",max:"max",count:"sum"};function it9(e,t){const n=t.getScale(e.name).params;let i;for(i in n.domain=st8(e.domain,e,t),null!=e.range&&(n.range=mt7(e,t,n)),null!=e.interpolate&&function(e,t){t.interpolate=at10(e.type||e),null!=e.gamma&&(t.interpolateGamma=at10(e.gamma));}(e.interpolate,n),null!=e.nice&&(n.nice=function(e,t){return e.signal?t.signalRef(e.signal):E(e)?{interval:at10(e.interval),step:at10(e.step)}:at10(e);}(e.nice,t)),null!=e.bins&&(n.bins=function(e,t){return e.signal||w(e)?lt9(e,t):t.objectProperty(e);}(e.bins,t)),e)ln(n,i)||"name"===i||(n[i]=at10(e[i],t));}function at10(n,i){return E(n)?n.signal?i.signalRef(n.signal):l("Unsupported object: "+xn(n)):n;}function lt9(e,t){return e.signal?t.signalRef(e.signal):e.map(e=>at10(e,t));}function ot8(n){l("Can not find data set: "+xn(n));}function st8(e,n,i){if(e)return e.signal?i.signalRef(e.signal):(w(e)?rt10:e.fields?ct8:ut8)(e,n,i);null==n.domainMin&&null==n.domainMax||l("No scale domain defined for domainMin/domainMax to override.");}function rt10(e,t,n){return e.map(e=>at10(e,n));}function ut8(e,t,n){const i=n.getData(e.data);return i||ot8(e.data),le2(t.type)?i.valuesRef(n,e.field,ft7(e.sort,!1)):pe1(t.type)?i.domainRef(n,e.field):i.extentRef(n,e.field);}function ct8(t,n,a){const l=t.data,o=t.fields.reduce((t,n)=>(n=Mn(n)?{data:l,field:n}:w(n)||n.signal?function(t,n){const i="_:vega:_"+tt9++,a=_e5({});if(w(t))a.value={$ingest:t};else if(t.signal){const l="setdata("+xn(i)+","+t.signal+")";a.params.input=n.signalRef(l);}return n.addDataPipeline(i,[a,Ke2({})]),{data:i,field:"data"};}(n,a):n,t.push(n),t),[]);return(le2(n.type)?dt7:pe1(n.type)?pt7:gt8)(t,a,o);}function dt7(e,t,n){const i=ft7(e.sort,!0);let a,l;const o=n.map(e=>{const n=t.getData(e.data);return n||ot8(e.data),n.countsRef(t,e.field,i);}),s={groupby:se7,pulse:o};i&&(a=i.op||"count",l=i.field?ue7(a,i.field):"count",s.ops=[nt10[a]],s.fields=[t.fieldRef(l)],s.as=[l]),a=t.add(we5(s));const r=t.add(_e5({pulse:le7(a)}));return l=t.add(et9({field:se7,sort:t.sortRef(i),pulse:le7(r)})),le7(l);}function ft7(e,n){return e&&(e.field||e.op?e.field||"count"===e.op?n&&e.field&&e.op&&!nt10[e.op]&&l("Multiple domain scales can not be sorted using "+e.op):l("No field provided for sort aggregate op: "+e.op):E(e)?e.field="key":e={field:"key"}),e;}function pt7(e,t,n){const i=n.map(e=>{const n=t.getData(e.data);return n||ot8(e.data),n.domainRef(t,e.field);});return le7(t.add(Me5({values:i})));}function gt8(e,t,n){const i=n.map(e=>{const n=t.getData(e.data);return n||ot8(e.data),n.extentRef(t,e.field);});return le7(t.add(He4({extents:i})));}function mt7(n,a,o){const u=a.config.range;let c=n.range;if(c.signal)return a.signalRef(c.signal);if(Mn(c)){if(u&&ln(u,c))return mt7(n=rn({},n,{range:u[c]}),a,o);"width"===c?c=[0,{signal:"width"}]:"height"===c?c=le2(n.type)?[0,{signal:"height"}]:[{signal:"height"},0]:l("Unrecognized scale range value: "+xn(c));}else{if(c.scheme)return o.scheme=w(c.scheme)?lt9(c.scheme,a):at10(c.scheme,a),c.extent&&(o.schemeExtent=lt9(c.extent,a)),void(c.count&&(o.schemeCount=at10(c.count,a)));if(c.step)return void(o.rangeStep=at10(c.step,a));if(le2(n.type)&&!w(c))return st8(c,n,a);w(c)||l("Unsupported range type: "+xn(c));}return c.map(e=>(w(e)?lt9:at10)(e,a));}function ht8(n,i,a){return w(n)?n.map(e=>ht8(e,i,a)):E(n)?n.signal?a.signalRef(n.signal):"fit"===i?n:l("Unsupported parameter object: "+xn(n)):n;}const yt7="top",bt7="left",xt6="right",kt7="bottom",vt6="center",$t4="index",St5="label",Rt6="perc",Ot5="value",zt6="guide-label",wt7="guide-title",Wt5="group-title",jt8="group-subtitle",_t4="symbol",Ct6="gradient",Dt7="discrete",Et6="size",Ft4=[Et6,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],Lt4={name:1,style:1,interactive:1},Pt3={value:0},Tt5={value:1},Bt7="group",Ut6="rect",At4="rule",Ht5="text";function Mt7(e){return e.type=Bt7,e.interactive=e.interactive||!1,e;}function Vt4(e,t){const n=(n,i)=>ge6(e[n],ge6(t[n],i));return n.isVertical=n=>"vertical"===ge6(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection)),n.gradientLength=()=>ge6(e.gradientLength,t.gradientLength||t.gradientWidth),n.gradientThickness=()=>ge6(e.gradientThickness,t.gradientThickness||t.gradientHeight),n.entryColumns=()=>ge6(e.columns,ge6(t.columns,+n.isVertical(!0))),n;}function qt6(e,t){const n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null;}function It5(e,t,n){return`item.anchor === 'start' ? ${e} : item.anchor === 'end' ? ${t} : ${n}`;}const Xt4=It5(xn(bt7),xn(xt6),xn(vt6));function Yt5(e,t){return t?e?E(e)?Object.assign({},e,{offset:Yt5(e.offset,t)}):{value:e,offset:t}:t:e;}function Nt5(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=O19(e.encode,t,Lt4)):e.interactive=!1,e;}function Gt4(e,t,n,i){const a=Vt4(e,n),l=a.isVertical(),o=a.gradientThickness(),r=a.gradientLength();let u,c,d,f,p;l?(c=[0,1],d=[0,0],f=o,p=r):(c=[0,0],d=[1,0],f=r,p=o);const g={enter:u={opacity:Pt3,x:Pt3,y:Pt3,width:$20(f),height:$20(p)},update:rn({},u,{opacity:Tt5,fill:{gradient:t,start:c,stop:d}}),exit:{opacity:Pt3}};return R19(g,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Nt5({type:Ut6,role:"legend-gradient",encode:g},i);}function Jt4(e,t,n,i,a){const l=Vt4(e,n),o=l.isVertical(),r=l.gradientThickness(),u=l.gradientLength();let c,d,f,p,g="";o?(c="y",f="y2",d="x",p="width",g="1-"):(c="x",f="x2",d="y",p="height");const m={opacity:Pt3,fill:{scale:t,field:Ot5}};m[c]={signal:g+"datum."+Rt6,mult:u},m[d]=Pt3,m[f]={signal:g+"datum.perc2",mult:u},m[p]=$20(r);const h={enter:m,update:rn({},m,{opacity:Tt5}),exit:{opacity:Pt3}};return R19(h,{stroke:l("gradientStrokeColor"),strokeWidth:l("gradientStrokeWidth")},{opacity:l("gradientOpacity")}),Nt5({type:Ut6,role:"legend-band",key:Ot5,from:a,encode:h},i);}const Kt5=`datum.${Rt6}<=0?"${bt7}":datum.${Rt6}>=1?"${xt6}":"${vt6}"`,Qt3=`datum.${Rt6}<=0?"${kt7}":datum.${Rt6}>=1?"${yt7}":"middle"`;function Zt3(e,t,n,i){const a=Vt4(e,t),l=a.isVertical(),o=$20(a.gradientThickness()),s=a.gradientLength();let r,u,c,d,f=a("labelOverlap"),p="";const g={enter:r={opacity:Pt3},update:u={opacity:Tt5,text:{field:St5}},exit:{opacity:Pt3}};return R19(g,{fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:ge6(e.labelLimit,t.gradientLabelLimit)}),l?(r.align={value:"left"},r.baseline=u.baseline={signal:Qt3},c="y",d="x",p="1-"):(r.align=u.align={signal:Kt5},r.baseline={value:"top"},c="x",d="y"),r[c]=u[c]={signal:p+"datum."+Rt6,mult:s},r[d]=u[d]=o,o.offset=ge6(e.labelOffset,t.gradientLabelOffset)||0,f=f?{separation:a("labelSeparation"),method:f,order:"datum."+$t4}:void 0,Nt5({type:Ht5,role:B21,style:zt6,key:Ot5,from:i,encode:g,overlap:f},n);}function en8(e,t,n,i,a){const l=Vt4(e,t),o=n.entries,s=!(!o||!o.interactive),r=o?o.name:void 0,u=l("clipHeight"),c=l("symbolOffset"),d={data:"value"},f=`(${a}) ? datum.offset : datum.${Et6}`,p=u?$20(u):{field:Et6},g=`datum.${$t4}`,m=`max(1, ${a})`;let h,y,b,x,k;p.mult=.5,h={enter:y={opacity:Pt3,x:{signal:f,mult:.5,offset:c},y:p},update:b={opacity:Tt5,x:y.x,y:y.y},exit:{opacity:Pt3}};let v=null,S=null;e.fill||(v=t.symbolBaseFillColor,S=t.symbolBaseStrokeColor),R19(h,{fill:l("symbolFillColor",v),shape:l("symbolType"),size:l("symbolSize"),stroke:l("symbolStrokeColor",S),strokeDash:l("symbolDash"),strokeDashOffset:l("symbolDashOffset"),strokeWidth:l("symbolStrokeWidth")},{opacity:l("symbolOpacity")}),Ft4.forEach(t=>{e[t]&&(b[t]=y[t]={scale:e[t],field:Ot5});});const z=Nt5({type:"symbol",role:U18,key:Ot5,from:d,clip:!!u||void 0,encode:h},n.symbols),w=$20(c);w.offset=l("labelOffset"),h={enter:y={opacity:Pt3,x:{signal:f,offset:w},y:p},update:b={opacity:Tt5,text:{field:St5},x:y.x,y:y.y},exit:{opacity:Pt3}},R19(h,{align:l("labelAlign"),baseline:l("labelBaseline"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:l("labelLimit")});const W=Nt5({type:Ht5,role:B21,style:zt6,key:Ot5,from:d,encode:h},n.labels);return h={enter:{noBound:{value:!u},width:Pt3,height:u?$20(u):Pt3,opacity:Pt3},exit:{opacity:Pt3},update:b={opacity:Tt5,row:{signal:null},column:{signal:null}}},l.isVertical(!0)?(x=`ceil(item.mark.items.length / ${m})`,b.row.signal=`${g}%${x}`,b.column.signal=`floor(${g} / ${x})`,k={field:["row",g]}):(b.row.signal=`floor(${g} / ${m})`,b.column.signal=`${g} % ${m}`,k={field:g}),b.column.signal=`(${a})?${b.column.signal}:${g}`,Mt7({role:j20,from:i={facet:{data:i,name:"value",groupby:$t4}},encode:O19(h,o,Lt4),marks:[z,W],name:r,interactive:s,sort:k});}const tn7='item.orient === "left"',nn9='item.orient === "right"',an8=`(${tn7} || ${nn9})`,ln8=`datum.vgrad && ${an8}`,on8=It5('"top"','"bottom"','"middle"'),sn7=`datum.vgrad && ${nn9} ? (${It5('"right"','"left"','"center"')}) : (${an8} && !(datum.vgrad && ${tn7})) ? "left" : ${Xt4}`,rn9=`item._anchor || (${an8} ? "middle" : "start")`,un8=`${ln8} ? (${tn7} ? -90 : 90) : 0`,cn9=`${an8} ? (datum.vgrad ? (${nn9} ? "bottom" : "top") : ${on8}) : "top"`;function dn7(e,t){let n;return E(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+fn8(e.path)+")":e.sphere&&(n="geoShape("+fn8(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e;}function fn8(t){return E(t)&&t.signal?t.signal:xn(t);}function pn7(e){const t=e.role||"";return t.startsWith("axis")||t.startsWith("legend")||t.startsWith("title")?t:e.type===Bt7?j20:t||w21;}function gn6(e){return{marktype:e.type,name:e.name||void 0,role:e.role||pn7(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description};}function mn7(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e;}function hn8(n,i){const a=it2(n.type);a||l("Unrecognized transform type: "+xn(n.type));const l1=ie7(a.type.toLowerCase(),null,yn7(a,n,i));return n.signal&&i.addSignal(n.signal,i.proxy(l1)),l1.metadata=a.metadata||{},l1;}function yn7(e,t,n){const i={},a=e.params.length;for(let l=0;l<a;++l){const a=e.params[l];i[a.name]=bn7(a,t,n);}return i;}function bn7(n,a,l1){const o=n.type,s=a[n.name];return"index"===o?function(e,n,a){Mn(n.from)||l('Lookup "from" parameter must be a string literal.');return a.getData(n.from).lookupRef(a,n.key);}(0,a,l1):void 0!==s?"param"===o?function(n,i,a){const l1=i[n.name];return n.array?(w(l1)||l("Expected an array of sub-parameters. Instead: "+xn(l1)),l1.map(e=>kn5(n,e,a))):kn5(n,l1,a);}(n,a,l1):"projection"===o?l1.projectionRef(a[n.name]):n.array&&!fe6(s)?s.map(e=>xn6(n,e,l1)):xn6(n,s,l1):void(n.required&&l("Missing required "+xn(a.type)+" parameter: "+xn(n.name)));}function xn6(e,n,i){const a=e.type;if(fe6(n))return Rn5(a)?l("Expression references can not be signals."):On6(a)?i.fieldRef(n):zn5(a)?i.compareRef(n):i.signalRef(n.signal);{const t=e.expr||On6(a);return t&&vn6(n)?i.exprRef(n.expr,n.as):t&&$n4(n)?oe6(n.field,n.as):Rn5(a)?de4(n,i):Sn6(a)?le7(i.getData(n).values):On6(a)?oe6(n):zn5(a)?i.compareRef(n):n;}}function kn5(n,i,a){const l1=n.params.length;let o;for(let e=0;e<l1;++e){o=n.params[e];for(const e in o.key)if(o.key[e]!==i[e]){o=null;break;}if(o)break;}o||l("Unsupported parameter: "+xn(i));const r=rn(yn7(o,i,a),o.key);return le7(a.add(qe3(r)));}const vn6=e=>e&&e.expr,$n4=e=>e&&e.field,Sn6=e=>"data"===e,Rn5=e=>"expr"===e,On6=e=>"field"===e,zn5=e=>"compare"===e;function wn7(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:le7(t.getData(e.data).output);}function Wn4(e,t,n,i,a){this.scope=e,this.input=t,this.output=n,this.values=i,this.aggregate=a,this.index={};}function jn7(e){return Mn(e)?e:null;}function _n5(e,t,n){const i=ue7(n.op,n.field);let a;if(t.ops){for(let e=0,n=t.as.length;e<n;++e)if(t.as[e]===i)return;}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((a=n.op.signal)?e.signalRef(a):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i));}function Cn5(e,t,n,i,a,l,s){const r=t[n]||(t[n]={}),u=function(e){return E(e)?("descending"===e.order?"-":"+")+ue7(e.op,e.field):"";}(l);let c,d,f=jn7(a);if(null!=f&&(e=t.scope,f+=u?"|"+u:"",c=r[f]),!c){const n=l?{field:se7,pulse:t.countsRef(e,a,l)}:{field:e.fieldRef(a),pulse:le7(t.output)};u&&(n.sort=e.sortRef(l)),d=e.add(ie7(i,void 0,n)),s&&(t.index[a]=d),c=le7(d),null!=f&&(r[f]=c);}return c;}function Dn6(e,t,n){const i=e.remove,a=e.insert,l=e.toggle,o=e.modify,s=e.values,r=t.add(ae8()),u="if("+e.trigger+',modify("'+n+'",'+[a,i,l,o,s].map(e=>null==e?"null":e).join(",")+"),0)",c=de4(u,t);r.update=c.$expr,r.params=c.$params;}function En6(n,i){const l1=pn7(n),o=n.type===Bt7,r=n.from&&n.from.facet,u=n.overlap;let c,d,f,p,g,m,h,y=n.layout||l1===j20||l1===W21;const b=l1===w21||y||r,x=function(e,n,i){let l1,o,r,u,c;return e?(l1=e.facet)&&(n||l("Only group marks can be faceted."),null!=l1.field?u=c=wn7(l1,i):(e.data?c=le7(i.getData(e.data).aggregate):(r=hn8(rn({type:"aggregate",groupby:H(l1.groupby)},l1.aggregate),i),r.params.key=i.keyRef(l1.groupby),r.params.pulse=wn7(l1,i),u=c=le7(i.add(r))),o=i.keyRef(l1.groupby,!0))):u=le7(i.add(_e5(null,[{}]))),u||(u=wn7(e,i)),{key:o,pulse:u,parent:c};}(n.from,o,i);d=i.add(De4({key:x.key||(n.key?oe6(n.key):void 0),pulse:x.pulse,clean:!o}));const k=le7(d);d=f=i.add(_e5({pulse:k})),d=i.add(Ae4({markdef:gn6(n),interactive:mn7(n.interactive,i),clip:dn7(n.clip,i),context:{$context:!0},groups:i.lookup(),parent:i.signals.parent?i.signalRef("parent"):null,index:i.markpath(),pulse:le7(d)}));const v=le7(d);d=p=i.add(Ee4(J22(n.encode,n.type,l1,n.style,i,{mod:!1,pulse:v}))),d.params.parent=i.encode(),n.transform&&n.transform.forEach(e=>{const n=hn8(e,i),a=n.metadata;(a.generates||a.changes)&&l("Mark transforms should not generate new data."),a.nomod||(p.params.mod=!0),n.params.pulse=le7(d),i.add(d=n);}),n.sort&&(d=i.add(Qe3({sort:i.compareRef(n.sort),pulse:le7(d)})));const $=le7(d);(r||y)&&(y=i.add(Ze2({layout:i.objectProperty(n.layout),legends:i.legends,mark:v,pulse:$})),m=le7(y));const S=i.add(je3({mark:v,pulse:m||$}));h=le7(S),o&&(b&&(c=i.operators,c.pop(),y&&c.pop()),i.pushState($,m||h,k),r?function(n,i,a){const l1=n.from.facet,o=l1.name,s=wn7(l1,i);let r;l1.name||l("Facet must have a name: "+xn(l1)),l1.data||l("Facet must reference a data set: "+xn(l1)),l1.field?r=i.add(Ie5({field:i.fieldRef(l1.field),pulse:s})):l1.groupby?r=i.add(Le4({key:i.keyRef(l1.groupby),group:le7(i.proxy(a.parent)),pulse:s})):l("Facet must specify groupby or field: "+xn(l1));const u=i.fork(),c=u.add(_e5()),d=u.add(Ke2({pulse:le7(c)}));u.addData(o,new Wn4(u,c,c,d)),u.addSignal("parent",null),r.params.subflow={$subflow:u.parse(n).toRuntime()};}(n,i,x):b?function(e,t,n){const i=t.add(Ie5({pulse:n.pulse})),a=t.fork();a.add(Ke2()),a.addSignal("parent",null),i.params.subflow={$subflow:a.parse(e).toRuntime()};}(n,i,x):i.parse(n),i.popState(),b&&(y&&c.push(y),c.push(S))),u&&(h=function(e,t,n){const i=e.method,a=e.bound,l=e.separation,o={separation:fe6(l)?n.signalRef(l.signal):l,method:fe6(i)?n.signalRef(i.signal):i,pulse:t};e.order&&(o.sort=n.compareRef({field:e.order}));if(a){const e=a.tolerance;o.boundTolerance=fe6(e)?n.signalRef(e.signal):+e,o.boundScale=n.scaleRef(a.scale),o.boundOrient=a.orient;}return le7(n.add(Ve2(o)));}(u,h,i));const R=i.add(Ge3({pulse:h})),O=i.add(Ke2({pulse:le7(R)},void 0,i.parent()));null!=n.name&&(g=n.name,i.addData(g,new Wn4(i,f,R,O)),n.on&&n.on.forEach(e=>{(e.insert||e.remove||e.toggle)&&l("Marks only support modify triggers."),Dn6(e,i,g);}));}function Fn5(e,n){const i=n.config.legend,a=e.encode||{},l1=Vt4(e,i),o=a.legend||{},s=o.name||void 0,r=o.interactive,u=o.style,c={};let f,p,g,m=0;Ft4.forEach(t=>e[t]?(c[t]=e[t],m=m||e[t]):0),m||l("Missing valid scale for legend.");const b=function(e,t){let n=e.type||_t4;e.type||1!==function(e){return Ft4.reduce((t,n)=>t+(e[n]?1:0),0);}(e)||!e.fill&&!e.stroke||(n=ie2(t)?Ct6:ue2(t)?Dt7:_t4);return n!==Ct6?n:ue2(t)?Dt7:Ct6;}(e,n.scaleType(m)),x={title:null!=e.title,scales:c,type:b,vgrad:"symbol"!==b&&l1.isVertical()},k=le7(n.add(_e5(null,[x]))),v=le7(n.add(Be4(p={type:b,scale:n.scaleRef(m),count:n.objectProperty(l1("tickCount")),limit:n.property(l1("symbolLimit")),values:n.objectProperty(e.values),minstep:n.property(e.tickMinStep),formatType:n.property(e.formatType),formatSpecifier:n.property(e.format)})));return b===Ct6?(g=[Gt4(e,m,i,a.gradient),Zt3(e,i,a.labels,v)],p.count=p.count||n.signalRef(`max(2,2*floor((${me7(l1.gradientLength())})/100))`)):b===Dt7?g=[Jt4(e,m,i,a.gradient,v),Zt3(e,i,a.labels,v)]:(f=function(e,t){const n=Vt4(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}};}(e,i),g=[en8(e,i,a,v,me7(f.columns))],p.size=function(e,t,n){const i=me7(Pn4("size",e,n)),a=me7(Pn4("strokeWidth",e,n)),l=me7(function(e,t,n){return qt6("fontSize",e)||function(e,t,n){const i=t.config.style[n];return i&&i[e];}("fontSize",t,n);}(n[1].encode,t,zt6));return de4(`max(ceil(sqrt(${i})+${a}),${l})`,t);}(e,n,g[0].marks)),g=[Mt7({role:T20,from:k,encode:{enter:{x:{value:0},y:{value:0}}},marks:g,layout:f,interactive:r})],x.title&&g.push(function(e,t,n,i){const a=Vt4(e,t),l={enter:{opacity:Pt3},update:{opacity:Tt5,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Pt3}};return R19(l,{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:rn9},angle:{signal:un8},align:{signal:sn7},baseline:{signal:cn9},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),Nt5({type:Ht5,role:A21,style:wt7,from:i,encode:l},n);}(e,i,a.title,k)),En6(Mt7({role:P19,from:k,encode:O19(Ln5(l1,e,i),o,Lt4),marks:g,aria:l1("aria"),description:l1("description"),zindex:l1("zindex"),name:s,interactive:r,style:u}),n);}function Ln5(e,t,n){const i={enter:{},update:{}};return R19(i,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),i;}function Pn4(e,t,n){return t[e]?`scale("${t[e]}",datum)`:qt6(e,n[0].encode);}Wn4.fromEntries=function(e,t){const n=t.length,i=t[n-1],a=t[n-2];let l=t[0],o=null,s=1;for(l&&"load"===l.type&&(l=t[1]),e.add(t[0]);s<n;++s)t[s].params.pulse=le7(t[s-1]),e.add(t[s]),"aggregate"===t[s].type&&(o=t[s]);return new Wn4(e,l,a,i,o);},Wn4.prototype={countsRef(e,t,n){const i=this,a=i.counts||(i.counts={}),l=jn7(t);let o,s,r;return null!=l&&(e=i.scope,o=a[l]),o?n&&n.field&&_n5(e,o.agg.params,n):(r={groupby:e.fieldRef(t,"key"),pulse:le7(i.output)},n&&n.field&&_n5(e,r,n),s=e.add(we5(r)),o=e.add(_e5({pulse:le7(s)})),o={agg:s,ref:le7(o)},null!=l&&(a[l]=o)),o.ref;},tuplesRef(){return le7(this.values);},extentRef(e,t){return Cn5(e,this,"extent","extent",t,!1);},domainRef(e,t){return Cn5(e,this,"domain","values",t,!1);},valuesRef(e,t,n){return Cn5(e,this,"vals","values",t,n||!0);},lookupRef(e,t){return Cn5(e,this,"lookup","tupleindex",t,!1);},indataRef(e,t){return Cn5(e,this,"indata","tupleindex",t,!0,!0);}};const Tn5=`item.orient==="${bt7}"?-90:item.orient==="${xt6}"?90:0`;function Bn4(e,t){const n=Vt4(e=Mn(e)?{text:e}:e,t.config.title),a=e.encode||{},l=a.group||{},o=l.name||void 0,r=l.interactive,u=l.style,c=[],d=le7(t.add(_e5(null,[{}])));return c.push(function(e,t,n,i){const a={value:0},l=e.text,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return R19(o,{text:l,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nt5({type:Ht5,role:H20,style:Wt5,from:i,encode:o},n);}(e,n,function(e){const t=e.encode;return t&&t.title||rn({name:e.name,interactive:e.interactive,style:e.style},t);}(e),d)),e.subtitle&&c.push(function(e,t,n,i){const a={value:0},l=e.subtitle,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return R19(o,{text:l,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nt5({type:Ht5,role:M22,style:jt8,from:i,encode:o},n);}(e,n,a.subtitle,d)),En6(Mt7({role:"title",from:d,encode:Un5(n,l),marks:c,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:r,style:u}),t);}function Un5(e,t){const n={enter:{},update:{}};return R19(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Xt4},angle:{signal:Tn5},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),O19(n,t,Lt4);}function An5(e,t){const n=[];e.transform&&e.transform.forEach(e=>{n.push(hn8(e,t));}),e.on&&e.on.forEach(n=>{Dn6(n,t,e.name);}),t.addDataPipeline(e.name,function(e,t,n){const i=[];let l,o,s,r,u,c=null,d=!1,f=!1;e.values?fe6(e.values)||pe5(e.format)?(i.push(Mn6(t,e)),i.push(c=Hn5())):i.push(c=Hn5({$ingest:e.values,$format:e.format})):e.url?pe5(e.url)||pe5(e.format)?(i.push(Mn6(t,e)),i.push(c=Hn5())):i.push(c=Hn5({$request:e.url,$format:e.format})):e.source&&(c=l=H(e.source).map(e=>le7(t.getData(e).output)),i.push(null));for(o=0,s=n.length;o<s;++o)r=n[o],u=r.metadata,c||u.source||i.push(c=Hn5()),i.push(r),u.generates&&(f=!0),u.modifies&&!f&&(d=!0),u.source?c=r:u.changes&&(c=null);l&&(s=l.length-1,i[0]=Ne5({derive:d,pulse:s?l:l[0]}),(d||s)&&i.splice(1,0,Hn5()));c||i.push(Hn5());return i.push(Ke2({})),i;}(e,t,n));}function Hn5(e){const t=_e5({},e);return t.metadata={source:!0},t;}function Mn6(e,t){return Ue4({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)});}const Vn6=e=>e===kt7||e===yt7,qn4=(e,t,n)=>fe6(e)?Jn4(e.signal,t,n):e===bt7||e===yt7?t:n,In5=(e,t,n)=>fe6(e)?Nn5(e.signal,t,n):Vn6(e)?t:n,Xn3=(e,t,n)=>fe6(e)?Gn4(e.signal,t,n):Vn6(e)?n:t,Yn5=(e,t,n)=>fe6(e)?Kn5(e.signal,t,n):e===yt7?{value:t}:{value:n},Nn5=(e,t,n)=>Zn4(`${e} === '${yt7}' || ${e} === '${kt7}'`,t,n),Gn4=(e,t,n)=>Zn4(`${e} !== '${yt7}' && ${e} !== '${kt7}'`,t,n),Jn4=(e,t,n)=>ti2(`${e} === '${bt7}' || ${e} === '${yt7}'`,t,n),Kn5=(e,t,n)=>ti2(`${e} === '${yt7}'`,t,n),Qn4=(e,t,n)=>ti2(`${e} === '${xt6}'`,t,n),Zn4=(t,n,i)=>(n=null!=n?$20(n):n,i=null!=i?$20(i):i,ei2(n)&&ei2(i)?{signal:`${t} ? (${n=n?n.signal||xn(n.value):null}) : (${i=i?i.signal||xn(i.value):null})`}:[rn({test:t},n)].concat(i||[])),ei2=e=>null==e||1===Object.keys(e).length,ti2=(e,t,n)=>({signal:`${e} ? (${ni1(t)}) : (${ni1(n)})`}),ni1=t=>fe6(t)?t.signal:null==t?null:xn(t),ii2=(e,t)=>{const n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e;};function ai2(e,t,n,i){let a;if(t&&ln(t,e))return t[e];if(ln(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=e[5].toLowerCase()+e.slice(6);}return i[wt7][a];}if(e.startsWith("label")){switch(e){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=e[5].toLowerCase()+e.slice(6);}return i[zt6][a];}return null;}function li2(e){const t={};for(const n of e)if(n)for(const e in n)t[e]=1;return Object.keys(t);}function oi2(e,t){return{scale:e.scale,range:t};}function si2(e,t,n,i,a){const l=Vt4(e,t),r=e.orient,u=e.gridScale,c=qn4(r,1,-1),d=function(e,t){if(1===t);else if(E(e)){let n=e=rn({},e);for(;null!=n.mult;){if(!E(n.mult))return n.mult=fe6(t)?{signal:`(${n.mult}) * (${t.signal})`}:n.mult*t,e;n=n.mult=rn({},n.mult);}n.mult=t;}else e=fe6(t)?{signal:`(${t.signal}) * (${e||0})`}:t*(e||0);return e;}(e.offset,c);let f,p,g;const m={enter:f={opacity:Pt3},update:g={opacity:Tt5},exit:p={opacity:Pt3}};R19(m,{stroke:l("gridColor"),strokeCap:l("gridCap"),strokeDash:l("gridDash"),strokeDashOffset:l("gridDashOffset"),strokeOpacity:l("gridOpacity"),strokeWidth:l("gridWidth")});const h={scale:e.scale,field:Ot5,band:a.band,extra:a.extra,offset:a.offset,round:l("tickRound")},y=In5(r,{signal:"height"},{signal:"width"}),b=u?{scale:u,range:0,mult:c,offset:d}:{value:0,offset:d},x=u?{scale:u,range:1,mult:c,offset:d}:rn(y,{mult:c,offset:d});return f.x=g.x=In5(r,h,b),f.y=g.y=Xn3(r,h,b),f.x2=g.x2=Xn3(r,x),f.y2=g.y2=In5(r,x),p.x=In5(r,h),p.y=Xn3(r,h),Nt5({type:At4,role:D19,key:Ot5,from:i,encode:m},n);}function ri2(e,t,n,i,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+i+","+a+")"};}function ui2(e,t,n,i,a,l){const o=Vt4(e,t),s=e.orient,r=e.scale,u=qn4(s,-1,1),c=me7(o("labelFlush")),d=me7(o("labelFlushOffset")),f=o("labelAlign"),p=o("labelBaseline");let g,m=0===c||!!c;const h=$20(a);h.mult=u,h.offset=$20(o("labelPadding")||0),h.offset.mult=u;const y={scale:r,field:Ot5,band:.5,offset:Yt5(l.offset,o("labelOffset"))},b=In5(s,m?ri2(r,c,'"left"','"right"','"center"'):{value:"center"},((e,t,n)=>fe6(e)?Qn4(e.signal,t,n):e===xt6?{value:t}:{value:n})(s,"left","right")),x=In5(s,Yn5(s,"bottom","top"),m?ri2(r,c,'"top"','"bottom"','"middle"'):{value:"middle"}),k=ri2(r,c,`-(${d})`,d,0);m=m&&d;const v={opacity:Pt3,x:In5(s,y,h),y:Xn3(s,y,h)},S={enter:v,update:g={opacity:Tt5,text:{field:St5},x:v.x,y:v.y,align:b,baseline:x},exit:{opacity:Pt3,x:v.x,y:v.y}};R19(S,{dx:!f&&m?In5(s,k):null,dy:!p&&m?Xn3(s,k):null}),R19(S,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:f,baseline:p});const O=o("labelBound");let z=o("labelOverlap");return z=z||O?{separation:o("labelSeparation"),method:z,order:"datum.index",bound:O?{scale:r,orient:s,tolerance:O}:null}:void 0,g.align!==b&&(g.align=ii2(g.align,b)),g.baseline!==x&&(g.baseline=ii2(g.baseline,x)),Nt5({type:Ht5,role:E23,style:zt6,key:Ot5,from:i,encode:S,overlap:z},n);}function ci2(e,t,n,i){const a=Vt4(e,t),l=e.orient,o=qn4(l,-1,1);let r,u;const c={enter:r={opacity:Pt3,anchor:$20(a("titleAnchor",null)),align:{signal:Xt4}},update:u=rn({},r,{opacity:Tt5,text:$20(e.title)}),exit:{opacity:Pt3}},d={signal:`lerp(range("${e.scale}"), ${It5(0,1,.5)})`};return u.x=In5(l,d),u.y=Xn3(l,d),r.angle=In5(l,Pt3,((e,t)=>0===t?0:fe6(e)?{signal:`(${e.signal}) * ${t}`}:{value:e*t})(o,90)),r.baseline=In5(l,Yn5(l,kt7,yt7),{value:kt7}),u.angle=r.angle,u.baseline=r.baseline,R19(c,{fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),angle:a("titleAngle"),baseline:a("titleBaseline")}),function(e,t,n,i){const a=(e,t)=>null!=e?(n.update[t]=ii2($20(e),n.update[t]),!1):!z22(t,i),l=a(e("titleX"),"x"),o=a(e("titleY"),"y");n.enter.auto=o===l?$20(o):In5(t,$20(o),$20(l));}(a,l,c,n),c.update.align=ii2(c.update.align,r.align),c.update.angle=ii2(c.update.angle,r.angle),c.update.baseline=ii2(c.update.baseline,r.baseline),Nt5({type:Ht5,role:L19,style:wt7,from:i,encode:c},n);}function di2(e,t){const n=function(e,t){var n,i,a,l,o,r,u,c,d=t.config,f=d.style,p=d.axis,g="band"===t.scaleType(e.scale)&&d.axisBand,m=e.orient;if(fe6(m)){const e=li2([d.axisX,d.axisY]),t=li2([d.axisTop,d.axisBottom,d.axisLeft,d.axisRight]);for(a of(n={},e))n[a]=In5(m,ai2(a,d.axisX,p,f),ai2(a,d.axisY,p,f));for(a of(i={},t))i[a]=(l=m.signal,o=ai2(a,d.axisTop,p,f),r=ai2(a,d.axisBottom,p,f),u=ai2(a,d.axisLeft,p,f),c=ai2(a,d.axisRight,p,f),{signal:(null!=u?`${l} === '${bt7}' ? (${ni1(u)}) : `:"")+(null!=r?`${l} === '${kt7}' ? (${ni1(r)}) : `:"")+(null!=c?`${l} === '${xt6}' ? (${ni1(c)}) : `:"")+(null!=o?`${l} === '${yt7}' ? (${ni1(o)}) : `:"")+"(null)"});}else n=m===yt7||m===kt7?d.axisX:d.axisY,i=d["axis"+m[0].toUpperCase()+m.slice(1)];return n||i||g?rn({},p,n,i,g):p;}(e,t),i=e.encode||{},a=i.axis||{},l=a.name||void 0,r=a.interactive,u=a.style,c=Vt4(e,n),d=function(e){const t=e("tickBand");let n,i,a=e("tickOffset");return t?t.signal?(n={signal:`(${t.signal}) === 'extent' ? 1 : 0.5`},i={signal:`(${t.signal}) === 'extent'`},E(a)||(a={signal:`(${t.signal}) === 'extent' ? 0 : ${a}`})):"extent"===t?(n=1,i=!0,a=0):(n=.5,i=!1):(n=e("bandPosition"),i=e("tickExtra")),{extra:i,band:n,offset:a};}(c),f={scale:e.scale,ticks:!!c("ticks"),labels:!!c("labels"),grid:!!c("grid"),domain:!!c("domain"),title:null!=e.title},p=le7(t.add(_e5({},[f]))),g=le7(t.add(We2({scale:t.scaleRef(e.scale),extra:t.property(d.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),m=[];let h;return f.grid&&m.push(si2(e,n,i.grid,g,d)),f.ticks&&(h=c("tickSize"),m.push(function(e,t,n,i,a,l){const o=Vt4(e,t),s=e.orient,r=qn4(s,-1,1);let u,c,d;const f={enter:u={opacity:Pt3},update:d={opacity:Tt5},exit:c={opacity:Pt3}};R19(f,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const p=$20(a);p.mult=r;const g={scale:e.scale,field:Ot5,band:l.band,extra:l.extra,offset:l.offset,round:o("tickRound")};return d.y=u.y=In5(s,Pt3,g),d.y2=u.y2=In5(s,p),c.x=In5(s,g),d.x=u.x=Xn3(s,Pt3,g),d.x2=u.x2=Xn3(s,p),c.y=Xn3(s,g),Nt5({type:At4,role:F19,key:Ot5,from:i,encode:f},n);}(e,n,i.ticks,g,h,d))),f.labels&&(h=f.ticks?h:0,m.push(ui2(e,n,i.labels,g,h,d))),f.domain&&m.push(function(e,t,n,i){const a=Vt4(e,t),l=e.orient;let o,s;const r={enter:o={opacity:Pt3},update:s={opacity:Tt5},exit:{opacity:Pt3}};R19(r,{stroke:a("domainColor"),strokeCap:a("domainCap"),strokeDash:a("domainDash"),strokeDashOffset:a("domainDashOffset"),strokeWidth:a("domainWidth"),strokeOpacity:a("domainOpacity")});const u=oi2(e,0),c=oi2(e,1);return o.x=s.x=In5(l,u,Pt3),o.x2=s.x2=In5(l,c),o.y=s.y=Xn3(l,u,Pt3),o.y2=s.y2=Xn3(l,c),Nt5({type:At4,role:C19,from:i,encode:r},n);}(e,n,i.domain,p)),f.title&&m.push(ci2(e,n,i.title,p)),En6(Mt7({role:_20,from:p,encode:O19(fi2(c,e),a,Lt4),marks:m,aria:c("aria"),description:c("description"),zindex:c("zindex"),name:l,interactive:r,style:u}),t);}function fi2(e,t){const n={enter:{},update:{}};return R19(n,{orient:e("orient"),offset:e("offset")||0,position:ge6(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:`abs(span(range("${t.scale}")))`},translate:e("translate"),format:t.format,formatType:t.formatType}),n;}function pi2(n,i,l1){const o=H(n.signals),s=H(n.scales);return l1||o.forEach(e=>te6(e,i)),H(n.projections).forEach(e=>(function(e,t){const n=t.config.projection||{},i={};for(const n in e)"name"!==n&&(i[n]=ht8(e[n],n,t));for(const e in n)null==i[e]&&(i[e]=ht8(n[e],e,t));t.addProjection(e.name,i);})(e,i)),s.forEach(n=>(function(n,i){const a=n.type||"linear";re2(a)||l("Unrecognized scale type: "+xn(a)),i.addScale(n.name,{type:a,domain:void 0});})(n,i)),H(n.data).forEach(e=>An5(e,i)),s.forEach(e=>it9(e,i)),(l1||o).forEach(e=>Oe4(e,i)),H(n.axes).forEach(e=>di2(e,i)),H(n.marks).forEach(e=>En6(e,i)),H(n.legends).forEach(e=>Fn5(e,i)),n.title&&Bn4(n.title,i),i.parseLambdas(),i;}function gi2(e,t){const n=t.config,i=le7(t.root=t.add(ae8())),o=function(e,t){const n=n=>ge6(e[n],t[n]),i=[mi2("background",n("background")),mi2("autosize",x24(n("autosize"))),mi2("padding",v23(n("padding"))),mi2("width",n("width")||0),mi2("height",n("height")||0)],o=i.reduce((e,t)=>(e[t.name]=t,e),{}),r={};return H(e.signals).forEach(e=>{ln(o,e.name)?e=rn(o[e.name],e):i.push(e),r[e.name]=e;}),H(t.signals).forEach(e=>{ln(r,e.name)||ln(o,e.name)||i.push(e);}),i;}(e,n);o.forEach(e=>te6(e,t)),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;const r=t.add(_e5()),u=t.add(Ee4(J22((e=>O19({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e))(e.encode),Bt7,W21,e.style,t,{pulse:le7(r)}))),c=t.add(Ze2({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:i,pulse:le7(u)}));t.operators.pop(),t.pushState(le7(u),le7(c),null),pi2(e,t,o),t.operators.push(c);let d=t.add(je3({mark:i,pulse:le7(c)}));return d=t.add(Ge3({pulse:le7(d)})),d=t.add(Ke2({pulse:le7(d)})),t.addData("root",new Wn4(t,r,r,d)),t;}function mi2(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t};}function hi2(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[];}function yi2(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath;}function bi2(e){return(w(e)?xi2:ki2)(e);}function xi2(t){const n=t.length;let i="[";for(let a=0;a<n;++a){const n=t[a];i+=(a>0?",":"")+(E(n)?n.signal||bi2(n):xn(n));}return i+"]";}function ki2(t){let n,i,a="{",l=0;for(n in t)i=t[n],a+=(++l>1?",":"")+xn(n)+":"+(E(i)?i.signal||bi2(i):xn(i));return a+"}";}function vi2(){const e="sans-serif",t="#4c78a8",n="#000",i="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:i,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:i,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:i,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}};}function $i2(e,n,i){return E(e)||l("Input Vega specification must be an object."),gi2(e,new hi2(n=k(vi2(),n,e.config),i)).toRuntime();}hi2.prototype=yi2.prototype={parse(e){return pi2(e,this);},fork(){return new yi2(this);},isSubscope(){return this._subid>0;},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale};},id(){return(this._subid?this._subid+":":0)+this._id++;},add(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(t=>{t.$ref=e.id;}),e.refs=null),e;},proxy(e){const t=e instanceof ne7?le7(e):e;return this.add(Ye3({value:t}));},addStream(e){return this.streams.push(e),e.id=this.id(),e;},addUpdate(e){return this.updates.push(e),e;},finish(){let e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){let i,a;e&&(i=e.data||(e.data={}),a=i[t]||(i[t]=[]),a.push(n));}for(e in this.data){t=this.data[e],n(t.input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values");for(const i in t.index)n(t.index[i],e,"index:"+i);}return this;},pushState(e,t,n){this._encode.push(le7(this.add(Ke2({pulse:e})))),this._parent.push(t),this._lookup.push(n?le7(this.proxy(n)):null),this._markpath.push(-1);},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop();},parent(){return D(this._parent);},encode(){return D(this._encode);},lookup(){return D(this._lookup);},markpath(){const e=this._markpath;return++e[e.length-1];},fieldRef(n,a){if(Mn(n))return oe6(n,a);n.signal||l("Unsupported field reference: "+xn(n));const l1=n.signal;let o=this.field[l1];if(!o){const e={name:this.signalRef(l1)};a&&(e.as=a),this.field[l1]=o=le7(this.add(Pe4(e)));}return o;},compareRef(e){let t=!1;const n=e=>fe6(e)?(t=!0,this.signalRef(e.signal)):function(e){return e&&e.expr;}(e)?(t=!0,this.exprRef(e.expr)):e,i=H(e.field).map(n),l=H(e.order).map(n);return t?le7(this.add(Ce5({fields:i,orders:l}))):re8(i,l);},keyRef(e,t){let n=!1;const i=this.signals;return e=H(e).map(e=>fe6(e)?(n=!0,le7(i[e.signal])):e),n?le7(this.add(Te4({fields:e,flat:t}))):function(e,t){const n={$key:e};return t&&(n.$flat=!0),n;}(e,t);},sortRef(e){if(!e)return e;const t=ue7(e.op,e.field),n=e.order||"ascending";return n.signal?le7(this.add(Ce5({fields:t,orders:this.signalRef(n.signal)}))):re8(t,n);},event(e,t){const n=e+":"+t;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:e,type:t}),this.events[n]=i;}return this.events[n];},hasOwnSignal(e){return ln(this.signals,e);},addSignal(n,i){this.hasOwnSignal(n)&&l("Duplicate signal name: "+xn(n));const a=i instanceof ne7?i:this.add(ae8(i));return this.signals[n]=a;},getSignal(n){return this.signals[n]||l("Unrecognized signal name: "+xn(n)),this.signals[n];},signalRef(e){return this.signals[e]?le7(this.signals[e]):(ln(this.lambdas,e)||(this.lambdas[e]=this.add(ae8(null))),le7(this.lambdas[e]));},parseLambdas(){const e=Object.keys(this.lambdas);for(let t=0,n=e.length;t<n;++t){const n=e[t],i=de4(n,this),a=this.lambdas[n];a.params=i.$params,a.update=i.$expr;}},property(e){return e&&e.signal?this.signalRef(e.signal):e;},objectProperty(e){return e&&E(e)?this.signalRef(e.signal||bi2(e)):e;},exprRef(e,t){const n={expr:de4(e,this)};return t&&(n.expr.$name=t),le7(this.add(Fe4(n)));},addBinding(n,i){this.bindings||l("Nested signals do not support binding: "+xn(n)),this.bindings.push(rn({signal:n},i));},addScaleProj(n,i){ln(this.scales,n)&&l("Duplicate scale or projection name: "+xn(n)),this.scales[n]=this.add(i);},addScale(e,t){this.addScaleProj(e,Je3(t));},addProjection(e,t){this.addScaleProj(e,Xe3(t));},getScale(n){return this.scales[n]||l("Unrecognized scale name: "+xn(n)),this.scales[n];},scaleRef(e){return le7(this.getScale(e));},scaleType(e){return this.getScale(e).params.type;},projectionRef(e){return this.scaleRef(e);},projectionType(e){return this.scaleType(e);},addData(n,i){return ln(this.data,n)&&l("Duplicate data set name: "+xn(n)),this.data[n]=i;},getData(n){return this.data[n]||l("Undefined data set name: "+xn(n)),this.data[n];},addDataPipeline(n,i){return ln(this.data,n)&&l("Duplicate data set name: "+xn(n)),this.addData(n,Wn4.fromEntries(this,i));}};rn(rt2,mod,mod2,mod3,mod4,mod5,mod7,mod6,mod8,mod9,mod10,mod11);const v24="6.1.2";const __default=null;const mod12=function(){return{Dataflow:et2,EventStream:I5,MultiPulse:V5,Operator:U4,Parameters:x5,Pulse:H6,Transform:st2,changeset:L5,definition:it2,ingest:O6,isTuple:D5,transform:ot2,transforms:rt2,tupleid:E7,interpolate:xe1,interpolateColors:ve1,interpolateRange:ye1,quantizeInterpolator:we1,scale:be1,scheme:ke1,projection:w13,View:_e4,defaultLocale:J5,formatLocale:Y4,locale:H4,resetDefaultLocale:K5,timeFormatLocale:E5,expressionFunction:me5,parse:$i2,runtimeContext:b21,codegenExpression:bu,parseExpression:mu,parseSelector:l22,version:v24,default:null,Debug:4,Error:1,Info:3,None:0,Warn:2,accessor:n1,accessorFields:e,accessorName:t1,array:H,ascending:X,clampRange:K,compare:Q,constant:tn,debounce:en,error:l,extend:rn,extent:un,extentIndex:on,falsy:p,fastmap:fn,field:i,flush:sn,hasOwnProperty:ln,id:f,identity:s,inherits:an,inrange:hn,isArray:w,isBoolean:gn,isDate:pn,isFunction:L,isIterable:bn,isNumber:yn,isObject:E,isRegExp:mn,isString:Mn,key:dn,lerp:jn,logger:O,lruCache:On,merge:wn,mergeConfig:k,one:h,pad:vn,panLinear:U,panLog:q,panPow:B,panSymlog:C,peek:D,quarter:W,repeat:En,span:kn,splitAccessPath:c,stringValue:xn,toBoolean:An,toDate:zn,toNumber:z,toSet:Sn,toString:Rn,truncate:_n,truthy:g,utcquarter:$,visitArray:Nn,writeConfig:x,zero:a,zoomLinear:G,zoomLog:I,zoomPow:J,zoomSymlog:V,format:Dt1,formats:Nt1,inferType:It1,inferTypes:Yt1,loader:zt,read:jt2,responseType:kt1,typeParsers:Ut1,DATE:j1,DAY:k2,DAYOFYEAR:q2,HOURS:I2,MILLISECONDS:L2,MINUTES:B2,MONTH:H2,QUARTER:x2,SECONDS:E3,TIME_UNITS:Q2,WEEK:S2,YEAR:b2,dayofyear:N3,timeBin:Bt,timeFloor:st,timeInterval:Dt,timeOffset:ht1,timeSequence:Mt1,timeUnitSpecifier:G3,timeUnits:z2,utcFloor:ft1,utcInterval:Tt,utcOffset:Ct,utcSequence:yt1,utcdayofyear:Z3,utcweek:_2,week:O2,bandwidthNRD:f4,bin:s6,bootstrapCI:h5,cumulativeLogNormal:S7,cumulativeNormal:N7,cumulativeUniform:I6,densityLogNormal:v6,densityNormal:b6,densityUniform:D6,dotbin:d5,quantileLogNormal:E8,quantileNormal:y3,quantileUniform:C7,quantiles:u7,quartiles:a6,random:c5,randomInteger:M6,randomKDE:A8,randomLCG:p6,randomLogNormal:L6,randomMixture:P6,randomNormal:q7,randomUniform:K8,regressionConstant:Q6,regressionExp:B7,regressionLinear:j6,regressionLoess:W7,regressionLog:z7,regressionPoly:O7,regressionPow:H7,regressionQuad:J8,sampleCurve:$7,sampleLogNormal:F6,sampleNormal:x6,sampleUniform:k6,setRandom:i6,path:n6,Bounds:Bt3,CanvasHandler:Mi,CanvasRenderer:Ei,Gradient:X14,GroupItem:Wt2,Handler:ni,HybridHandler:br,HybridRenderer:kr,Item:Ht2,Marks:Vn2,RenderType:zr,Renderer:ri,ResourceLoader:jt4,SVGHandler:Ni,SVGRenderer:sr,SVGStringRenderer:mr,Scenegraph:Yn1,boundClip:Nr,boundContext:ue3,boundItem:Bn1,boundMark:Wn1,boundStroke:Gt1,domChild:Zn1,domClear:Kn1,domCreate:Fn2,domFind:Qn1,font:En2,fontFamily:Ln2,fontSize:zn2,intersect:Cr,intersectBoxLine:be2,intersectPath:me3,intersectPoint:_e2,intersectRule:ke2,lineHeight:Rn2,markup:Qi,multiLineOffset:Cn2,pathCurves:Y13,pathEqual:Dr,pathParse:tt6,pathRectangle:Tt2,pathRender:ut5,pathSymbols:gt5,pathTrail:Mt4,point:ei,renderModule:Ar,resetSVGDefIds:Ir,sceneEqual:Or,sceneFromJSON:Xn,scenePickVisit:Ne2,sceneToJSON:Un2,sceneVisit:Se2,sceneZOrder:Ee2,serializeXML:Zi,setHybridRendererOptions:xr,textMetrics:xn3};}();var n18={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},r19={"*":(e,t)=>e*t,"+":(e,t)=>e+t,"-":(e,t)=>e-t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,">":(e,t)=>e>t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">=":(e,t)=>e>=t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,"===":(e,t)=>e===t,"!==":(e,t)=>e!==t,"&":(e,t)=>e&t,"|":(e,t)=>e|t,"^":(e,t)=>e^t,"<<":(e,t)=>e<<t,">>":(e,t)=>e>>t,">>>":(e,t)=>e>>>t},a18={"+":e=>+e,"-":e=>-e,"~":e=>~e,"!":e=>!e};const o20=Array.prototype.slice,i22=(e,t,n)=>{const r=n?n(t[0]):t[0];return r[e].apply(r,o20.call(t,1));};var s24={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(e,t,n)=>Math.max(t,Math.min(n,e)),now:Date.now,utc:Date.UTC,datetime:function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;return Mn(e)?new Date(e):new Date(e,n,r,a,o,i,s);},date:e=>new Date(e).getDate(),day:e=>new Date(e).getDay(),year:e=>new Date(e).getFullYear(),month:e=>new Date(e).getMonth(),hours:e=>new Date(e).getHours(),minutes:e=>new Date(e).getMinutes(),seconds:e=>new Date(e).getSeconds(),milliseconds:e=>new Date(e).getMilliseconds(),time:e=>new Date(e).getTime(),timezoneoffset:e=>new Date(e).getTimezoneOffset(),utcdate:e=>new Date(e).getUTCDate(),utcday:e=>new Date(e).getUTCDay(),utcyear:e=>new Date(e).getUTCFullYear(),utcmonth:e=>new Date(e).getUTCMonth(),utchours:e=>new Date(e).getUTCHours(),utcminutes:e=>new Date(e).getUTCMinutes(),utcseconds:e=>new Date(e).getUTCSeconds(),utcmilliseconds:e=>new Date(e).getUTCMilliseconds(),length:e=>e.length,join:function(){return i22("join",arguments);},indexof:function(){return i22("indexOf",arguments);},lastindexof:function(){return i22("lastIndexOf",arguments);},slice:function(){return i22("slice",arguments);},reverse:e=>e.slice().reverse(),sort:t=>t.slice().sort(X),parseFloat:parseFloat,parseInt:parseInt,upper:e=>String(e).toUpperCase(),lower:e=>String(e).toLowerCase(),substring:function(){return i22("substring",arguments,String);},split:function(){return i22("split",arguments,String);},replace:function(){return i22("replace",arguments,String);},trim:e=>String(e).trim(),btoa:e=>btoa(e),atob:e=>atob(e),regexp:RegExp,test:(e,t)=>RegExp(e).test(t)};const c22=["view","item","group","xy","x","y"],u20=new Set([Function,eval,setTimeout,setInterval]);"function"==typeof setImmediate&&u20.add(setImmediate);const l23={Literal:(e,t)=>t.value,Identifier:(e,t)=>{const r=t.name;return e.memberDepth>0?r:"datum"===r?e.datum:"event"===r?e.event:"item"===r?e.item:n18[r]||e.params["$"+r];},MemberExpression:(e,t)=>{const n=!t.computed,r=e(t.object);n&&(e.memberDepth+=1);const a=e(t.property);if(n&&(e.memberDepth-=1),!u20.has(r[a]))return r[a];console.error(`Prevented interpretation of member "${a}" which could lead to insecure code execution`);},CallExpression:(e,t)=>{const n=t.arguments;let r=t.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?e(n[0])?e(n[1]):e(n[2]):(e.fn[r]||s24[r]).apply(e.fn,n.map(e));},ArrayExpression:(e,t)=>t.elements.map(e),BinaryExpression:(e,t)=>r19[t.operator](e(t.left),e(t.right)),UnaryExpression:(e,t)=>a18[t.operator](e(t.argument)),ConditionalExpression:(e,t)=>e(t.test)?e(t.consequent):e(t.alternate),LogicalExpression:(e,t)=>"&&"===t.operator?e(t.left)&&e(t.right):e(t.left)||e(t.right),ObjectExpression:(e,t)=>t.properties.reduce((t,n)=>{e.memberDepth+=1;const r=e(n.key);return e.memberDepth-=1,u20.has(e(n.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):t[r]=e(n.value),t;},{})};function m21(e,t,n,r,a,o){const i=e=>l23[e.type](i,e);return i.memberDepth=0,i.fn=Object.create(t),i.params=n,i.datum=r,i.event=a,i.item=o,c22.forEach(e=>i.fn[e]=function(){return a.vega[e](...arguments);}),i(e);}var h27={operator(e,t){const n=t.ast,r=e.functions;return e=>m21(n,r,e);},parameter(e,t){const n=t.ast,r=e.functions;return(e,t)=>m21(n,r,t,e);},event(e,t){const n=t.ast,r=e.functions;return e=>m21(n,r,void 0,void 0,e);},handler(e,t){const n=t.ast,r=e.functions;return(e,t)=>{const a=t.item&&t.item.datum;return m21(n,r,e,a,t);};},encode(e,t){const{marktype:n,channels:r}=t,a=e.functions,o="group"===n||"image"===n||"rect"===n;return(e,t)=>{const i=e.datum;let s,c=0;for(const n in r)s=m21(r[n].ast,a,t,i,void 0,e),e[n]!==s&&(e[n]=s,c=1);return"rule"!==n&&function(e,t,n){let r;t.x2&&(t.x?(n&&e.x>e.x2&&(r=e.x,e.x=e.x2,e.x2=r),e.width=e.x2-e.x):e.x=e.x2-(e.width||0)),t.xc&&(e.x=e.xc-(e.width||0)/2),t.y2&&(t.y?(n&&e.y>e.y2&&(r=e.y,e.y=e.y2,e.y2=r),e.height=e.y2-e.y):e.y=e.y2-(e.height||0)),t.yc&&(e.y=e.yc-(e.height||0)/2);}(e,r,o),c;};}};var $21="5.20.1";function w22(e){return!!e.or;}function k22(e){return!!e.and;}function S20(e){return!!e.not;}function D20(e,t){if(S20(e))D20(e.not,t);else if(k22(e))for(const n of e.and)D20(n,t);else if(w22(e))for(const n of e.or)D20(n,t);else t(e);}function F20(e,t){return S20(e)?{not:F20(e.not,t)}:k22(e)?{and:e.and.map(e=>F20(e,t))}:w22(e)?{or:e.or.map(e=>F20(e,t))}:t(e);}const z23=structuredClone;function C20(e){throw new Error(e);}function _21(t,n){const i={};for(const r of n)ln(t,r)&&(i[r]=t[r]);return i;}function O20(e,t){const n={...e};for(const e of t)delete n[e];return n;}function P20(e){if(yn(e))return e;const i=Mn(e)?e:he7(e);if(i.length<250)return i;let r=0;for(let e=0;e<i.length;e++){r=(r<<5)-r+i.charCodeAt(e),r|=0;}return r;}function N23(e){return!1===e||null===e;}function T21(e,t){return e.includes(t);}function E24(e,t){let n=0;for(const[i,r]of e.entries())if(t(r,i,n++))return!0;return!1;}function j21(e,t){let n=0;for(const[i,r]of e.entries())if(!t(r,i,n++))return!1;return!0;}function A22(e,...t){for(const n of t)M23(e,n??{});return e;}function M23(e,t){for(const n of H21(t))x(e,n,t[n],!0);}function R20(e,t){const n=[],i={};let r;for(const o of e)r=t(o),r in i||(i[r]=1,n.push(o));return n;}function q19(e,t){const n=H21(e),i=H21(t);if(n.length!==i.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0;}function L20(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0;}function U19(e,t){for(const n of e)if(t.has(n))return!0;return!1;}function W22(e){const t=new Set;for(const n of e){const e=c(n).map((e,t)=>0===t?e:`[${e}]`),i=e.map((t,n)=>e.slice(0,n+1).join(""));for(const e of i)t.add(e);}return t;}function B22(e,t){return void 0===e||void 0===t||U19(W22(e),W22(t));}function I19(e){return 0===H21(e).length;}Set.prototype.toJSON=function(){return`Set(${[...this].map(e=>he7(e)).join(",")})`;};const H21=Object.keys,V20=Object.values,G21=Object.entries;function Y21(e){return!0===e||!1===e;}function X22(e){const t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t;}function J23(e,t){return S20(e)?`!(${J23(e.not,t)})`:k22(e)?`(${e.and.map(e=>J23(e,t)).join(") && (")})`:w22(e)?`(${e.or.map(e=>J23(e,t)).join(") || (")})`:t(e);}function Q19(e,t){if(0===t.length)return!0;const n=t.shift();return n in e&&Q19(e[n],t)&&delete e[n],I19(e);}function K24(e){return e.charAt(0).toUpperCase()+e.substr(1);}function Z23(e,t="datum"){const n=c(e),i=[];for(let e=1;e<=n.length;e++){const r=`[${n.slice(0,e).map(xn).join("][")}]`;i.push(`${t}${r}`);}return i.join(" && ");}function ee8(e,t="datum"){return`${t}[${xn(c(e).join("."))}]`;}function te7(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1");}function ne8(e){return`${c(e).map(te7).join("\\.")}`;}function ie8(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n);}function re9(e){return`${c(e).join(".")}`;}function oe7(e){return e?c(e).length:0;}function ae9(...e){for(const t of e)if(void 0!==t)return t;}let se8=42;function ce8(e){const t=++se8;return e?String(e)+t:t;}function le8(){se8=42;}function ue8(e){return fe7(e)?e:`__${e}`;}function fe7(e){return e.startsWith("__");}function de7(e){if(void 0!==e)return(e%360+360)%360;}function me8(e){return!!yn(e)||!isNaN(e)&&!isNaN(parseFloat(e));}const pe6=Object.getPrototypeOf(structuredClone({}));function ge7(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor.name!==t.constructor.name)return!1;let n,i;if(Array.isArray(e)){if(n=e.length,n!=t.length)return!1;for(i=n;0!=i--;)if(!ge7(e[i],t[i]))return!1;return!0;}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!ge7(i[1],t.get(i[0])))return!1;return!0;}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0;}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(n=e.length,n!=t.length)return!1;for(i=n;0!=i--;)if(e[i]!==t[i])return!1;return!0;}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&e.valueOf!==pe6.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&e.toString!==pe6.toString)return e.toString()===t.toString();const r=Object.keys(e);if(n=r.length,n!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;for(i=n;0!=i--;){const n=r[i];if(!ge7(e[n],t[n]))return!1;}return!0;}return e!=e&&t!=t;}function he7(e){const t=[];return function e(n){if(n&&n.toJSON&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0===n)return;if("number"==typeof n)return isFinite(n)?""+n:"null";if("object"!=typeof n)return JSON.stringify(n);let i,r;if(Array.isArray(n)){for(r="[",i=0;i<n.length;i++)i&&(r+=","),r+=e(n[i])||"null";return r+"]";}if(null===n)return"null";if(t.includes(n))throw new TypeError("Converting circular structure to JSON");const o=t.push(n)-1,a=Object.keys(n).sort();for(r="",i=0;i<a.length;i++){const t=a[i],o=e(n[t]);o&&(r&&(r+=","),r+=JSON.stringify(t)+":"+o);}return t.splice(o,1),`{${r}}`;}(e);}const ye6="row",ve6="column",be6="facet",xe6="x",$e3="y",we6="x2",ke5="y2",Se5="xOffset",De5="yOffset",Fe5="radius",ze6="radius2",Ce6="theta",_e6="theta2",Oe5="latitude",Pe5="longitude",Ne6="latitude2",Te5="longitude2",Ee5="color",je4="fill",Ae5="stroke",Me6="shape",Re5="size",qe4="angle",Le5="opacity",Ue5="fillOpacity",We3="strokeOpacity",Be5="strokeWidth",Ie6="strokeDash",He5="text",Ve3="order",Ge4="detail",Ye4="key",Xe4="tooltip",Je4="href",Qe4="url",Ke3="description",Ze3={theta:1,theta2:1,radius:1,radius2:1};function et10(e){return e in Ze3;}const tt10={longitude:1,longitude2:1,latitude:1,latitude2:1};function nt11(e){switch(e){case Oe5:return"y";case Ne6:return"y2";case Pe5:return"x";case Te5:return"x2";}}function it10(e){return e in tt10;}const rt11=H21(tt10),ot9={x:1,y:1,x2:1,y2:1,...Ze3,...tt10,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function at11(e){return e===Ee5||e===je4||e===Ae5;}const st9={row:1,column:1,facet:1},ct9=H21(st9),lt10={...ot9,...st9},ut9=H21(lt10),{order:ft8,detail:dt8,tooltip:mt8,...pt8}=lt10,{row:gt9,column:ht9,facet:yt8,...vt7}=pt8;function bt8(e){return!!lt10[e];}const xt7=[we6,ke5,Ne6,Te5,_e6,ze6];function $t5(e){return wt8(e)!==e;}function wt8(e){switch(e){case we6:return xe6;case ke5:return $e3;case Ne6:return Oe5;case Te5:return Pe5;case _e6:return Ce6;case ze6:return Fe5;}return e;}function kt8(e){if(et10(e))switch(e){case Ce6:return"startAngle";case _e6:return"endAngle";case Fe5:return"outerRadius";case ze6:return"innerRadius";}return e;}function St6(e){switch(e){case xe6:return we6;case $e3:return ke5;case Oe5:return Ne6;case Pe5:return Te5;case Ce6:return _e6;case Fe5:return ze6;}}function Dt8(e){switch(e){case xe6:case we6:return"width";case $e3:case ke5:return"height";}}function Ft5(e){switch(e){case xe6:return"xOffset";case $e3:return"yOffset";case we6:return"x2Offset";case ke5:return"y2Offset";case Ce6:return"thetaOffset";case Fe5:return"radiusOffset";case _e6:return"theta2Offset";case ze6:return"radius2Offset";}}function zt7(e){switch(e){case xe6:return"xOffset";case $e3:return"yOffset";}}function Ct7(e){switch(e){case"xOffset":return"x";case"yOffset":return"y";}}const _t5=H21(ot9),{x:Ot6,y:Pt4,x2:Nt6,y2:Tt6,xOffset:Et7,yOffset:jt9,latitude:At5,longitude:Mt8,latitude2:Rt7,longitude2:qt7,theta:Lt5,theta2:Ut7,radius:Wt6,radius2:Bt8,...It6}=ot9,Ht6=H21(It6),Vt5={x:1,y:1},Gt5=H21(Vt5);function Yt6(e){return e in Vt5;}const Xt5={theta:1,radius:1},Jt5=H21(Xt5);function Qt4(e){return"width"===e?xe6:$e3;}const Kt6={xOffset:1,yOffset:1};function Zt4(e){return e in Kt6;}const{text:en9,tooltip:tn8,href:nn10,url:rn10,description:on9,detail:an9,key:sn8,order:cn10,...ln9}=It6,un9=H21(ln9);const fn9={...Vt5,...Xt5,...Kt6,...ln9},dn8=H21(fn9);function mn8(e){return!!fn9[e];}function pn8(e,t){return function(e){switch(e){case Ee5:case je4:case Ae5:case Ke3:case Ge4:case Ye4:case Xe4:case Je4:case Ve3:case Le5:case Ue5:case We3:case Be5:case be6:case ye6:case ve6:return gn7;case xe6:case $e3:case Se5:case De5:case Oe5:case Pe5:return yn8;case we6:case ke5:case Ne6:case Te5:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Re5:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Ie6:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Me6:return{point:"always",geoshape:"always"};case He5:return{text:"always"};case qe4:return{point:"always",square:"always",text:"always"};case Qe4:return{image:"always"};case Ce6:case Fe5:return{text:"always",arc:"always"};case _e6:case ze6:return{arc:"always"};}}(e)[t];}const gn7={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:hn9,...yn8}=gn7;function vn7(e){switch(e){case xe6:case $e3:case Ce6:case Fe5:case Se5:case De5:case Re5:case qe4:case Be5:case Le5:case Ue5:case We3:case we6:case ke5:case _e6:case ze6:return;case be6:case ye6:case ve6:case Me6:case Ie6:case He5:case Xe4:case Je4:case Qe4:case Ke3:return"discrete";case Ee5:case je4:case Ae5:return"flexible";case Oe5:case Pe5:case Ne6:case Te5:case Ge4:case Ye4:case Ve3:return;}}const bn8={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},xn7={count:1,min:1,max:1};function $n5(e){return!!e&&!!e.argmin;}function wn8(e){return!!e&&!!e.argmax;}function kn6(e){return Mn(e)&&!!bn8[e];}const Sn7=new Set(["count","valid","missing","distinct"]);function Dn7(e){return Mn(e)&&Sn7.has(e);}const Fn6=new Set(["count","sum","distinct","valid","missing"]),zn6=new Set(["mean","average","median","q1","q3","min","max"]);function Cn6(e){return gn(e)&&(e=Ha(e,void 0)),"bin"+H21(e).map(t=>Nn6(e[t])?X22(`_${t}_${G21(e[t])}`):X22(`_${t}_${e[t]}`)).join("");}function _n6(e){return!0===e||Pn5(e)&&!e.binned;}function On7(e){return"binned"===e||Pn5(e)&&!0===e.binned;}function Pn5(e){return E(e);}function Nn6(e){return e?.param;}function Tn6(e){switch(e){case ye6:case ve6:case Re5:case Ee5:case je4:case Ae5:case Be5:case Le5:case Ue5:case We3:case Me6:return 6;case Ie6:return 4;default:return 10;}}function En7(e){return!!e?.expr;}function jn8(e,{level:t}={level:0}){const n=H21(e||{}),i={};for(const r of n)i[r]=0===t?Hn6(e[r]):jn8(e[r],{level:t-1});return i;}function An6(e){const{anchor:t,frame:n,offset:i,orient:r,angle:o,limit:a,color:s,subtitleColor:c,subtitleFont:l,subtitleFontSize:u,subtitleFontStyle:f,subtitleFontWeight:d,subtitleLineHeight:m,subtitlePadding:p,...g}=e,h={...t?{anchor:t}:{},...n?{frame:n}:{},...i?{offset:i}:{},...r?{orient:r}:{},...void 0!==o?{angle:o}:{},...void 0!==a?{limit:a}:{}},y={...c?{subtitleColor:c}:{},...l?{subtitleFont:l}:{},...u?{subtitleFontSize:u}:{},...f?{subtitleFontStyle:f}:{},...d?{subtitleFontWeight:d}:{},...m?{subtitleLineHeight:m}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...g,...s?{fill:s}:{}},subtitleMarkConfig:_21(e,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:h,subtitle:y};}function Mn7(e){return Mn(e)||w(e)&&Mn(e[0]);}function Rn6(e){return!!e?.signal;}function qn5(e){return!!e.step;}function Ln6(e){return!w(e)&&"field"in e&&"data"in e;}const Un6=H21({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),Wn5={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Bn5=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function In6(e){const t=w(e.condition)?e.condition.map(Vn7):Vn7(e.condition);return{...Hn6(e),condition:t};}function Hn6(e){if(En7(e)){const{expr:t,...n}=e;return{signal:t,...n};}return e;}function Vn7(e){if(En7(e)){const{expr:t,...n}=e;return{signal:t,...n};}return e;}function Gn5(e){if(En7(e)){const{expr:t,...n}=e;return{signal:t,...n};}return Rn6(e)?e:void 0!==e?{value:e}:void 0;}function Yn6(e){return Rn6(e)?e.signal:xn(e);}function Xn4(e){return Rn6(e)?e.signal:xn(e.value);}function Jn5(e){return Rn6(e)?e.signal:null==e?null:xn(e);}function Qn5(e,t,n){for(const i of n){const n=ei3(i,t.markDef,t.config);void 0!==n&&(e[i]=Gn5(n));}return e;}function Kn6(e){return[].concat(e.type,e.style??[]);}function Zn5(e,t,n,i={}){const{vgChannel:r,ignoreVgConfig:o}=i;return r&&void 0!==t[r]?t[r]:void 0!==t[e]?t[e]:!o||r&&r!==e?ei3(e,t,n,i):void 0;}function ei3(e,t,n,{vgChannel:i}={}){return ae9(i?ti3(e,t,n.style):void 0,ti3(e,t,n.style),i?n[t.type][i]:void 0,n[t.type][e],i?n.mark[i]:n.mark[e]);}function ti3(e,t,n){return ni2(e,Kn6(t),n);}function ni2(e,t,n){let i;t=H(t);for(const r of t){const t=n[r];t&&void 0!==t[e]&&(i=t[e]);}return i;}function ii3(e,t){return H(e).reduce((e,n)=>(e.field.push(Pa(n,t)),e.order.push(n.sort??"ascending"),e),{field:[],order:[]});}function ri3(e,t){const n=[...e];return t.forEach(e=>{for(const t of n)if(ge7(t,e))return;n.push(e);}),n;}function oi3(e,t){return ge7(e,t)||!t?e:e?[...H(e),...H(t)].join(", "):t;}function ai3(e,t){const n=e.value,i=t.value;if(null==n||null===i)return{explicit:e.explicit,value:null};if((Mn7(n)||Rn6(n))&&(Mn7(i)||Rn6(i)))return{explicit:e.explicit,value:oi3(n,i)};if(Mn7(n)||Rn6(n))return{explicit:e.explicit,value:n};if(Mn7(i)||Rn6(i))return{explicit:e.explicit,value:i};if(!(Mn7(n)||Rn6(n)||Mn7(i)||Rn6(i)))return{explicit:e.explicit,value:ri3(n,i)};throw new Error("It should never reach here");}function si3(e){return`Invalid specification ${he7(e)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`;}const ci3='Autosize "fit" only works for single views and layered views.';function li3(e){return`${"width"==e?"Width":"Height"} "container" only works for single views and layered views.`;}function ui3(e){return`${"width"==e?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==e?"x":"y"}".`;}function fi3(e){return e?`Dropping "fit-${e}" because spec has discrete ${Dt8(e)}.`:'Dropping "fit" because spec has discrete size.';}function di3(e){return`Unknown field for ${e}. Cannot calculate view size.`;}function mi3(e){return`Cannot project a selection on encoding channel "${e}", which has no field.`;}function pi3(e,t){return`Cannot project a selection on encoding channel "${e}" as it uses an aggregate function ("${t}").`;}function gi3(e){return`Selection not supported for ${e} yet.`;}const hi3="The same selection must be used to override scale domains in a layered view.";function yi3(e){return`The "columns" property cannot be used when "${e}" has nested row/column.`;}function vi3(e,t,n){return`An ancestor parsed field "${e}" as ${n} but a child wants to parse the field as ${t}.`;}function bi3(e){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${e} are dropped.`;}function xi3(e){return`${e}Offset dropped because ${e} is continuous`;}function $i3(e){return`Invalid field type "${e}".`;}function wi2(e,t){const{fill:n,stroke:i}=t;return`Dropping color ${e} as the plot also has ${n&&i?"fill and stroke":n?"fill":"stroke"}.`;}function ki3(e,t){return`Dropping ${he7(e)} from channel "${t}" since it does not contain any data field, datum, value, or signal.`;}function Si2(e,t,n){return`${e} dropped as it is incompatible with "${t}"${n?` when ${n}`:""}.`;}function Di2(e){return`${e} encoding should be discrete (ordinal / nominal / binned).`;}function Fi2(e){return`${e} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`;}function zi2(e,t){return`Using discrete channel "${e}" to encode "${t}" field can be misleading as it does not encode ${"ordinal"===t?"order":"magnitude"}.`;}function Ci2(e){return`Using unaggregated domain with raw field has no effect (${he7(e)}).`;}function _i2(e){return`Unaggregated domain not applicable for "${e}" since it produces values outside the origin domain of the source data.`;}function Oi2(e){return`Unaggregated domain is currently unsupported for log scale (${he7(e)}).`;}function Pi2(e,t,n){return`${n}-scale's "${t}" is dropped as it does not work with ${e} scale.`;}function Ni2(e){return`The step for "${e}" is dropped because the ${"width"===e?"x":"y"} is continuous.`;}const Ti2="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function Ei2(e,t){return`Invalid ${e}: ${he7(t)}.`;}function ji2(e){return`1D error band does not support ${e}.`;}function Ai2(e){return`Channel ${e} is required for "binned" bin.`;}const Mi2=O(2);let Ri2=Mi2;function qi2(...e){Ri2.warn(...e);}function Li2(e){if(e&&E(e)){for(const t of Yi2)if(t in e)return!0;}return!1;}const Ui2=["january","february","march","april","may","june","july","august","september","october","november","december"],Wi2=Ui2.map(e=>e.substr(0,3)),Bi2=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Ii2=Bi2.map(e=>e.substr(0,3));function Hi2(e,n){const i=[];if(n&&void 0!==e.day&&H21(e).length>1&&(qi2(function(e){return`Dropping day from datetime ${he7(e)} as day cannot be combined with other units.`;}(e)),delete(e=z23(e)).day),void 0!==e.year?i.push(e.year):i.push(2012),void 0!==e.month){const r=n?function(e){if(me8(e)&&(e=+e),yn(e))return e-1;{const t=e.toLowerCase(),n=Ui2.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=Wi2.indexOf(i);if(-1!==r)return r;throw new Error(Ei2("month",e));}}(e.month):e.month;i.push(r);}else if(void 0!==e.quarter){const r=n?function(e){if(me8(e)&&(e=+e),yn(e))return e>4&&qi2(Ei2("quarter",e)),e-1;throw new Error(Ei2("quarter",e));}(e.quarter):e.quarter;i.push(yn(r)?3*r:`${r}*3`);}else i.push(0);if(void 0!==e.date)i.push(e.date);else if(void 0!==e.day){const r=n?function(e){if(me8(e)&&(e=+e),yn(e))return e%7;{const t=e.toLowerCase(),n=Bi2.indexOf(t);if(-1!==n)return n;const i=t.substr(0,3),r=Ii2.indexOf(i);if(-1!==r)return r;throw new Error(Ei2("day",e));}}(e.day):e.day;i.push(yn(r)?r+1:`${r}+1`);}else i.push(1);for(const t of["hours","minutes","seconds","milliseconds"]){const n=e[t];i.push(void 0===n?0:n);}return i;}function Vi1(e){const t=Hi2(e,!0).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`;}const Gi2={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Yi2=H21(Gi2);function Xi2(e){return E(e)?e.binned:Ji2(e);}function Ji2(e){return e&&e.startsWith("binned");}function Qi2(e){return e.startsWith("utc");}const Ki2={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Zi2(e){return Yi2.filter(t=>tr3(e,t));}function er2(e){const t=Zi2(e);return t[t.length-1];}function tr3(e,t){const n=e.indexOf(t);return!(n<0)&&!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1));}function nr2(e,t,{end:n}={end:!1}){const i=Z23(t),r=Qi2(e)?"utc":"";let o;const a={};for(const t of Yi2)tr3(e,t)&&(a[t]="quarter"===(s=t)?`(${r}quarter(${i})-1)`:`${r}${s}(${i})`,o=t);var s;return n&&(a[o]+="+1"),function(e){const t=Hi2(e,!1).join(", ");return e.utc?`utc(${t})`:`datetime(${t})`;}(a);}function ir2(e){if(!e)return;return`timeUnitSpecifier(${he7(Zi2(e))}, ${he7(Ki2)})`;}function rr3(e){if(!e)return;let t;return Mn(e)?t=Ji2(e)?{unit:e.substring(6),binned:!0}:{unit:e}:E(e)&&(t={...e,...e.unit?{unit:e.unit}:{}}),Qi2(t.unit)&&(t.utc=!0,t.unit=t.unit.substring(3)),t;}function or3(e,t=e=>e){const n=rr3(e),i=er2(n.unit);if(i&&"day"!==i){const e={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:r,part:o}=sr3(i,n.step);return`${t(Vi1({...e,[o]:+e[o]+r}))} - ${t(Vi1(e))}`;}}const ar2={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function sr3(e,t=1){if(function(e){return!!ar2[e];}(e))return{part:e,step:t};switch(e){case"day":case"dayofyear":return{part:"date",step:t};case"quarter":return{part:"month",step:3*t};case"week":return{part:"date",step:7*t};}}function cr3(e){return!!e?.field&&void 0!==e.equal;}function lr3(e){return!!e?.field&&void 0!==e.lt;}function ur3(e){return!!e?.field&&void 0!==e.lte;}function fr2(e){return!!e?.field&&void 0!==e.gt;}function dr2(e){return!!e?.field&&void 0!==e.gte;}function mr2(e){if(e?.field){if(w(e.range)&&2===e.range.length)return!0;if(Rn6(e.range))return!0;}return!1;}function pr2(e){return!!e?.field&&(w(e.oneOf)||w(e.in));}function gr3(e){return pr2(e)||cr3(e)||mr2(e)||lr3(e)||fr2(e)||ur3(e)||dr2(e);}function hr2(e,t){return Ya(e,{timeUnit:t,wrapTime:!0});}function yr2(e,t=!0){const{field:n}=e,i=rr3(e.timeUnit),{unit:r,binned:o}=i||{},a=Pa(e,{expr:"datum"}),s=r?`time(${o?a:nr2(r,n)})`:a;if(cr3(e))return`${s}===${hr2(e.equal,r)}`;if(lr3(e)){return`${s}<${hr2(e.lt,r)}`;}if(fr2(e)){return`${s}>${hr2(e.gt,r)}`;}if(ur3(e)){return`${s}<=${hr2(e.lte,r)}`;}if(dr2(e)){return`${s}>=${hr2(e.gte,r)}`;}if(pr2(e))return`indexof([${(function(e,t){return e.map(e=>hr2(e,t));})(e.oneOf,r).join(",")}], ${s}) !== -1`;if(function(e){return!!e?.field&&void 0!==e.valid;}(e))return vr2(s,e.valid);if(mr2(e)){const{range:n}=e,i=Rn6(n)?{signal:`${n.signal}[0]`}:n[0],o=Rn6(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==i&&null!==o&&t)return"inrange("+s+", ["+hr2(i,r)+", "+hr2(o,r)+"])";const a=[];return null!==i&&a.push(`${s} >= ${hr2(i,r)}`),null!==o&&a.push(`${s} <= ${hr2(o,r)}`),a.length>0?a.join(" && "):"true";}throw new Error(`Invalid field predicate: ${he7(e)}`);}function vr2(e,t=!0){return t?`isValid(${e}) && isFinite(+${e})`:`!isValid(${e}) || !isFinite(+${e})`;}function br2(e){return gr3(e)&&e.timeUnit?{...e,timeUnit:rr3(e.timeUnit)}:e;}function xr2(e){return"quantitative"===e||"temporal"===e;}function $r1(e){return"ordinal"===e||"nominal"===e;}const wr2="quantitative",kr2="ordinal",Sr2="temporal",Dr3="nominal",Fr2="geojson";const zr2="linear",Cr2="log",_r2="pow",Or2="sqrt",Pr3="time",Nr2="utc",Tr2="point",Er2="band",jr2={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Ar2(e,t){const n=jr2[e],i=jr2[t];return n===i||"ordinal-position"===n&&"time"===i||"ordinal-position"===i&&"time"===n;}const Mr2={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Rr2(e){return Mr2[e];}const qr1=new Set(["linear","log","pow","sqrt","symlog"]),Lr2=new Set([...qr1,"time","utc"]);function Ur1(e){return qr1.has(e);}const Wr1=new Set(["quantile","quantize","threshold"]),Br2=new Set([...Lr2,...Wr1,"sequential","identity"]),Ir3=new Set(["ordinal","bin-ordinal","point","band"]);function Hr1(e){return Ir3.has(e);}function Vr1(e){return Br2.has(e);}function Gr1(e){return Lr2.has(e);}function Yr1(e){return Wr1.has(e);}function Xr1(e){return e?.param;}const{type:Jr1,domain:Qr1,range:Kr1,rangeMax:Zr1,rangeMin:eo,scheme:to,...no1}={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},io=H21(no1);function ro(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(e);case"bins":return!["point","band","identity","ordinal"].includes(e);case"round":return Gr1(e)||"band"===e||"point"===e;case"padding":case"rangeMin":case"rangeMax":return Gr1(e)||["point","band"].includes(e);case"paddingOuter":case"align":return["point","band"].includes(e);case"paddingInner":return"band"===e;case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return Gr1(e);case"nice":return Gr1(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return Vr1(e)&&!T21(["log","time","utc","threshold","quantile"],e);}}function oo(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return at11(e)?void 0:`Cannot use the scale property "${t}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return;}}const ao={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},so=ao.arc,co=ao.area,lo=ao.bar,uo=ao.image,fo=ao.line,mo=ao.point,po=ao.rect,go=ao.rule,ho=ao.text,yo=ao.tick,vo=ao.trail,bo=ao.circle,xo=ao.square,$o=ao.geoshape;function wo(e){return["line","area","trail"].includes(e);}function ko(e){return["rect","bar","image","arc"].includes(e);}const So=new Set(H21(ao));function Do(e){return e.type;}const Fo=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],zo=H21({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),Co=H21({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function _o(e){return e&&null!=e.band;}const Oo={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Po={binSpacing:1,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},No={binSpacing:0,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5};function To(e,{isPath:t}){return void 0===e||"break-paths-show-path-domains"===e?t?"break-paths-show-domains":"filter":null===e?"show":e;}function Eo({markDef:e,config:t,scaleChannel:n,scaleType:i,isCountAggregate:r}){if(!i||!Vr1(i)||r)return"always-valid";const o=To(Zn5("invalid",e,t),{isPath:wo(e.type)}),a=t.scale?.invalid?.[n];return void 0!==a?"show":o;}function jo({scaleName:e,scale:t,mode:n}){const i=`domain('${e}')`;if(!t||!e)return;const r=`${i}[0]`,o=`peek(${i})`,a=t.domainHasZero();if("definitely"===a)return{scale:e,value:0};if("maybe"===a){return{signal:`scale('${e}', inrange(0, ${i}) ? 0 : ${"zeroOrMin"===n?r:o})`};}return{signal:`scale('${e}', ${"zeroOrMin"===n?r:o})`};}function Ao({scaleChannel:e,channelDef:t,scale:n,scaleName:i,markDef:r,config:o}){const a=n?.get("type"),s=La(t),c=Eo({scaleChannel:e,markDef:r,config:o,scaleType:a,isCountAggregate:Dn7(s?.aggregate)});if(s&&"show"===c){const t=o.scale.invalid?.[e]??"zero-or-min";return{test:vr2(Pa(s,{expr:"datum"}),!1),...Mo(t,n,i)};}}function Mo(e,t,n){if(E(i=e)&&"value"in i){const{value:t}=e;return Rn6(t)?{signal:t.signal}:{value:t};}var i;return jo({scale:t,scaleName:n,mode:"zeroOrMin"});}function Ro(e){const{channel:t,channelDef:n,markDef:i,scale:r,scaleName:o,config:a}=e,s=wt8(t),c=Uo(e),l=Ao({scaleChannel:s,channelDef:n,scale:r,scaleName:o,markDef:i,config:a});return void 0!==l?[l,c]:c;}function qo(e,t,n,i){const r={};if(t&&(r.scale=t),ba(e)){const{datum:t}=e;Li2(t)?r.signal=Vi1(t):Rn6(t)?r.signal=t.signal:En7(t)?r.signal=t.expr:r.value=t;}else r.field=Pa(e,n);if(i){const{offset:e,band:t}=i;e&&(r.offset=e),t&&(r.band=t);}return r;}function Lo({scaleName:e,fieldOrDatumDef:t,fieldOrDatumDef2:n,offset:i,startSuffix:r,endSuffix:o="end",bandPosition:a=.5}){const s=!Rn6(a)&&0<a&&a<1?"datum":void 0,c=Pa(t,{expr:s,suffix:r}),l=void 0!==n?Pa(n,{expr:s}):Pa(t,{suffix:o,expr:s}),u={};if(0===a||1===a){u.scale=e;const t=0===a?c:l;u.field=t;}else{const t=Rn6(a)?`(1-${a.signal}) * ${c} + ${a.signal} * ${l}`:`${1-a} * ${c} + ${a} * ${l}`;u.signal=`scale("${e}", ${t})`;}return i&&(u.offset=i),u;}function Uo({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:c,defaultRef:l,bandPosition:u}){if(t){if(ka(t)){const l=a?.get("type");if(Sa1(t)){u??(u=ua1({fieldDef:t,fieldDef2:n,markDef:i,config:r}));const{bin:a,timeUnit:f,type:d}=t;if(_n6(a)||u&&f&&d===Sr2)return s?.impute?qo(t,o,{binSuffix:"mid"},{offset:c}):u&&!Hr1(l)?Lo({scaleName:o,fieldOrDatumDef:t,bandPosition:u,offset:c}):qo(t,o,Ja1(t,e)?{binSuffix:"range"}:{},{offset:c});if(On7(a)){if(ya(n))return Lo({scaleName:o,fieldOrDatumDef:t,fieldOrDatumDef2:n,bandPosition:u,offset:c});qi2(Ai2(e===xe6?we6:ke5));}}return qo(t,o,Hr1(l)?{binSuffix:"range"}:{},{offset:c,band:"band"===l?u??t.bandPosition??.5:void 0});}if(Da1(t)){const n=c?{offset:c}:{};return{...Wo(e,t.value),...n};}}return L(l)&&(l=l()),l?{...l,...c?{offset:c}:{}}:l;}function Wo(e,t){return T21(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:T21(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:Gn5(t);}function Bo(e){return e&&"number"!==e&&"time"!==e;}function Io(e,t,n){return`${e}(${t}${n?`, ${he7(n)}`:""})`;}function Ho({fieldOrDatumDef:e,format:t,formatType:i,expr:r,normalizeStack:o,config:a}){if(Bo(i))return Go({fieldOrDatumDef:e,format:t,formatType:i,expr:r,config:a});const s=Vo(e,r,o),c=va(e);if(void 0===t&&void 0===i&&a.customFormatTypes){if("quantitative"===c){if(o&&a.normalizedNumberFormatType)return Go({fieldOrDatumDef:e,format:a.normalizedNumberFormat,formatType:a.normalizedNumberFormatType,expr:r,config:a});if(a.numberFormatType)return Go({fieldOrDatumDef:e,format:a.numberFormat,formatType:a.numberFormatType,expr:r,config:a});}if("temporal"===c&&a.timeFormatType&&ya(e)&&void 0===e.timeUnit)return Go({fieldOrDatumDef:e,format:a.timeFormat,formatType:a.timeFormatType,expr:r,config:a});}if(Ga(e)){const i=function({field:e,timeUnit:t,format:i,formatType:r,rawTimeFormat:o,isUTCScale:a}){return!t||i?!t&&r?`${r}(${e}, '${i}')`:`${a?"utc":"time"}Format(${e}, '${i=Mn(i)?i:o}')`:function(e,t,n){if(!e)return;const i=ir2(e);return`${n||Qi2(e)?"utc":"time"}Format(${t}, ${i})`;}(t,e,a);}({field:s,timeUnit:ya(e)?rr3(e.timeUnit)?.unit:void 0,format:t,formatType:a.timeFormatType,rawTimeFormat:a.timeFormat,isUTCScale:Fa(e)&&e.scale?.type===Nr2});return i?{signal:i}:void 0;}if(t=Jo({type:c,specifiedFormat:t,config:a,normalizeStack:o}),ya(e)&&_n6(e.bin)){return{signal:Zo(s,Pa(e,{expr:r,binSuffix:"end"}),t,i,a)};}return t||"quantitative"===va(e)?{signal:`${Qo(s,t)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`};}function Vo(e,t,n){return ya(e)?n?`${Pa(e,{expr:t,suffix:"end"})}-${Pa(e,{expr:t,suffix:"start"})}`:Pa(e,{expr:t}):function(e){const{datum:t}=e;return Li2(t)?Vi1(t):`${he7(t)}`;}(e);}function Go({fieldOrDatumDef:e,format:t,formatType:n,expr:i,normalizeStack:r,config:o,field:a}){if(a??(a=Vo(e,i,r)),"datum.value"!==a&&ya(e)&&_n6(e.bin)){return{signal:Zo(a,Pa(e,{expr:i,binSuffix:"end"}),t,n,o)};}return{signal:Io(n,a,t)};}function Yo(e,t,i,r,o,a){if(!Mn(r)||!Bo(r)){if(void 0===i&&void 0===r&&o.customFormatTypes&&"quantitative"===va(e)){if(o.normalizedNumberFormatType&&za1(e)&&"normalize"===e.stack)return;if(o.numberFormatType)return;}if(za1(e)&&"normalize"===e.stack&&o.normalizedNumberFormat)return Jo({type:"quantitative",config:o,normalizeStack:!0});if(Ga(e)){const t=ya(e)?rr3(e.timeUnit)?.unit:void 0;if(void 0===t&&o.customFormatTypes&&o.timeFormatType)return;return function({specifiedFormat:e,timeUnit:t,config:n,omitTimeFormatConfig:i}){if(e)return e;if(t)return{signal:ir2(t)};return i?void 0:n.timeFormat;}({specifiedFormat:i,timeUnit:t,config:o,omitTimeFormatConfig:a});}return Jo({type:t,specifiedFormat:i,config:o});}}function Xo(e,t,n){return e&&(Rn6(e)||"number"===e||"time"===e)?e:Ga(t)&&"time"!==n&&"utc"!==n?ya(t)&&rr3(t?.timeUnit)?.utc?"utc":"time":void 0;}function Jo({type:e,specifiedFormat:t,config:i,normalizeStack:r}){return Mn(t)?t:e===wr2?r?i.normalizedNumberFormat:i.numberFormat:void 0;}function Qo(e,t){return`format(${e}, "${t||""}")`;}function Ko(e,t,i,r){return Bo(i)?Io(i,e,t):Qo(e,(Mn(t)?t:void 0)??r.numberFormat);}function Zo(e,t,n,i,r){if(void 0===n&&void 0===i&&r.customFormatTypes&&r.numberFormatType)return Zo(e,t,r.numberFormat,r.numberFormatType,r);const o=Ko(e,n,i,r),a=Ko(t,n,i,r);return`${vr2(e,!1)} ? "null" : ${o} + " â€“ " + ${a}`;}const ea="min",ta={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function na(e){return e in ta;}function ia(e){return e&&("count"===e.op||!!e.field);}function ra(e){return e&&w(e);}function oa(e){return"row"in e||"column"in e;}function aa(e){return!!e&&"header"in e;}function sa(e){return"facet"in e;}function ca1(e){const{field:t,timeUnit:n,bin:i,aggregate:r}=e;return{...n?{timeUnit:n}:{},...i?{bin:i}:{},...r?{aggregate:r}:{},field:t};}function la(e){return"sort"in e;}function ua1({fieldDef:e,fieldDef2:t,markDef:n,config:i}){if(ka(e)&&void 0!==e.bandPosition)return e.bandPosition;if(ya(e)){const{timeUnit:r,bin:o}=e;if(r&&!t)return ei3("timeUnitBandPosition",n,i);if(_n6(o))return .5;}}function fa({channel:e,fieldDef:t,fieldDef2:n,markDef:i,config:r,scaleType:o,useVlSizeChannel:a}){const s=Dt8(e),c=Zn5(a?"size":s,i,r,{vgChannel:s});if(void 0!==c)return c;if(ya(t)){const{timeUnit:e,bin:a}=t;if(e&&!n)return{band:ei3("timeUnitBandSize",i,r)};if(_n6(a)&&!Hr1(o))return{band:1};}return ko(i.type)?o?Hr1(o)?r[i.type]?.discreteBandSize||{band:1}:r[i.type]?.continuousBandSize:r[i.type]?.discreteBandSize:void 0;}function da(e,t,n,i){return!!(_n6(e.bin)||e.timeUnit&&Sa1(e)&&"temporal"===e.type)&&void 0!==ua1({fieldDef:e,fieldDef2:t,markDef:n,config:i});}function ma(e){return e&&!!e.sort&&!e.field;}function pa(e){return e&&"condition"in e;}function ga(e){const t=e?.condition;return!!t&&!w(t)&&ya(t);}function ha(e){const t=e?.condition;return!!t&&!w(t)&&ka(t);}function ya(e){return e&&(!!e.field||"count"===e.aggregate);}function va(e){return e?.type;}function ba(e){return e&&"datum"in e;}function xa(e){return Sa1(e)&&!Na(e)||wa(e);}function $a(e){return Sa1(e)&&"quantitative"===e.type&&!e.bin||wa(e);}function wa(e){return ba(e)&&yn(e.datum);}function ka(e){return ya(e)||ba(e);}function Sa1(e){return e&&("field"in e||"count"===e.aggregate)&&"type"in e;}function Da1(e){return e&&"value"in e&&"value"in e;}function Fa(e){return e&&("scale"in e||"sort"in e);}function za1(e){return e&&("axis"in e||"stack"in e||"impute"in e);}function Ca(e){return e&&"legend"in e;}function _a1(e){return e&&("format"in e||"formatType"in e);}function Oa(e){return O20(e,["legend","axis","header","scale"]);}function Pa(e,t={}){let n=e.field;const i=t.prefix;let r=t.suffix,o="";if(function(e){return"count"===e.aggregate;}(e))n=ue8("count");else{let i;if(!t.nofn)if(function(e){return"op"in e;}(e))i=e.op;else{const{bin:a,aggregate:s,timeUnit:c}=e;_n6(a)?(i=Cn6(a),r=(t.binSuffix??"")+(t.suffix??"")):s?wn8(s)?(o=`["${n}"]`,n=`argmax_${s.argmax}`):$n5(s)?(o=`["${n}"]`,n=`argmin_${s.argmin}`):i=String(s):c&&!Xi2(c)&&(i=function(e){const{utc:t,...n}=rr3(e);return n.unit?(t?"utc":"")+H21(n).map(e=>X22(`${"unit"===e?"":`_${e}_`}${n[e]}`)).join(""):(t?"utc":"")+"timeunit"+H21(n).map(e=>X22(`_${e}_${n[e]}`)).join("");}(c),r=(!["range","mid"].includes(t.binSuffix)&&t.binSuffix||"")+(t.suffix??""));}i&&(n=n?`${i}_${n}`:i);}return r&&(n=`${n}_${r}`),i&&(n=`${i}_${n}`),t.forAs?re9(n):t.expr?ee8(n,t.expr)+o:ne8(n)+o;}function Na(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return ya(e)&&!!e.bin;case"temporal":return!1;}throw new Error($i3(e.type));}const Ta1=(e,t)=>{switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){const{aggregate:t,bin:n,timeUnit:i,field:r}=e;if(wn8(t))return`${r} for argmax(${t.argmax})`;if($n5(t))return`${r} for argmin(${t.argmin})`;const o=i&&!Xi2(i)?rr3(i):void 0,a=t||o?.unit||o?.maxbins&&"timeunit"||_n6(n)&&"bin";return a?`${a.toUpperCase()}(${r})`:r;}(e);default:return function(e,t){const{field:n,bin:i,timeUnit:r,aggregate:o}=e;if("count"===o)return t.countTitle;if(_n6(i))return`${n} (binned)`;if(r&&!Xi2(r)){const e=rr3(r)?.unit;if(e)return`${n} (${Zi2(e).join("-")})`;}else if(o)return wn8(o)?`${n} for max ${o.argmax}`:$n5(o)?`${n} for min ${o.argmin}`:`${K24(o)} of ${n}`;return n;}(e,t);}};let Ea=Ta1;function ja(e){Ea=e;}function Aa(e,t,{allowDisabling:n,includeDefault:i=!0}){const r=Ma(e)?.title;if(!ya(e))return r??e.title;const o=e,a=i?Ra(o,t):void 0;return n?ae9(r,o.title,a):r??o.title??a;}function Ma(e){return za1(e)&&e.axis?e.axis:Ca(e)&&e.legend?e.legend:aa(e)&&e.header?e.header:void 0;}function Ra(e,t){return Ea(e,t);}function qa(e){if(_a1(e)){const{format:t,formatType:n}=e;return{format:t,formatType:n};}{const t=Ma(e)??{},{format:n,formatType:i}=t;return{format:n,formatType:i};}}function La(e){return ya(e)?e:ga(e)?e.condition:void 0;}function Ua1(e){return ka(e)?e:ha(e)?e.condition:void 0;}function Wa1(e,i,r,o={}){if(Mn(e)||yn(e)||gn(e)){return qi2(function(e,t,n){return`Channel ${e} is a ${t}. Converted to {value: ${he7(n)}}.`;}(i,Mn(e)?"string":yn(e)?"number":"boolean",e)),{value:e};}return ka(e)?Ba(e,i,r,o):ha(e)?{...e,condition:Ba(e.condition,i,r,o)}:e;}function Ba(e,i,r,o){if(_a1(e)){const{format:t,formatType:n,...a}=e;if(Bo(n)&&!r.customFormatTypes)return qi2(bi3(i)),Ba(a,i,r,o);}else{const t=za1(e)?"axis":Ca(e)?"legend":aa(e)?"header":null;if(t&&e[t]){const{format:n,formatType:a,...s}=e[t];if(Bo(a)&&!r.customFormatTypes)return qi2(bi3(i)),Ba({...e,[t]:s},i,r,o);}}return ya(e)?Ia(e,i,o):function(e){let i=e.type;if(i)return e;const{datum:r}=e;return i=yn(r)?"quantitative":Mn(r)?"nominal":Li2(r)?"temporal":void 0,{...e,type:i};}(e);}function Ia(e,t,{compositeMark:i=!1}={}){const{aggregate:r,timeUnit:o,bin:a,field:s}=e,l={...e};if(i||!r||kn6(r)||wn8(r)||$n5(r)||(qi2(function(e){return`Invalid aggregation operator "${e}".`;}(r)),delete l.aggregate),o&&(l.timeUnit=rr3(o)),s&&(l.field=`${s}`),_n6(a)&&(l.bin=Ha(a,t)),On7(a)&&!Yt6(t)&&qi2(function(e){return`Channel ${e} should not be used with "binned" bin.`;}(t)),Sa1(l)){const{type:e}=l,t=function(e){if(e)switch(e=e.toLowerCase()){case"q":case wr2:return"quantitative";case"t":case Sr2:return"temporal";case"o":case kr2:return"ordinal";case"n":case Dr3:return"nominal";case Fr2:return"geojson";}}(e);e!==t&&(l.type=t),"quantitative"!==e&&Dn7(r)&&(qi2(function(e,t){return`Invalid field type "${e}" for aggregate: "${t}", using "quantitative" instead.`;}(e,r)),l.type="quantitative");}else if(!$t5(t)){const e=function(e,t){switch(t){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal";}if(la(e)&&w(e.sort))return"ordinal";const{aggregate:n,bin:i,timeUnit:r}=e;if(r)return"temporal";if(i||n&&!wn8(n)&&!$n5(n))return"quantitative";if(Fa(e)&&e.scale?.type)switch(jr2[e.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal";}return"nominal";}(l,t);l.type=e;}if(Sa1(l)){const{compatible:e,warning:n}=function(e,t){const n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:`Channel ${t} should not be used with a geojson data.`};switch(t){case ye6:case ve6:case be6:return Na(e)?Va:{compatible:!1,warning:Di2(t)};case xe6:case $e3:case Se5:case De5:case Ee5:case je4:case Ae5:case He5:case Ge4:case Ye4:case Xe4:case Je4:case Qe4:case qe4:case Ce6:case Fe5:case Ke3:return Va;case Pe5:case Te5:case Oe5:case Ne6:return n!==wr2?{compatible:!1,warning:`Channel ${t} should be used with a quantitative field only, not ${e.type} field.`}:Va;case Le5:case Ue5:case We3:case Be5:case Re5:case _e6:case ze6:case we6:case ke5:return"nominal"!==n||e.sort?Va:{compatible:!1,warning:`Channel ${t} should not be used with an unsorted discrete field.`};case Me6:case Ie6:return Na(e)||Fa(i=e)&&Yr1(i.scale?.type)?Va:{compatible:!1,warning:Fi2(t)};case Ve3:return"nominal"!==e.type||"sort"in e?Va:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."};}var i;}(l,t)||{};!1===e&&qi2(n);}if(la(l)&&Mn(l.sort)){const{sort:e}=l;if(na(e))return{...l,sort:{encoding:e}};const t=e.substr(1);if("-"===e.charAt(0)&&na(t))return{...l,sort:{encoding:t,order:"descending"}};}if(aa(l)){const{header:e}=l;if(e){const{orient:t,...n}=e;if(t)return{...l,header:{...n,labelOrient:e.labelOrient||t,titleOrient:e.titleOrient||t}};}}return l;}function Ha(e,t){return gn(e)?{maxbins:Tn6(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:{...e,maxbins:Tn6(t)};}const Va={compatible:!0};function Ga(e){const{formatType:t}=qa(e);return"time"===t||!t&&(n=e)&&("temporal"===n.type||ya(n)&&!!n.timeUnit);var n;}function Ya(e,{timeUnit:i,type:r,wrapTime:o,undefinedIfExprNotRequired:a}){const s=i&&rr3(i)?.unit;let c,l=s||"temporal"===r;return En7(e)?c=e.expr:Rn6(e)?c=e.signal:Li2(e)?(l=!0,c=Vi1(e)):(Mn(e)||yn(e))&&l&&(c=`datetime(${he7(e)})`,function(e){return!!Gi2[e];}(s)&&(yn(e)&&e<1e4||Mn(e)&&isNaN(Date.parse(e)))&&(c=Vi1({[s]:e}))),c?o&&l?`time(${c})`:c:a?void 0:he7(e);}function Xa1(e,t){const{type:n}=e;return t.map(t=>{const i=Ya(t,{timeUnit:ya(e)&&!Xi2(e.timeUnit)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==i?{signal:i}:t;});}function Ja1(e,t){return _n6(e.bin)?mn8(t)&&["ordinal","nominal"].includes(e.type):(console.warn("Only call this method for binned field defs."),!1);}const Qa={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Ka(e){return e?.condition;}const Za1=["domain","grid","labels","ticks","title"],es={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},ts={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},ns={...ts,style:1,labelExpr:1,encoding:1};function is(e){return!!ns[e];}const rs=H21({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function os(e){return"mark"in e;}class as{constructor(e,t){this.name=e,this.run=t;}hasMatchingType(e){return!!os(e)&&(Do(t=e.mark)?t.type:t)===this.name;var t;}}function ss(e,t){const n=e&&e[t];return!!n&&(w(n)?E24(n,e=>!!e.field):ya(n)||ga(n));}function cs(e,t){const n=e&&e[t];return!!n&&(w(n)?E24(n,e=>!!e.field):ya(n)||ba(n)||ha(n));}function ls(e,t){if(Yt6(t)){const n=e[t];if((ya(n)||ba(n))&&($r1(n.type)||ya(n)&&n.timeUnit)){return cs(e,zt7(t));}}return!1;}function us(e){return E24(ut9,t=>{if(ss(e,t)){const n=e[t];if(w(n))return E24(n,e=>!!e.aggregate);{const e=La(n);return e&&!!e.aggregate;}}return!1;});}function fs(e,t){const n=[],i=[],r=[],o=[],a={};return ps(e,(s,c)=>{if(ya(s)){const{field:l,aggregate:u,bin:f,timeUnit:d,...m}=s;if(u||d||f){const e=Ma(s),p=e?.title;let g=Pa(s,{forAs:!0});const h={...p?[]:{title:Aa(s,t,{allowDisabling:!0})},...m,field:g};if(u){let e;if(wn8(u)?(e="argmax",g=Pa({op:"argmax",field:u.argmax},{forAs:!0}),h.field=`${g}.${l}`):$n5(u)?(e="argmin",g=Pa({op:"argmin",field:u.argmin},{forAs:!0}),h.field=`${g}.${l}`):"boxplot"!==u&&"errorbar"!==u&&"errorband"!==u&&(e=u),e){const t={op:e,as:g};l&&(t.field=l),o.push(t);}}else if(n.push(g),Sa1(s)&&_n6(f)){if(i.push({bin:f,field:l,as:g}),n.push(Pa(s,{binSuffix:"end"})),Ja1(s,c)&&n.push(Pa(s,{binSuffix:"range"})),Yt6(c)){const e={field:`${g}_end`};a[`${c}2`]=e;}h.bin="binned",$t5(c)||(h.type=wr2);}else if(d&&!Xi2(d)){r.push({timeUnit:d,field:l,as:g});const e=Sa1(s)&&s.type!==Sr2&&"time";e&&(c===He5||c===Xe4?h.formatType=e:!function(e){return!!It6[e];}(c)?Yt6(c)&&(h.axis={formatType:e,...h.axis}):h.legend={formatType:e,...h.legend});}a[c]=h;}else n.push(l),a[c]=e[c];}else a[c]=e[c];}),{bins:i,timeUnits:r,aggregate:o,groupby:n,encoding:a};}function ds(e,t,n){const i=pn8(t,n);if(!i)return!1;if("binned"===i){const n=e[t===we6?xe6:$e3];return!!(ya(n)&&ya(e[t])&&On7(n.bin));}return!0;}function ms(e,t){const n={};for(const i of H21(e)){const r=Wa1(e[i],i,t,{compositeMark:!0});n[i]=r;}return n;}function ps(e,t,n){if(e)for(const i of H21(e)){const r=e[i];if(w(r))for(const e of r)t.call(n,e,i);else t.call(n,r,i);}}function gs(e,t){return H21(t).reduce((n,i)=>{switch(i){case xe6:case $e3:case Je4:case Ke3:case Qe4:case we6:case ke5:case Se5:case De5:case Ce6:case _e6:case Fe5:case ze6:case Oe5:case Pe5:case Ne6:case Te5:case He5:case Me6:case qe4:case Xe4:return n;case Ve3:if("line"===e||"trail"===e)return n;case Ge4:case Ye4:{const e=t[i];if(w(e)||ya(e))for(const t of H(e))t.aggregate||n.push(Pa(t,{}));return n;}case Re5:if("trail"===e)return n;case Ee5:case je4:case Ae5:case Le5:case Ue5:case We3:case Ie6:case Be5:{const e=La(t[i]);return e&&!e.aggregate&&n.push(Pa(e,{})),n;}}},[]);}function hs(e,t,n,i=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...e.map(({fieldPrefix:e,titlePrefix:n})=>{const r=i?` of ${ys(t)}`:"";return{field:e+t.field,type:t.type,title:Rn6(n)?{signal:`${n}"${escape(r)}"`}:n+r};}),...R20((function(e){const t=[];for(const n of H21(e))if(ss(e,n)){const i=e[n],r=H(i);for(const e of r)ya(e)?t.push(e):ga(e)&&t.push(e.condition);}return t;})(n).map(Oa),P20)]};}function ys(e){const{title:t,field:n}=e;return ae9(t,n);}function vs(e,t,i,r,o){const{scale:a,axis:s}=i;return({partName:c,mark:l,positionPrefix:u,endPositionPrefix:f,extraEncoding:d={}})=>{const m=ys(i);return bs(e,c,o,{mark:l,encoding:{[t]:{field:`${u}_${i.field}`,type:i.type,...void 0!==m?{title:m}:{},...void 0!==a?{scale:a}:{},...void 0!==s?{axis:s}:{}},...Mn(f)?{[`${t}2`]:{field:`${f}_${i.field}`}}:{},...r,...d}});};}function bs(e,t,n,i){const{clip:r,color:o,opacity:a}=e,c=e.type;return e[t]||void 0===e[t]&&n[t]?[{...i,mark:{...n[t],...r?{clip:r}:{},...o?{color:o}:{},...a?{opacity:a}:{},...Do(i.mark)?i.mark:{type:i.mark},style:`${c}-${String(t)}`,...gn(e[t])?{}:e[t]}}]:[];}function xs(e,t,n){const{encoding:i}=e,r="vertical"===t?"y":"x",o=i[r],a=i[`${r}2`],s=i[`${r}Error`],c=i[`${r}Error2`];return{continuousAxisChannelDef:$s(o,n),continuousAxisChannelDef2:$s(a,n),continuousAxisChannelDefError:$s(s,n),continuousAxisChannelDefError2:$s(c,n),continuousAxis:r};}function $s(e,t){if(e?.aggregate){const{aggregate:n,...i}=e;return n!==t&&qi2(function(e,t){return`Continuous axis should not have customized aggregation function ${e}; ${t} already agregates the axis.`;}(n,t)),i;}return e;}function ws(e,t){const{mark:n,encoding:i}=e,{x:r,y:o}=i;if(Do(n)&&n.orient)return n.orient;if(xa(r)){if(xa(o)){const e=ya(r)&&r.aggregate,n=ya(o)&&o.aggregate;if(e||n!==t){if(n||e!==t){if(e===t&&n===t)throw new Error("Both x and y cannot have aggregate");return Ga(o)&&!Ga(r)?"horizontal":"vertical";}return"horizontal";}return"vertical";}return"horizontal";}if(xa(o))return"vertical";throw new Error(`Need a valid continuous axis for ${t}s`);}const ks="boxplot",Ss=new as(ks,Fs);function Ds(e){return yn(e)?"tukey":e;}function Fs(e,{config:t}){e={...e,encoding:ms(e.encoding,t)};const{mark:n,encoding:i,params:r,projection:o,...s}=e,l=Do(n)?n:{type:n};r&&qi2(gi3("boxplot"));const u=l.extent??t.boxplot.extent,f=Zn5("size",l,t),d=l.invalid,m=Ds(u),{bins:p,timeUnits:g,transform:h,continuousAxisChannelDef:y,continuousAxis:v,groupby:b,aggregate:x,encodingWithoutContinuousAxis:$,ticksOrient:w1,boxOrient:k,customTooltipWithoutAggregatedField:S}=function(e,t,n){const i=ws(e,ks),{continuousAxisChannelDef:r,continuousAxis:o}=xs(e,i,ks),a=r.field,s=re9(a),l=Ds(t),u=[...zs(a),{op:"median",field:a,as:`mid_box_${s}`},{op:"min",field:a,as:("min-max"===l?"lower_whisker_":"min_")+s},{op:"max",field:a,as:("min-max"===l?"upper_whisker_":"max_")+s}],f="min-max"===l||"tukey"===l?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${t}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${t}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],{[o]:d,...m}=e.encoding,{customTooltipWithoutAggregatedField:p,filteredEncoding:g}=function(e){const{tooltip:t,...n}=e;if(!t)return{filteredEncoding:n};let i,r;if(w(t)){for(const e of t)e.aggregate?(i||(i=[]),i.push(e)):(r||(r=[]),r.push(e));i&&(n.tooltip=i);}else t.aggregate?n.tooltip=t:r=t;return w(r)&&1===r.length&&(r=r[0]),{customTooltipWithoutAggregatedField:r,filteredEncoding:n};}(m),{bins:h,timeUnits:y,aggregate:v,groupby:b,encoding:x}=fs(g,n),$="vertical"===i?"horizontal":"vertical",w1=i,k=[...h,...y,{aggregate:[...v,...u],groupby:b},...f];return{bins:h,timeUnits:y,transform:k,groupby:b,aggregate:v,continuousAxisChannelDef:r,continuousAxis:o,encodingWithoutContinuousAxis:x,ticksOrient:$,boxOrient:w1,customTooltipWithoutAggregatedField:p};}(e,u,t),D=re9(y.field),{color:F,size:z,...C}=$,_=e=>vs(l,v,y,e,t.boxplot),P=_(C),N=_($),T=(E(t.boxplot.box)?t.boxplot.box.color:t.mark.color)||"#4c78a8",E1=_({...C,...z?{size:z}:{},color:{condition:{test:`datum['lower_box_${y.field}'] >= datum['upper_box_${y.field}']`,...F||{value:T}}}}),j=hs([{fieldPrefix:"min-max"===m?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===m?"lower_whisker_":"min_",titlePrefix:"Min"}],y,$),A={type:"tick",color:"black",opacity:1,orient:w1,invalid:d,aria:!1},M="min-max"===m?j:hs([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],y,$),R=[...P({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:M}),...P({partName:"rule",mark:{type:"rule",invalid:d,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:M}),...P({partName:"ticks",mark:A,positionPrefix:"lower_whisker",extraEncoding:M}),...P({partName:"ticks",mark:A,positionPrefix:"upper_whisker",extraEncoding:M})],q=[..."tukey"!==m?R:[],...N({partName:"box",mark:{type:"bar",...f?{size:f}:{},orient:k,invalid:d,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:j}),...E1({partName:"median",mark:{type:"tick",invalid:d,...E(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},...f?{size:f}:{},orient:w1,aria:!1},positionPrefix:"mid_box",extraEncoding:j})];if("min-max"===m)return{...s,transform:(s.transform??[]).concat(h),layer:q};const L=`datum["lower_box_${y.field}"]`,U=`datum["upper_box_${y.field}"]`,W=`(${U} - ${L})`,B=`${L} - ${u} * ${W}`,H=`${U} + ${u} * ${W}`,V=`datum["${y.field}"]`,G={joinaggregate:zs(y.field),groupby:b},Y={transform:[{filter:`(${B} <= ${V}) && (${V} <= ${H})`},{aggregate:[{op:"min",field:y.field,as:`lower_whisker_${D}`},{op:"max",field:y.field,as:`upper_whisker_${D}`},{op:"min",field:`lower_box_${y.field}`,as:`lower_box_${D}`},{op:"max",field:`upper_box_${y.field}`,as:`upper_box_${D}`},...x],groupby:b}],layer:R},{tooltip:X,...J}=C,{scale:Q,axis:K}=y,Z=ys(y),ee=O20(K,["title"]),te=bs(l,"outliers",t.boxplot,{transform:[{filter:`(${V} < ${B}) || (${V} > ${H})`}],mark:"point",encoding:{[v]:{field:y.field,type:y.type,...void 0!==Z?{title:Z}:{},...void 0!==Q?{scale:Q}:{},...I19(ee)?{}:{axis:ee}},...J,...F?{color:F}:{},...S?{tooltip:S}:{}}})[0];let ne;const ie=[...p,...g,G];return te?ne={transform:ie,layer:[te,Y]}:(ne=Y,ne.transform.unshift(...ie)),{...s,layer:[ne,{transform:h,layer:q}]};}function zs(e){const t=re9(e);return[{op:"q1",field:e,as:`lower_box_${t}`},{op:"q3",field:e,as:`upper_box_${t}`}];}const Cs="errorbar",_s=new as(Cs,Os);function Os(e,{config:t}){e={...e,encoding:ms(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:c,tooltipEncoding:l}=Ns(e,Cs,t);delete o.size;const u=vs(s,r,i,o,t.errorbar),f=s.thickness,d=s.size,m={type:"tick",orient:a,aria:!1,...void 0!==f?{thickness:f}:{},...void 0!==d?{size:d}:{}},p=[...u({partName:"ticks",mark:m,positionPrefix:"lower",extraEncoding:l}),...u({partName:"ticks",mark:m,positionPrefix:"upper",extraEncoding:l}),...u({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==f?{size:f}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return{...c,transform:n,...p.length>1?{layer:p}:{...p[0]}};}function Ps(e,t){const{encoding:n}=e;if(function(e){return(ka(e.x)||ka(e.y))&&!ka(e.x2)&&!ka(e.y2)&&!ka(e.xError)&&!ka(e.xError2)&&!ka(e.yError)&&!ka(e.yError2);}(n))return{orient:ws(e,t),inputType:"raw"};const i=function(e){return ka(e.x2)||ka(e.y2);}(n),r=function(e){return ka(e.xError)||ka(e.xError2)||ka(e.yError)||ka(e.yError2);}(n),o=n.x,a=n.y;if(i){if(r)throw new Error(`${t} cannot be both type aggregated-upper-lower and aggregated-error`);const e=n.x2,i=n.y2;if(ka(e)&&ka(i))throw new Error(`${t} cannot have both x2 and y2`);if(ka(e)){if(xa(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${t}`);}if(ka(i)){if(xa(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${t}`);}throw new Error("No ranged axis");}{const e=n.xError,i=n.xError2,r=n.yError,s=n.yError2;if(ka(i)&&!ka(e))throw new Error(`${t} cannot have xError2 without xError`);if(ka(s)&&!ka(r))throw new Error(`${t} cannot have yError2 without yError`);if(ka(e)&&ka(r))throw new Error(`${t} cannot have both xError and yError with both are quantiative`);if(ka(e)){if(xa(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative");}if(ka(r)){if(xa(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative");}throw new Error("No ranged axis");}}function Ns(e,t,n){const{mark:i,encoding:r,params:o,projection:a,...s}=e,c=Do(i)?i:{type:i};o&&qi2(gi3(t));const{orient:l,inputType:u}=Ps(e,t),{continuousAxisChannelDef:f,continuousAxisChannelDef2:d,continuousAxisChannelDefError:m,continuousAxisChannelDefError2:p,continuousAxis:g}=xs(e,l,t),{errorBarSpecificAggregate:h,postAggregateCalculates:y,tooltipSummary:v,tooltipTitleWithFieldName:b}=function(e,t,n,i,r,o,a,s){let c=[],l=[];const u=t.field;let f,d=!1;if("raw"===o){const t=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,n=e.extent?e.extent:"mean"===t?"stderr":"iqr";if("median"===t!=("iqr"===n)&&qi2(function(e,t,n){return`${e} is not usually used with ${t} for ${n}.`;}(t,n,a)),"stderr"===n||"stdev"===n)c=[{op:n,field:u,as:`extent_${u}`},{op:t,field:u,as:`center_${u}`}],l=[{calculate:`datum["center_${u}"] + datum["extent_${u}"]`,as:`upper_${u}`},{calculate:`datum["center_${u}"] - datum["extent_${u}"]`,as:`lower_${u}`}],f=[{fieldPrefix:"center_",titlePrefix:K24(t)},{fieldPrefix:"upper_",titlePrefix:Ts(t,n,"+")},{fieldPrefix:"lower_",titlePrefix:Ts(t,n,"-")}],d=!0;else{let e,t,i;"ci"===n?(e="mean",t="ci0",i="ci1"):(e="median",t="q1",i="q3"),c=[{op:t,field:u,as:`lower_${u}`},{op:i,field:u,as:`upper_${u}`},{op:e,field:u,as:`center_${u}`}],f=[{fieldPrefix:"upper_",titlePrefix:Aa({field:u,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Aa({field:u,aggregate:t,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Aa({field:u,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}];}}else{(e.center||e.extent)&&qi2((m=e.center,`${(p=e.extent)?"extent ":""}${p&&m?"and ":""}${m?"center ":""}${p&&m?"are ":"is "}not needed when data are aggregated.`)),"aggregated-upper-lower"===o?(f=[],l=[{calculate:`datum["${n.field}"]`,as:`upper_${u}`},{calculate:`datum["${u}"]`,as:`lower_${u}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:u}],l=[{calculate:`datum["${u}"] + datum["${i.field}"]`,as:`upper_${u}`}],r?l.push({calculate:`datum["${u}"] + datum["${r.field}"]`,as:`lower_${u}`}):l.push({calculate:`datum["${u}"] - datum["${i.field}"]`,as:`lower_${u}`}));for(const e of l)f.push({fieldPrefix:e.as.substring(0,6),titlePrefix:ie8(ie8(e.calculate,'datum["',""),'"]',"")});}var m,p;return{postAggregateCalculates:l,errorBarSpecificAggregate:c,tooltipSummary:f,tooltipTitleWithFieldName:d};}(c,f,d,m,p,u,t,n),{[g]:x,["x"===g?"x2":"y2"]:$,["x"===g?"xError":"yError"]:w,["x"===g?"xError2":"yError2"]:k,...S}=r,{bins:D,timeUnits:F,aggregate:z,groupby:C,encoding:_}=fs(S,n),O=[...z,...h],P="raw"!==u?[]:C,N=hs(v,f,_,b);return{transform:[...s.transform??[],...D,...F,...0===O.length?[]:[{aggregate:O,groupby:P}],...y],groupby:P,continuousAxisChannelDef:f,continuousAxis:g,encodingWithoutContinuousAxis:_,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:c,outerSpec:s,tooltipEncoding:N};}function Ts(e,t,n){return`${K24(e)} ${n} ${t}`;}const Es="errorband",js=new as(Es,As);function As(e,{config:t}){e={...e,encoding:ms(e.encoding,t)};const{transform:n,continuousAxisChannelDef:i,continuousAxis:r,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:c}=Ns(e,Es,t),l=a,u=vs(l,r,i,o,t.errorband),f=void 0!==e.encoding.x&&void 0!==e.encoding.y;let d={type:f?"area":"rect"},m={type:f?"line":"rule"};const p={...l.interpolate?{interpolate:l.interpolate}:{},...l.tension&&l.interpolate?{tension:l.tension}:{}};return f?(d={...d,...p,ariaRoleDescription:"errorband"},m={...m,...p,aria:!1}):l.interpolate?qi2(ji2("interpolate")):l.tension&&qi2(ji2("tension")),{...s,transform:n,layer:[...u({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c}),...u({partName:"borders",mark:m,positionPrefix:"lower",extraEncoding:c}),...u({partName:"borders",mark:m,positionPrefix:"upper",extraEncoding:c})]};}const Ms={};function Rs(e,t,n){const i=new as(e,t);Ms[e]={normalizer:i,parts:n};}Rs(ks,Fs,["box","median","outliers","rule","ticks"]),Rs(Cs,Os,["ticks","rule"]),Rs(Es,As,["band","borders"]);const qs=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Ls={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Us={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Ws=H21(Ls),Bs=H21(Us),Is=H21({header:1,headerRow:1,headerColumn:1,headerFacet:1}),Hs=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Vs="_vgsid_",Gs={point:{on:"click",fields:[Vs],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Ys(e){return"legend"===e||!!e?.legend;}function Xs(e){return Ys(e)&&E(e);}function Js(e){return!!e?.select;}function Qs(e){const t=[];for(const n of e||[]){if(Js(n))continue;const{expr:e,bind:i,...r}=n;if(i&&e){const n={...r,bind:i,init:e};t.push(n);}else{const n={...r,...e?{update:e}:{},...i?{bind:i}:{}};t.push(n);}}return t;}function Ks(e){return"concat"in e;}function Zs(e){return"vconcat"in e;}function ec(e){return"hconcat"in e;}function tc({step:e,offsetIsDiscrete:t}){return t?e.for??"offset":"position";}function nc(e){return E(e)&&void 0!==e.step;}function ic(e){return e.view||e.width||e.height;}const rc=H21({align:1,bounds:1,center:1,columns:1,spacing:1});function oc(e,t){return e[t]??e["width"===t?"continuousWidth":"continuousHeight"];}function ac(e,t){const n=sc(e,t);return nc(n)?n.step:cc;}function sc(e,t){return ae9(e[t]??e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step});}const cc=20,lc={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:cc},mark:{color:"#4c78a8",invalid:"break-paths-show-path-domains",timeUnitBandSize:1},arc:{},area:{},bar:Po,circle:{},geoshape:{},image:{},line:{},point:{},rect:No,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,tickBandPaddingInner:.25,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:4,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Gs,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},uc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],fc={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},dc={blue:uc[0],orange:uc[1],red:uc[2],teal:uc[3],green:uc[4],yellow:uc[5],purple:uc[6],pink:uc[7],brown:uc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function mc(e){const t=H21(e||{}),n={};for(const i of t){const t=e[i];n[i]=Ka(t)?In6(t):Hn6(t);}return n;}const pc=[...Co,...rs,...Is,"background","padding","legend","lineBreak","scale","style","title","view"];function gc(e={}){const{color:t,font:n,fontSize:i,selection:r,...o}=e,s=k({},z23(lc),n?function(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}};}(n):{},t?function(e={}){return{signals:[{name:"color",value:E(e)?{...dc,...e}:dc}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}};}(t):{},i?function(e){return{signals:[{name:"fontSize",value:E(e)?{...fc,...e}:fc}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}};}(i):{},o||{});r&&x(s,"selection",r,!0);const c=O20(s,pc);for(const e of["background","lineBreak","padding"])s[e]&&(c[e]=Hn6(s[e]));for(const e of Co)s[e]&&(c[e]=jn8(s[e]));for(const e of rs)s[e]&&(c[e]=mc(s[e]));for(const e of Is)s[e]&&(c[e]=jn8(s[e]));if(s.legend&&(c.legend=jn8(s.legend)),s.scale){const{invalid:e,...t}=s.scale,n=jn8(e,{level:1});c.scale={...jn8(t),...H21(n).length>0?{invalid:n}:{}};}return s.style&&(c.style=function(e){const t=H21(e),n={};for(const i of t)n[i]=mc(e[i]);return n;}(s.style)),s.title&&(c.title=jn8(s.title)),s.view&&(c.view=jn8(s.view)),c;}const hc=new Set(["view",...So]),yc=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],vc={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]};function bc(e){e=z23(e);for(const t of yc)delete e[t];if(e.axis)for(const t in e.axis)Ka(e.axis[t])&&delete e.axis[t];if(e.legend)for(const t of qs)delete e.legend[t];if(e.mark){for(const t of zo)delete e.mark[t];e.mark.tooltip&&E(e.mark.tooltip)&&delete e.mark.tooltip;}e.params&&(e.signals=(e.signals||[]).concat(Qs(e.params)),delete e.params);for(const t of hc){for(const n of zo)delete e[t][n];const n=vc[t];if(n)for(const i of n)delete e[t][i];xc(e,t);}for(const t of H21(Ms))delete e[t];!function(e){const{titleMarkConfig:t,subtitleMarkConfig:n,subtitle:i}=An6(e.title);I19(t)||(e.style["group-title"]={...e.style["group-title"],...t});I19(n)||(e.style["group-subtitle"]={...e.style["group-subtitle"],...n});I19(i)?delete e.title:e.title=i;}(e);for(const t in e)E(e[t])&&I19(e[t])&&delete e[t];return I19(e)?void 0:e;}function xc(e,t,n,i){"view"===t&&(n="cell");const r={...i?e[t][i]:e[t],...e.style[n??t]};I19(r)||(e.style[n??t]=r),i||delete e[t];}function $c(e){return"layer"in e;}class wc{map(e,t){return sa(e)?this.mapFacet(e,t):function(e){return"repeat"in e;}(e)?this.mapRepeat(e,t):ec(e)?this.mapHConcat(e,t):Zs(e)?this.mapVConcat(e,t):Ks(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t);}mapLayerOrUnit(e,t){if($c(e))return this.mapLayer(e,t);if(os(e))return this.mapUnit(e,t);throw new Error(si3(e));}mapLayer(e,t){return{...e,layer:e.layer.map(e=>this.mapLayerOrUnit(e,t))};}mapHConcat(e,t){return{...e,hconcat:e.hconcat.map(e=>this.map(e,t))};}mapVConcat(e,t){return{...e,vconcat:e.vconcat.map(e=>this.map(e,t))};}mapConcat(e,t){const{concat:n,...i}=e;return{...i,concat:n.map(e=>this.map(e,t))};}mapFacet(e,t){return{...e,spec:this.map(e.spec,t)};}mapRepeat(e,t){return{...e,spec:this.map(e.spec,t)};}}const kc={zero:1,center:1,normalize:1};const Sc=new Set([so,lo,co,go,mo,bo,xo,fo,ho,yo]),Dc=new Set([lo,co,so]);function Fc(e){return ya(e)&&"quantitative"===va(e)&&!e.bin;}function zc(e,t,{orient:n,type:i}){const r="x"===t?"y":"radius",o="x"===t&&["bar","area"].includes(i),a=e[t],s=e[r];if(ya(a)&&ya(s))if(Fc(a)&&Fc(s)){if(a.stack)return t;if(s.stack)return r;const e=ya(a)&&!!a.aggregate;if(e!==(ya(s)&&!!s.aggregate))return e?t:r;if(o){if("vertical"===n)return r;if("horizontal"===n)return t;}}else{if(Fc(a))return t;if(Fc(s))return r;}else{if(Fc(a)){if(o&&"vertical"===n)return;return t;}if(Fc(s)){if(o&&"horizontal"===n)return;return r;}}}function Cc(e,t){const n=Do(e)?e:{type:e},i=n.type;if(!Sc.has(i))return null;const r=zc(t,"x",n)||zc(t,"theta",n);if(!r)return null;const o=t[r],a=ya(o)?Pa(o,{}):void 0,c=function(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta";}}(r),u=[],f=new Set;if(t[c]){const e=t[c],n=ya(e)?Pa(e,{}):void 0;n&&n!==a&&(u.push(c),f.add(n));}const d="x"===c?"xOffset":"yOffset",m=t[d],p=ya(m)?Pa(m,{}):void 0;p&&p!==a&&(u.push(d),f.add(p));const g=Ht6.reduce((e,n)=>{if("tooltip"!==n&&ss(t,n)){const i=t[n];for(const t of H(i)){const i=La(t);if(i.aggregate)continue;const r=Pa(i,{});r&&f.has(r)||e.push({channel:n,fieldDef:i});}}return e;},[]);let h;return void 0!==o.stack?h=gn(o.stack)?o.stack?"zero":null:o.stack:Dc.has(i)&&(h="zero"),h&&h in kc?us(t)&&0===g.length?null:(o?.scale?.type&&o?.scale?.type!==zr2&&o?.stack&&qi2(function(e){return`Stack is applied to a non-linear scale (${e}).`;}(o.scale.type)),ka(t[St6(r)])?(void 0!==o.stack&&qi2(`Cannot stack "${y=r}" if there is already "${y}2".`),null):(ya(o)&&o.aggregate&&!Fn6.has(o.aggregate)&&qi2(`Stacking is applied even though the aggregate function is non-summative ("${o.aggregate}").`),{groupbyChannels:u,groupbyFields:f,fieldChannel:r,impute:null!==o.impute&&wo(i),stackBy:g,offset:h})):null;var y;}function _c(e,t,n){const i=jn8(e),r=Zn5("orient",i,n);if(i.orient=function(e,t,n){switch(e){case mo:case bo:case xo:case ho:case po:case uo:return;}const{x:i,y:r,x2:o,y2:a}=t;switch(e){case lo:if(ya(i)&&(On7(i.bin)||ya(r)&&r.aggregate&&!i.aggregate))return"vertical";if(ya(r)&&(On7(r.bin)||ya(i)&&i.aggregate&&!r.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o)return(ya(i)&&i.type===wr2&&!_n6(i.bin)||wa(i))&&ya(r)&&On7(r.bin)?"horizontal":"vertical";if(!a)return(ya(r)&&r.type===wr2&&!_n6(r.bin)||wa(r))&&ya(i)&&On7(i.bin)?"vertical":"horizontal";}case go:if(o&&(!ya(i)||!On7(i.bin))&&a&&(!ya(r)||!On7(r.bin)))return;case co:if(a)return ya(r)&&On7(r.bin)?"horizontal":"vertical";if(o)return ya(i)&&On7(i.bin)?"vertical":"horizontal";if(e===go){if(i&&!r)return"vertical";if(r&&!i)return"horizontal";}case fo:case yo:{const t=$a(i),o=$a(r);if(n)return n;if(t&&!o)return"tick"!==e?"horizontal":"vertical";if(!t&&o)return"tick"!==e?"vertical":"horizontal";if(t&&o)return"vertical";{const e=Sa1(i)&&i.type===Sr2,t=Sa1(r)&&r.type===Sr2;if(e&&!t)return"vertical";if(!e&&t)return"horizontal";}return;}}return"vertical";}(i.type,t,r),void 0!==r&&r!==i.orient&&qi2(`Specified orient "${i.orient}" overridden with "${r}".`),"bar"===i.type&&i.orient){const e=Zn5("cornerRadiusEnd",i,n);if(void 0!==e){const n="horizontal"===i.orient&&t.x2||"vertical"===i.orient&&t.y2?["cornerRadius"]:Oo[i.orient];for(const t of n)i[t]=e;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd;}}const o=Zn5("opacity",i,n),a=Zn5("fillOpacity",i,n);void 0===o&&void 0===a&&(i.opacity=function(e,t){if(T21([mo,yo,bo,xo],e)&&!us(t))return .7;return;}(i.type,t));return void 0===Zn5("cursor",i,n)&&(i.cursor=function(e,t,n){if(t.href||e.href||Zn5("href",e,n))return"pointer";return e.cursor;}(i,t,n)),i;}function Oc(e){const{point:t,line:n,...i}=e;return H21(i).length>1?i:i.type;}function Pc(e){for(const t of["line","area","rule","trail"])e[t]&&(e={...e,[t]:O20(e[t],["point","line"])});return e;}function Nc(e,t={},n){return"transparent"===e.point?{opacity:0}:e.point?E(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?E(t.point)?t.point:{}:void 0;}function Tc(e,t={}){return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0;}class Ec{constructor(){this.name="path-overlay";}hasMatchingType(e,t){if(os(e)){const{mark:n,encoding:i}=e,r=Do(n)?n:{type:n};switch(r.type){case"line":case"rule":case"trail":return!!Nc(r,t[r.type],i);case"area":return!!Nc(r,t[r.type],i)||!!Tc(r,t[r.type]);}}return!1;}run(e,t,n){const{config:i}=t,{params:r,projection:o,mark:a,name:s,encoding:c,...l}=e,u=ms(c,i),f=Do(a)?a:{type:a},d=Nc(f,i[f.type],u),m="area"===f.type&&Tc(f,i[f.type]),p=[{name:s,...r?{params:r}:{},mark:Oc({..."area"===f.type&&void 0===f.opacity&&void 0===f.fillOpacity?{opacity:.7}:{},...f}),encoding:O20(u,["shape"])}],g=Cc(_c(f,u,i),u);let h=u;if(g){const{fieldChannel:e,offset:t}=g;h={...u,[e]:{...u[e],...t?{stack:t}:{}}};}return h=O20(h,["y2","x2"]),m&&p.push({...o?{projection:o}:{},mark:{type:"line",..._21(f,["clip","interpolate","tension","tooltip"]),...m},encoding:h}),d&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,..._21(f,["clip","tooltip"]),...d},encoding:h}),n({...l,layer:p},{...t,config:Pc(i)});}}function jc(e,t){return t?oa(e)?Uc(e,t):Rc(e,t):e;}function Ac(e,t){return t?Uc(e,t):e;}function Mc(e,t,i){const r=t[e];return(o=r)&&!Mn(o)&&"repeat"in o?r.repeat in i?{...t,[e]:i[r.repeat]}:void qi2(function(e){return`Unknown repeated value "${e}".`;}(r.repeat)):t;var o;}function Rc(e,t){if(void 0!==(e=Mc("field",e,t))){if(null===e)return null;if(la(e)&&ia(e.sort)){const n=Mc("field",e.sort,t);e={...e,...n?{sort:n}:{}};}return e;}}function qc(e,t){if(ya(e))return Rc(e,t);{const n=Mc("datum",e,t);return n===e||n.type||(n.type="nominal"),n;}}function Lc(e,t){if(!ka(e)){if(ha(e)){const n=qc(e.condition,t);if(n)return{...e,condition:n};{const{condition:t,...n}=e;return n;}}return e;}{const n=qc(e,t);if(n)return n;if(pa(e))return{condition:e.condition};}}function Uc(t,n){const i={};for(const r in t)if(ln(t,r)){const e=t[r];if(w(e))i[r]=e.map(e=>Lc(e,n)).filter(e=>e);else{const t=Lc(e,n);void 0!==t&&(i[r]=t);}}return i;}class Wc{constructor(){this.name="RuleForRangedLine";}hasMatchingType(e){if(os(e)){const{encoding:t,mark:n}=e;if("line"===n||Do(n)&&"line"===n.type)for(const e of xt7){const n=t[wt8(e)];if(t[e]&&(ya(n)&&!On7(n.bin)||ba(n)))return!0;}}return!1;}run(e,t,n){const{encoding:i,mark:r}=e;var o,s;return qi2((o=!!i.x2,s=!!i.y2,`Line mark is for continuous lines and thus cannot be used with ${o&&s?"x2 and y2":o?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n({...e,mark:E(r)?{...r,type:"rule"}:"rule"},t);}}function Bc({parentEncoding:e,encoding:t={},layer:n}){let i={};if(e){const r=new Set([...H21(e),...H21(t)]);for(const o of r){const r=t[o],a=e[o];if(ka(r)){const e={...a,...r};i[o]=e;}else ha(r)?i[o]={...r,condition:{...a,...r.condition}}:r||null===r?i[o]=r:(n||Da1(a)||Rn6(a)||ka(a)||w(a))&&(i[o]=a);}}else i=t;return!i||I19(i)?void 0:i;}function Ic(e){const{parentProjection:t,projection:n}=e;return t&&n&&qi2(function(e){const{parentProjection:t,projection:n}=e;return`Layer's shared projection ${he7(t)} is overridden by a child projection ${he7(n)}.`;}({parentProjection:t,projection:n})),n??t;}function Hc(e){return"filter"in e;}function Vc(e){return"lookup"in e;}function Gc(e){return"pivot"in e;}function Yc(e){return"density"in e;}function Xc(e){return"quantile"in e;}function Jc(e){return"regression"in e;}function Qc(e){return"loess"in e;}function Kc(e){return"sample"in e;}function Zc(e){return"window"in e;}function el(e){return"joinaggregate"in e;}function tl(e){return"flatten"in e;}function nl(e){return"calculate"in e;}function il(e){return"bin"in e;}function rl(e){return"impute"in e;}function ol(e){return"timeUnit"in e;}function al(e){return"aggregate"in e;}function sl(e){return"stack"in e;}function cl(e){return"fold"in e;}function ll(e){return"extent"in e&&!("density"in e)&&!("regression"in e);}function ul(e,t){const{transform:n,...i}=e;if(n){return{...i,transform:n.map(e=>{if(Hc(e))return{filter:ml(e,t)};if(il(e)&&Pn5(e.bin))return{...e,bin:dl(e.bin)};if(Vc(e)){const{selection:t,...n}=e.from;return t?{...e,from:{param:t,...n}}:e;}return e;})};}return e;}function fl(e,t){const n=z23(e);if(ya(n)&&Pn5(n.bin)&&(n.bin=dl(n.bin)),Fa(n)&&n.scale?.domain?.selection){const{selection:e,...t}=n.scale.domain;n.scale.domain={...t,...e?{param:e}:{}};}if(pa(n))if(w(n.condition))n.condition=n.condition.map(e=>{const{selection:n,param:i,test:r,...o}=e;return i?e:{...o,test:ml(e,t)};});else{const{selection:e,param:i,test:r,...o}=fl(n.condition,t);n.condition=i?n.condition:{...o,test:ml(n.condition,t)};}return n;}function dl(e){const t=e.extent;if(t?.selection){const{selection:n,...i}=t;return{...e,extent:{...i,param:n}};}return e;}function ml(e,t){const n=e=>F20(e,e=>{var n;const i={param:e,empty:t.emptySelections[e]??!0};return(n=t.selectionPredicates)[e]??(n[e]=[]),t.selectionPredicates[e].push(i),i;});return e.selection?n(e.selection):F20(e.test||e.filter,e=>e.selection?n(e.selection):e);}class pl extends wc{map(e,t){const n=t.selections??[];if(e.params&&!os(e)){const t=[];for(const i of e.params)Js(i)?n.push(i):t.push(i);e.params=t;}return t.selections=n,super.map(e,t);}mapUnit(e,t){const n=t.selections;if(!n||!n.length)return e;const i=(t.path??[]).concat(e.name),r=[];for(const t of n)if(t.views&&t.views.length)for(const n of t.views)(Mn(n)&&(n===e.name||i.includes(n))||w(n)&&n.map(e=>i.indexOf(e)).every((e,t,n)=>-1!==e&&(0===t||e>n[t-1])))&&r.push(t);else r.push(t);return r.length&&(e.params=r),e;}}for(const e of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=pl.prototype[e];pl.prototype[e]=function(e,n){return t.call(this,e,gl(e,n));};}function gl(e,t){return e.name?{...t,path:(t.path??[]).concat(e.name)}:t;}function hl(e,t){void 0===t&&(t=gc(e.config));const n=function(e,t={}){const n={config:t};return bl.map(yl.map(vl.map(e,n),n),n);}(e,t),{width:i,height:r}=e,o=function(e,t,n){let{width:i,height:r}=t;const o=os(e)||$c(e),a={};o?"container"==i&&"container"==r?(a.type="fit",a.contains="padding"):"container"==i?(a.type="fit-x",a.contains="padding"):"container"==r&&(a.type="fit-y",a.contains="padding"):("container"==i&&(qi2(li3("width")),i=void 0),"container"==r&&(qi2(li3("height")),r=void 0));const s={type:"pad",...a,...n?xl(n.autosize):{},...xl(e.autosize)};"fit"!==s.type||o||(qi2(ci3),s.type="pad");"container"==i&&"fit"!=s.type&&"fit-x"!=s.type&&qi2(ui3("width"));"container"==r&&"fit"!=s.type&&"fit-y"!=s.type&&qi2(ui3("height"));if(ge7(s,{type:"pad"}))return;return s;}(n,{width:i,height:r,autosize:e.autosize},t);return{...n,...o?{autosize:o}:{}};}const yl=new class extends wc{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[Ss,_s,js,new Ec,new Wc];}map(e,t){if(os(e)){const n=ss(e.encoding,ye6),i=ss(e.encoding,ve6),r=ss(e.encoding,be6);if(n||i||r)return this.mapFacetedUnit(e,t);}return super.map(e,t);}mapUnit(e,t){const{parentEncoding:n,parentProjection:i}=t,r=Ac(e.encoding,t.repeater),o={...e,...e.name?{name:[t.repeaterPrefix,e.name].filter(e=>e).join("_")}:{},...r?{encoding:r}:{}};if(n||i)return this.mapUnitWithParentEncodingOrProjection(o,t);const a=this.mapLayerOrUnit.bind(this);for(const e of this.nonFacetUnitNormalizers)if(e.hasMatchingType(o,t.config))return e.run(o,t,a);return o;}mapRepeat(e,t){return function(e){return!w(e.repeat)&&e.repeat.layer;}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t);}mapLayerRepeat(e,t){const{repeat:n,spec:i,...r}=e,{row:o,column:a,layer:s}=n,{repeater:c={},repeaterPrefix:l=""}=t;return o||a?this.mapRepeat({...e,repeat:{...o?{row:o}:{},...a?{column:a}:{}},spec:{repeat:{layer:s},spec:i}},t):{...r,layer:s.map(e=>{const n={...c,layer:e},r=`${(i.name?`${i.name}_`:"")+l}child__layer_${X22(e)}`,o=this.mapLayerOrUnit(i,{...t,repeater:n,repeaterPrefix:r});return o.name=r,o;})};}mapNonLayerRepeat(e,t){const{repeat:n,spec:i,data:r,...o}=e;!w(n)&&e.columns&&(e=O20(e,["columns"]),qi2(yi3("repeat")));const a=[],{repeater:s={},repeaterPrefix:l=""}=t,u=!w(n)&&n.row||[s?s.row:null],f=!w(n)&&n.column||[s?s.column:null],d=w(n)&&n||[s?s.repeat:null];for(const e of d)for(const r of u)for(const o of f){const u={repeat:e,row:r,column:o,layer:s.layer},f=(i.name?`${i.name}_`:"")+l+"child__"+(w(n)?`${X22(e)}`:(n.row?`row_${X22(r)}`:"")+(n.column?`column_${X22(o)}`:"")),d=this.map(i,{...t,repeater:u,repeaterPrefix:f});d.name=f,a.push(O20(d,["data"]));}const m=w(n)?e.columns:n.column?n.column.length:1;return{data:i.data??r,align:"all",...o,columns:m,concat:a};}mapFacet(e,t){const{facet:n}=e;return oa(n)&&e.columns&&(e=O20(e,["columns"]),qi2(yi3("facet"))),super.mapFacet(e,t);}mapUnitWithParentEncodingOrProjection(e,t){const{encoding:n,projection:i}=e,{parentEncoding:r,parentProjection:o,config:a}=t,s=Ic({parentProjection:o,projection:i}),c=Bc({parentEncoding:r,encoding:Ac(n,t.repeater)});return this.mapUnit({...e,...s?{projection:s}:{},...c?{encoding:c}:{}},{config:a});}mapFacetedUnit(e,t){const{row:n,column:i,facet:r,...o}=e.encoding,{mark:a,width:s,projection:c,height:l,view:u,params:f,encoding:d,...m}=e,{facetMapping:p,layout:g}=this.getFacetMappingAndLayout({row:n,column:i,facet:r},t),h=Ac(o,t.repeater);return this.mapFacet({...m,...g,facet:p,spec:{...s?{width:s}:{},...l?{height:l}:{},...u?{view:u}:{},...c?{projection:c}:{},mark:a,encoding:h,...f?{params:f}:{}}},t);}getFacetMappingAndLayout(e,t){const{row:n,column:i,facet:r}=e;if(n||i){r&&qi2(`Facet encoding dropped as ${(o=[...n?[ye6]:[],...i?[ve6]:[]]).join(" and ")} ${o.length>1?"are":"is"} also specified.`);const t={},a={};for(const n of[ye6,ve6]){const i=e[n];if(i){const{align:e,center:r,spacing:o,columns:s,...c}=i;t[n]=c;for(const e of["align","center","spacing"])void 0!==i[e]&&(a[e]??(a[e]={}),a[e][n]=i[e]);}}return{facetMapping:t,layout:a};}{const{align:e,center:n,spacing:i,columns:o,...a}=r;return{facetMapping:jc(a,t.repeater),layout:{...e?{align:e}:{},...n?{center:n}:{},...i?{spacing:i}:{},...o?{columns:o}:{}}};}var o;}mapLayer(e,{parentEncoding:t,parentProjection:n,...i}){const{encoding:r,projection:o,...a}=e,s={...i,parentEncoding:Bc({parentEncoding:t,encoding:r,layer:!0}),parentProjection:Ic({parentProjection:n,projection:o})};return super.mapLayer({...a,...e.name?{name:[s.repeaterPrefix,e.name].filter(e=>e).join("_")}:{}},s);}},vl=new class extends wc{map(e,t){return t.emptySelections??(t.emptySelections={}),t.selectionPredicates??(t.selectionPredicates={}),e=ul(e,t),super.map(e,t);}mapLayerOrUnit(e,t){if((e=ul(e,t)).encoding){const n={};for(const[i,r]of G21(e.encoding))n[i]=fl(r,t);e={...e,encoding:n};}return super.mapLayerOrUnit(e,t);}mapUnit(e,t){const{selection:n,...i}=e;return n?{...i,params:G21(n).map(([e,n])=>{const{init:i,bind:r,empty:o,...a}=n;"single"===a.type?(a.type="point",a.toggle=!1):"multi"===a.type&&(a.type="point"),t.emptySelections[e]="none"!==o;for(const n of V20(t.selectionPredicates[e]??{}))n.empty="none"!==o;return{name:e,value:i,select:a,bind:r};})}:e;}},bl=new pl;function xl(e){return Mn(e)?{type:e}:e??{};}const $l=["background","padding"];function wl(e,t){const n={};for(const t of $l)e&&void 0!==e[t]&&(n[t]=Hn6(e[t]));return t&&(n.params=e.params),n;}class kl{constructor(e={},t={}){this.explicit=e,this.implicit=t;}clone(){return new kl(z23(this.explicit),z23(this.implicit));}combine(){return{...this.explicit,...this.implicit};}get(e){return ae9(this.explicit[e],this.implicit[e]);}getWithExplicit(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0};}setWithExplicit(e,{value:t,explicit:n}){void 0!==t&&this.set(e,t,n);}set(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this;}copyKeyFromSplit(e,{explicit:t,implicit:n}){void 0!==t[e]?this.set(e,t[e],!0):void 0!==n[e]&&this.set(e,n[e],!1);}copyKeyFromObject(e,t){void 0!==t[e]&&this.set(e,t[e],!0);}copyAll(e){for(const t of H21(e.combine())){const n=e.getWithExplicit(t);this.setWithExplicit(t,n);}}}function Sl(e){return{explicit:!0,value:e};}function Dl(e){return{explicit:!1,value:e};}function Fl(e){return(t,n,i,r)=>{const o=e(t.value,n.value);return o>0?t:o<0?n:zl(t,n,i,r);};}function zl(e,t,n,i){return e.explicit&&t.explicit&&qi2(function(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${he7(n)} and ${he7(i)}). Using ${he7(n)}.`;}(n,i,e.value,t.value)),e;}function Cl(e,t,n,i,r=zl){return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:ge7(e.value,t.value)?e:r(e,t,n,i);}class _l extends kl{constructor(e={},t={},n=!1){super(e,t),this.explicit=e,this.implicit=t,this.parseNothing=n;}clone(){const e=super.clone();return e.parseNothing=this.parseNothing,e;}}function Ol(e){return"url"in e;}function Pl(e){return"values"in e;}function Nl(e){return"name"in e&&!Ol(e)&&!Pl(e)&&!Tl(e);}function Tl(e){return e&&(El(e)||jl(e)||Al(e));}function El(e){return"sequence"in e;}function jl(e){return"sphere"in e;}function Al(e){return"graticule"in e;}var Ml;function Rl({invalid:e,isPath:t}){switch(To(e,{isPath:t})){case"filter":return{marks:"exclude-invalid-values",scales:"exclude-invalid-values"};case"break-paths-show-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"include-invalid-values"};case"break-paths-filter-domains":return{marks:t?"include-invalid-values":"exclude-invalid-values",scales:"exclude-invalid-values"};case"show":return{marks:"include-invalid-values",scales:"include-invalid-values"};}}function ql(e){const{signals:t,hasLegend:n,index:i,...r}=e;return r.field=ne8(r.field),r;}function Ll(e,t=!0,n=s){if(w(e)){const i=e.map(e=>Ll(e,t,n));return t?`[${i.join(", ")}]`:i;}return Li2(e)?n(t?Vi1(e):function(e){const t=Hi2(e,!0);return e.utc?+new Date(Date.UTC(...t)):+new Date(...t);}(e)):t?n(he7(e)):e;}function Ul(e,t){for(const n of V20(e.component.selection??{})){const i=n.name;let r=`${i}${cf1}, ${"global"===n.resolve?"true":`{unit: ${df1(e)}}`}`;for(const i of ff1)i.defined(n)&&(i.signals&&(t=i.signals(e,n,t)),i.modifyExpr&&(r=i.modifyExpr(e,n,r)));t.push({name:i+lf1,on:[{events:{signal:n.name+cf1},update:`modify(${xn(n.name+sf1)}, ${r})`}]});}return Il(t);}function Wl(e,t){if(e.component.selection&&H21(e.component.selection).length){const n=xn(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:l22("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]});}return Il(t);}function Bl(e,t){for(const n of V20(e.component.selection??{}))for(const i of ff1)i.defined(n)&&i.marks&&(t=i.marks(e,n,t));return t;}function Il(e){return e.map(e=>(e.on&&!e.on.length&&delete e.on,e));}!function(e){e[e.Raw=0]="Raw",e[e.Main=1]="Main",e[e.Row=2]="Row",e[e.Column=3]="Column",e[e.Lookup=4]="Lookup",e[e.PreFilterInvalid=5]="PreFilterInvalid",e[e.PostFilterInvalid=6]="PostFilterInvalid";}(Ml||(Ml={}));class Hl{constructor(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e);}clone(){throw new Error("Cannot clone node");}get parent(){return this._parent;}set parent(e){this._parent=e,e&&e.addChild(this);}get children(){return this._children;}numChildren(){return this._children.length;}addChild(e,t){this._children.includes(e)?qi2("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e);}removeChild(e){const t=this._children.indexOf(e);return this._children.splice(t,1),t;}remove(){let e=this._parent.removeChild(this);for(const t of this._children)t._parent=this._parent,this._parent.addChild(t,e++);}insertAsParentOf(e){const t=e.parent;t.removeChild(this),this.parent=t,e.parent=this;}swapWithParent(){const e=this._parent,t=e.parent;for(const t of this._children)t.parent=e;this._children=[],e.removeChild(this);const n=e.parent.removeChild(e);this._parent=t,t.addChild(this,n),e.parent=this;}}class Vl extends Hl{clone(){const e=new this.constructor;return e.debugName=`clone_${this.debugName}`,e._source=this._source,e._name=`clone_${this._name}`,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e;}constructor(e,t,n,i){super(e,t),this.type=n,this.refCounts=i,this._source=this._name=t,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0);}dependentFields(){return new Set;}producedFields(){return new Set;}hash(){return void 0===this._hash&&(this._hash=`Output ${ce8()}`),this._hash;}getSource(){return this.refCounts[this._name]++,this._source;}isRequired(){return!!this.refCounts[this._name];}setSource(e){this._source=e;}}function Gl(e){return void 0!==e.as;}function Yl(e){return`${e}_end`;}class Xl extends Hl{clone(){return new Xl(null,z23(this.timeUnits));}constructor(e,t){super(e),this.timeUnits=t;}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{const{field:r,timeUnit:o}=n;if(o){let a;if(Xi2(o)){if(Jm(t)){const{mark:e,markDef:i,config:s}=t,c=ua1({fieldDef:n,markDef:i,config:s});(ko(e)||c)&&(a={timeUnit:rr3(o),field:r});}}else a={as:Pa(n,{forAs:!0}),field:r,timeUnit:o};if(Jm(t)){const{mark:e,markDef:r,config:o}=t,s=ua1({fieldDef:n,markDef:r,config:o});ko(e)&&Yt6(i)&&.5!==s&&(a.rectBandPosition=s);}a&&(e[P20(a)]=a);}return e;},{});return I19(n)?null:new Xl(e,n);}static makeFromTransform(e,t){const{timeUnit:n,...i}={...t},r={...i,timeUnit:rr3(n)};return new Xl(e,{[P20(r)]:r});}merge(e){this.timeUnits={...this.timeUnits};for(const t in e.timeUnits)this.timeUnits[t]||(this.timeUnits[t]=e.timeUnits[t]);for(const t of e.children)e.removeChild(t),t.parent=this;e.remove();}removeFormulas(e){const t={};for(const[n,i]of G21(this.timeUnits)){const r=Gl(i)?i.as:`${i.field}_end`;e.has(r)||(t[n]=i);}this.timeUnits=t;}producedFields(){return new Set(V20(this.timeUnits).map(e=>Gl(e)?e.as:Yl(e.field)));}dependentFields(){return new Set(V20(this.timeUnits).map(e=>e.field));}hash(){return`TimeUnit ${P20(this.timeUnits)}`;}assemble(){const e=[];for(const t of V20(this.timeUnits)){const{rectBandPosition:n}=t,i=rr3(t.timeUnit);if(Gl(t)){const{field:r,as:o}=t,{unit:a,utc:s,...c}=i,l=[o,`${o}_end`];e.push({field:ne8(r),type:"timeunit",...a?{units:Zi2(a)}:{},...s?{timezone:"utc"}:{},...c,as:l}),e.push(...Zl(l,n,i));}else if(t){const{field:r}=t,o=r.replaceAll("\\.","."),a=Kl({timeUnit:i,field:o}),s=Yl(o);e.push({type:"formula",expr:a,as:s}),e.push(...Zl([o,s],n,i));}}return e;}}const Jl="offsetted_rect_start",Ql="offsetted_rect_end";function Kl({timeUnit:e,field:t,reverse:n}){const{unit:i,utc:r}=e,o=er2(i),{part:a,step:s}=sr3(o,e.step);return`${r?"utcOffset":"timeOffset"}('${a}', datum['${t}'], ${n?-s:s})`;}function Zl([e,t],n,i){if(void 0!==n&&.5!==n){const r=`datum['${e}']`,o=`datum['${t}']`;return[{type:"formula",expr:eu1([Kl({timeUnit:i,field:e,reverse:!0}),r],n+.5),as:`${e}_${Jl}`},{type:"formula",expr:eu1([r,o],n+.5),as:`${e}_${Ql}`}];}return[];}function eu1([e,t],n){return`${1-n} * ${e} + ${n} * ${t}`;}const tu1="_tuple_fields";class nu1{constructor(...e){this.items=e,this.hasChannel={},this.hasField={},this.hasSelectionId=!1;}}const iu1={defined:()=>!0,parse:(e,t,n)=>{const i=t.name,r=t.project??(t.project=new nu1),o={},s={},c=new Set,u=(e,t)=>{const n="visual"===t?e.channel:e.field;let r=X22(`${i}_${n}`);for(let e=1;c.has(r);e++)r=X22(`${i}_${n}_${e}`);return c.add(r),{[t]:r};},f=t.type,d=e.config.selection[f],m=void 0!==n.value?H(n.value):null;let{fields:p,encodings:g}=E(n.select)?n.select:{};if(!p&&!g&&m){for(const e of m)if(E(e))for(const t of H21(e))vt7[t]?(g||(g=[])).push(t):"interval"===f?(qi2('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),g=d.encodings):(p??(p=[])).push(t);}p||g||(g=d.encodings,"fields"in d&&(p=d.fields));for(const t of g??[]){const n=e.fieldDef(t);if(n){let i=n.field;if(n.aggregate){qi2(pi3(t,n.aggregate));continue;}if(!i){qi2(mi3(t));continue;}if(n.timeUnit&&!Xi2(n.timeUnit)){i=e.vgField(t);const r={timeUnit:n.timeUnit,as:i,field:n.field};s[P20(r)]=r;}if(!o[i]){const a={field:i,channel:t,type:"interval"===f&&mn8(t)&&Vr1(e.getScaleComponent(t).get("type"))?"R":n.bin?"R-RE":"E",index:r.items.length};a.signals={...u(a,"data"),...u(a,"visual")},r.items.push(o[i]=a),r.hasField[i]=o[i],r.hasSelectionId=r.hasSelectionId||i===Vs,it10(t)?(a.geoChannel=t,a.channel=nt11(t),r.hasChannel[a.channel]=o[i]):r.hasChannel[t]=o[i];}}else qi2(mi3(t));}for(const e of p??[]){if(r.hasField[e])continue;const t={type:"E",field:e,index:r.items.length};t.signals={...u(t,"data")},r.items.push(t),r.hasField[e]=t,r.hasSelectionId=r.hasSelectionId||e===Vs;}m&&(t.init=m.map(e=>r.items.map(t=>E(e)?void 0!==e[t.geoChannel||t.channel]?e[t.geoChannel||t.channel]:e[t.field]:e))),I19(s)||(r.timeUnit=new Xl(null,s));},signals:(e,t,n)=>{const i=t.name+tu1;return n.filter(e=>e.name===i).length>0||t.project.hasSelectionId?n:n.concat({name:i,value:t.project.items.map(ql)});}},ru1={defined:e=>"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind,parse:(e,t)=>{const n=t.scales=[];for(const i of t.project.items){const r=i.channel;if(!mn8(r))continue;const o=e.getScaleComponent(r),a=o?o.get("type"):void 0;"sequential"==a&&qi2("Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc"),o&&Vr1(a)?(o.set("selectionExtent",{param:t.name,field:i.field},!0),n.push(i)):qi2("Scale bindings are currently only supported for scales with unbinned, continuous domains.");}},topLevelSignals:(e,t,n)=>{const i=t.scales.filter(e=>0===n.filter(t=>t.name===e.signals.data).length);if(!e.parent||au1(e)||0===i.length)return n;const r=n.find(e=>e.name===t.name);let a=r.update;if(a.includes(uf1))r.update=`{${i.map(e=>`${xn(ne8(e.field))}: ${e.signals.data}`).join(", ")}}`;else{for(const e of i){const t=`${xn(ne8(e.field))}: ${e.signals.data}`;a.includes(t)||(a=`${a.substring(0,a.length-1)}, ${t}}`);}r.update=a;}return n.concat(i.map(e=>({name:e.signals.data})));},signals:(e,t,n)=>{if(e.parent&&!au1(e))for(const e of t.scales){const t=n.find(t=>t.name===e.signals.data);t.push="outer",delete t.value,delete t.update;}return n;}};function ou1(e,t){return`domain(${xn(e.scaleName(t))})`;}function au1(e){return e.parent&&Zm(e.parent)&&(!e.parent.parent??au1(e.parent.parent));}const su1="_brush",cu1="_scale_trigger",lu1="geo_interval_init_tick",uu1="_init",fu1={defined:e=>"interval"===e.type,parse:(e,t,n)=>{var i;if(e.hasProjection){const e={...E(n.select)?n.select:{}};e.fields=[Vs],e.encodings||(e.encodings=n.value?H21(n.value):[Pe5,Oe5]),n.select={type:"interval",...e};}if(t.translate&&!ru1.defined(t)){const e=`!event.item || event.item.mark.name !== ${xn(t.name+su1)}`;for(const n of t.events){if(!n.between){qi2(`${n} is not an ordered event stream for interval selections.`);continue;}const t=H((i=n.between[0]).filter??(i.filter=[]));t.includes(e)||t.push(e);}}},signals:(e,t,n)=>{const i=t.name,r=i+cf1,a=V20(t.project.hasChannel).filter(e=>e.channel===xe6||e.channel===$e3),s=t.init?t.init[0]:null;if(n.push(...a.reduce((n,i)=>n.concat(function(e,t,n,i){const r=!e.hasProjection,a=n.channel,s=n.signals.visual,c=xn(r?e.scaleName(a):e.projectionName()),l=e=>`scale(${c}, ${e})`,u=e.getSizeSignalRef(a===xe6?"width":"height").signal,f=`${a}(unit)`,d=t.events.reduce((e,t)=>[...e,{events:t.between[0],update:`[${f}, ${f}]`},{events:t,update:`[${s}[0], clamp(${f}, 0, ${u})]`}],[]);if(r){const r=n.signals.data,o=ru1.defined(t),u=e.getScaleComponent(a),f=u?u.get("type"):void 0,m=i?{init:Ll(i,!0,l)}:{value:[]};return d.push({events:{signal:t.name+cu1},update:Vr1(f)?`[${l(`${r}[0]`)}, ${l(`${r}[1]`)}]`:"[0, 0]"}),o?[{name:r,on:[]}]:[{name:s,...m,on:d},{name:r,...i?{init:Ll(i)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${c}, ${s})`}]}];}{const e=a===xe6?0:1,n=t.name+uu1;return[{name:s,...i?{init:`[${n}[0][${e}], ${n}[1][${e}]]`}:{value:[]},on:d}];}}(e,t,i,s&&s[i.index])),[])),e.hasProjection){const c=xn(e.projectionName()),l=e.projectionName()+"_center",{x:u,y:f}=t.project.hasChannel,d=u&&u.signals.visual,m=f&&f.signals.visual,p=u?s&&s[u.index]:`${l}[0]`,g=f?s&&s[f.index]:`${l}[1]`,h=t=>e.getSizeSignalRef(t).signal,y=`[[${d?d+"[0]":"0"}, ${m?m+"[0]":"0"}],[${d?d+"[1]":h("width")}, ${m?m+"[1]":h("height")}]]`;if(s&&(n.unshift({name:i+uu1,init:`[scale(${c}, [${u?p[0]:p}, ${f?g[0]:g}]), scale(${c}, [${u?p[1]:p}, ${f?g[1]:g}])]`}),!u||!f)){n.find(e=>e.name===l)||n.unshift({name:l,update:`invert(${c}, [${h("width")}/2, ${h("height")}/2])`});}const v=`vlSelectionTuples(${`intersect(${y}, {markname: ${xn(e.getName("marks"))}}, unit.mark)`}, ${`{unit: ${df1(e)}}`})`,b=a.map(e=>e.signals.visual);return n.concat({name:r,on:[{events:[...b.length?[{signal:b.join(" || ")}]:[],...s?[{signal:lu1}]:[]],update:v}]});}{if(!ru1.defined(t)){const t=i+cu1,r=a.map(t=>{const n=t.channel,{data:i,visual:r}=t.signals,a=xn(e.scaleName(n)),s=Vr1(e.getScaleComponent(n).get("type"))?"+":"";return`(!isArray(${i}) || (${s}invert(${a}, ${r})[0] === ${s}${i}[0] && ${s}invert(${a}, ${r})[1] === ${s}${i}[1]))`;});r.length&&n.push({name:t,value:{},on:[{events:a.map(t=>({scale:e.scaleName(t.channel)})),update:r.join(" && ")+` ? ${t} : {}`}]});}const c=a.map(e=>e.signals.data),l=`unit: ${df1(e)}, fields: ${i+tu1}, values`;return n.concat({name:r,...s?{init:`{${l}: ${Ll(s)}}`}:{},...c.length?{on:[{events:[{signal:c.join(" || ")}],update:`${c.join(" && ")} ? {${l}: [${c}]} : null`}]}:{}});}},topLevelSignals:(e,t,n)=>{if(Jm(e)&&e.hasProjection&&t.init){n.filter(e=>e.name===lu1).length||n.unshift({name:lu1,value:null,on:[{events:"timer{1}",update:`${lu1} === null ? {} : ${lu1}`}]});}return n;},marks:(e,t,n)=>{const i=t.name,{x:r,y:a}=t.project.hasChannel,s=r?.signals.visual,c=a?.signals.visual,l=`data(${xn(t.name+sf1)})`;if(ru1.defined(t)||!r&&!a)return n;const u={x:void 0!==r?{signal:`${s}[0]`}:{value:0},y:void 0!==a?{signal:`${c}[0]`}:{value:0},x2:void 0!==r?{signal:`${s}[1]`}:{field:{group:"width"}},y2:void 0!==a?{signal:`${c}[1]`}:{field:{group:"height"}}};if("global"===t.resolve)for(const t of H21(u))u[t]=[{test:`${l}.length && ${l}[0].unit === ${df1(e)}`,...u[t]},{value:0}];const{fill:f,fillOpacity:d,cursor:m,...p}=t.mark,g=H21(p).reduce((e,t)=>(e[t]=[{test:[void 0!==r&&`${s}[0] !== ${s}[1]`,void 0!==a&&`${c}[0] !== ${c}[1]`].filter(e=>e).join(" && "),value:p[t]},{value:null}],e),{}),h=m??(t.translate?"move":null);return[{name:`${i+su1}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:d}},update:u}},...n,{name:i+su1,type:"rect",clip:!0,encode:{enter:{...h?{cursor:{value:h}}:{},fill:{value:"transparent"}},update:{...u,...g}}}];}};const du1={defined:e=>"point"===e.type,signals:(e,t,n)=>{const i=t.name,r=i+tu1,a=t.project,s="(item().isVoronoi ? datum.datum : datum)",c=V20(e.component.selection??{}).reduce((e,t)=>"interval"===t.type?e.concat(t.name+su1):e,[]).map(e=>`indexof(item().mark.name, '${e}') < 0`).join(" && "),l="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0"+(c?` && ${c}`:"");let u=`unit: ${df1(e)}, `;if(t.project.hasSelectionId)u+=`${Vs}: ${s}[${xn(Vs)}]`;else{u+=`fields: ${r}, values: [${a.items.map(t=>{const n=e.fieldDef(t.channel);return n?.bin?`[${s}[${xn(e.vgField(t.channel,{}))}], ${s}[${xn(e.vgField(t.channel,{binSuffix:"end"}))}]]`:`${s}[${xn(t.field)}]`;}).join(", ")}]`;}const f=t.events;return n.concat([{name:i+cf1,on:f?[{events:f,update:`${l} ? {${u}} : null`,force:!0}]:[]}]);}};function mu1({model:e,channelDef:t,vgChannel:n,invalidValueRef:i,mainRefFn:r}){const o=pa(t)&&t.condition;let a=[];if(o){a=H(o).map(t=>{const n=r(t);if(function(e){return e.param;}(t)){const{param:i,empty:r}=t;return{test:bf1(e,{param:i,empty:r}),...n};}return{test:$f(e,t.test),...n};});}void 0!==i&&a.push(i);const s=r(t);return void 0!==s&&a.push(s),a.length>1||1===a.length&&Boolean(a[0].test)?{[n]:a}:1===a.length?{[n]:a[0]}:{};}function pu1(e,t="text"){const n=e.encoding[t];return mu1({model:e,channelDef:n,vgChannel:t,mainRefFn:t=>gu1(t,e.config),invalidValueRef:void 0});}function gu1(e,t,n="datum"){if(e){if(Da1(e))return Gn5(e.value);if(ka(e)){const{format:i,formatType:r}=qa(e);return Ho({fieldOrDatumDef:e,format:i,formatType:r,expr:n,config:t});}}}function hu1(e,t={}){const{encoding:i,markDef:r,config:o,stack:s}=e,l=i.tooltip;if(w(l))return{tooltip:vu1({tooltip:l},s,o,t)};{const c=t.reactiveGeom?"datum.datum":"datum";return mu1({model:e,channelDef:l,vgChannel:"tooltip",mainRefFn:e=>{const l=gu1(e,o,c);if(l)return l;if(null===e)return;let u=Zn5("tooltip",r,o);return!0===u&&(u={content:"encoding"}),Mn(u)?{value:u}:E(u)?Rn6(u)?u:"encoding"===u.content?vu1(i,s,o,t):{signal:c}:void 0;},invalidValueRef:void 0});}}function yu1(e,t,n,{reactiveGeom:i}={}){const r={...n,...n.tooltipFormat},o={},a=i?"datum.datum":"datum",s=[];function c(n,i){const c=wt8(i),u=Sa1(n)?n:{...n,type:e[c].type},f=u.title||Ra(u,r),d=H(f).join(", ").replaceAll(/"/g,'\\"');let m;if(Yt6(i)){const t="x"===i?"x2":"y2",n=La(e[t]);if(On7(u.bin)&&n){const e=Pa(u,{expr:a}),i=Pa(n,{expr:a}),{format:s,formatType:c}=qa(u);m=Zo(e,i,s,c,r),o[t]=!0;}}if((Yt6(i)||i===Ce6||i===Fe5)&&t&&t.fieldChannel===i&&"normalize"===t.offset){const{format:e,formatType:t}=qa(u);m=Ho({fieldOrDatumDef:u,format:e,formatType:t,expr:a,config:r,normalizeStack:!0}).signal;}m??(m=gu1(u,r,a).signal),s.push({channel:i,key:d,value:m});}ps(e,(e,t)=>{ya(e)?c(e,t):ga(e)&&c(e.condition,t);});const u={};for(const{channel:e,key:t,value:n}of s)o[e]||u[t]||(u[t]=n);return u;}function vu1(e,t,n,{reactiveGeom:i}={}){const r=yu1(e,t,n,{reactiveGeom:i}),o=G21(r).map(([e,t])=>`"${e}": ${t}`);return o.length>0?{signal:`{${o.join(", ")}}`}:void 0;}function bu1(e){const{markDef:t,config:n}=e,i=Zn5("aria",t,n);return!1===i?{}:{...i?{aria:i}:{},...xu1(e),...$u(e)};}function xu1(e){const{mark:t,markDef:n,config:i}=e;if(!1===i.aria)return{};const r=Zn5("ariaRoleDescription",n,i);return null!=r?{ariaRoleDescription:{value:r}}:t in Wn5?{}:{ariaRoleDescription:{value:t}};}function $u(e){const{encoding:t,markDef:n,config:i,stack:r}=e,o=t.description;if(o)return mu1({model:e,channelDef:o,vgChannel:"description",mainRefFn:t=>gu1(t,e.config),invalidValueRef:void 0});const a=Zn5("description",n,i);if(null!=a)return{description:Gn5(a)};if(!1===i.aria)return{};const s=yu1(t,r,i);return I19(s)?void 0:{description:{signal:G21(s).map(([e,t],n)=>`"${n>0?"; ":""}${e}: " + (${t})`).join(" + ")}};}function wu(e,t,n={}){const{markDef:i,encoding:r,config:o}=t,{vgChannel:a}=n;let{defaultRef:s,defaultValue:c}=n;const l=r[e];void 0===s&&(c??(c=Zn5(e,i,o,{vgChannel:a,ignoreVgConfig:!pa(l)})),void 0!==c&&(s=Gn5(c)));const u={markDef:i,config:o,scaleName:t.scaleName(e),scale:t.getScaleComponent(e)},f=Ao({...u,scaleChannel:e,channelDef:l});return mu1({model:t,channelDef:l,vgChannel:a??e,invalidValueRef:f,mainRefFn:t=>Uo({...u,channel:e,channelDef:t,stack:null,defaultRef:s})});}function ku(e,t={filled:void 0}){const{markDef:n,encoding:i,config:r}=e,{type:o}=n,a=t.filled??Zn5("filled",n,r),s=T21(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,c=Zn5(!0===a?"color":void 0,n,r,{vgChannel:"fill"})??r.mark[!0===a&&"color"]??s,l=Zn5(!1===a?"color":void 0,n,r,{vgChannel:"stroke"})??r.mark[!1===a&&"color"],u=a?"fill":"stroke",f={...c?{fill:Gn5(c)}:{},...l?{stroke:Gn5(l)}:{}};return n.color&&(a?n.fill:n.stroke)&&qi2(wi2("property",{fill:"fill"in n,stroke:"stroke"in n})),{...f,...wu("color",e,{vgChannel:u,defaultValue:a?c:l}),...wu("fill",e,{defaultValue:i.fill?c:void 0}),...wu("stroke",e,{defaultValue:i.stroke?l:void 0})};}function Su(e){const{encoding:t,mark:n}=e,i=t.order;return!wo(n)&&Da1(i)?mu1({model:e,channelDef:i,vgChannel:"zindex",mainRefFn:e=>Gn5(e.value),invalidValueRef:void 0}):{};}function Du1({channel:e,markDef:t,encoding:n={},model:i,bandPosition:r}){const o=`${e}Offset`,a=t[o],s=n[o];if(("xOffset"===o||"yOffset"===o)&&s){return{offsetType:"encoding",offset:Uo({channel:o,channelDef:s,markDef:t,config:i?.config,scaleName:i.scaleName(o),scale:i.getScaleComponent(o),stack:null,defaultRef:Gn5(a),bandPosition:r})};}const c=t[o];return c?{offsetType:"visual",offset:c}:{};}function Fu1(e,t,{defaultPos:n,vgChannel:i}){const{encoding:r,markDef:o,config:a,stack:s}=t,c=r[e],l=r[St6(e)],u=t.scaleName(e),f=t.getScaleComponent(e),{offset:d,offsetType:m}=Du1({channel:e,markDef:o,encoding:r,model:t,bandPosition:.5}),p=zu({model:t,defaultPos:n,channel:e,scaleName:u,scale:f}),g=!c&&Yt6(e)&&(r.latitude||r.longitude)?{field:t.getName(e)}:function(e){const{channel:t,channelDef:n,scaleName:i,stack:r,offset:o,markDef:a}=e;if(ka(n)&&r&&t===r.fieldChannel){if(ya(n)){let e=n.bandPosition;if(void 0!==e||"text"!==a.type||"radius"!==t&&"theta"!==t||(e=.5),void 0!==e)return Lo({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",bandPosition:e,offset:o});}return qo(n,i,{suffix:"end"},{offset:o});}return Ro(e);}({channel:e,channelDef:c,channel2Def:l,markDef:o,config:a,scaleName:u,scale:f,stack:s,offset:d,defaultRef:p,bandPosition:"encoding"===m?0:void 0});return g?{[i||e]:g}:void 0;}function zu({model:e,defaultPos:t,channel:n,scaleName:i,scale:r}){const{markDef:o,config:a}=e;return()=>{const s=wt8(n),c=kt8(n),l=Zn5(n,o,a,{vgChannel:c});if(void 0!==l)return Wo(n,l);switch(t){case"zeroOrMin":return Cu1({scaleName:i,scale:r,mode:"zeroOrMin",mainChannel:s,config:a});case"zeroOrMax":return Cu1({scaleName:i,scale:r,mode:{zeroOrMax:{widthSignal:e.width.signal,heightSignal:e.height.signal}},mainChannel:s,config:a});case"mid":return{...e[Dt8(n)],mult:.5};}};}function Cu1({mainChannel:e,config:t,...n}){const i=jo(n),{mode:r}=n;if(i)return i;switch(e){case"radius":{if("zeroOrMin"===r)return{value:0};const{widthSignal:e,heightSignal:t}=r.zeroOrMax;return{signal:`min(${e},${t})/2`};}case"theta":return"zeroOrMin"===r?{value:0}:{signal:"2*PI"};case"x":return"zeroOrMin"===r?{value:0}:{field:{group:"width"}};case"y":return"zeroOrMin"===r?{field:{group:"height"}}:{value:0};}}const _u={left:"x",center:"xc",right:"x2"},Ou={top:"y",middle:"yc",bottom:"y2"};function Pu(e,t,n,i="middle"){if("radius"===e||"theta"===e)return kt8(e);const r="x"===e?"align":"baseline",o=Zn5(r,t,n);let a;return Rn6(o)?(qi2(function(e){return`The ${e} for range marks cannot be an expression`;}(r)),a=void 0):a=o,"x"===e?_u[a||("top"===i?"left":"center")]:Ou[a||i];}function Nu(e,t,{defaultPos:n,defaultPos2:i,range:r}){return r?Tu(e,t,{defaultPos:n,defaultPos2:i}):Fu1(e,t,{defaultPos:n});}function Tu(e,t,{defaultPos:n,defaultPos2:i}){const{markDef:r,config:o}=t,a=St6(e),s=Dt8(e),c=function(e,t,n){const{encoding:i,mark:r,markDef:o,stack:a,config:s}=e,c=wt8(n),l=Dt8(n),u=kt8(n),f=i[c],d=e.scaleName(c),m=e.getScaleComponent(c),{offset:p}=Du1(n in i||n in o?{channel:n,markDef:o,encoding:i,model:e}:{channel:c,markDef:o,encoding:i,model:e});if(!f&&("x2"===n||"y2"===n)&&(i.latitude||i.longitude)){const t=Dt8(n),i=e.markDef[t];return null!=i?{[t]:{value:i}}:{[u]:{field:e.getName(n)}};}const g=function({channel:e,channelDef:t,channel2Def:n,markDef:i,config:r,scaleName:o,scale:a,stack:s,offset:c,defaultRef:l}){if(ka(t)&&s&&e.charAt(0)===s.fieldChannel.charAt(0))return qo(t,o,{suffix:"start"},{offset:c});return Ro({channel:e,channelDef:n,scaleName:o,scale:a,stack:s,markDef:i,config:r,offset:c,defaultRef:l});}({channel:n,channelDef:f,channel2Def:i[n],markDef:o,config:s,scaleName:d,scale:m,stack:a,offset:p,defaultRef:void 0});if(void 0!==g)return{[u]:g};return Eu1(n,o)||Eu1(n,{[n]:ti3(n,o,s.style),[l]:ti3(l,o,s.style)})||Eu1(n,s[r])||Eu1(n,s.mark)||{[u]:zu({model:e,defaultPos:t,channel:n,scaleName:d,scale:m})()};}(t,i,a);return{...Fu1(e,t,{defaultPos:n,vgChannel:c[s]?Pu(e,r,o):kt8(e)}),...c};}function Eu1(e,t){const n=Dt8(e),i=kt8(e);if(void 0!==t[i])return{[i]:Wo(e,t[i])};if(void 0!==t[e])return{[i]:Wo(e,t[e])};if(t[n]){const i=t[n];if(!_o(i))return{[n]:Wo(e,i)};qi2(function(e){return`Position range does not support relative band size for ${e}.`;}(n));}}function ju(e,t){const{config:n,encoding:i,markDef:r}=e,o=r.type,a=St6(t),s=Dt8(t),l=i[t],u=i[a],f=e.getScaleComponent(t),d=f?f.get("type"):void 0,m=r.orient,p=i[s]??i.size??Zn5("size",r,n,{vgChannel:s}),g=Ft5(t),h="bar"===o&&("x"===t?"vertical"===m:"horizontal"===m);return!ya(l)||!(_n6(l.bin)||On7(l.bin)||l.timeUnit&&!u)||p&&!_o(p)||i[g]||Hr1(d)?(ka(l)&&Hr1(d)||h)&&!u?function(e,t,n){const{markDef:i,encoding:r,config:o,stack:a}=n,s=i.orient,l=n.scaleName(t),u=n.getScaleComponent(t),f=Dt8(t),d=St6(t),m=Ft5(t),p=n.scaleName(m),g=n.getScaleComponent(zt7(t)),h="horizontal"===s&&"y"===t||"vertical"===s&&"x"===t;let y;(r.size||i.size)&&(h?y=wu("size",n,{vgChannel:f,defaultRef:Gn5(i.size)}):qi2(function(e){return`Cannot apply size to non-oriented mark "${e}".`;}(i.type)));const v=!!y,b=fa({channel:t,fieldDef:e,markDef:i,config:o,scaleType:(u||g)?.get("type"),useVlSizeChannel:h});y=y||{[f]:Au1(f,p||l,g||u,o,b,!!e,i.type)};const x="band"===(u||g)?.get("type")&&_o(b)&&!v?"top":"middle",$=Pu(t,i,o,x),w1="xc"===$||"yc"===$,{offset:k,offsetType:S}=Du1({channel:t,markDef:i,encoding:r,model:n,bandPosition:w1?.5:0}),D=Ro({channel:t,channelDef:e,markDef:i,config:o,scaleName:l,scale:u,stack:a,offset:k,defaultRef:zu({model:n,defaultPos:"mid",channel:t,scaleName:l,scale:u}),bandPosition:w1?"encoding"===S?0:.5:Rn6(b)?{signal:`(1-${b})/2`}:_o(b)?(1-b.band)/2:0});if(f)return{[$]:D,...y};{const e=kt8(d),t=y[f],n=k?{...t,offset:k}:t;return{[$]:D,[e]:w(D)?[D[0],{...D[1],offset:n}]:{...D,offset:n}};}}(l,t,e):Tu(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function({fieldDef:e,fieldDef2:t,channel:n,model:i}){const{config:r,markDef:o,encoding:a}=i,s=i.getScaleComponent(n),c=i.scaleName(n),l=s?s.get("type"):void 0,u=s.get("reverse"),f=fa({channel:n,fieldDef:e,markDef:o,config:r,scaleType:l}),d=i.component.axes[n]?.[0],m=d?.get("translate")??.5,p=Yt6(n)?Zn5("binSpacing",o,r)??0:0,g=St6(n),h=kt8(n),y=kt8(g),v=ei3("minBandSize",o,r),{offset:b}=Du1({channel:n,markDef:o,encoding:a,model:i,bandPosition:0}),{offset:x}=Du1({channel:g,markDef:o,encoding:a,model:i,bandPosition:0}),$=function({scaleName:e,fieldDef:t}){const n=Pa(t,{expr:"datum"});return`abs(scale("${e}", ${Pa(t,{expr:"datum",suffix:"end"})}) - scale("${e}", ${n}))`;}({fieldDef:e,scaleName:c}),w=Mu(n,p,u,m,b,v,$),k=Mu(g,p,u,m,x??b,v,$),S=Rn6(f)?{signal:`(1-${f.signal})/2`}:_o(f)?(1-f.band)/2:.5,D=ua1({fieldDef:e,fieldDef2:t,markDef:o,config:r});if(_n6(e.bin)||e.timeUnit){const t=e.timeUnit&&.5!==D;return{[y]:Ru({fieldDef:e,scaleName:c,bandPosition:S,offset:k,useRectOffsetField:t}),[h]:Ru({fieldDef:e,scaleName:c,bandPosition:Rn6(S)?{signal:`1-${S.signal}`}:1-S,offset:w,useRectOffsetField:t})};}if(On7(e.bin)){const n=qo(e,c,{},{offset:k});if(ya(t))return{[y]:n,[h]:qo(t,c,{},{offset:w})};if(Pn5(e.bin)&&e.bin.step)return{[y]:n,[h]:{signal:`scale("${c}", ${Pa(e,{expr:"datum"})} + ${e.bin.step})`,offset:w}};}return void qi2(Ai2(g));}({fieldDef:l,fieldDef2:u,channel:t,model:e});}function Au1(e,n,i,r,o,a,s){if(_o(o)){if(!i)return{mult:o.band,field:{group:e}};{const e=i.get("type");if("band"===e){let e=`bandwidth('${n}')`;1!==o.band&&(e=`${o.band} * ${e}`);const t=ei3("minBandSize",{type:s},r);return{signal:t?`max(${Jn5(t)}, ${e})`:e};}1!==o.band&&(qi2(function(e){return`Cannot use the relative band size with ${e} scale.`;}(e)),o=void 0);}}else{if(Rn6(o))return o;if(o)return{value:o};}if(i){const e=i.get("range");if(qn5(e)&&yn(e.step))return{value:e.step-2};}if(!a){const{bandPaddingInner:n,barBandPaddingInner:i,rectBandPaddingInner:o}=r.scale,a=ae9(n,"bar"===s?i:o);if(Rn6(a))return{signal:`(1 - (${a.signal})) * ${e}`};if(yn(a))return{signal:`${1-a} * ${e}`};}return{value:ac(r.view,e)-2};}function Mu(e,t,n,i,r,o,a){if(et10(e))return 0;const s="x"===e||"y2"===e,c=s?-t/2:t/2;if(Rn6(n)||Rn6(r)||Rn6(i)||o){const e=Jn5(n),t=Jn5(r),l=Jn5(i),u=Jn5(o),f=o?`(${a} < ${u} ? ${s?"":"-"}0.5 * (${u} - (${a})) : ${c})`:c;return{signal:(l?`${l} + `:"")+(e?`(${e} ? -1 : 1) * `:"")+(t?`(${t} + ${f})`:f)};}return r=r||0,i+(n?-r-c:+r+c);}function Ru({fieldDef:e,scaleName:t,bandPosition:n,offset:i,useRectOffsetField:r}){return Lo({scaleName:t,fieldOrDatumDef:e,bandPosition:n,offset:i,...r?{startSuffix:Jl,endSuffix:Ql}:{}});}const qu=new Set(["aria","width","height"]);function Lu(e,t){const{fill:n,stroke:i}="include"===t.color?ku(e):{};return{...Wu(e.markDef,t),...Uu("fill",n),...Uu("stroke",i),...wu("opacity",e),...wu("fillOpacity",e),...wu("strokeOpacity",e),...wu("strokeWidth",e),...wu("strokeDash",e),...Su(e),...hu1(e),...pu1(e,"href"),...bu1(e)};}function Uu(e,t){return t?{[e]:t}:{};}function Wu(e,t){return Un6.reduce((n,i)=>(qu.has(i)||void 0===e[i]||"ignore"===t[i]||(n[i]=Gn5(e[i])),n),{});}function Bu1(e){const{config:t,markDef:n}=e,i=new Set;if(e.forEachFieldDef((r,o)=>{let a;if(!mn8(o)||!(a=e.getScaleType(o)))return;const s=Dn7(r.aggregate),c=Eo({scaleChannel:o,markDef:n,config:t,scaleType:a,isCountAggregate:s});if("break-paths-filter-domains"===(l=c)||"break-paths-show-domains"===l){const t=e.vgField(o,{expr:"datum",binSuffix:e.stack?.impute?"mid":void 0});t&&i.add(t);}var l;}),i.size>0){return{defined:{signal:[...i].map(e=>vr2(e,!0)).join(" && ")}};}}function Iu(e,t){if(void 0!==t)return{[e]:Gn5(t)};}const Hu="voronoi",Vu={defined:e=>"point"===e.type&&e.nearest,parse:(e,t)=>{if(t.events)for(const n of t.events)n.markname=e.getName(Hu);},marks:(e,t,n)=>{const{x:i,y:r}=t.project.hasChannel,o=e.mark;if(wo(o))return qi2(`The "nearest" transform is not supported for ${o} marks.`),n;const a={name:e.getName(Hu),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...hu1(e,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:i||!r?"datum.datum.x || 0":"0"},y:{expr:r||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]};let s=0,c=!1;return n.forEach((t,n)=>{const i=t.name??"";i===e.component.mark[0].name?s=n:i.includes(Hu)&&(c=!0);}),c||n.splice(s+1,0,a),n;}},Gu={defined:e=>"point"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!Ys(e.bind),parse:(e,t,n)=>pf1(t,n),topLevelSignals:(e,t,n)=>{const i=t.name,r=t.project,a=t.bind,s=t.init&&t.init[0],c=Vu.defined(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return r.items.forEach((e,r)=>{const l=X22(`${i}_${e.field}`);n.filter(e=>e.name===l).length||n.unshift({name:l,...s?{init:Ll(s[r])}:{value:null},on:t.events?[{events:t.events,update:`datum && item().mark.marktype !== 'group' ? ${c}[${xn(e.field)}] : null`}]:[],bind:a[e.field]??a[e.channel]??a});}),n;},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(e=>e.name===i+cf1),a=i+tu1,s=r.items.map(e=>X22(`${i}_${e.field}`)),c=s.map(e=>`${e} !== null`).join(" && ");return s.length&&(o.update=`${c} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n;}},Yu="_toggle",Xu={defined:e=>"point"===e.type&&!!e.toggle,signals:(e,t,n)=>n.concat({name:t.name+Yu,value:!1,on:[{events:t.events,update:t.toggle}]}),modifyExpr:(e,t)=>{const n=t.name+cf1,i=t.name+Yu;return`${i} ? null : ${n}, `+("global"===t.resolve?`${i} ? null : true, `:`${i} ? null : {unit: ${df1(e)}}, `)+`${i} ? ${n} : null`;}},Ju={defined:e=>void 0!==e.clear&&!1!==e.clear,parse:(e,t)=>{t.clear&&(t.clear=Mn(t.clear)?l22(t.clear,"view"):t.clear);},topLevelSignals:(e,t,n)=>{if(Gu.defined(t))for(const e of t.project.items){const i=n.findIndex(n=>n.name===X22(`${t.name}_${e.field}`));-1!==i&&n[i].on.push({events:t.clear,update:"null"});}return n;},signals:(e,t,n)=>{function i(e,i){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:i});}if("interval"===t.type)for(const e of t.project.items){const t=n.findIndex(t=>t.name===e.signals.visual);if(i(t,"[0, 0]"),-1===t){i(n.findIndex(t=>t.name===e.signals.data),"null");}}else{let e=n.findIndex(e=>e.name===t.name+cf1);i(e,"null"),Xu.defined(t)&&(e=n.findIndex(e=>e.name===t.name+Yu),i(e,"false"));}return n;}},Qu={defined:e=>{const t="global"===e.resolve&&e.bind&&Ys(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==Vs;return t&&!n&&qi2("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n;},parse:(e,t,i)=>{const r=z23(i);if(r.select=Mn(r.select)?{type:r.select,toggle:t.toggle}:{...r.select,toggle:t.toggle},pf1(t,r),E(i.select)&&(i.select.on||i.select.clear)){const e='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of t.events)n.filter=H(n.filter??[]),n.filter.includes(e)||n.filter.push(e);}const o=Xs(t.bind)?t.bind.legend:"click",a=Mn(o)?l22(o,"view"):H(o);t.bind={legend:{merge:a}};},topLevelSignals:(e,t,n)=>{const i=t.name,r=Xs(t.bind)&&t.bind.legend,o=e=>t=>{const n=z23(t);return n.markname=e,n;};for(const e of t.project.items){if(!e.hasLegend)continue;const a=`${X22(e.field)}_legend`,s=`${i}_${a}`;if(0===n.filter(e=>e.name===s).length){const e=r.merge.map(o(`${a}_symbols`)).concat(r.merge.map(o(`${a}_labels`))).concat(r.merge.map(o(`${a}_entries`)));n.unshift({name:s,...t.init?{}:{value:null},on:[{events:e,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:r.merge,update:`!event.item || !datum ? null : ${s}`,force:!0}]});}}return n;},signals:(e,t,n)=>{const i=t.name,r=t.project,o=n.find(e=>e.name===i+cf1),a=i+tu1,s=r.items.filter(e=>e.hasLegend).map(e=>X22(`${i}_${X22(e.field)}_legend`)),c=`${s.map(e=>`${e} !== null`).join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;t.events&&s.length>0?o.on.push({events:s.map(e=>({signal:e})),update:c}):s.length>0&&(o.update=c,delete o.value,delete o.on);const l=n.find(e=>e.name===i+Yu),u=Xs(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push({...l.on[0],events:u}):l.on[0].events=u),n;}};const Ku="_translate_anchor",Zu="_translate_delta",ef1={defined:e=>"interval"===e.type&&e.translate,signals:(e,t,n)=>{const i=t.name,r=ru1.defined(t),o=i+Ku,{x:a,y:s}=t.project.hasChannel;let c=l22(t.translate,"scope");return r||(c=c.map(e=>(e.between[0].markname=i+su1,e))),n.push({name:o,value:{},on:[{events:c.map(e=>e.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==a?`, extent_x: ${r?ou1(e,xe6):`slice(${a.signals.visual})`}`:"")+(void 0!==s?`, extent_y: ${r?ou1(e,$e3):`slice(${s.signals.visual})`}`:"")+"}"}]},{name:i+Zu,value:{},on:[{events:c,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&tf1(e,t,a,"width",n),void 0!==s&&tf1(e,t,s,"height",n),n;}};function tf1(e,t,n,i,r){const o=t.name,a=o+Ku,s=o+Zu,c=n.channel,l=ru1.defined(t),u=r.find(e=>e.name===n.signals[l?"data":"visual"]),f=e.getSizeSignalRef(i).signal,d=e.getScaleComponent(c),m=d&&d.get("type"),p=d&&d.get("reverse"),g=`${a}.extent_${c}`,h=`${l&&d?"log"===m?"panLog":"symlog"===m?"panSymlog":"pow"===m?"panPow":"panLinear":"panLinear"}(${g}, ${`${l?c===xe6?p?"":"-":p?"-":"":""}${s}.${c} / ${l?`${f}`:`span(${g})`}`}${l?"pow"===m?`, ${d.get("exponent")??1}`:"symlog"===m?`, ${d.get("constant")??1}`:"":""})`;u.on.push({events:{signal:s},update:l?h:`clampRange(${h}, 0, ${f})`});}const nf1="_zoom_anchor",rf1="_zoom_delta",of1={defined:e=>"interval"===e.type&&e.zoom,signals:(e,t,n)=>{const i=t.name,r=ru1.defined(t),a=i+rf1,{x:s,y:c}=t.project.hasChannel,l=xn(e.scaleName(xe6)),u=xn(e.scaleName($e3));let f=l22(t.zoom,"scope");return r||(f=f.map(e=>(e.markname=i+su1,e))),n.push({name:i+nf1,on:[{events:f,update:r?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter(e=>e).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&af1(e,t,s,"width",n),void 0!==c&&af1(e,t,c,"height",n),n;}};function af1(e,t,n,i,r){const o=t.name,a=n.channel,s=ru1.defined(t),c=r.find(e=>e.name===n.signals[s?"data":"visual"]),l=e.getSizeSignalRef(i).signal,u=e.getScaleComponent(a),f=u&&u.get("type"),d=s?ou1(e,a):c.name,m=o+rf1,p=`${s&&u?"log"===f?"zoomLog":"symlog"===f?"zoomSymlog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear"}(${d}, ${`${o}${nf1}.${a}`}, ${m}${s?"pow"===f?`, ${u.get("exponent")??1}`:"symlog"===f?`, ${u.get("constant")??1}`:"":""})`;c.on.push({events:{signal:m},update:s?p:`clampRange(${p}, 0, ${l})`});}const sf1="_store",cf1="_tuple",lf1="_modify",uf1="vlSelectionResolve",ff1=[du1,fu1,iu1,Xu,Gu,ru1,Qu,Ju,ef1,of1,Vu];function df1(e,{escape:t}={escape:!0}){let n=t?xn(e.name):e.name;const i=function(e){let t=e.parent;for(;t&&!Qm(t);)t=t.parent;return t;}(e);if(i){const{facet:e}=i;for(const t of ct9)e[t]&&(n+=` + '__facet_${t}_' + (facet[${xn(i.vgField(t))}])`);}return n;}function mf1(e){return V20(e.component.selection??{}).reduce((e,t)=>e||t.project.hasSelectionId,!1);}function pf1(e,t){!Mn(t.select)&&t.select.on||delete e.events,!Mn(t.select)&&t.select.clear||delete e.clear,!Mn(t.select)&&t.select.toggle||delete e.toggle;}function gf(e){const t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push(...gf(e.object)),t.push(...gf(e.property))),t);}function hf1(e){return"MemberExpression"===e.object.type?hf1(e.object):"datum"===e.object.name;}function yf(e){const t=mu(e),n=new Set;return t.visit(e=>{"MemberExpression"===e.type&&hf1(e)&&n.add(gf(e).slice(1).join("."));}),n;}class vf1 extends Hl{clone(){return new vf1(null,this.model,z23(this.filter));}constructor(e,t,n){super(e),this.model=t,this.filter=n,this.expr=$f(this.model,this.filter,this),this._dependentFields=yf(this.expr);}dependentFields(){return this._dependentFields;}producedFields(){return new Set;}assemble(){return{type:"filter",expr:this.expr};}hash(){return`Filter ${this.expr}`;}}function bf1(e,t,i,r="datum"){const a=Mn(t)?t:t.param,s=X22(a),c=xn(s+sf1);let l;try{l=e.getSelectionComponent(s,a);}catch(e){return`!!${s}`;}if(l.project.timeUnit){const t=i??e.component.data.raw,n=l.project.timeUnit.clone();t.parent?n.insertAsParentOf(t):t.parent=n;}const u=`${l.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest("}${c}, ${r}${"global"===l.resolve?")":`, ${xn(l.resolve)})`}`,f=`length(data(${c}))`;return!1===t.empty?`${f} && ${u}`:`!${f} || ${u}`;}function xf(e,t,n){const i=X22(t),r=n.encoding;let a,s=n.field;try{a=e.getSelectionComponent(i,t);}catch(e){return i;}if(r||s){if(r&&!s){const e=a.project.items.filter(e=>e.channel===r);!e.length||e.length>1?(s=a.project.items[0].field,qi2((e.length?"Multiple ":"No ")+`matching ${xn(r)} encoding found for selection ${xn(n.param)}. `+`Using "field": ${xn(s)}.`)):s=e[0].field;}}else s=a.project.items[0].field,a.project.items.length>1&&qi2(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${xn(s)}.`);return`${a.name}[${xn(ne8(s))}]`;}function $f(e,t,i){return J23(t,t=>Mn(t)?t:function(e){return e?.param;}(t)?bf1(e,t,i):yr2(t));}function wf(e,t,n,i){var r,o;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=i;}function kf(e,t,n,i={header:!1}){const{disable:r,orient:o,scale:a,labelExpr:s,title:u,zindex:f,...d}=e.combine();if(!r){for(const e in d){const n=es[e],i=d[e];if(n&&n!==t&&"both"!==n)delete d[e];else if(Ka(i)){const{condition:t,...n}=i,r=H(t),o=Qa[e];if(o){const{vgProp:t,part:i}=o;wf(d,i,t,[...r.map(e=>{const{test:t,...n}=e;return{test:$f(null,t),...n};}),n]),delete d[e];}else if(null===o){const t={signal:r.map(e=>{const{test:t,...n}=e;return`${$f(null,t)} ? ${Xn4(n)} : `;}).join("")+Xn4(n)};d[e]=t;}}else if(Rn6(i)){const t=Qa[e];if(t){const{vgProp:n,part:r}=t;wf(d,r,n,i),delete d[e];}}T21(["labelAlign","labelBaseline"],e)&&null===d[e]&&delete d[e];}if("grid"===t){if(!d.grid)return;if(d.encode){const{grid:e}=d.encode;d.encode={...e?{grid:e}:{}},I19(d.encode)&&delete d.encode;}return{scale:a,orient:o,...d,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ae9(f,0)};}{if(!i.header&&e.mainExtracted)return;if(void 0!==s){let e=s;d.encode?.labels?.update&&Rn6(d.encode.labels.update.text)&&(e=ie8(s,"datum.label",d.encode.labels.update.text.signal)),wf(d,"labels","text",{signal:e});}if(null===d.labelAlign&&delete d.labelAlign,d.encode){for(const t of Za1)e.hasAxisPart(t)||delete d.encode[t];I19(d.encode)&&delete d.encode;}const t=function(e,t){if(e)return w(e)&&!Mn7(e)?e.map(e=>Ra(e,t)).join(", "):e;}(u,n);return{scale:a,orient:o,grid:!1,...t?{title:t}:{},...d,...!1===n.aria?{aria:!1}:{},zindex:ae9(f,0)};}}}function Sf(e){const{axes:t}=e.component,n=[];for(const i of Gt5)if(t[i]){for(const r of t[i])if(!r.get("disable")&&!r.get("gridScale")){const t="x"===i?"height":"width",r=e.getSizeSignalRef(t).signal;t!==r&&n.push({name:t,update:r});}}return n;}function Df(e,t,n,i){return Object.assign.apply(null,[{},...e.map(e=>{if("axisOrient"===e){const e="x"===n?"bottom":"left",r=t["x"===n?"axisBottom":"axisLeft"]||{},o=t["x"===n?"axisTop":"axisRight"]||{},a=new Set([...H21(r),...H21(o)]),s={};for(const t of a.values())s[t]={signal:`${i.signal} === "${e}" ? ${Jn5(r[t])} : ${Jn5(o[t])}`};return s;}return t[e];})]);}function Ff(e,t){const n=[{}];for(const i of e){let e=t[i]?.style;if(e){e=H(e);for(const i of e)n.push(t.style[i]);}}return Object.assign.apply(null,n);}function zf(e,t,n,i={}){const r=ni2(e,n,t);if(void 0!==r)return{configFrom:"style",configValue:r};for(const t of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==i[t]?.[e])return{configFrom:t,configValue:i[t][e]};return{};}const Cf={scale:({model:e,channel:t})=>e.scaleName(t),format:({format:e})=>e,formatType:({formatType:e})=>e,grid:({fieldOrDatumDef:e,axis:t,scaleType:n})=>t.grid??function(e,t){return!Hr1(e)&&ya(t)&&!_n6(t?.bin)&&!On7(t?.bin);}(n,e),gridScale:({model:e,channel:t})=>(function(e,t){const n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return;})(e,t),labelAlign:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelAlign||Pf(t,n,i),labelAngle:({labelAngle:e})=>e,labelBaseline:({axis:e,labelAngle:t,orient:n,channel:i})=>e.labelBaseline||Of(t,n,i),labelFlush:({axis:e,fieldOrDatumDef:t,channel:n})=>e.labelFlush??function(e,t){if("x"===t&&T21(["quantitative","temporal"],e))return!0;return;}(t.type,n),labelOverlap:({axis:e,fieldOrDatumDef:t,scaleType:n})=>e.labelOverlap??function(e,t,n,i){if(n&&!E(i)||"nominal"!==e&&"ordinal"!==e)return"log"!==t&&"symlog"!==t||"greedy";return;}(t.type,n,ya(t)&&!!t.timeUnit,ya(t)?t.sort:void 0),orient:({orient:e})=>e,tickCount:({channel:e,model:t,axis:n,fieldOrDatumDef:i,scaleType:r})=>{const o="x"===e?"width":"y"===e?"height":void 0,a=o?t.getSizeSignalRef(o):void 0;return n.tickCount??function({fieldOrDatumDef:e,scaleType:t,size:n,values:i}){if(!i&&!Hr1(t)&&"log"!==t){if(ya(e)){if(_n6(e.bin))return{signal:`ceil(${n.signal}/10)`};if(e.timeUnit&&T21(["month","hours","day","quarter"],rr3(e.timeUnit)?.unit))return;}return{signal:`ceil(${n.signal}/40)`};}return;}({fieldOrDatumDef:i,scaleType:r,size:a,values:n.values});},tickMinStep:function({format:e,fieldOrDatumDef:t}){if("d"===e)return 1;if(ya(t)){const{timeUnit:e}=t;if(e){const t=or3(e);if(t)return{signal:t};}}return;},title:({axis:e,model:t,channel:n})=>{if(void 0!==e.title)return e.title;const i=Nf(t,n);if(void 0!==i)return i;const r=t.typedFieldDef(n),o="x"===n?"x2":"y2",a=t.fieldDef(o);return ri3(r?[ca1(r)]:[],ya(a)?[ca1(a)]:[]);},values:({axis:e,fieldOrDatumDef:t})=>(function(e,t){const n=e.values;if(w(n))return Xa1(t,n);if(Rn6(n))return n;return;})(e,t),zindex:({axis:e,fieldOrDatumDef:t,mark:n})=>e.zindex??function(e,t){if("rect"===e&&Na(t))return 1;return 0;}(n,t)};function _f(e){return`(((${e.signal} % 360) + 360) % 360)`;}function Of(e,t,n,i){if(void 0!==e){if("x"===n){if(Rn6(e)){const n=_f(e);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${Rn6(t)?`(${t.signal} === "top")`:"top"===t} ? "bottom" : "top"`};}if(45<e&&e<135||225<e&&e<315)return"middle";if(Rn6(t)){const n=e<=45||315<=e?"===":"!==";return{signal:`${t.signal} ${n} "top" ? "bottom" : "top"`};}return(e<=45||315<=e)==("top"===t)?"bottom":"top";}if(Rn6(e)){const n=_f(e);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${i?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${Rn6(t)?`(${t.signal} === "left")`:"left"===t} ? "top" : "bottom"`};}if(e<=45||315<=e||135<=e&&e<=225)return i?"middle":null;if(Rn6(t)){const n=45<=e&&e<=135?"===":"!==";return{signal:`${t.signal} ${n} "left" ? "top" : "bottom"`};}return(45<=e&&e<=135)==("left"===t)?"top":"bottom";}}function Pf(e,t,n){if(void 0===e)return;const i="x"===n,r=i?0:90,o=i?"bottom":"left";if(Rn6(e)){const n=_f(e);return{signal:`(${r?`(${n} + 90)`:n} % 180 === 0) ? ${i?null:'"center"'} :(${r} < ${n} && ${n} < ${180+r}) === ${Rn6(t)?`(${t.signal} === "${o}")`:t===o} ? "left" : "right"`};}if((e+r)%180==0)return i?null:"center";if(Rn6(t)){const n=r<e&&e<180+r?"===":"!==";return{signal:`${`${t.signal} ${n} "${o}"`} ? "left" : "right"`};}return(r<e&&e<180+r)==(t===o)?"left":"right";}function Nf(e,t){const n="x"===t?"x2":"y2",i=e.fieldDef(t),r=e.fieldDef(n),o=i?i.title:void 0,a=r?r.title:void 0;return o&&a?oi3(o,a):o||a||(void 0!==o?o:void 0!==a?a:void 0);}class Tf extends Hl{clone(){return new Tf(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this._dependentFields=yf(this.transform.calculate);}static parseAllForSortIndex(e,t){return t.forEachFieldDef((t,n)=>{if(Fa(t)&&ra(t.sort)){const{field:i,timeUnit:r}=t,o=t.sort,a=o.map((e,t)=>`${yr2({field:i,timeUnit:r,equal:e})} ? ${t} : `).join("")+o.length;e=new Tf(e,{calculate:a,as:Ef(t,n,{forAs:!0})});}}),e;}producedFields(){return new Set([this.transform.as]);}dependentFields(){return this._dependentFields;}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as};}hash(){return`Calculate ${P20(this.transform)}`;}}function Ef(e,t,n){return Pa(e,{prefix:t,suffix:"sort_index",...n});}function jf(e,t){return T21(["top","bottom"],t)?"column":T21(["left","right"],t)||"row"===e?"row":"column";}function Af(e,t,n,i){const r="row"===i?n.headerRow:"column"===i?n.headerColumn:n.headerFacet;return ae9((t||{})[e],r[e],n.header[e]);}function Mf1(e,t,n,i){const r={};for(const o of e){const e=Af(o,t||{},n,i);void 0!==e&&(r[o]=e);}return r;}const Rf=["row","column"],qf=["header","footer"];function Lf(e,t){const n=e.component.layoutHeaders[t].title,i=e.config?e.config:void 0,r=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=Mf1(["titleAnchor","titleAngle","titleOrient"],r.header,i,t),c=jf(t,s),l=de7(a);return{name:`${t}-title`,type:"group",role:`${c}-title`,title:{text:n,..."row"===t?{orient:"left"}:{},style:"guide-title",...Wf(l,c),...Uf(c,l,o),...Xf(i,r,t,Ws,Ls)}};}function Uf(e,t,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"};}const i=Pf(t,"row"===e?"left":"top","row"===e?"y":"x");return i?{align:i}:{};}function Wf(e,t){const n=Of(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{};}function Bf(e,t){const n=e.component.layoutHeaders[t],i=[];for(const r of qf)if(n[r])for(const o of n[r]){const a=Vf(e,t,r,n,o);null!=a&&i.push(a);}return i;}function If(e,t){const{sort:n}=e;return ia(n)?{field:Pa(n,{expr:"datum"}),order:n.order??"ascending"}:w(n)?{field:Ef(e,t,{expr:"datum"}),order:"ascending"}:{field:Pa(e,{expr:"datum"}),order:n??"ascending"};}function Hf(e,t,n){const{format:i,formatType:r,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:c}=Mf1(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e.header,n,t),l=Ho({fieldOrDatumDef:e,format:i,formatType:r,expr:"parent",config:n}).signal,u=jf(t,s);return{text:{signal:c?ie8(ie8(c,"datum.label",l),"datum.value",Pa(e,{expr:"parent"})):l},..."row"===t?{orient:"left"}:{},style:"guide-label",frame:"group",...Wf(o,u),...Uf(u,o,a),...Xf(n,e,t,Bs,Us)};}function Vf(e,t,n,i,r){if(r){let o=null;const{facetFieldDef:a}=i,s=e.config?e.config:void 0;if(a&&r.labels){const{labelOrient:e}=Mf1(["labelOrient"],a.header,s,t);("row"===t&&!T21(["top","bottom"],e)||"column"===t&&!T21(["left","right"],e))&&(o=Hf(a,t,s));}const c=Qm(e)&&!oa(e.facet),l=r.axes,u=l?.length>0;if(o||u){const s="row"===t?"height":"width";return{name:e.getName(`${t}_${n}`),type:"group",role:`${t}-${n}`,...i.facetFieldDef?{from:{data:e.getName(`${t}_domain`)},sort:If(a,t)}:{},...u&&c?{from:{data:e.getName(`facet_domain_${t}`)}}:{},...o?{title:o}:{},...r.sizeSignal?{encode:{update:{[s]:r.sizeSignal}}}:{},...u?{axes:l}:{}};}}return null;}const Gf={column:{start:0,end:1},row:{start:1,end:0}};function Yf(e,t){return Gf[t][e];}function Xf(e,t,n,i,r){const o={};for(const a of i){if(!r[a])continue;const i=Af(a,t?.header,e,n);void 0!==i&&(o[r[a]]=i);}return o;}function Jf(e){return[...Qf(e,"width"),...Qf(e,"height"),...Qf(e,"childWidth"),...Qf(e,"childHeight")];}function Qf(e,t){const n="width"===t?"x":"y",i=e.component.layoutSize.get(t);if(!i||"merged"===i)return[];const r=e.getSizeSignalRef(t).signal;if("step"===i){const t=e.getScaleComponent(n);if(t){const i=t.get("type"),o=t.get("range");if(Hr1(i)&&qn5(o)){const i=e.scaleName(n);if(Qm(e.parent)){if("independent"===e.parent.component.resolve.scale[n])return[Kf(i,o)];}return[Kf(i,o),{name:r,update:Zf(i,t,`domain('${i}').length`)}];}}throw new Error("layout size is step although width/height is not step.");}if("container"==i){const t=r.endsWith("width"),n=t?"containerSize()[0]":"containerSize()[1]",i=`isFinite(${n}) ? ${n} : ${oc(e.config.view,t?"width":"height")}`;return[{name:r,init:i,on:[{update:i,events:"window:resize"}]}];}return[{name:r,value:i}];}function Kf(e,t){const n=`${e}_step`;return Rn6(t.step)?{name:n,update:t.step.signal}:{name:n,value:t.step};}function Zf(e,t,n){const i=t.get("type"),r=t.get("padding"),o=ae9(t.get("paddingOuter"),r);let a=t.get("paddingInner");return a="band"===i?void 0!==a?a:r:1,`bandspace(${n}, ${Jn5(a)}, ${Jn5(o)}) * ${e}_step`;}function ed(e){return"childWidth"===e?"width":"childHeight"===e?"height":e;}function td(e,t){return H21(e).reduce((n,i)=>({...n,...mu1({model:t,channelDef:e[i],vgChannel:i,mainRefFn:e=>Gn5(e.value),invalidValueRef:void 0})}),{});}function nd(e,t){if(Qm(t))return"theta"===e?"independent":"shared";if(Zm(t))return"shared";if(Km(t))return Yt6(e)||"theta"===e||"radius"===e?"independent":"shared";throw new Error("invalid model type for resolve");}function id(e,t){const n=e.scale[t],i=Yt6(t)?"axis":"legend";return"independent"===n?("shared"===e[i][t]&&qi2(function(e){return`Setting the scale to be independent for "${e}" means we also have to set the guide (axis or legend) to be independent.`;}(t)),"independent"):e[i][t]||"shared";}const rd=H21({aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1});class od extends kl{}const ad={symbols:function(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r,legendType:o}){if("symbol"!==o)return;const{markDef:a,encoding:s,config:l,mark:u}=n,f=a.filled&&"trail"!==u;let d={...Qn5({},n,Fo),...ku(n,{filled:f})};const m=r.get("symbolOpacity")??l.legend.symbolOpacity,p=r.get("symbolFillColor")??l.legend.symbolFillColor,g=r.get("symbolStrokeColor")??l.legend.symbolStrokeColor,h=void 0===m?sd(s.opacity)??a.opacity:void 0;if(d.fill){if("fill"===i||f&&i===Ee5)delete d.fill;else if(d.fill.field)p?delete d.fill:(d.fill=Gn5(l.legend.symbolBaseFillColor??"black"),d.fillOpacity=Gn5(h??1));else if(w(d.fill)){const e=cd(s.fill??s.color)??a.fill??(f&&a.color);e&&(d.fill=Gn5(e));}}if(d.stroke){if("stroke"===i||!f&&i===Ee5)delete d.stroke;else if(d.stroke.field||g)delete d.stroke;else if(w(d.stroke)){const e=ae9(cd(s.stroke||s.color),a.stroke,f?a.color:void 0);e&&(d.stroke={value:e});}}if(i!==Le5){const e=ya(t)&&ud(n,r,t);e?d.opacity=[{test:e,...Gn5(h??1)},Gn5(l.legend.unselectedOpacity)]:h&&(d.opacity=Gn5(h));}return d={...d,...e},I19(d)?void 0:d;},gradient:function(e,{model:t,legendType:n,legendCmpt:i}){if("gradient"!==n)return;const{config:r,markDef:o,encoding:a}=t;let s={};const c=void 0===(i.get("gradientOpacity")??r.legend.gradientOpacity)?sd(a.opacity)||o.opacity:void 0;c&&(s.opacity=Gn5(c));return s={...s,...e},I19(s)?void 0:s;},labels:function(e,{fieldOrDatumDef:t,model:n,channel:i,legendCmpt:r}){const o=n.legend(i)||{},a=n.config,s=ya(t)?ud(n,r,t):void 0,c=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:u}=o;let f;Bo(u)?f=Go({fieldOrDatumDef:t,field:"datum.value",format:l,formatType:u,config:a}):void 0===l&&void 0===u&&a.customFormatTypes&&("quantitative"===t.type&&a.numberFormatType?f=Go({fieldOrDatumDef:t,field:"datum.value",format:a.numberFormat,formatType:a.numberFormatType,config:a}):"temporal"===t.type&&a.timeFormatType&&ya(t)&&void 0===t.timeUnit&&(f=Go({fieldOrDatumDef:t,field:"datum.value",format:a.timeFormat,formatType:a.timeFormatType,config:a})));const d={...c?{opacity:c}:{},...f?{text:f}:{},...e};return I19(d)?void 0:d;},entries:function(e,{legendCmpt:t}){const n=t.get("selections");return n?.length?{...e,fill:{value:"transparent"}}:e;}};function sd(e){return ld(e,(e,t)=>Math.max(e,t.value));}function cd(e){return ld(e,(e,t)=>ae9(e,t.value));}function ld(e,t){return function(e){const t=e?.condition;return!!t&&(w(t)||Da1(t));}(e)?H(e.condition).reduce(t,e.value):Da1(e)?e.value:void 0;}function ud(e,t,n){const i=t.get("selections");if(!i?.length)return;const r=xn(n.field);return i.map(e=>`(!length(data(${xn(X22(e)+sf1)})) || (${e}[${r}] && indexof(${e}[${r}], datum.value) >= 0))`).join(" || ");}const fd={direction:({direction:e})=>e,format:({fieldOrDatumDef:e,legend:t,config:n})=>{const{format:i,formatType:r}=t;return Yo(e,e.type,i,r,n,!1);},formatType:({legend:e,fieldOrDatumDef:t,scaleType:n})=>{const{formatType:i}=e;return Xo(i,t,n);},gradientLength:e=>{const{legend:t,legendConfig:n}=e;return t.gradientLength??n.gradientLength??function({legendConfig:e,model:t,direction:n,orient:i,scaleType:r}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:c}=e;if(Gr1(r))return"horizontal"===n?"top"===i||"bottom"===i?pd(t,"width",a,o):a:pd(t,"height",c,s);return;}(e);},labelOverlap:({legend:e,legendConfig:t,scaleType:n})=>e.labelOverlap??t.labelOverlap??function(e){if(T21(["quantile","threshold","log","symlog"],e))return"greedy";return;}(n),symbolType:({legend:e,markDef:t,channel:n,encoding:i})=>e.symbolType??function(e,t,n,i){if("shape"!==t){const e=cd(n)??i;if(e)return e;}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle";}}(t.type,n,i.shape,t.shape),title:({fieldOrDatumDef:e,config:t})=>Aa(e,t,{allowDisabling:!0}),type:({legendType:e,scaleType:t,channel:n})=>{if(at11(n)&&Gr1(t)){if("gradient"===e)return;}else if("symbol"===e)return;return e;},values:({fieldOrDatumDef:e,legend:t})=>(function(e,t){const n=e.values;if(w(n))return Xa1(t,n);if(Rn6(n))return n;return;})(t,e)};function dd(e){const{legend:t}=e;return ae9(t.type,function({channel:e,timeUnit:t,scaleType:n}){if(at11(e)){if(T21(["quarter","month","day"],t))return"symbol";if(Gr1(n))return"gradient";}return"symbol";}(e));}function md({legendConfig:e,legendType:t,orient:n,legend:i}){return i.direction??e[t?"gradientDirection":"symbolDirection"]??function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0;}}(n,t);}function pd(e,t,n,i){return{signal:`clamp(${e.getSizeSignalRef(t).signal}, ${n}, ${i})`};}function gd(e){const t=Jm(e)?function(e){const{encoding:t}=e,n={};for(const i of[Ee5,...Hs]){const r=Ua1(t[i]);r&&e.getScaleComponent(i)&&(i===Me6&&ya(r)&&r.type===Fr2||(n[i]=yd(e,i)));}return n;}(e):function(e){const{legends:t,resolve:n}=e.component;for(const i of e.children){gd(i);for(const r of H21(i.component.legends))n.legend[r]=id(e.component.resolve,r),"shared"===n.legend[r]&&(t[r]=vd(t[r],i.component.legends[r]),t[r]||(n.legend[r]="independent",delete t[r]));}for(const i of H21(t))for(const t of e.children)t.component.legends[i]&&"shared"===n.legend[i]&&delete t.component.legends[i];return t;}(e);return e.component.legends=t,t;}function hd(e,t,n,i){switch(t){case"disable":return void 0!==n;case"values":return!!n?.values;case"title":if("title"===t&&e===i?.title)return!0;}return e===(n||{})[t];}function yd(e,t){let n=e.legend(t);const{markDef:i,encoding:r,config:o}=e,a=o.legend,s=new od({},function(e,t){const n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n};}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:{[t]:n};}(e,t));!function(e,t,n){const i=e.fieldDef(t)?.field;for(const r of V20(e.component.selection??{})){const e=r.project.hasField[i]??r.project.hasChannel[t];if(e&&Qu.defined(r)){const t=n.get("selections")??[];t.push(r.name),n.set("selections",t,!1),e.hasLegend=!0;}}}(e,t,s);const c=void 0!==n?!n:a.disable;if(s.set("disable",c,void 0!==n),c)return s;n=n||{};const l=e.getScaleComponent(t).get("type"),u=Ua1(r[t]),f=ya(u)?rr3(u.timeUnit)?.unit:void 0,d=n.orient||o.legend.orient||"right",m=dd({legend:n,channel:t,timeUnit:f,scaleType:l}),p={legend:n,channel:t,model:e,markDef:i,encoding:r,fieldOrDatumDef:u,legendConfig:a,config:o,scaleType:l,orient:d,legendType:m,direction:md({legend:n,legendType:m,orient:d,legendConfig:a})};for(const i of rd){if("gradient"===m&&i.startsWith("symbol")||"symbol"===m&&i.startsWith("gradient"))continue;const r=i in fd?fd[i](p):n[i];if(void 0!==r){const a=hd(r,i,n,e.fieldDef(t));(a||void 0===o.legend[i])&&s.set(i,r,a);}}const g=n?.encoding??{},h=s.get("selections"),y={},v={fieldOrDatumDef:u,model:e,channel:t,legendCmpt:s,legendType:m};for(const t of["labels","legend","title","symbols","gradient","entries"]){const n=td(g[t]??{},e),i=t in ad?ad[t](n,v):n;void 0===i||I19(i)||(y[t]={...h?.length&&ya(u)?{name:`${X22(u.field)}_legend_${t}`}:{},...h?.length?{interactive:!!h}:{},update:i});}return I19(y)||s.set("encode",y,!!n?.encoding),s;}function vd(e,t){if(!e)return t.clone();const n=e.getWithExplicit("orient"),i=t.getWithExplicit("orient");if(n.explicit&&i.explicit&&n.value!==i.value)return;let r=!1;for(const n of rd){const i=Cl(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(e,t)=>{switch(n){case"symbolType":return bd(e,t);case"title":return ai3(e,t);case"type":return r=!0,Dl("symbol");}return zl(e,t,n,"legend");});e.setWithExplicit(n,i);}return r&&(e.implicit?.encode?.gradient&&Q19(e.implicit,["encode","gradient"]),e.explicit?.encode?.gradient&&Q19(e.explicit,["encode","gradient"])),e;}function bd(e,t){return"circle"===t.value?t:e;}function xd(e){const t=e.component.legends,n={};for(const i of H21(t)){const r=he7(e.getScaleComponent(i).get("domains"));if(n[r])for(const e of n[r]){vd(e,t[i])||n[r].push(t[i]);}else n[r]=[t[i].clone()];}return V20(n).flat().map(t=>(function(e,t){const{disable:n,labelExpr:i,selections:r,...o}=e.combine();if(n)return;!1===t.aria&&null==o.aria&&(o.aria=!1);if(o.encode?.symbols){const e=o.encode.symbols.update;!e.fill||"transparent"===e.fill.value||e.stroke||o.stroke||(e.stroke={value:"transparent"});for(const t of Hs)o[t]&&delete e[t];}o.title||delete o.title;if(void 0!==i){let e=i;o.encode?.labels?.update&&Rn6(o.encode.labels.update.text)&&(e=ie8(i,"datum.label",o.encode.labels.update.text.signal)),function(e,t,n,i){var r,o;e.encode??(e.encode={}),(r=e.encode)[t]??(r[t]={}),(o=e.encode[t]).update??(o.update={}),e.encode[t].update[n]=i;}(o,"labels","text",{signal:e});}return o;})(t,e.config)).filter(e=>void 0!==e);}function $d(e){return Zm(e)||Km(e)?function(e){return e.children.reduce((e,t)=>e.concat(t.assembleProjections()),wd(e));}(e):wd(e);}function wd(e){const t=e.component.projection;if(!t||t.merged)return[];const n=t.combine(),{name:i}=n;if(t.data){const r={signal:`[${t.size.map(e=>e.signal).join(", ")}]`},o=t.data.reduce((t,n)=>{const i=Rn6(n)?n.signal:`data('${e.lookupDataSource(n)}')`;return T21(t,i)||t.push(i),t;},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:i,size:r,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}];}return[{name:i,translate:{signal:"[width / 2, height / 2]"},...n}];}const kd=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Sd extends kl{constructor(e,t,n,i){super({...t},{name:e}),this.specifiedProjection=t,this.size=n,this.data=i,this.merged=!1;}get isFit(){return!!this.data;}}function Dd(t){t.component.projection=Jm(t)?function(e){if(e.hasProjection){const t=jn8(e.specifiedProjection),n=!(t&&(null!=t.scale||null!=t.translate)),i=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,r=n?function(e){const t=[],{encoding:n}=e;for(const i of[[Pe5,Oe5],[Te5,Ne6]])(Ua1(n[i[0]])||Ua1(n[i[1]]))&&t.push({signal:e.getName(`geojson_${t.length}`)});e.channelHasField(Me6)&&e.typedFieldDef(Me6).type===Fr2&&t.push({signal:e.getName(`geojson_${t.length}`)});0===t.length&&t.push(e.requestDataName(Ml.Main));return t;}(e):void 0,o=new Sd(e.projectionName(!0),{...jn8(e.config.projection),...t},i,r);return o.get("type")||o.set("type","equalEarth",!1),o;}return;}(t):function(t){if(0===t.children.length)return;let n;for(const e of t.children)Dd(e);const i=j21(t.children,t=>{const i=t.component.projection;if(i){if(n){const t=function(t,n){const i=j21(kd,i=>!ln(t.explicit,i)&&!ln(n.explicit,i)||!!(ln(t.explicit,i)&&ln(n.explicit,i)&&ge7(t.get(i),n.get(i))));if(ge7(t.size,n.size)){if(i)return t;if(ge7(t.explicit,{}))return n;if(ge7(n.explicit,{}))return t;}return null;}(n,i);return t&&(n=t),!!t;}return n=i,!0;}return!0;});if(n&&i){const e=t.projectionName(!0),i=new Sd(e,n.specifiedProjection,n.size,z23(n.data));for(const n of t.children){const t=n.component.projection;t&&(t.isFit&&i.data.push(...n.component.projection.data),n.renameProjection(t.get("name"),e),t.merged=!0);}return i;}return;}(t);}function Fd(e,t,n,i){if(Ja1(t,n)){const r=Jm(e)?e.axis(n)??e.legend(n)??{}:{},o=Pa(t,{expr:"datum"}),a=Pa(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Pa(t,{binSuffix:"range",forAs:!0}),formula:Zo(o,a,r.format,r.formatType,i)};}return{};}function zd(e,t){return`${Cn6(e)}_${t}`;}function Cd(e,t,n){const i=zd(Ha(n,void 0)??{},t);return e.getName(`${i}_bins`);}function _d(e,t,i){let r,o;r=function(e){return"as"in e;}(e)?Mn(e.as)?[e.as,`${e.as}_end`]:[e.as[0],e.as[1]]:[Pa(e,{forAs:!0}),Pa(e,{binSuffix:"end",forAs:!0})];const a={...Ha(t,void 0)},s=zd(a,e.field),{signal:c,extentSignal:l}=function(e,t){return{signal:e.getName(`${t}_bins`),extentSignal:e.getName(`${t}_extent`)};}(i,s);if(Nn6(a.extent)){const e=a.extent;o=xf(i,e.param,e),delete a.extent;}return{key:s,binComponent:{bin:a,field:e.field,as:[r],...c?{signal:c}:{},...l?{extentSignal:l}:{},...o?{span:o}:{}}};}class Od extends Hl{clone(){return new Od(null,z23(this.bins));}constructor(e,t){super(e),this.bins=t;}static makeFromEncoding(e,t){const n=t.reduceFieldDef((e,n,i)=>{if(Sa1(n)&&_n6(n.bin)){const{key:r,binComponent:o}=_d(n,n.bin,t);e[r]={...o,...e[r],...Fd(t,n,i,t.config)};}return e;},{});return I19(n)?null:new Od(e,n);}static makeFromTransform(e,t,n){const{key:i,binComponent:r}=_d(t,t.bin,n);return new Od(e,{[i]:r});}merge(e,t){for(const n of H21(e.bins))n in this.bins?(t(e.bins[n].signal,this.bins[n].signal),this.bins[n].as=R20([...this.bins[n].as,...e.bins[n].as],P20)):this.bins[n]=e.bins[n];for(const t of e.children)e.removeChild(t),t.parent=this;e.remove();}producedFields(){return new Set(V20(this.bins).map(e=>e.as).flat(2));}dependentFields(){return new Set(V20(this.bins).map(e=>e.field));}hash(){return`Bin ${P20(this.bins)}`;}assemble(){return V20(this.bins).flatMap(e=>{const t=[],[n,...i]=e.as,{extent:r,...o}=e.bin,a={type:"bin",field:ne8(e.field),as:n,signal:e.signal,...Nn6(r)?{extent:null}:{extent:r},...e.span?{span:{signal:`span(${e.span})`}}:{},...o};!r&&e.extentSignal&&(t.push({type:"extent",field:ne8(e.field),signal:e.extentSignal}),a.extent={signal:e.extentSignal}),t.push(a);for(const e of i)for(let i=0;i<2;i++)t.push({type:"formula",expr:Pa({field:n[i]},{expr:"datum"}),as:e[i]});return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t;});}}function Pd(e,t,n,i){const r=Jm(i)?i.encoding[St6(t)]:void 0;if(Sa1(n)&&Jm(i)&&da(n,r,i.markDef,i.config)){e.add(Pa(n,{})),e.add(Pa(n,{suffix:"end"}));const{mark:r,markDef:o,config:a}=i,s=ua1({fieldDef:n,markDef:o,config:a});ko(r)&&.5!==s&&Yt6(t)&&(e.add(Pa(n,{suffix:Jl})),e.add(Pa(n,{suffix:Ql}))),n.bin&&Ja1(n,t)&&e.add(Pa(n,{binSuffix:"range"}));}else if(it10(t)){const n=nt11(t);e.add(i.getName(n));}else e.add(Pa(n));return Fa(n)&&function(e){return E(e)&&"field"in e;}(n.scale?.range)&&e.add(n.scale.range.field),e;}class Nd extends Hl{clone(){return new Nd(null,new Set(this.dimensions),z23(this.measures));}constructor(e,t,n){super(e),this.dimensions=t,this.measures=n;}get groupBy(){return this.dimensions;}static makeFromEncoding(e,t){let n=!1;t.forEachFieldDef(e=>{e.aggregate&&(n=!0);});const i={},r=new Set;return n?(t.forEachFieldDef((e,n)=>{const{aggregate:o,field:a}=e;if(o)if("count"===o)i["*"]??(i["*"]={}),i["*"].count=new Set([Pa(e,{forAs:!0})]);else{if($n5(o)||wn8(o)){const e=$n5(o)?"argmin":"argmax",t=o[e];i[t]??(i[t]={}),i[t][e]=new Set([Pa({op:e,field:t},{forAs:!0})]);}else i[a]??(i[a]={}),i[a][o]=new Set([Pa(e,{forAs:!0})]);mn8(n)&&"unaggregated"===t.scaleDomain(n)&&(i[a]??(i[a]={}),i[a].min=new Set([Pa({field:a,aggregate:"min"},{forAs:!0})]),i[a].max=new Set([Pa({field:a,aggregate:"max"},{forAs:!0})]));}else Pd(r,n,e,t);}),r.size+H21(i).length===0?null:new Nd(e,r,i)):null;}static makeFromTransform(e,t){var n;const i=new Set,r={};for(const e of t.aggregate){const{op:t,field:i,as:o}=e;t&&("count"===t?(r["*"]??(r["*"]={}),r["*"].count=new Set([o||Pa(e,{forAs:!0})])):(r[i]??(r[i]={}),(n=r[i])[t]??(n[t]=new Set),r[i][t].add(o||Pa(e,{forAs:!0}))));}for(const e of t.groupby??[])i.add(e);return i.size+H21(r).length===0?null:new Nd(e,i,r);}merge(e){return L20(this.dimensions,e.dimensions)?(function(e,t){for(const n of H21(t)){const i=t[n];for(const t of H21(i))n in e?e[n][t]=new Set([...e[n][t]??[],...i[t]]):e[n]={[t]:i[t]};}}(this.measures,e.measures),!0):(function(...e){Ri2.debug(...e);}("different dimensions, cannot merge"),!1);}addDimensions(e){e.forEach(this.dimensions.add,this.dimensions);}dependentFields(){return new Set([...this.dimensions,...H21(this.measures)]);}producedFields(){const e=new Set;for(const t of H21(this.measures))for(const n of H21(this.measures[t])){const i=this.measures[t][n];0===i.size?e.add(`${n}_${t}`):i.forEach(e.add,e);}return e;}hash(){return`Aggregate ${P20({dimensions:this.dimensions,measures:this.measures})}`;}assemble(){const e=[],t=[],n=[];for(const i of H21(this.measures))for(const r of H21(this.measures[i]))for(const o of this.measures[i][r])n.push(o),e.push(r),t.push("*"===i?null:ne8(i));return{type:"aggregate",groupby:[...this.dimensions].map(ne8),ops:e,fields:t,as:n};}}class Td extends Hl{constructor(e,t,n,i){super(e),this.model=t,this.name=n,this.data=i;for(const e of ct9){const n=t.facet[e];if(n){const{bin:i,sort:r}=n;this[e]={name:t.getName(`${e}_domain`),fields:[Pa(n),..._n6(i)?[Pa(n,{binSuffix:"end"})]:[]],...ia(r)?{sortField:r}:w(r)?{sortIndexField:Ef(n,e)}:{}};}}this.childModel=t.child;}hash(){let e="Facet";for(const t of ct9)this[t]&&(e+=` ${t.charAt(0)}:${P20(this[t])}`);return e;}get fields(){const e=[];for(const t of ct9)this[t]?.fields&&e.push(...this[t].fields);return e;}dependentFields(){const e=new Set(this.fields);for(const t of ct9)this[t]&&(this[t].sortField&&e.add(this[t].sortField.field),this[t].sortIndexField&&e.add(this[t].sortIndexField));return e;}producedFields(){return new Set;}getSource(){return this.name;}getChildIndependentFieldsWithStep(){const e={};for(const t of Gt5){const n=this.childModel.component.scales[t];if(n&&!n.merged){const i=n.get("type"),r=n.get("range");if(Hr1(i)&&qn5(r)){const n=zm(Cm(this.childModel,t));n?e[t]=n:qi2(di3(t));}}}return e;}assembleRowColumnHeaderData(e,t,n){const i={row:"y",column:"x",facet:void 0}[e],r=[],o=[],a=[];i&&n&&n[i]&&(t?(r.push(`distinct_${n[i]}`),o.push("max")):(r.push(n[i]),o.push("distinct")),a.push(`distinct_${n[i]}`));const{sortField:s,sortIndexField:c}=this[e];if(s){const{op:e=ea,field:t}=s;r.push(t),o.push(e),a.push(Pa(s,{forAs:!0}));}else c&&(r.push(c),o.push("max"),a.push(c));return{name:this[e].name,source:t??this.data,transform:[{type:"aggregate",groupby:this[e].fields,...r.length?{fields:r,ops:o,as:a}:{}}]};}assembleFacetHeaderData(e){const{columns:t}=this.model.layout,{layoutHeaders:n}=this.model.component,i=[],r={};for(const e of Rf){for(const t of qf){const i=(n[e]&&n[e][t])??[];for(const t of i)if(t.axes?.length>0){r[e]=!0;break;}}if(r[e]){const n=`length(data("${this.facet.name}"))`,r="row"===e?t?{signal:`ceil(${n} / ${t})`}:1:t?{signal:`min(${n}, ${t})`}:{signal:n};i.push({name:`${this.facet.name}_${e}`,transform:[{type:"sequence",start:0,stop:r}]});}}const{row:o,column:a}=r;return(o||a)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,e)),i;}assemble(){const e=[];let t=null;const n=this.getChildIndependentFieldsWithStep(),{column:i,row:r,facet:o}=this;if(i&&r&&(n.x||n.y)){t=`cross_${this.column.name}_${this.row.name}`;const i=[].concat(n.x??[],n.y??[]),r=i.map(()=>"distinct");e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:i,ops:r}]});}for(const i of[ve6,ye6])this[i]&&e.push(this.assembleRowColumnHeaderData(i,t,n));if(o){const t=this.assembleFacetHeaderData(n);t&&e.push(...t);}return e;}}function Ed(e){return e.startsWith("'")&&e.endsWith("'")||e.startsWith('"')&&e.endsWith('"')?e.slice(1,-1):e;}function jd(e){const i={};return D20(e.filter,e=>{if(gr3(e)){let r=null;cr3(e)?r=Hn6(e.equal):ur3(e)?r=Hn6(e.lte):lr3(e)?r=Hn6(e.lt):fr2(e)?r=Hn6(e.gt):dr2(e)?r=Hn6(e.gte):mr2(e)?r=e.range[0]:pr2(e)&&(r=(e.oneOf??e.in)[0]),r&&(Li2(r)?i[e.field]="date":yn(r)?i[e.field]="number":Mn(r)&&(i[e.field]="string")),e.timeUnit&&(i[e.field]="date");}}),i;}function Ad(e){const t={};function i(e){var i;Ga(e)?t[e.field]="date":"quantitative"===e.type&&(i=e.aggregate,Mn(i)&&T21(["min","max"],i))?t[e.field]="number":oe7(e.field)>1?e.field in t||(t[e.field]="flatten"):Fa(e)&&ia(e.sort)&&oe7(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"));}if((Jm(e)||Qm(e))&&e.forEachFieldDef((t,n)=>{if(Sa1(t))i(t);else{const r=wt8(n),o=e.fieldDef(r);i({...t,type:o.type});}}),Jm(e)){const{mark:n,markDef:i,encoding:r}=e;if(wo(n)&&!e.encoding.order){const e=r["horizontal"===i.orient?"y":"x"];ya(e)&&"quantitative"===e.type&&!(e.field in t)&&(t[e.field]="number");}}return t;}class Md extends Hl{clone(){return new Md(null,z23(this._parse));}constructor(e,t){super(e),this._parse=t;}hash(){return`Parse ${P20(this._parse)}`;}static makeExplicit(e,t,n){let i={};const r=t.data;return!Tl(r)&&r?.format?.parse&&(i=r.format.parse),this.makeWithAncestors(e,i,{},n);}static makeWithAncestors(e,t,n,i){for(const e of H21(n)){const t=i.getWithExplicit(e);void 0!==t.value&&(t.explicit||t.value===n[e]||"derived"===t.value||"flatten"===n[e]?delete n[e]:qi2(vi3(e,n[e],t.value)));}for(const e of H21(t)){const n=i.get(e);void 0!==n&&(n===t[e]?delete t[e]:qi2(vi3(e,t[e],n)));}const r=new kl(t,n);i.copyAll(r);const o={};for(const e of H21(r.combine())){const t=r.get(e);null!==t&&(o[e]=t);}return 0===H21(o).length||i.parseNothing?null:new Md(e,o);}get parse(){return this._parse;}merge(e){this._parse={...this._parse,...e.parse},e.remove();}assembleFormatParse(){const e={};for(const t of H21(this._parse)){const n=this._parse[t];1===oe7(t)&&(e[t]=n);}return e;}producedFields(){return new Set(H21(this._parse));}dependentFields(){return new Set(H21(this._parse));}assembleTransforms(e=!1){return H21(this._parse).filter(t=>!e||oe7(t)>1).map(e=>{const t=function(e,t){const n=Z23(e);if("number"===t)return`toNumber(${n})`;if("boolean"===t)return`toBoolean(${n})`;if("string"===t)return`toString(${n})`;if("date"===t)return`toDate(${n})`;if("flatten"===t)return n;if(t.startsWith("date:"))return`timeParse(${n},'${Ed(t.slice(5,t.length))}')`;if(t.startsWith("utc:"))return`utcParse(${n},'${Ed(t.slice(4,t.length))}')`;return qi2(`Unrecognized parse "${t}".`),null;}(e,this._parse[e]);if(!t)return null;return{type:"formula",expr:t,as:re9(e)};}).filter(e=>null!==e);}}class Rd extends Hl{clone(){return new Rd(null);}constructor(e){super(e);}dependentFields(){return new Set;}producedFields(){return new Set([Vs]);}hash(){return"Identifier";}assemble(){return{type:"identifier",as:Vs};}}class qd extends Hl{clone(){return new qd(null,this.params);}constructor(e,t){super(e),this.params=t;}dependentFields(){return new Set;}producedFields(){}hash(){return`Graticule ${P20(this.params)}`;}assemble(){return{type:"graticule",...!0===this.params?{}:this.params};}}class Ld extends Hl{clone(){return new Ld(null,this.params);}constructor(e,t){super(e),this.params=t;}dependentFields(){return new Set;}producedFields(){return new Set([this.params.as??"data"]);}hash(){return`Hash ${P20(this.params)}`;}assemble(){return{type:"sequence",...this.params};}}class Ud extends Hl{constructor(e){let t;if(super(null),e??(e={name:"source"}),Tl(e)||(t=e.format?{...O20(e.format,["parse"])}:{}),Pl(e))this._data={values:e.values};else if(Ol(e)){if(this._data={url:e.url},!t.type){let n=/(?:\.([^.]+))?$/.exec(e.url)[1];T21(["json","csv","tsv","dsv","topojson"],n)||(n="json"),t.type=n;}}else jl(e)?this._data={values:[{type:"Sphere"}]}:(Nl(e)||Tl(e))&&(this._data={});this._generator=Tl(e),e.name&&(this._name=e.name),t&&!I19(t)&&(this._data.format=t);}dependentFields(){return new Set;}producedFields(){}get data(){return this._data;}hasName(){return!!this._name;}get isGenerator(){return this._generator;}get dataName(){return this._name;}set dataName(e){this._name=e;}set parent(e){throw new Error("Source nodes have to be roots.");}remove(){throw new Error("Source nodes are roots and cannot be removed.");}hash(){throw new Error("Cannot hash sources");}assemble(){return{name:this._name,...this._data,transform:[]};}}var Wd,Bd=function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n;},Id=function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e);};function Hd(e){return e instanceof Ud||e instanceof qd||e instanceof Ld;}class Vd{constructor(){Wd.set(this,void 0),Bd(this,Wd,!1,"f");}setModified(){Bd(this,Wd,!0,"f");}get modifiedFlag(){return Id(this,Wd,"f");}}Wd=new WeakMap;class Gd extends Vd{getNodeDepths(e,t,n){n.set(e,t);for(const i of e.children)this.getNodeDepths(i,t+1,n);return n;}optimize(e){const t=[...this.getNodeDepths(e,0,new Map).entries()].sort((e,t)=>t[1]-e[1]);for(const e of t)this.run(e[0]);return this.modifiedFlag;}}class Yd extends Vd{optimize(e){this.run(e);for(const t of e.children)this.optimize(t);return this.modifiedFlag;}}class Xd extends Yd{mergeNodes(e,t){const n=t.shift();for(const i of t)e.removeChild(i),i.parent=n,i.remove();}run(e){const t=e.children.map(e=>e.hash()),n={};for(let i=0;i<t.length;i++)void 0===n[t[i]]?n[t[i]]=[e.children[i]]:n[t[i]].push(e.children[i]);for(const t of H21(n))n[t].length>1&&(this.setModified(),this.mergeNodes(e,n[t]));}}class Jd extends Yd{constructor(e){super(),this.requiresSelectionId=e&&mf1(e);}run(e){e instanceof Rd&&(this.requiresSelectionId&&(Hd(e.parent)||e.parent instanceof Nd||e.parent instanceof Md)||(this.setModified(),e.remove()));}}class Qd extends Vd{optimize(e){return this.run(e,new Set),this.modifiedFlag;}run(e,t){let n=new Set;e instanceof Xl&&(n=e.producedFields(),U19(n,t)&&(this.setModified(),e.removeFormulas(t),0===e.producedFields.length&&e.remove()));for(const i of e.children)this.run(i,new Set([...t,...n]));}}class Kd extends Yd{constructor(){super();}run(e){e instanceof Vl&&!e.isRequired()&&(this.setModified(),e.remove());}}class Zd extends Gd{run(e){if(!(Hd(e)||e.numChildren()>1)){for(const t of e.children)if(t instanceof Md)if(e instanceof Md)this.setModified(),e.merge(t);else{if(B22(e.producedFields(),t.dependentFields()))continue;this.setModified(),t.swapWithParent();}}}}class em extends Gd{run(e){const t=[...e.children],n=e.children.filter(e=>e instanceof Md);if(e.numChildren()>1&&n.length>=1){const i={},r=new Set;for(const e of n){const t=e.parse;for(const e of H21(t))e in i?i[e]!==t[e]&&r.add(e):i[e]=t[e];}for(const e of r)delete i[e];if(!I19(i)){this.setModified();const n=new Md(e,i);for(const r of t){if(r instanceof Md)for(const e of H21(i))delete r.parse[e];e.removeChild(r),r.parent=n,r instanceof Md&&0===H21(r.parse).length&&r.remove();}}}}}class tm extends Gd{run(e){e instanceof Vl||e.numChildren()>0||e instanceof Td||e instanceof Ud||(this.setModified(),e.remove());}}class nm extends Gd{run(e){const t=e.children.filter(e=>e instanceof Xl),n=t.pop();for(const e of t)this.setModified(),n.merge(e);}}class im extends Gd{run(e){const t=e.children.filter(e=>e instanceof Nd),n={};for(const e of t){const t=P20(e.groupBy);t in n||(n[t]=[]),n[t].push(e);}for(const t of H21(n)){const i=n[t];if(i.length>1){const t=i.pop();for(const n of i)t.merge(n)&&(e.removeChild(n),n.parent=t,n.remove(),this.setModified());}}}}class rm extends Gd{constructor(e){super(),this.model=e;}run(e){const t=!(Hd(e)||e instanceof vf1||e instanceof Md||e instanceof Rd),n=[],i=[];for(const r of e.children)r instanceof Od&&(t&&!B22(e.producedFields(),r.dependentFields())?n.push(r):i.push(r));if(n.length>0){const t=n.pop();for(const e of n)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified(),e instanceof Od?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent();}if(i.length>1){const e=i.pop();for(const t of i)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified();}}}class om extends Gd{run(e){const t=[...e.children];if(!E24(t,e=>e instanceof Vl)||e.numChildren()<=1)return;const n=[];let i;for(const r of t)if(r instanceof Vl){let t=r;for(;1===t.numChildren();){const[e]=t.children;if(!(e instanceof Vl))break;t=e;}n.push(...t.children),i?(e.removeChild(r),r.parent=i.parent,i.parent.removeChild(i),i.parent=t,this.setModified()):i=t;}else n.push(r);if(n.length){this.setModified();for(const e of n)e.parent.removeChild(e),e.parent=i;}}}class am extends Hl{clone(){return new am(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t;}addDimensions(e){this.transform.groupby=R20(this.transform.groupby.concat(e),e=>e);}dependentFields(){const e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map(e=>e.field).filter(e=>void 0!==e).forEach(e.add,e),e;}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName));}getDefaultName(e){return e.as??Pa(e);}hash(){return`JoinAggregateTransform ${P20(this.transform)}`;}assemble(){const e=[],t=[],n=[];for(const i of this.transform.joinaggregate)t.push(i.op),n.push(this.getDefaultName(i)),e.push(void 0===i.field?null:i.field);const i=this.transform.groupby;return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==i?{groupby:i}:{}};}}class sm extends Hl{clone(){return new sm(null,{...this.filter});}constructor(e,t){super(e),this.filter=t;}static make(e,t,n){const{config:i,markDef:r}=t,{marks:o,scales:a}=n;if("include-invalid-values"===o&&"include-invalid-values"===a)return null;const s=t.reduceFieldDef((e,n,o)=>{const a=mn8(o)&&t.getScaleComponent(o);if(a){const t=a.get("type"),{aggregate:s}=n,c=Eo({scaleChannel:o,markDef:r,config:i,scaleType:t,isCountAggregate:Dn7(s)});"show"!==c&&"always-valid"!==c&&(e[n.field]=n);}return e;},{});return H21(s).length?new sm(e,s):null;}dependentFields(){return new Set(H21(this.filter));}producedFields(){return new Set;}hash(){return`FilterInvalid ${P20(this.filter)}`;}assemble(){const e=H21(this.filter).reduce((e,t)=>{const n=this.filter[t],i=Pa(n,{expr:"datum"});return null!==n&&("temporal"===n.type?e.push(`(isDate(${i}) || (${cm(i)}))`):"quantitative"===n.type&&e.push(cm(i))),e;},[]);return e.length>0?{type:"filter",expr:e.join(" && ")}:null;}}function cm(e){return`isValid(${e}) && isFinite(+${e})`;}class lm extends Hl{clone(){return new lm(null,z23(this._stack));}constructor(e,t){super(e),this._stack=t;}static makeFromTransform(e,t){const{stack:i,groupby:r,as:o,offset:a="zero"}=t,s=[],l=[];if(void 0!==t.sort)for(const e of t.sort)s.push(e.field),l.push(ae9(e.order,"ascending"));const u={field:s,order:l};let f;return f=function(e){return w(e)&&e.every(e=>Mn(e))&&e.length>1;}(o)?o:Mn(o)?[o,`${o}_end`]:[`${t.stack}_start`,`${t.stack}_end`],new lm(e,{dimensionFieldDefs:[],stackField:i,groupby:r,offset:a,sort:u,facetby:[],as:f});}static makeFromEncoding(e,t){const n=t.stack,{encoding:i}=t;if(!n)return null;const{groupbyChannels:r,fieldChannel:o,offset:a,impute:s}=n,l=r.map(e=>La(i[e])).filter(e=>!!e),u=function(e){return e.stack.stackBy.reduce((e,t)=>{const n=Pa(t.fieldDef);return n&&e.push(n),e;},[]);}(t),f=t.encoding.order;let d;if(w(f)||ya(f))d=ii3(f);else{const e=ma(f)?f.sort:"y"===o?"descending":"ascending";d=u.reduce((t,n)=>(t.field.includes(n)||(t.field.push(n),t.order.push(e)),t),{field:[],order:[]});}return new lm(e,{dimensionFieldDefs:l,stackField:t.vgField(o),facetby:[],stackby:u,sort:d,offset:a,impute:s,as:[t.vgField(o,{suffix:"start",forAs:!0}),t.vgField(o,{suffix:"end",forAs:!0})]});}get stack(){return this._stack;}addDimensions(e){this._stack.facetby.push(...e);}dependentFields(){const e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e;}producedFields(){return new Set(this._stack.as);}hash(){return`Stack ${P20(this._stack)}`;}getGroupbyFields(){const{dimensionFieldDefs:e,impute:t,groupby:n}=this._stack;return e.length>0?e.map(e=>e.bin?t?[Pa(e,{binSuffix:"mid"})]:[Pa(e,{}),Pa(e,{binSuffix:"end"})]:[Pa(e)]).flat():n??[];}assemble(){const e=[],{facetby:t,dimensionFieldDefs:n,stackField:i,stackby:r,sort:o,offset:a,impute:s,as:c}=this._stack;if(s)for(const o of n){const{bandPosition:n=.5,bin:a}=o;if(a){const t=Pa(o,{expr:"datum"}),i=Pa(o,{expr:"datum",binSuffix:"end"});e.push({type:"formula",expr:`${cm(t)} ? ${n}*${t}+${1-n}*${i} : ${t}`,as:Pa(o,{binSuffix:"mid",forAs:!0})});}e.push({type:"impute",field:i,groupby:[...r,...t],key:Pa(o,{binSuffix:"mid"}),method:"value",value:0});}return e.push({type:"stack",groupby:[...this.getGroupbyFields(),...t],field:i,sort:o,as:c,offset:a}),e;}}class um extends Hl{clone(){return new um(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t;}addDimensions(e){this.transform.groupby=R20(this.transform.groupby.concat(e),e=>e);}dependentFields(){const e=new Set;return(this.transform.groupby??[]).forEach(e.add,e),(this.transform.sort??[]).forEach(t=>e.add(t.field)),this.transform.window.map(e=>e.field).filter(e=>void 0!==e).forEach(e.add,e),e;}producedFields(){return new Set(this.transform.window.map(this.getDefaultName));}getDefaultName(e){return e.as??Pa(e);}hash(){return`WindowTransform ${P20(this.transform)}`;}assemble(){const e=[],t=[],n=[],i=[];for(const r of this.transform.window)t.push(r.op),n.push(this.getDefaultName(r)),i.push(void 0===r.param?null:r.param),e.push(void 0===r.field?null:r.field);const r=this.transform.frame,o=this.transform.groupby;if(r&&null===r[0]&&null===r[1]&&t.every(e=>kn6(e)))return{type:"joinaggregate",as:n,ops:t,fields:e,...void 0!==o?{groupby:o}:{}};const a=[],s=[];if(void 0!==this.transform.sort)for(const e of this.transform.sort)a.push(e.field),s.push(e.order??"ascending");const c={field:a,order:s},l=this.transform.ignorePeers;return{type:"window",params:i,as:n,ops:t,fields:e,sort:c,...void 0!==l?{ignorePeers:l}:{},...void 0!==o?{groupby:o}:{},...void 0!==r?{frame:r}:{}};}}function fm(e){if(e instanceof Td)if(1!==e.numChildren()||e.children[0]instanceof Vl){const n=e.model.component.data.main;dm(n);const i=(t=e,function e(n){if(!(n instanceof Td)){const i=n.clone();if(i instanceof Vl){const e=mm+i.getSource();i.setSource(e),t.model.component.data.outputNodes[e]=i;}else(i instanceof Nd||i instanceof lm||i instanceof um||i instanceof am)&&i.addDimensions(t.fields);for(const t of n.children.flatMap(e))t.parent=i;return[i];}return n.children.flatMap(e);}),r=e.children.map(i).flat();for(const e of r)e.parent=n;}else{const t=e.children[0];(t instanceof Nd||t instanceof lm||t instanceof um||t instanceof am)&&t.addDimensions(e.fields),t.swapWithParent(),fm(e);}else e.children.map(fm);var t;}function dm(e){if(e instanceof Vl&&e.type===Ml.Main&&1===e.numChildren()){const t=e.children[0];t instanceof Td||(t.swapWithParent(),dm(e));}}const mm="scale_";function pm(e){for(const t of e){for(const e of t.children)if(e.parent!==t)return!1;if(!pm(t.children))return!1;}return!0;}function gm(e,t){let n=!1;for(const i of t)n=e.optimize(i)||n;return n;}function hm(e,t,n){let i=e.sources,r=!1;return r=gm(new Kd,i)||r,r=gm(new Jd(t),i)||r,i=i.filter(e=>e.numChildren()>0),r=gm(new tm,i)||r,i=i.filter(e=>e.numChildren()>0),n||(r=gm(new Zd,i)||r,r=gm(new rm(t),i)||r,r=gm(new Qd,i)||r,r=gm(new em,i)||r,r=gm(new im,i)||r,r=gm(new nm,i)||r,r=gm(new Xd,i)||r,r=gm(new om,i)||r),e.sources=i,r;}class ym{constructor(e){Object.defineProperty(this,"signal",{enumerable:!0,get:e});}static fromName(e,t){return new ym(()=>e(t));}}function vm(e){Jm(e)?function(e){const t=e.component.scales;for(const n of H21(t)){const i=bm(e,n);if(t[n].setWithExplicit("domains",i),km(e,n),e.component.data.isFaceted){let t=e;for(;!Qm(t)&&t.parent;)t=t.parent;if("shared"===t.component.resolve.scale[n])for(const e of i.value)Ln6(e)&&(e.data=mm+e.data.replace(mm,""));}}}(e):function(e){for(const t of e.children)vm(t);const t=e.component.scales;for(const n of H21(t)){let i,r=null;for(const t of e.children){const e=t.component.scales[n];if(e){i=void 0===i?e.getWithExplicit("domains"):Cl(i,e.getWithExplicit("domains"),"domains","scale",Dm);const t=e.get("selectionExtent");r&&t&&r.param!==t.param&&qi2(hi3),r=t;}}t[n].setWithExplicit("domains",i),r&&t[n].set("selectionExtent",r,!0);}}(e);}function bm(e,t){const n=e.getScaleComponent(t).get("type"),{encoding:i}=e,r=function(e,t,n,i){if("unaggregated"===e){const{valid:e,reason:i}=Sm(t,n);if(!e)return void qi2(i);}else if(void 0===e&&i.useUnaggregatedDomain){const{valid:e}=Sm(t,n);if(e)return"unaggregated";}return e;}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]={...e.specifiedScales[t],domain:r}),"x"===t&&Ua1(i.x2)?Ua1(i.x)?Cl($m(n,r,e,"x"),$m(n,r,e,"x2"),"domain","scale",Dm):$m(n,r,e,"x2"):"y"===t&&Ua1(i.y2)?Ua1(i.y)?Cl($m(n,r,e,"y"),$m(n,r,e,"y2"),"domain","scale",Dm):$m(n,r,e,"y2"):$m(n,r,e,t);}function xm(e,t,n){const i=rr3(n)?.unit;return"temporal"===t||i?function(e,t,n){return e.map(e=>({signal:`{data: ${Ya(e,{timeUnit:n,type:t})}}`}));}(e,t,i):[e];}function $m(e,t,n,i){const{encoding:r,markDef:o,mark:s,config:c,stack:l}=n,u=Ua1(r[i]),{type:f}=u,d=u.timeUnit,m=function(e){const{marks:t,scales:n}=Rl(e);return t===n?Ml.Main:"include-invalid-values"===n?Ml.PreFilterInvalid:Ml.PostFilterInvalid;}({invalid:ei3("invalid",o,c),isPath:wo(s)});if(function(e){return e?.unionWith;}(t)){const r=$m(e,void 0,n,i);return Sl([...xm(t.unionWith,f,d),...r.value]);}if(Rn6(t))return Sl([t]);if(t&&"unaggregated"!==t&&!Xr1(t))return Sl(xm(t,f,d));if(l&&i===l.fieldChannel){if("normalize"===l.offset)return Dl([[0,1]]);const e=n.requestDataName(m);return Dl([{data:e,field:n.vgField(i,{suffix:"start"})},{data:e,field:n.vgField(i,{suffix:"end"})}]);}const p=mn8(i)&&ya(u)?function(e,t,n){if(!Hr1(n))return;const i=e.fieldDef(t),r=i.sort;if(ra(r))return{op:"min",field:Ef(i,t),order:"ascending"};const{stack:o}=e,a=o?new Set([...o.groupbyFields,...o.stackBy.map(e=>e.fieldDef.field)]):void 0;if(ia(r)){return wm(r,o&&!a.has(r.field));}if(function(e){return!!e?.encoding;}(r)){const{encoding:t,order:n}=r,i=e.fieldDef(t),{aggregate:s,field:c}=i,l=o&&!a.has(c);if($n5(s)||wn8(s))return wm({field:Pa(i),order:n},l);if(kn6(s)||!s)return wm({op:s,field:c,order:n},l);}else{if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(T21(["ascending",void 0],r))return!0;}return;}(n,i,e):void 0;if(ba(u)){return Dl(xm([u.datum],f,d));}const g=u;if("unaggregated"===t){const{field:e}=u;return Dl([{data:n.requestDataName(m),field:Pa({field:e,aggregate:"min"})},{data:n.requestDataName(m),field:Pa({field:e,aggregate:"max"})}]);}if(_n6(g.bin)){if(Hr1(e))return Dl("bin-ordinal"===e?[]:[{data:Y21(p)?n.requestDataName(m):n.requestDataName(Ml.Raw),field:n.vgField(i,Ja1(g,i)?{binSuffix:"range"}:{}),sort:!0!==p&&E(p)?p:{field:n.vgField(i,{}),op:"min"}}]);{const{bin:e}=g;if(_n6(e)){const t=Cd(n,g.field,e);return Dl([new ym(()=>{const e=n.getSignalName(t);return`[${e}.start, ${e}.stop]`;})]);}return Dl([{data:n.requestDataName(m),field:n.vgField(i,{})}]);}}if(g.timeUnit&&T21(["time","utc"],e)){const e=r[St6(i)];if(da(g,e,o,c)){const t=n.requestDataName(m),r=ua1({fieldDef:g,fieldDef2:e,markDef:o,config:c}),a=ko(s)&&.5!==r&&Yt6(i);return Dl([{data:t,field:n.vgField(i,a?{suffix:Jl}:{})},{data:t,field:n.vgField(i,{suffix:a?Ql:"end"})}]);}}return Dl(p?[{data:Y21(p)?n.requestDataName(m):n.requestDataName(Ml.Raw),field:n.vgField(i),sort:p}]:[{data:n.requestDataName(m),field:n.vgField(i)}]);}function wm(e,t){const{op:n,field:i,order:r}=e;return{op:n??(t?"sum":ea),...i?{field:ne8(i)}:{},...r?{order:r}:{}};}function km(e,t){const n=e.component.scales[t],i=e.specifiedScales[t].domain,r=e.fieldDef(t)?.bin,o=Xr1(i)&&i,a=Pn5(r)&&Nn6(r.extent)&&r.extent;(o||a)&&n.set("selectionExtent",o??a,!0);}function Sm(e,t){const{aggregate:i,type:r}=e;return i?Mn(i)&&!zn6.has(i)?{valid:!1,reason:_i2(i)}:"quantitative"===r&&"log"===t?{valid:!1,reason:Oi2(e)}:{valid:!0}:{valid:!1,reason:Ci2(e)};}function Dm(e,t,n,i){return e.explicit&&t.explicit&&qi2(function(e,t,n,i){return`Conflicting ${t.toString()} property "${e.toString()}" (${he7(n)} and ${he7(i)}). Using the union of the two domains.`;}(n,i,e.value,t.value)),{explicit:e.explicit,value:[...e.value,...t.value]};}function Fm(e){const t=R20(e.map(e=>{if(Ln6(e)){const{sort:t,...n}=e;return n;}return e;}),P20),i=R20(e.map(e=>{if(Ln6(e)){const t=e.sort;return void 0===t||Y21(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t;}}).filter(e=>void 0!==e),P20);if(0===t.length)return;if(1===t.length){const t=e[0];if(Ln6(t)&&i.length>0){let e=i[0];if(i.length>1){qi2(Ti2);const t=i.filter(e=>E(e)&&"op"in e&&"min"!==e.op);e=!i.every(e=>E(e)&&"op"in e)||1!==t.length||t[0];}else if(E(e)&&"field"in e){const n=e.field;t.field===n&&(e=!e.order||{order:e.order});}return{...t,sort:e};}return t;}const r=R20(i.map(e=>Y21(e)||!("op"in e)||Mn(e.op)&&e.op in xn7?e:(qi2(function(e){return`Dropping sort property ${he7(e)} as unioned domains only support boolean or op "count", "min", and "max".`;}(e)),!0)),P20);let o;1===r.length?o=r[0]:r.length>1&&(qi2(Ti2),o=!0);const s=R20(e.map(e=>Ln6(e)?e.data:null),e=>e);if(1===s.length&&null!==s[0]){return{data:s[0],fields:t.map(e=>e.field),...o?{sort:o}:{}};}return{fields:t,...o?{sort:o}:{}};}function zm(e){if(Ln6(e)&&Mn(e.field))return e.field;if(function(e){return!w(e)&&"fields"in e&&!("data"in e);}(e)){let t;for(const i of e.fields)if(Ln6(i)&&Mn(i.field))if(t){if(t!==i.field)return qi2("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t;}else t=i.field;return qi2("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t;}if(function(e){return!w(e)&&"fields"in e&&"data"in e;}(e)){qi2("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const t=e.fields[0];return Mn(t)?t:void 0;}}function Cm(e,t){const n=e.component.scales[t].get("domains").map(t=>(Ln6(t)&&(t.data=e.lookupDataSource(t.data)),t));return Fm(n);}function _m(e){return Zm(e)||Km(e)?e.children.reduce((e,t)=>e.concat(_m(t)),Om(e)):Om(e);}function Om(e){return H21(e.component.scales).reduce((t,n)=>{const i=e.component.scales[n];if(i.merged)return t;const r=i.combine(),{name:o,type:s,selectionExtent:l,domains:u,range:f,reverse:d,...m}=r,p=function(e,t,n,i){if(Yt6(n)){if(qn5(e))return{step:{signal:`${t}_step`}};}else if(E(e)&&Ln6(e))return{...e,data:i.lookupDataSource(e.data)};return e;}(r.range,o,n,e),g=Cm(e,n),h=l?function(e,t,n,i){const r=xf(e,t.param,t);return{signal:Vr1(n.get("type"))&&w(i)&&i[0]>i[1]?`isValid(${r}) && reverse(${r})`:r};}(e,l,i,g):null;return t.push({name:o,type:s,...g?{domain:g}:{},...h?{domainRaw:h}:{},range:p,...void 0!==d?{reverse:d}:{},...m}),t;},[]);}class Pm extends kl{constructor(e,t){super({},{name:e}),this.merged=!1,this.setWithExplicit("type",t);}domainHasZero(){const e=this.get("type");if(T21([Cr2,Pr3,Nr2],e))return"definitely-not";const n=this.get("zero");if(!0===n||void 0===n&&T21([zr2,Or2,_r2],e))return"definitely";const i=this.get("domains");if(i.length>0){let e=!1,n=!1,r=!1;for(const o of i){if(w(o)){const i=o[0],r=o[o.length-1];if(yn(i)&&yn(r)){if(i<=0&&r>=0){e=!0;continue;}n=!0;continue;}}r=!0;}if(e)return"definitely";if(n&&!r)return"definitely-not";}return"maybe";}}const Nm=["range","scheme"];function Tm(e,t){const n=e.fieldDef(t);if(n?.bin){const{bin:i,field:r}=n,o=Dt8(t),s=e.getName(o);if(E(i)&&i.binned&&void 0!==i.step)return new ym(()=>{const n=e.scaleName(t),r=`(domain("${n}")[1] - domain("${n}")[0]) / ${i.step}`;return`${e.getSignalName(s)} / (${r})`;});if(_n6(i)){const t=Cd(e,r,i);return new ym(()=>{const n=e.getSignalName(t),i=`(${n}.stop - ${n}.start) / ${n}.step`;return`${e.getSignalName(s)} / (${i})`;});}}}function Em(e,n){const i=n.specifiedScales[e],{size:r}=n,o=n.getScaleComponent(e).get("type");for(const t of Nm)if(void 0!==i[t]){const r=ro(o,t),s=oo(e,t);if(r)if(s)qi2(s);else switch(t){case"range":{const t=i.range;if(w(t)){if(Yt6(e))return Sl(t.map(e=>{if("width"===e||"height"===e){const t=n.getName(e),i=n.getSignalName.bind(n);return ym.fromName(i,t);}return e;}));}else if(E(t))return Sl({data:n.requestDataName(Ml.Main),field:t.field,sort:{op:"min",field:n.vgField(e)}});return Sl(t);}case"scheme":return Sl(jm(i[t]));}else qi2(Pi2(o,t,e));}const s=e===xe6||"xOffset"===e?"width":"height",l=r[s];if(nc(l)){if(Yt6(e))if(Hr1(o)){const t=Mm(l,n,e);if(t)return Sl({step:t});}else qi2(Ni2(s));else if(Zt4(e)){const t=e===Se5?"x":"y";if("band"===n.getScaleComponent(t).get("type")){const e=Rm(l,o);if(e)return Sl(e);}}}const{rangeMin:u,rangeMax:f}=i,d=function(e,n){const{size:i,config:r,mark:o,encoding:a}=n,{type:s}=Ua1(a[e]),l=n.getScaleComponent(e),u=l.get("type"),{domain:f,domainMid:d}=n.specifiedScales[e];switch(e){case xe6:case $e3:if(T21(["point","band"],u)){const t=qm(e,i,r.view);if(nc(t)){return{step:Mm(t,n,e)};}}return Am(e,n,u);case Se5:case De5:return function(e,t,n){const i=e===Se5?"x":"y",r=t.getScaleComponent(i);if(!r)return Am(i,t,n,{center:!0});const o=r.get("type"),a=t.scaleName(i),{markDef:s,config:c}=t;if("band"===o){const e=qm(i,t.size,t.config.view);if(nc(e)){const t=Rm(e,n);if(t)return t;}return[0,{signal:`bandwidth('${a}')`}];}{const n=t.encoding[i];if(ya(n)&&n.timeUnit){const e=or3(n.timeUnit,e=>`scale('${a}', ${e})`),i=t.config.scale.bandWithNestedOffsetPaddingInner,r=ua1({fieldDef:n,markDef:s,config:c})-.5,o=0!==r?` + ${r}`:"";if(i){return[{signal:`${Rn6(i)?`${i.signal}/2`+o:`${i/2+r}`} * (${e})`},{signal:`${Rn6(i)?`(1 - ${i.signal}/2)`+o:`${1-i/2+r}`} * (${e})`}];}return[0,{signal:e}];}return C20(`Cannot use ${e} scale if ${i} scale is not discrete.`);}}(e,n,u);case Re5:{const a=function(e,t){switch(e){case"bar":case"tick":return t.scale.minBandSize;case"line":case"trail":case"rule":return t.scale.minStrokeWidth;case"text":return t.scale.minFontSize;case"point":case"square":case"circle":return t.scale.minSize;}throw new Error(Si2("size",e));}(o,r),s=function(e,n,i,r){const o={x:Tm(i,"x"),y:Tm(i,"y")};switch(e){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const e=Um(n,o,r.view);return yn(e)?e-1:new ym(()=>`${e.signal} - 1`);}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const e=Um(n,o,r.view);return yn(e)?Math.pow(Lm*e,2):new ym(()=>`pow(${Lm} * ${e.signal}, 2)`);}}throw new Error(Si2("size",e));}(o,i,n,r);return Yr1(u)?function(e,t,n){const i=()=>{const i=Jn5(t),r=Jn5(e),o=`(${i} - ${r}) / (${n} - 1)`;return`sequence(${r}, ${i} + ${o}, ${o})`;};return Rn6(t)?new ym(i):{signal:i()};}(a,s,function(e,t,n,i){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&w(n)?n.length+1:(qi2(function(e){return`Domain for ${e} is required for threshold scale.`;}(i)),3);}}(u,r,f,e)):[a,s];}case Ce6:return[0,2*Math.PI];case qe4:return[0,360];case Fe5:return[0,new ym(()=>`min(${n.getSignalName(Qm(n.parent)?"child_width":"width")},${n.getSignalName(Qm(n.parent)?"child_height":"height")})/2`)];case Be5:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Ie6:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Me6:return"symbol";case Ee5:case je4:case Ae5:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==d?"diverging":"rect"===o||"geoshape"===o?"heatmap":"ramp";case Le5:case Ue5:case We3:return[r.scale.minOpacity,r.scale.maxOpacity];}}(e,n);return(void 0!==u||void 0!==f)&&ro(o,"rangeMin")&&w(d)&&2===d.length?Sl([u??d[0],f??d[1]]):Dl(d);}function jm(e){return function(e){return!Mn(e)&&!!e.name;}(e)?{scheme:e.name,...O20(e,["name"])}:{scheme:e};}function Am(e,t,n,{center:i}={}){const r=Dt8(e),o=t.getName(r),a=t.getSignalName.bind(t);return e===$e3&&Vr1(n)?i?[ym.fromName(e=>`${a(e)}/2`,o),ym.fromName(e=>`-${a(e)}/2`,o)]:[ym.fromName(a,o),0]:i?[ym.fromName(e=>`-${a(e)}/2`,o),ym.fromName(e=>`${a(e)}/2`,o)]:[0,ym.fromName(a,o)];}function Mm(e,t,n){const{encoding:i}=t,r=t.getScaleComponent(n),o=zt7(n),a=i[o];if("offset"===tc({step:e,offsetIsDiscrete:ka(a)&&$r1(a.type)})&&cs(i,o)){const n=t.getScaleComponent(o);let i=`domain('${t.scaleName(o)}').length`;if("band"===n.get("type")){i=`bandspace(${i}, ${n.get("paddingInner")??n.get("padding")??0}, ${n.get("paddingOuter")??n.get("padding")??0})`;}const a=r.get("paddingInner")??r.get("padding");return{signal:`${e.step} * ${i} / (1-${Yn6(a)})`};}return e.step;}function Rm(e,t){if("offset"===tc({step:e,offsetIsDiscrete:Hr1(t)}))return{step:e.step};}function qm(e,t,n){const i=e===xe6?"width":"height",r=t[i];return r||sc(n,i);}const Lm=.95;function Um(e,t,n){const i=nc(e.width)?e.width.step:ac(n,"width"),r=nc(e.height)?e.height.step:ac(n,"height");return t.x||t.y?new ym(()=>`min(${[t.x?t.x.signal:i,t.y?t.y.signal:r].join(", ")})`):Math.min(i,r);}function Wm(e,t){Jm(e)?function(e,t){const n=e.component.scales,{config:i,encoding:r,markDef:o,specifiedScales:a}=e;for(const s of H21(n)){const c=a[s],l=n[s],u=e.getScaleComponent(s),f=Ua1(r[s]),d=c[t],m=u.get("type"),p=u.get("padding"),g=u.get("paddingInner"),h=ro(m,t),y=oo(s,t);if(void 0!==d&&(h?y&&qi2(y):qi2(Pi2(m,t,s))),h&&void 0===y)if(void 0!==d){const e=f.timeUnit,n=f.type;switch(t){case"domainMax":case"domainMin":Li2(c[t])||"temporal"===n||e?l.set(t,{signal:Ya(c[t],{type:n,timeUnit:e})},!0):l.set(t,c[t],!0);break;default:l.copyKeyFromObject(t,c);}}else{const n=t in Bm?Bm[t]({model:e,channel:s,fieldOrDatumDef:f,scaleType:m,scalePadding:p,scalePaddingInner:g,domain:c.domain,domainMin:c.domainMin,domainMax:c.domainMax,markDef:o,config:i,hasNestedOffsetScale:ls(r,s),hasSecondaryRangeChannel:!!r[St6(s)]}):i.scale[t];void 0!==n&&l.set(t,n,!1);}}}(e,t):Hm(e,t);}const Bm={bins:({model:e,fieldOrDatumDef:t})=>ya(t)?function(e,t){const n=t.bin;if(_n6(n)){const i=Cd(e,t.field,n);return new ym(()=>e.getSignalName(i));}if(On7(n)&&Pn5(n)&&void 0!==n.step)return{step:n.step};return;}(e,t):void 0,interpolate:({channel:e,fieldOrDatumDef:t})=>(function(e,t){if(T21([Ee5,je4,Ae5],e)&&"nominal"!==t)return"hcl";return;})(e,t.type),nice:({scaleType:e,channel:t,domain:n,domainMin:i,domainMax:r,fieldOrDatumDef:o})=>(function(e,t,n,i,r,o){if(La(o)?.bin||w(n)||null!=r||null!=i||T21([Pr3,Nr2],e))return;return!!Yt6(t)||void 0;})(e,t,n,i,r,o),padding:({channel:e,scaleType:t,fieldOrDatumDef:n,markDef:i,config:r})=>(function(e,t,n,i,r,o){if(Yt6(e)){if(Gr1(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:t,orient:a}=r;if("bar"===t&&(!ya(i)||!i.bin&&!i.timeUnit)&&("vertical"===a&&"x"===e||"horizontal"===a&&"y"===e))return o.continuousBandSize;}if(t===Tr2)return n.pointPadding;}return;})(e,t,r.scale,n,i,r.bar),paddingInner:({scalePadding:e,channel:t,markDef:n,scaleType:i,config:r,hasNestedOffsetScale:o})=>(function(e,t,n,i,r,o=!1){if(void 0!==e)return;if(Yt6(t)){const{bandPaddingInner:e,barBandPaddingInner:t,rectBandPaddingInner:i,tickBandPaddingInner:a,bandWithNestedOffsetPaddingInner:s}=r;return o?s:ae9(e,"bar"===n?t:"tick"===n?a:i);}if(Zt4(t)&&i===Er2)return r.offsetBandPaddingInner;return;})(e,t,n.type,i,r.scale,o),paddingOuter:({scalePadding:e,channel:t,scaleType:n,scalePaddingInner:i,config:r,hasNestedOffsetScale:o})=>(function(e,t,n,i,r,o=!1){if(void 0!==e)return;if(Yt6(t)){const{bandPaddingOuter:e,bandWithNestedOffsetPaddingOuter:t}=r;if(o)return t;if(n===Er2)return ae9(e,Rn6(i)?{signal:`${i.signal}/2`}:i/2);}else if(Zt4(t)){if(n===Tr2)return .5;if(n===Er2)return r.offsetBandPaddingOuter;}return;})(e,t,n,i,r.scale,o),reverse:({fieldOrDatumDef:e,scaleType:t,channel:n,config:i})=>(function(e,t,n,i){if("x"===n&&void 0!==i.xReverse)return Vr1(e)&&"descending"===t?Rn6(i.xReverse)?{signal:`!${i.xReverse.signal}`}:!i.xReverse:i.xReverse;if(Vr1(e)&&"descending"===t)return!0;return;})(t,ya(e)?e.sort:void 0,n,i.scale),zero:({channel:e,fieldOrDatumDef:n,domain:i,markDef:r,scaleType:o,config:a,hasSecondaryRangeChannel:s})=>(function(e,n,i,r,o,a,s){if(i&&"unaggregated"!==i&&Vr1(o)){if(w(i)){const e=i[0],n=i[i.length-1];if(yn(e)&&e<=0&&yn(n)&&n>=0)return!0;}return!1;}if("size"===e&&"quantitative"===n.type&&!Yr1(o))return!0;if((!ya(n)||!n.bin)&&T21([...Gt5,...Jt5],e)){const{orient:t,type:n}=r;return(!T21(["bar","area","line","trail"],n)||!("horizontal"===t&&"y"===e||"vertical"===t&&"x"===e))&&(!(!T21(["bar","area"],n)||s)||a?.zero);}return!1;})(e,n,i,r,o,a.scale,s)};function Im(e){Jm(e)?function(e){const t=e.component.scales;for(const n of dn8){const i=t[n];if(!i)continue;const r=Em(n,e);i.setWithExplicit("range",r);}}(e):Hm(e,"range");}function Hm(e,t){const n=e.component.scales;for(const n of e.children)"range"===t?Im(n):Wm(n,t);for(const i of H21(n)){let r;for(const n of e.children){const e=n.component.scales[i];if(e){r=Cl(r,e.getWithExplicit(t),t,"scale",Fl((e,n)=>"range"===t&&e.step&&n.step?e.step-n.step:0));}}n[i].setWithExplicit(t,r);}}function Vm(e,t,n,i,r=!1){const o=function(e,t,n,i){switch(t.type){case"nominal":case"ordinal":if(at11(e)||"discrete"===vn7(e))return"shape"===e&&"ordinal"===t.type&&qi2(zi2(e,"ordinal")),"ordinal";if(Yt6(e)||Zt4(e)){if(T21(["rect","bar","image","rule","tick"],n.type))return"band";if(i)return"band";}else if("arc"===n.type&&e in Xt5)return"band";return _o(n[Dt8(e)])||za1(t)&&t.axis?.tickBand?"band":"point";case"temporal":return at11(e)?"time":"discrete"===vn7(e)?(qi2(zi2(e,"temporal")),"ordinal"):ya(t)&&t.timeUnit&&rr3(t.timeUnit).utc?"utc":"time";case"quantitative":return at11(e)?ya(t)&&_n6(t.bin)?"bin-ordinal":"linear":"discrete"===vn7(e)?(qi2(zi2(e,"quantitative")),"ordinal"):"linear";case"geojson":return;}throw new Error($i3(t.type));}(t,n,i,r),{type:a}=e;return mn8(t)?void 0!==a?function(e,t,n=!1){if(!mn8(e))return!1;switch(e){case xe6:case $e3:case Se5:case De5:case Ce6:case Fe5:return!!Gr1(t)||"band"===t||"point"===t&&!n;case Re5:case Be5:case Le5:case Ue5:case We3:case qe4:return Gr1(t)||Yr1(t)||T21(["band","point","ordinal"],t);case Ee5:case je4:case Ae5:return"band"!==t;case Ie6:case Me6:return"ordinal"===t||Yr1(t);}}(t,a)?ya(n)&&(s=a,c=n.type,!(T21([kr2,Dr3],c)?void 0===s||Hr1(s):c===Sr2?T21([Pr3,Nr2,void 0],s):c!==wr2||Ur1(s)||Yr1(s)||void 0===s))?(qi2(function(e,t){return`FieldDef does not work with "${e}" scale. We are using "${t}" scale instead.`;}(a,o)),o):a:(qi2(function(e,t,n){return`Channel "${e}" does not work with "${t}" scale. We are using "${n}" scale instead.`;}(t,a,o)),o):o:null;var s,c;}function Gm(e){Jm(e)?e.component.scales=function(e){const{encoding:t,mark:n,markDef:i}=e,r={};for(const o of dn8){const a=Ua1(t[o]);if(a&&n===$o&&o===Me6&&a.type===Fr2)continue;let s=a&&a.scale;if(a&&null!==s&&!1!==s){s??(s={});const n=Vm(s,o,a,i,ls(t,o));r[o]=new Pm(e.scaleName(`${o}`,!0),{value:n,explicit:s.type===n});}}return r;}(e):e.component.scales=function(e){var t;const n=e.component.scales={},i={},r=e.component.resolve;for(const n of e.children){Gm(n);for(const o of H21(n.component.scales))if((t=r.scale)[o]??(t[o]=nd(o,e)),"shared"===r.scale[o]){const e=i[o],t=n.component.scales[o].getWithExplicit("type");e?Ar2(e.value,t.value)?i[o]=Cl(e,t,"type","scale",Ym):(r.scale[o]="independent",delete i[o]):i[o]=t;}}for(const t of H21(i)){const r=e.scaleName(t,!0),o=i[t];n[t]=new Pm(r,o);for(const n of e.children){const e=n.component.scales[t];e&&(n.renameScale(e.get("name"),r),e.merged=!0);}}return n;}(e);}const Ym=Fl((e,t)=>Rr2(e)-Rr2(t));class Xm{constructor(){this.nameMap={};}rename(e,t){this.nameMap[e]=t;}has(e){return void 0!==this.nameMap[e];}get(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e;}}function Jm(e){return"unit"===e?.type;}function Qm(e){return"facet"===e?.type;}function Km(e){return"concat"===e?.type;}function Zm(e){return"layer"===e?.type;}class ep{constructor(e,n,i,r,o,a,s){this.type=n,this.parent=i,this.config=o,this.correctDataNames=e=>(e.from?.data&&(e.from.data=this.lookupDataSource(e.from.data)),e.from?.facet?.data&&(e.from.facet.data=this.lookupDataSource(e.from.facet.data)),e),this.parent=i,this.config=o,this.view=jn8(s),this.name=e.name??r,this.title=Mn7(e.title)?{text:e.title}:e.title?jn8(e.title):void 0,this.scaleNameMap=i?i.scaleNameMap:new Xm,this.projectionNameMap=i?i.projectionNameMap:new Xm,this.signalNameMap=i?i.signalNameMap:new Xm,this.data=e.data,this.description=e.description,this.transforms=(e.transform??[]).map(e=>Hc(e)?{filter:F20(e.filter,br2)}:e),this.layout="layer"===n||"unit"===n?{}:function(e,n,i){const r=i[n],o={},{spacing:a,columns:s}=r;void 0!==a&&(o.spacing=a),void 0!==s&&(sa(e)&&!oa(e.facet)||Ks(e))&&(o.columns=s),Zs(e)&&(o.columns=1);for(const n of rc)if(void 0!==e[n])if("spacing"===n){const i=e[n];o[n]=yn(i)?i:{row:i.row??a,column:i.column??a};}else o[n]=e[n];return o;}(e,n,o),this.component={data:{sources:i?i.component.data.sources:[],outputNodes:i?i.component.data.outputNodes:{},outputNodeRefCounts:i?i.component.data.outputNodeRefCounts:{},isFaceted:sa(e)||i?.component.data.isFaceted&&void 0===e.data},layoutSize:new kl,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...a?z23(a):{}},selection:null,scales:null,projection:null,axes:{},legends:{}};}get width(){return this.getSizeSignalRef("width");}get height(){return this.getSizeSignalRef("height");}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup();}parseScale(){!function(e,{ignoreRange:t}={}){Gm(e),vm(e);for(const t of io)Wm(e,t);t||Im(e);}(this);}parseProjection(){Dd(this);}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height");}parseLegends(){gd(this);}assembleEncodeFromView(e){const{style:t,...n}=e,i={};for(const e of H21(n)){const t=n[e];void 0!==t&&(i[e]=Gn5(t));}return i;}assembleGroupEncodeEntry(e){let t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=Gn5(this.description)),"unit"!==this.type&&"layer"!==this.type)?I19(t)?void 0:t:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...t};}assembleLayout(){if(!this.layout)return;const{spacing:e,...t}=this.layout,{component:n,config:i}=this,r=function(e,t){const n={};for(const i of ct9){const r=e[i];if(r?.facetFieldDef){const{titleAnchor:e,titleOrient:o}=Mf1(["titleAnchor","titleOrient"],r.facetFieldDef.header,t,i),a=jf(i,o),s=Yf(e,a);void 0!==s&&(n[a]=s);}}return I19(n)?void 0:n;}(n.layoutHeaders,i);return{padding:e,...this.assembleDefaultLayout(),...t,...r?{titleBand:r}:{}};}assembleDefaultLayout(){return{};}assembleHeaderMarks(){const{layoutHeaders:e}=this.component;let t=[];for(const n of ct9)e[n].title&&t.push(Lf(this,n));for(const e of Rf)t=t.concat(Bf(this,e));return t;}assembleAxes(){return function(e,t){const{x:n=[],y:i=[]}=e;return[...n.map(e=>kf(e,"grid",t)),...i.map(e=>kf(e,"grid",t)),...n.map(e=>kf(e,"main",t)),...i.map(e=>kf(e,"main",t))].filter(e=>e);}(this.component.axes,this.config);}assembleLegends(){return xd(this);}assembleProjections(){return $d(this);}assembleTitle(){const{encoding:e,...t}=this.title??{},n={...An6(this.config.title).nonMarkTitleProperties,...t,...e?{encode:{update:e}}:{}};if(n.text)return T21(["unit","layer"],this.type)?T21(["middle",void 0],n.anchor)&&(n.frame??(n.frame="group")):n.anchor??(n.anchor="start"),I19(n)?void 0:n;}assembleGroup(e=[]){const t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);const n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const i=!this.parent||Qm(this.parent)?_m(this):[];i.length>0&&(t.scales=i);const r=this.assembleAxes();r.length>0&&(t.axes=r);const o=this.assembleLegends();return o.length>0&&(t.legends=o),t;}getName(e){return X22((this.name?`${this.name}_`:"")+e);}getDataName(e){return this.getName(Ml[e].toLowerCase());}requestDataName(e){const t=this.getDataName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t;}getSizeSignalRef(e){if(Qm(this.parent)){const t=Qt4(ed(e)),n=this.component.scales[t];if(n&&!n.merged){const e=n.get("type"),i=n.get("range");if(Hr1(e)&&qn5(i)){const e=n.get("name"),i=zm(Cm(this,t));if(i){return{signal:Zf(e,n,Pa({aggregate:"distinct",field:i},{expr:"datum"}))};}return qi2(di3(t)),null;}}}return{signal:this.signalNameMap.get(this.getName(e))};}lookupDataSource(e){const t=this.component.data.outputNodes[e];return t?t.getSource():e;}getSignalName(e){return this.signalNameMap.get(e);}renameSignal(e,t){this.signalNameMap.rename(e,t);}renameScale(e,t){this.scaleNameMap.rename(e,t);}renameProjection(e,t){this.projectionNameMap.rename(e,t);}scaleName(e,t){return t?this.getName(e):bt8(e)&&mn8(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0;}projectionName(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0;}getScaleComponent(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0;}getScaleType(e){const t=this.getScaleComponent(e);return t?t.get("type"):void 0;}getSelectionComponent(e,t){let n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(function(e){return`Cannot find a selection named "${e}".`;}(t));return n;}hasAxisOrientSignalRef(){return this.component.axes.x?.some(e=>e.hasOrientSignalRef())||this.component.axes.y?.some(e=>e.hasOrientSignalRef());}}class tp extends ep{vgField(e,t={}){const n=this.fieldDef(e);if(n)return Pa(n,t);}reduceFieldDef(e,t){return function(e,t,n,i){return e?H21(e).reduce((n,r)=>{const o=e[r];return w(o)?o.reduce((e,n)=>t.call(i,e,n,r),n):t.call(i,n,o,r);},n):n;}(this.getMapping(),(t,n,i)=>{const r=La(n);return r?e(t,r,i):t;},t);}forEachFieldDef(e,t){ps(this.getMapping(),(t,n)=>{const i=La(t);i&&e(i,n);},t);}}class np extends Hl{clone(){return new np(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"value",n[1]??"density"];const i=this.transform.resolve??"shared";this.transform.resolve=i;}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]]);}producedFields(){return new Set(this.transform.as);}hash(){return`DensityTransform ${P20(this.transform)}`;}assemble(){const{density:e,...t}=this.transform,n={type:"kde",field:e,...t};return n.resolve=this.transform.resolve,n;}}class ip extends Hl{clone(){return new ip(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);}dependentFields(){return new Set([this.transform.extent]);}producedFields(){return new Set([]);}hash(){return`ExtentTransform ${P20(this.transform)}`;}assemble(){const{extent:e,param:t}=this.transform;return{type:"extent",field:e,signal:t};}}class rp extends Hl{clone(){return new rp(this.parent,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const{flatten:n,as:i=[]}=this.transform;this.transform.as=n.map((e,t)=>i[t]??e);}dependentFields(){return new Set(this.transform.flatten);}producedFields(){return new Set(this.transform.as);}hash(){return`FlattenTransform ${P20(this.transform)}`;}assemble(){const{flatten:e,as:t}=this.transform;return{type:"flatten",fields:e,as:t};}}class op extends Hl{clone(){return new op(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"key",n[1]??"value"];}dependentFields(){return new Set(this.transform.fold);}producedFields(){return new Set(this.transform.as);}hash(){return`FoldTransform ${P20(this.transform)}`;}assemble(){const{fold:e,as:t}=this.transform;return{type:"fold",fields:e,as:t};}}class ap extends Hl{clone(){return new ap(null,z23(this.fields),this.geojson,this.signal);}static parseAll(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;let n=0;for(const i of[[Pe5,Oe5],[Te5,Ne6]]){const r=i.map(e=>{const n=Ua1(t.encoding[e]);return ya(n)?n.field:ba(n)?{expr:`${n.datum}`}:Da1(n)?{expr:`${n.value}`}:void 0;});(r[0]||r[1])&&(e=new ap(e,r,null,t.getName("geojson_"+n++)));}if(t.channelHasField(Me6)){const i=t.typedFieldDef(Me6);i.type===Fr2&&(e=new ap(e,null,i.field,t.getName("geojson_"+n++)));}return e;}constructor(e,t,n,i){super(e),this.fields=t,this.geojson=n,this.signal=i;}dependentFields(){const e=(this.fields??[]).filter(Mn);return new Set([...this.geojson?[this.geojson]:[],...e]);}producedFields(){return new Set;}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${P20(this.fields)}`;}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}];}}class sp extends Hl{clone(){return new sp(null,this.projection,z23(this.fields),z23(this.as));}constructor(e,t,n,i){super(e),this.projection=t,this.fields=n,this.as=i;}static parseAll(e,t){if(!t.projectionName())return e;for(const n of[[Pe5,Oe5],[Te5,Ne6]]){const i=n.map(e=>{const n=Ua1(t.encoding[e]);return ya(n)?n.field:ba(n)?{expr:`${n.datum}`}:Da1(n)?{expr:`${n.value}`}:void 0;}),r=n[0]===Te5?"2":"";(i[0]||i[1])&&(e=new sp(e,t.projectionName(),i,[t.getName(`x${r}`),t.getName(`y${r}`)]));}return e;}dependentFields(){return new Set(this.fields.filter(Mn));}producedFields(){return new Set(this.as);}hash(){return`Geopoint ${this.projection} ${P20(this.fields)} ${P20(this.as)}`;}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as};}}class cp extends Hl{clone(){return new cp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t;}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]]);}producedFields(){return new Set([this.transform.impute]);}processSequence(e){const{start:t=0,stop:n,step:i}=e;return{signal:`sequence(${[t,n,...i?[i]:[]].join(",")})`};}static makeFromTransform(e,t){return new cp(e,t);}static makeFromEncoding(e,t){const n=t.encoding,i=n.x,r=n.y;if(ya(i)&&ya(r)){const o=i.impute?i:r.impute?r:void 0;if(void 0===o)return;const a=i.impute?r:r.impute?i:void 0,{method:s,value:c,frame:l,keyvals:u}=o.impute,f=gs(t.mark,n);return new cp(e,{impute:o.field,key:a.field,...s?{method:s}:{},...void 0!==c?{value:c}:{},...l?{frame:l}:{},...void 0!==u?{keyvals:u}:{},...f.length?{groupby:f}:{}});}return null;}hash(){return`Impute ${P20(this.transform)}`;}assemble(){const{impute:e,key:t,keyvals:n,method:i,groupby:r,value:o,frame:a=[null,null]}=this.transform,s={type:"impute",field:e,key:t,...n?{keyvals:(c=n,void 0!==c?.stop?this.processSequence(n):n)}:{},method:"value",...r?{groupby:r}:{},value:i&&"value"!==i?null:o};var c;if(i&&"value"!==i){return[s,{type:"window",as:[`imputed_${e}_value`],ops:[i],fields:[e],frame:a,ignorePeers:!1,...r?{groupby:r}:{}},{type:"formula",expr:`datum.${e} === null ? datum.imputed_${e}_value : datum.${e}`,as:e}];}return[s];}}class lp extends Hl{clone(){return new lp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.loess];}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]]);}producedFields(){return new Set(this.transform.as);}hash(){return`LoessTransform ${P20(this.transform)}`;}assemble(){const{loess:e,on:t,...n}=this.transform;return{type:"loess",x:t,y:e,...n};}}class up extends Hl{clone(){return new up(null,z23(this.transform),this.secondary);}constructor(e,t,n){super(e),this.transform=t,this.secondary=n;}static make(e,t,n,i){const r=t.component.data.sources,{from:o}=n;let a=null;if(function(e){return"data"in e;}(o)){let e=Dp(o.data,r);e||(e=new Ud(o.data),r.push(e));const n=t.getName(`lookup_${i}`);a=new Vl(e,n,Ml.Lookup,t.component.data.outputNodeRefCounts),t.component.data.outputNodes[n]=a;}else if(function(e){return"param"in e;}(o)){const e=o.param;let i;n={as:e,...n};try{i=t.getSelectionComponent(X22(e),e);}catch(t){throw new Error(function(e){return`Lookups can only be performed on selection parameters. "${e}" is a variable parameter.`;}(e));}if(a=i.materialized,!a)throw new Error(function(e){return`Cannot define and lookup the "${e}" selection in the same view. Try moving the lookup into a second, layered view?`;}(e));}return new up(e,n,a.getSource());}dependentFields(){return new Set([this.transform.lookup]);}producedFields(){return new Set(this.transform.as?H(this.transform.as):this.transform.from.fields);}hash(){return`Lookup ${P20({transform:this.transform,secondary:this.secondary})}`;}assemble(){let e;if(this.transform.from.fields)e={values:this.transform.from.fields,...this.transform.as?{as:H(this.transform.as)}:{}};else{let t=this.transform.as;Mn(t)||(qi2('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]};}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...e,...this.transform.default?{default:this.transform.default}:{}};}}class fp extends Hl{clone(){return new fp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"prob",n[1]??"value"];}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]]);}producedFields(){return new Set(this.transform.as);}hash(){return`QuantileTransform ${P20(this.transform)}`;}assemble(){const{quantile:e,...t}=this.transform;return{type:"quantile",field:e,...t};}}class dp extends Hl{clone(){return new dp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t,this.transform=z23(t);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??t.on,n[1]??t.regression];}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]]);}producedFields(){return new Set(this.transform.as);}hash(){return`RegressionTransform ${P20(this.transform)}`;}assemble(){const{regression:e,on:t,...n}=this.transform;return{type:"regression",x:t,y:e,...n};}}class mp extends Hl{clone(){return new mp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t;}addDimensions(e){this.transform.groupby=R20((this.transform.groupby??[]).concat(e),e=>e);}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]]);}hash(){return`PivotTransform ${P20(this.transform)}`;}assemble(){const{pivot:e,value:t,groupby:n,limit:i,op:r}=this.transform;return{type:"pivot",field:e,value:t,...void 0!==i?{limit:i}:{},...void 0!==r?{op:r}:{},...void 0!==n?{groupby:n}:{}};}}class pp extends Hl{clone(){return new pp(null,z23(this.transform));}constructor(e,t){super(e),this.transform=t;}dependentFields(){return new Set;}producedFields(){return new Set;}hash(){return`SampleTransform ${P20(this.transform)}`;}assemble(){return{type:"sample",size:this.transform.sample};}}function gp(e){let t=0;return function n(i,r){if(i instanceof Ud&&!i.isGenerator&&!Ol(i.data)){e.push(r);r={name:null,source:r.name,transform:[]};}if(i instanceof Md&&(i.parent instanceof Ud&&!r.source?(r.format={...r.format,parse:i.assembleFormatParse()},r.transform.push(...i.assembleTransforms(!0))):r.transform.push(...i.assembleTransforms())),i instanceof Td)return r.name||(r.name="data_"+t++),!r.source||r.transform.length>0?(e.push(r),i.data=r.name):i.data=r.source,void e.push(...i.assemble());if((i instanceof qd||i instanceof Ld||i instanceof sm||i instanceof vf1||i instanceof Tf||i instanceof sp||i instanceof Nd||i instanceof up||i instanceof um||i instanceof am||i instanceof op||i instanceof rp||i instanceof np||i instanceof lp||i instanceof fp||i instanceof dp||i instanceof Rd||i instanceof pp||i instanceof mp||i instanceof ip)&&r.transform.push(i.assemble()),(i instanceof Od||i instanceof Xl||i instanceof cp||i instanceof lm||i instanceof ap)&&r.transform.push(...i.assemble()),i instanceof Vl){if(r.source&&0===r.transform.length)i.setSource(r.source);else if(i.parent instanceof Vl)i.setSource(r.name);else if(r.name||(r.name="data_"+t++),i.setSource(r.name),1===i.numChildren()){e.push(r);r={name:null,source:r.name,transform:[]};}}switch(i.numChildren()){case 0:i instanceof Vl&&(!r.source||r.transform.length>0)&&e.push(r);break;case 1:n(i.children[0],r);break;default:{r.name||(r.name="data_"+t++);let o=r.name;!r.source||r.transform.length>0?e.push(r):o=r.source;for(const e of i.children){n(e,{name:null,source:o,transform:[]});}break;}}};}function hp(e){return"top"===e||"left"===e||Rn6(e)?"header":"footer";}function yp(e,t){const{facet:n,config:i,child:r,component:o}=e;if(e.channelHasField(t)){const a=n[t],s=Af("title",null,i,t);let l=Aa(a,i,{allowDisabling:!0,includeDefault:void 0===s||!!s});r.component.layoutHeaders[t].title&&(l=w(l)?l.join(", "):l,l+=` / ${r.component.layoutHeaders[t].title}`,r.component.layoutHeaders[t].title=null);const u=Af("labelOrient",a.header,i,t),f=null!==a.header&&ae9(a.header?.labels,i.header.labels,!0),d=T21(["bottom","right"],u)?"footer":"header";o.layoutHeaders[t]={title:null!==a.header?l:null,facetFieldDef:a,[d]:"facet"===t?[]:[vp(e,t,f)]};}}function vp(e,t,n){const i="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(i)?e.child.getSizeSignalRef(i):void 0,axes:[]};}function bp(e,t){const{child:n}=e;if(n.component.axes[t]){const{layoutHeaders:i,resolve:r}=e.component;if(r.axis[t]=id(r,t),"shared"===r.axis[t]){const r="x"===t?"column":"row",o=i[r];for(const i of n.component.axes[t]){const t=hp(i.get("orient"));o[t]??(o[t]=[vp(e,r,!1)]);const n=kf(i,"main",e.config,{header:!0});n&&o[t][0].axes.push(n),i.mainExtracted=!0;}}}}function xp(e){for(const t of e.children)t.parseLayoutSize();}function $p(e,t){const n=ed(t),i=Qt4(n),r=e.component.resolve,o=e.component.layoutSize;let a;for(const t of e.children){const o=t.component.layoutSize.getWithExplicit(n),s=r.scale[i]??nd(i,e);if("independent"===s&&"step"===o.value){a=void 0;break;}if(a){if("independent"===s&&a.value!==o.value){a=void 0;break;}a=Cl(a,o,n,"");}else a=o;}if(a){for(const i of e.children)e.renameSignal(i.getName(n),e.getName(t)),i.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(t,a);}else o.setWithExplicit(t,{explicit:!1,value:void 0});}function wp(e,t){const n="width"===t?"x":"y",i=e.config,r=e.getScaleComponent(n);if(r){const e=r.get("type"),n=r.get("range");if(Hr1(e)){const e=sc(i.view,t);return qn5(n)||nc(e)?"step":e;}return oc(i.view,t);}if(e.hasProjection||"arc"===e.mark)return oc(i.view,t);{const e=sc(i.view,t);return nc(e)?e.step:e;}}function kp(e,t,n){return Pa(t,{suffix:`by_${Pa(e)}`,...n});}class Sp extends tp{constructor(e,t,n,i){super(e,"facet",t,n,i,e.resolve),this.child=Kp(e.spec,this,this.getName("child"),void 0,i),this.children=[this.child],this.facet=this.initFacet(e.facet);}initFacet(e){if(!oa(e))return{facet:this.initFacetFieldDef(e,"facet")};const t=H21(e),n={};for(const i of t){if(![ye6,ve6].includes(i)){qi2(Si2(i,"facet"));break;}const t=e[i];if(void 0===t.field){qi2(ki3(t,i));break;}n[i]=this.initFacetFieldDef(t,i);}return n;}initFacetFieldDef(e,t){const n=Ia(e,t);return n.header?n.header=jn8(n.header):null===n.header&&(n.header=null),n;}channelHasField(e){return!!this.facet[e];}fieldDef(e){return this.facet[e];}parseData(){this.component.data=Fp(this),this.child.parseData();}parseLayoutSize(){xp(this);}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection;}parseMarkGroup(){this.child.parseMarkGroup();}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(e){for(const t of ct9)yp(e,t);bp(e,"x"),bp(e,"y");}(this);}assembleSelectionTopLevelSignals(e){return this.child.assembleSelectionTopLevelSignals(e);}assembleSignals(){return this.child.assembleSignals(),[];}assembleSelectionData(e){return this.child.assembleSelectionData(e);}getHeaderLayoutMixins(){const e={};for(const t of ct9)for(const n of qf){const i=this.component.layoutHeaders[t],r=i[n],{facetFieldDef:o}=i;if(o){const n=Af("titleOrient",o.header,this.config,t);if(["right","bottom"].includes(n)){const i=jf(t,n);e.titleAnchor??(e.titleAnchor={}),e.titleAnchor[i]="end";}}if(r?.[0]){const r="row"===t?"height":"width",o="header"===n?"headerBand":"footerBand";"facet"===t||this.child.component.layoutSize.get(r)||(e[o]??(e[o]={}),e[o][t]=.5),i.title&&(e.offset??(e.offset={}),e.offset["row"===t?"rowTitle":"columnTitle"]=10);}}return e;}assembleDefaultLayout(){const{column:e,row:t}=this.facet,n=e?this.columnDistinctSignal():t?1:void 0;let i="all";return(t||"independent"!==this.component.resolve.scale.x)&&(e||"independent"!==this.component.resolve.scale.y)||(i="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:i};}assembleLayoutSignals(){return this.child.assembleLayoutSignals();}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof Sp)){return{signal:`length(data('${this.getName("column_domain")}'))`};}}assembleGroupStyle(){}assembleGroup(e){return this.parent&&this.parent instanceof Sp?{...this.channelHasField("column")?{encode:{update:{columns:{field:Pa(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(e)}:super.assembleGroup(e);}getCardinalityAggregateForChild(){const e=[],t=[],n=[];if(this.child instanceof Sp){if(this.child.channelHasField("column")){const i=Pa(this.child.facet.column);e.push(i),t.push("distinct"),n.push(`distinct_${i}`);}}else for(const i of Gt5){const r=this.child.component.scales[i];if(r&&!r.merged){const o=r.get("type"),a=r.get("range");if(Hr1(o)&&qn5(a)){const r=zm(Cm(this.child,i));r?(e.push(r),t.push("distinct"),n.push(`distinct_${r}`)):qi2(di3(i));}}}return{fields:e,ops:t,as:n};}assembleFacet(){const{name:e,data:t}=this.component.data.facetRoot,{row:n,column:i}=this.facet,{fields:r,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const e of ct9){const t=this.facet[e];if(t){s.push(Pa(t));const{bin:l,sort:u}=t;if(_n6(l)&&s.push(Pa(t,{binSuffix:"end"})),ia(u)){const{field:e,op:s=ea}=u,c=kp(t,u);n&&i?(r.push(c),o.push("max"),a.push(c)):(r.push(e),o.push(s),a.push(c));}else if(w(u)){const n=Ef(t,e);r.push(n),o.push("max"),a.push(n);}}}const l=!!n&&!!i;return{name:e,data:t,groupby:s,...l||r.length>0?{aggregate:{...l?{cross:l}:{},...r.length?{fields:r,ops:o,as:a}:{}}}:{}};}facetSortFields(e){const{facet:t}=this,n=t[e];return n?ia(n.sort)?[kp(n,n.sort,{expr:"datum"})]:w(n.sort)?[Ef(n,e,{expr:"datum"})]:[Pa(n,{expr:"datum"})]:[];}facetSortOrder(e){const{facet:t}=this,n=t[e];if(n){const{sort:e}=n;return[(ia(e)?e.order:!w(e)&&e)||"ascending"];}return[];}assembleLabelTitle(){const{facet:e,config:t}=this;if(e.facet)return Hf(e.facet,"facet",t);const n={row:["top","bottom"],column:["left","right"]};for(const i of Rf)if(e[i]){const r=Af("labelOrient",e[i]?.header,t,i);if(n[i].includes(r))return Hf(e[i],i,t);}}assembleMarks(){const{child:e}=this,t=function(e){const t=[],n=gp(t);for(const t of e.children)n(t,{source:e.name,name:null,transform:[]});return t;}(this.component.data.facetRoot),n=e.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||e.assembleTitle(),r=e.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...i?{title:i}:{},...r?{style:r}:{},from:{facet:this.assembleFacet()},sort:{field:ct9.map(e=>this.facetSortFields(e)).flat(),order:ct9.map(e=>this.facetSortOrder(e)).flat()},...t.length>0?{data:t}:{},...n?{encode:{update:n}}:{},...e.assembleGroup(Wl(this,[]))}];}getMapping(){return this.facet;}}function Dp(e,t){for(const n of t){const t=n.data;if(e.name&&n.hasName()&&e.name!==n.dataName)continue;const i=e.format?.mesh,r=t.format?.feature;if(i&&r)continue;const o=e.format?.feature;if((o||r)&&o!==r)continue;const a=t.format?.mesh;if(!i&&!a||i===a){if(Pl(e)&&Pl(t)){if(ge7(e.values,t.values))return n;}else if(Ol(e)&&Ol(t)){if(e.url===t.url)return n;}else if(Nl(e)&&e.name===n.dataName)return n;}}return null;}function Fp(e){let t=function(e,t){if(e.data||!e.parent){if(null===e.data){const e=new Ud({values:[]});return t.push(e),e;}const n=Dp(e.data,t);if(n)return Tl(e.data)||(n.data.format=A22({},e.data.format,n.data.format)),!n.hasName()&&e.data.name&&(n.dataName=e.data.name),n;{const n=new Ud(e.data);return t.push(n),n;}}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main;}(e,e.component.data.sources);const{outputNodes:n,outputNodeRefCounts:i}=e.component.data,r=e.data,o=!(r&&(Tl(r)||Ol(r)||Pl(r)))&&e.parent?e.parent.component.data.ancestorParse.clone():new _l;Tl(r)?(El(r)?t=new Ld(t,r.sequence):Al(r)&&(t=new qd(t,r.graticule)),o.parseNothing=!0):null===r?.format?.parse&&(o.parseNothing=!0),t=Md.makeExplicit(t,e,o)??t,t=new Rd(t);const a=e.parent&&Zm(e.parent);(Jm(e)||Qm(e))&&a&&(t=Od.makeFromEncoding(t,e)??t),e.transforms.length>0&&(t=function(e,t,n){let i=0;for(const r of t.transforms){let o,a;if(nl(r))a=e=new Tf(e,r),o="derived";else if(Hc(r)){const i=jd(r);a=e=Md.makeWithAncestors(e,{},i,n)??e,e=new vf1(e,t,r.filter);}else if(il(r))a=e=Od.makeFromTransform(e,r,t),o="number";else if(ol(r))o="date",void 0===n.getWithExplicit(r.field).value&&(e=new Md(e,{[r.field]:o}),n.set(r.field,o,!1)),a=e=Xl.makeFromTransform(e,r);else if(al(r))a=e=Nd.makeFromTransform(e,r),o="number",mf1(t)&&(e=new Rd(e));else if(Vc(r))a=e=up.make(e,t,r,i++),o="derived";else if(Zc(r))a=e=new um(e,r),o="number";else if(el(r))a=e=new am(e,r),o="number";else if(sl(r))a=e=lm.makeFromTransform(e,r),o="derived";else if(cl(r))a=e=new op(e,r),o="derived";else if(ll(r))a=e=new ip(e,r),o="derived";else if(tl(r))a=e=new rp(e,r),o="derived";else if(Gc(r))a=e=new mp(e,r),o="derived";else if(Kc(r))e=new pp(e,r);else if(rl(r))a=e=cp.makeFromTransform(e,r),o="derived";else if(Yc(r))a=e=new np(e,r),o="derived";else if(Xc(r))a=e=new fp(e,r),o="derived";else if(Jc(r))a=e=new dp(e,r),o="derived";else{if(!Qc(r)){qi2(`Ignoring an invalid transform: ${he7(r)}.`);continue;}a=e=new lp(e,r),o="derived";}if(a&&void 0!==o)for(const e of a.producedFields()??[])n.set(e,o,!1);}return e;}(t,e,o));const s=function(e){const t={};if(Jm(e)&&e.component.selection)for(const n of H21(e.component.selection)){const i=e.component.selection[n];for(const e of i.project.items)!e.channel&&oe7(e.field)>1&&(t[e.field]="flatten");}return t;}(e),c=Ad(e);t=Md.makeWithAncestors(t,{},{...s,...c},o)??t,Jm(e)&&(t=ap.parseAll(t,e),t=sp.parseAll(t,e)),(Jm(e)||Qm(e))&&(a||(t=Od.makeFromEncoding(t,e)??t),t=Xl.makeFromEncoding(t,e)??t,t=Tf.parseAllForSortIndex(t,e));const l=t=zp(Ml.Raw,e,t);if(Jm(e)){const n=Nd.makeFromEncoding(t,e);n&&(t=n,mf1(e)&&(t=new Rd(t))),t=cp.makeFromEncoding(t,e)??t,t=lm.makeFromEncoding(t,e)??t;}let u,f;if(Jm(e)){const{markDef:n,mark:i,config:r}=e,o=Zn5("invalid",n,r),{marks:a,scales:s}=f=Rl({invalid:o,isPath:wo(i)});a!==s&&"include-invalid-values"===s&&(u=t=zp(Ml.PreFilterInvalid,e,t)),"exclude-invalid-values"===a&&(t=sm.make(t,e,f)??t);}const d=t=zp(Ml.Main,e,t);let m;if(Jm(e)&&f){const{marks:n,scales:i}=f;"include-invalid-values"===n&&"exclude-invalid-values"===i&&(t=sm.make(t,e,f)??t,m=t=zp(Ml.PostFilterInvalid,e,t));}Jm(e)&&function(e,t){for(const[n,i]of G21(e.component.selection??{})){const r=e.getName(`lookup_${n}`);e.component.data.outputNodes[r]=i.materialized=new Vl(new vf1(t,e,{param:n}),r,Ml.Lookup,e.component.data.outputNodeRefCounts);}}(e,d);let p=null;if(Qm(e)){const i=e.getName("facet");t=function(e,t){const{row:n,column:i}=t;if(n&&i){let t=null;for(const r of[n,i])if(ia(r.sort)){const{field:n,op:i=ea}=r.sort;e=t=new am(e,{joinaggregate:[{op:i,field:n,as:kp(r,r.sort,{forAs:!0})}],groupby:[Pa(r)]});}return t;}return null;}(t,e.facet)??t,p=new Td(t,e,i,d.getSource()),n[i]=p;}return{...e.component.data,outputNodes:n,outputNodeRefCounts:i,raw:l,main:d,facetRoot:p,ancestorParse:o,preFilterInvalid:u,postFilterInvalid:m};}function zp(e,t,n){const{outputNodes:i,outputNodeRefCounts:r}=t.component.data,o=t.getDataName(e),a=new Vl(n,o,e,r);return i[o]=a,a;}class Cp extends ep{constructor(e,t,n,i){super(e,"concat",t,n,i,e.resolve),"shared"!==e.resolve?.axis?.x&&"shared"!==e.resolve?.axis?.y||qi2("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(e).map((e,t)=>Kp(e,this,this.getName(`concat_${t}`),void 0,i));}parseData(){this.component.data=Fp(this);for(const e of this.children)e.parseData();}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of H21(e.component.selection))this.component.selection[t]=e.component.selection[t];}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup();}parseAxesAndHeaders(){for(const e of this.children)e.parseAxesAndHeaders();}getChildren(e){return Zs(e)?e.vconcat:ec(e)?e.hconcat:e.concat;}parseLayoutSize(){!function(e){xp(e);const t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";$p(e,t),$p(e,n);}(this);}parseAxisGroup(){return null;}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e);}assembleSignals(){return this.children.forEach(e=>e.assembleSignals()),[];}assembleLayoutSignals(){const e=Jf(this);for(const t of this.children)e.push(...t.assembleLayoutSignals());return e;}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e);}assembleMarks(){return this.children.map(e=>{const t=e.assembleTitle(),n=e.assembleGroupStyle(),i=e.assembleGroupEncodeEntry(!1);return{type:"group",name:e.getName("group"),...t?{title:t}:{},...n?{style:n}:{},...i?{encode:{update:i}}:{},...e.assembleGroup()};});}assembleGroupStyle(){}assembleDefaultLayout(){const e=this.layout.columns;return{...null!=e?{columns:e}:{},bounds:"full",align:"each"};}}const _p={disable:1,gridScale:1,scale:1,...ts,labelExpr:1,encode:1},Op=H21(_p);class Pp extends kl{constructor(e={},t={},n=!1){super(),this.explicit=e,this.implicit=t,this.mainExtracted=n;}clone(){return new Pp(z23(this.explicit),z23(this.implicit),this.mainExtracted);}hasAxisPart(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t;}hasOrientSignalRef(){return Rn6(this.explicit.orient);}}const Np={bottom:"top",top:"bottom",left:"right",right:"left"};function Tp(e,t){if(!e)return t.map(e=>e.clone());{if(e.length!==t.length)return;const n=e.length;for(let i=0;i<n;i++){const n=e[i],r=t[i];if(!!n!=!!r)return;if(n&&r){const t=n.getWithExplicit("orient"),o=r.getWithExplicit("orient");if(t.explicit&&o.explicit&&t.value!==o.value)return;e[i]=Ep(n,r);}}}return e;}function Ep(e,t){for(const n of Op){const i=Cl(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",(e,t)=>{switch(n){case"title":return ai3(e,t);case"gridScale":return{explicit:e.explicit,value:ae9(e.value,t.value)};}return zl(e,t,n,"axis");});e.setWithExplicit(n,i);}return e;}function jp(e,t,n,i,r){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Rn6(n.labelAngle)?n.labelAngle:de7(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Nf(i,r))return!0;}return e===n[t];}const Ap=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Mp(e,t){let n=t.axis(e);const i=new Pp,r=Ua1(t.encoding[e]),{mark:o,config:a}=t,s=n?.orient||a["x"===e?"axisX":"axisY"]?.orient||a.axis?.orient||function(e){return"x"===e?"bottom":"left";}(e),c=t.getScaleComponent(e).get("type"),l=function(e,t,n,i){const r="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:Ur1(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],o="x"===e?"axisX":"axisY",a=Rn6(n)?"axisOrient":`axis${K24(n)}`,s=[...r,...r.map(e=>o+e.substr(4))],c=["axis",a,o];return{vlOnlyAxisConfig:Df(s,i,e,n),vgAxisConfig:Df(c,i,e,n),axisConfigStyle:Ff([...c,...s],i)};}(e,c,s,t.config),u=void 0!==n?!n:zf("disable",a.style,n?.style,l).configValue;if(i.set("disable",u,void 0!==n),u)return i;n=n||{};const f=function(e,t,n,i,r){const o=t?.labelAngle;if(void 0!==o)return Rn6(o)?o:de7(o);{const{configValue:o}=zf("labelAngle",i,t?.style,r);return void 0!==o?de7(o):n!==xe6||!T21([Dr3,kr2],e.type)||ya(e)&&e.timeUnit?void 0:270;}}(r,n,e,a.style,l),d=Xo(n.formatType,r,c),m=Yo(r,r.type,n.format,n.formatType,a,!0),p={fieldOrDatumDef:r,axis:n,channel:e,model:t,scaleType:c,orient:s,labelAngle:f,format:m,formatType:d,mark:o,config:a};for(const r of Op){const o=r in Cf?Cf[r](p):is(r)?n[r]:void 0,s=void 0!==o,c=jp(o,r,n,t,e);if(s&&c)i.set(r,o,c);else{const{configValue:e,configFrom:t}=is(r)&&"values"!==r?zf(r,a.style,n.style,l):{},u=void 0!==e;s&&!u?i.set(r,o,c):("vgAxisConfig"!==t||Ap.has(r)&&u||Ka(e)||Rn6(e))&&i.set(r,e,!1);}}const g=n.encoding??{},h=Za1.reduce((n,r)=>{if(!i.hasAxisPart(r))return n;const o=td(g[r]??{},t),a="labels"===r?function(e,t,n){const{encoding:i,config:r}=e,o=Ua1(i[t])??Ua1(i[St6(t)]),a=e.axis(t)||{},{format:s,formatType:c}=a;if(Bo(c))return{text:Go({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:c,config:r}),...n};if(void 0===s&&void 0===c&&r.customFormatTypes){if("quantitative"===va(o)){if(za1(o)&&"normalize"===o.stack&&r.normalizedNumberFormatType)return{text:Go({fieldOrDatumDef:o,field:"datum.value",format:r.normalizedNumberFormat,formatType:r.normalizedNumberFormatType,config:r}),...n};if(r.numberFormatType)return{text:Go({fieldOrDatumDef:o,field:"datum.value",format:r.numberFormat,formatType:r.numberFormatType,config:r}),...n};}if("temporal"===va(o)&&r.timeFormatType&&ya(o)&&!o.timeUnit)return{text:Go({fieldOrDatumDef:o,field:"datum.value",format:r.timeFormat,formatType:r.timeFormatType,config:r}),...n};}return n;}(t,e,o):o;return void 0===a||I19(a)||(n[r]={update:a}),n;},{});return I19(h)||i.set("encode",h,!!n.encoding||void 0!==n.labelAngle),i;}function Rp(e,t){const{config:n}=e;return{...Lu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Fu1("x",e,{defaultPos:"mid"}),...Fu1("y",e,{defaultPos:"mid"}),...wu("size",e),...wu("angle",e),...qp(e,n,t)};}function qp(e,t,n){return n?{shape:{value:n}}:wu("shape",e);}const Lp={vgMark:"rule",encodeEntry:e=>{const{markDef:t}=e,n=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?{...Lu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Nu("x",e,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...Nu("y",e,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...wu("size",e,{vgChannel:"strokeWidth"})}:{};}};function Up(e,t,n){if(void 0===Zn5("align",e,n))return"center";}function Wp(e,t,n){if(void 0===Zn5("baseline",e,n))return"middle";}const Bp={vgMark:"rect",encodeEntry:e=>{const{config:t,markDef:n}=e,i=n.orient,r="horizontal"===i?"width":"height",o="horizontal"===i?"height":"width";return{...Lu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Fu1("x",e,{defaultPos:"mid",vgChannel:"xc"}),...Fu1("y",e,{defaultPos:"mid",vgChannel:"yc"}),...wu("size",e,{defaultRef:Ip(e),vgChannel:r}),[o]:Gn5(Zn5("thickness",n,t))};}};function Ip(e){const{config:n,markDef:i}=e,{orient:r}=i,o="horizontal"===r?"width":"height",a="horizontal"===r?"x":"y",s=zt7(a),c=e.getScaleComponent(s)||e.getScaleComponent(a),l=e.scaleName(s)||e.scaleName(a),u=Zn5("size",i,n,{vgChannel:o})??n.tick.bandSize;if(void 0!==u)return Gn5(u);if("band"===c?.get("type"))return{scale:l,band:1};const f=c?.get("range"),{tickBandPaddingInner:d}=n.scale,m=f&&qn5(f)?f.step:ac(n.view,o);return yn(m)&&yn(d)?{value:m*(1-d)}:{signal:`${Yn6(d)} * ${Yn6(m)}`};}const Hp={arc:{vgMark:"arc",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Fu1("x",e,{defaultPos:"mid"}),...Fu1("y",e,{defaultPos:"mid"}),...ju(e,"radius"),...ju(e,"theta")})},area:{vgMark:"area",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Nu("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient}),...Nu("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient}),...Bu1(e)})},bar:{vgMark:"rect",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ju(e,"x"),...ju(e,"y")})},circle:{vgMark:"symbol",encodeEntry:e=>Rp(e,"circle")},geoshape:{vgMark:"shape",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:e=>{const{encoding:t}=e,n=t.shape;return[{type:"geoshape",projection:e.projectionName(),...n&&ya(n)&&n.type===Fr2?{field:Pa(n,{expr:"datum"})}:{}}];}},image:{vgMark:"image",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...ju(e,"x"),...ju(e,"y"),...pu1(e,"url")})},line:{vgMark:"line",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...Fu1("x",e,{defaultPos:"mid"}),...Fu1("y",e,{defaultPos:"mid"}),...wu("size",e,{vgChannel:"strokeWidth"}),...Bu1(e)})},point:{vgMark:"symbol",encodeEntry:e=>Rp(e)},rect:{vgMark:"rect",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...ju(e,"x"),...ju(e,"y")})},rule:Lp,square:{vgMark:"symbol",encodeEntry:e=>Rp(e,"square")},text:{vgMark:"text",encodeEntry:e=>{const{config:t,encoding:n}=e;return{...Lu(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...Fu1("x",e,{defaultPos:"mid"}),...Fu1("y",e,{defaultPos:"mid"}),...pu1(e),...wu("size",e,{vgChannel:"fontSize"}),...wu("angle",e),...Iu("align",Up(e.markDef,n,t)),...Iu("baseline",Wp(e.markDef,n,t)),...Fu1("radius",e,{defaultPos:null}),...Fu1("theta",e,{defaultPos:null})};}},tick:Bp,trail:{vgMark:"trail",encodeEntry:e=>({...Lu(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...Fu1("x",e,{defaultPos:"mid"}),...Fu1("y",e,{defaultPos:"mid"}),...wu("size",e),...Bu1(e)})}};function Vp(e){if(T21([fo,co,vo],e.mark)){const t=gs(e.mark,e.encoding);if(t.length>0)return function(e,t){return[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Gp+e.requestDataName(Ml.Main),data:e.requestDataName(Ml.Main),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:Xp(e,{fromPrefix:Gp})}];}(e,t);}else if(e.mark===lo){const t=Bn5.some(t=>Zn5(t,e.markDef,e.config));if(e.stack&&!e.fieldDef("size")&&t)return function(e){const[t]=Xp(e,{fromPrefix:Yp}),n=e.scaleName(e.stack.fieldChannel),i=(t={})=>e.vgField(e.stack.fieldChannel,t),r=(e,t)=>`${e}(${[i({prefix:"min",suffix:"start",expr:t}),i({prefix:"max",suffix:"start",expr:t}),i({prefix:"min",suffix:"end",expr:t}),i({prefix:"max",suffix:"end",expr:t})].map(e=>`scale('${n}',${e})`).join(",")})`;let o,a;"x"===e.stack.fieldChannel?(o={..._21(t.encode.update,["y","yc","y2","height",...Bn5]),x:{signal:r("min","datum")},x2:{signal:r("max","datum")},clip:{value:!0}},a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},t.encode.update={...O20(t.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={..._21(t.encode.update,["x","xc","x2","width"]),y:{signal:r("min","datum")},y2:{signal:r("max","datum")},clip:{value:!0}},a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},t.encode.update={...O20(t.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const n of Bn5){const i=ei3(n,e.markDef,e.config);t.encode.update[n]?(o[n]=t.encode.update[n],delete t.encode.update[n]):i&&(o[n]=Gn5(i)),i&&(t.encode.update[n]={value:0});}const s=[];if(e.stack.groupbyChannels?.length>0)for(const t of e.stack.groupbyChannels){const n=e.fieldDef(t),i=Pa(n);i&&s.push(i),(n?.bin||n?.timeUnit)&&s.push(Pa(n,{binSuffix:"end"}));}o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((n,i)=>{if(t.encode.update[i])return{...n,[i]:t.encode.update[i]};{const t=ei3(i,e.markDef,e.config);return void 0!==t?{...n,[i]:Gn5(t)}:n;}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:e.requestDataName(Ml.Main),name:Yp+e.requestDataName(Ml.Main),groupby:s,aggregate:{fields:[i({suffix:"start"}),i({suffix:"start"}),i({suffix:"end"}),i({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[t]}]}];}(e);}return Xp(e);}const Gp="faceted_path_";const Yp="stack_group_";function Xp(e,t={fromPrefix:""}){const{mark:n,markDef:i,encoding:r,config:o}=e,a=ae9(i.clip,function(e){const t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!(!t?.get("selectionExtent")&&!n?.get("selectionExtent"))||void 0;}(e),function(e){const t=e.component.projection;return!(!t||t.isFit)||void 0;}(e)),s=Kn6(i),l=r.key,u=function(e){const{encoding:t,stack:n,mark:i,markDef:r,config:o}=e,a=t.order;if(!(!w(a)&&Da1(a)&&N23(a.value)||!a&&N23(Zn5("order",r,o)))){if((w(a)||ya(a))&&!n)return ii3(a,{expr:"datum"});if(wo(i)){const e="horizontal"===r.orient?"y":"x";if(ya(t[e]))return{field:e};}}}(e),f=function(e){if(!e.component.selection)return null;const t=H21(e.component.selection).length;let n=t,i=e.parent;for(;i&&0===n;)n=H21(i.component.selection).length,i=i.parent;return n?{interactive:t>0||"geoshape"===e.mark||!!e.encoding.tooltip||!!e.markDef.tooltip}:null;}(e),d=Zn5("aria",i,o),m=Hp[n].postEncodingTransform?Hp[n].postEncodingTransform(e):null;return[{name:e.getName("marks"),type:Hp[n].vgMark,...a?{clip:a}:{},...s?{style:s}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...f||{},...!1===d?{aria:d}:{},from:{data:t.fromPrefix+e.requestDataName(Ml.Main)},encode:{update:Hp[n].encodeEntry(e)},...m?{transform:m}:{}}];}class Jp extends tp{constructor(e,t,n,i={},r){super(e,"unit",t,n,r,void 0,ic(e)?e.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const o=Do(e.mark)?{...e.mark}:{type:e.mark},a=o.type;void 0===o.filled&&(o.filled=function(e,t,{graticule:n}){if(n)return!1;const i=ei3("filled",e,t),r=e.type;return ae9(i,r!==mo&&r!==fo&&r!==go);}(o,r,{graticule:e.data&&Al(e.data)}));const s=this.encoding=function(e,t,n,i){const r={};for(const t of H21(e))bt8(t)||qi2(`${o=t}-encoding is dropped as ${o} is not a valid encoding channel.`);var o;for(let o of _t5){if(!e[o])continue;const a=e[o];if(Zt4(o)){const e=Ct7(o),t=r[e];if(ya(t)&&xr2(t.type)&&ya(a)&&!t.timeUnit){qi2(xi3(e));continue;}}if("angle"!==o||"arc"!==t||e.theta||(qi2("Arc marks uses theta channel rather than angle, replacing angle with theta."),o=Ce6),ds(e,o,t)){if(o===Re5&&"line"===t){const t=La(e[o]);if(t?.aggregate){qi2("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue;}}if(o===Ee5&&(n?"fill"in e:"stroke"in e))qi2(wi2("encoding",{fill:"fill"in e,stroke:"stroke"in e}));else if(o===Ge4||o===Ve3&&!w(a)&&!Da1(a)||o===Xe4&&w(a)){if(a){if(o===Ve3){const t=e[o];if(ma(t)){r[o]=t;continue;}}r[o]=H(a).reduce((e,t)=>(ya(t)?e.push(Ia(t,o)):qi2(ki3(t,o)),e),[]);}}else{if(o===Xe4&&null===a)r[o]=null;else if(!(ya(a)||ba(a)||Da1(a)||pa(a)||Rn6(a))){qi2(ki3(a,o));continue;}r[o]=Wa1(a,o,i);}}else qi2(Si2(o,t));}return r;}(e.encoding||{},a,o.filled,r);this.markDef=_c(o,s,r),this.size=function({encoding:e,size:t}){for(const n of Gt5){const i=Dt8(n);nc(t[i])&&xa(e[n])&&(delete t[i],qi2(Ni2(i)));}return t;}({encoding:s,size:ic(e)?{...i,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}}:i}),this.stack=Cc(this.markDef,s),this.specifiedScales=this.initScales(a,s),this.specifiedAxes=this.initAxes(s),this.specifiedLegends=this.initLegends(s),this.specifiedProjection=e.projection,this.selection=(e.params??[]).filter(e=>Js(e));}get hasProjection(){const{encoding:e}=this,t=this.mark===$o,n=e&&rt11.some(t=>ka(e[t]));return t||n;}scaleDomain(e){const t=this.specifiedScales[e];return t?t.domain:void 0;}axis(e){return this.specifiedAxes[e];}legend(e){return this.specifiedLegends[e];}initScales(e,t){return dn8.reduce((e,n)=>{const i=Ua1(t[n]);return i&&(e[n]=this.initScale(i.scale??{})),e;},{});}initScale(e){const{domain:t,range:n}=e,i=jn8(e);return w(t)&&(i.domain=t.map(Hn6)),w(n)&&(i.range=n.map(Hn6)),i;}initAxes(e){return Gt5.reduce((t,n)=>{const i=e[n];if(ka(i)||n===xe6&&ka(e.x2)||n===$e3&&ka(e.y2)){const e=ka(i)?i.axis:void 0;t[n]=e?this.initAxis({...e}):e;}return t;},{});}initAxis(e){const t=H21(e),n={};for(const i of t){const t=e[i];n[i]=Ka(t)?In6(t):Hn6(t);}return n;}initLegends(e){return un9.reduce((t,n)=>{const i=Ua1(e[n]);if(i&&function(e){switch(e){case Ee5:case je4:case Ae5:case Re5:case Me6:case Le5:case Be5:case Ie6:return!0;case Ue5:case We3:case qe4:return!1;}}(n)){const e=i.legend;t[n]=e?jn8(e):e;}return t;},{});}parseData(){this.component.data=Fp(this);}parseLayoutSize(){!function(e){const{size:t,component:n}=e;for(const i of Gt5){const r=Dt8(i);if(t[r]){const e=t[r];n.layoutSize.set(r,nc(e)?"step":e,!0);}else{const t=wp(e,r);n.layoutSize.set(r,t,!1);}}}(this);}parseSelections(){this.component.selection=function(e,t){const i={},r=e.config.selection;if(!t||!t.length)return i;for(const o of t){const t=X22(o.name),s=o.select,c=Mn(s)?s:s.type,u=E(s)?z23(s):{type:c},f=r[c];for(const e in f)"fields"!==e&&"encodings"!==e&&("mark"===e&&(u[e]={...f[e],...u[e]}),void 0!==u[e]&&!0!==u[e]||(u[e]=z23(f[e]??u[e])));const d=i[t]={...u,name:t,type:c,init:o.value,bind:o.bind,events:Mn(u.on)?l22(u.on,"scope"):H(z23(u.on))},m=z23(o);for(const t of ff1)t.defined(d)&&t.parse&&t.parse(e,d,m);}return i;}(this,this.selection);}parseMarkGroup(){this.component.mark=Vp(this);}parseAxesAndHeaders(){var e;this.component.axes=(e=this,Gt5.reduce((t,n)=>(e.component.scales[n]&&(t[n]=[Mp(n,e)]),t),{}));}assembleSelectionTopLevelSignals(e){return function(e,t){let n=!1;for(const i of V20(e.component.selection??{})){const r=i.name,a=xn(r+sf1);if(0===t.filter(e=>e.name===r).length){const e="global"===i.resolve?"union":i.resolve,n="point"===i.type?", true, true)":")";t.push({name:i.name,update:`${uf1}(${a}, ${xn(e)}${n}`});}n=!0;for(const n of ff1)n.defined(i)&&n.topLevelSignals&&(t=n.topLevelSignals(e,i,t));}n&&0===t.filter(e=>"unit"===e.name).length&&t.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]});return Il(t);}(this,e);}assembleSignals(){return[...Sf(this),...Ul(this,[])];}assembleSelectionData(e){return function(e,t){const n=[...t],i=df1(e,{escape:!1});for(const t of V20(e.component.selection??{})){const e={name:t.name+sf1};if(t.project.hasSelectionId&&(e.transform=[{type:"collect",sort:{field:Vs}}]),t.init){const n=t.project.items.map(ql);e.values=t.project.hasSelectionId?t.init.map(e=>({unit:i,[Vs]:Ll(e,!1)[0]})):t.init.map(e=>({unit:i,fields:n,values:Ll(e,!1)}));}n.filter(e=>e.name===t.name+sf1).length||n.push(e);}return n;}(this,e);}assembleLayout(){return null;}assembleLayoutSignals(){return Jf(this);}assembleMarks(){let e=this.component.mark??[];return this.parent&&Zm(this.parent)||(e=Bl(this,e)),e.map(this.correctDataNames);}assembleGroupStyle(){const{style:e}=this.view||{};return void 0!==e?e:this.encoding.x||this.encoding.y?"cell":"view";}getMapping(){return this.encoding;}get mark(){return this.markDef.type;}channelHasField(e){return ss(this.encoding,e);}fieldDef(e){return La(this.encoding[e]);}typedFieldDef(e){const t=this.fieldDef(e);return Sa1(t)?t:null;}}class Qp extends ep{constructor(e,t,n,i,r){super(e,"layer",t,n,r,e.resolve,e.view);const o={...i,...e.width?{width:e.width}:{},...e.height?{height:e.height}:{}};this.children=e.layer.map((e,t)=>{if($c(e))return new Qp(e,this,this.getName(`layer_${t}`),o,r);if(os(e))return new Jp(e,this,this.getName(`layer_${t}`),o,r);throw new Error(si3(e));});}parseData(){this.component.data=Fp(this);for(const e of this.children)e.parseData();}parseLayoutSize(){var e;xp(e=this),$p(e,"width"),$p(e,"height");}parseSelections(){this.component.selection={};for(const e of this.children){e.parseSelections();for(const t of H21(e.component.selection))this.component.selection[t]=e.component.selection[t];}}parseMarkGroup(){for(const e of this.children)e.parseMarkGroup();}parseAxesAndHeaders(){!function(e){const{axes:t,resolve:n}=e.component,i={top:0,bottom:0,right:0,left:0};for(const i of e.children){i.parseAxesAndHeaders();for(const r of H21(i.component.axes))n.axis[r]=id(e.component.resolve,r),"shared"===n.axis[r]&&(t[r]=Tp(t[r],i.component.axes[r]),t[r]||(n.axis[r]="independent",delete t[r]));}for(const r of Gt5){for(const o of e.children)if(o.component.axes[r]){if("independent"===n.axis[r]){t[r]=(t[r]??[]).concat(o.component.axes[r]);for(const e of o.component.axes[r]){const{value:t,explicit:n}=e.getWithExplicit("orient");if(!Rn6(t)){if(i[t]>0&&!n){const n=Np[t];i[t]>i[n]&&e.set("orient",n,!1);}i[t]++;}}}delete o.component.axes[r];}if("independent"===n.axis[r]&&t[r]&&t[r].length>1)for(const[e,n]of(t[r]||[]).entries())e>0&&n.get("grid")&&!n.explicit.grid&&(n.implicit.grid=!1);}}(this);}assembleSelectionTopLevelSignals(e){return this.children.reduce((e,t)=>t.assembleSelectionTopLevelSignals(e),e);}assembleSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleSignals()),Sf(this));}assembleLayoutSignals(){return this.children.reduce((e,t)=>e.concat(t.assembleLayoutSignals()),Jf(this));}assembleSelectionData(e){return this.children.reduce((e,t)=>t.assembleSelectionData(e),e);}assembleGroupStyle(){const e=new Set;for(const t of this.children)for(const n of H(t.assembleGroupStyle()))e.add(n);const t=Array.from(e);return t.length>1?t:1===t.length?t[0]:void 0;}assembleTitle(){let e=super.assembleTitle();if(e)return e;for(const t of this.children)if(e=t.assembleTitle(),e)return e;}assembleLayout(){return null;}assembleMarks(){return function(e,t){for(const n of e.children)Jm(n)&&(t=Bl(n,t));return t;}(this,this.children.flatMap(e=>e.assembleMarks()));}assembleLegends(){return this.children.reduce((e,t)=>e.concat(t.assembleLegends()),xd(this));}}function Kp(e,t,n,i,r){if(sa(e))return new Sp(e,t,n,r);if($c(e))return new Qp(e,t,n,i,r);if(os(e))return new Jp(e,t,n,i,r);if(function(e){return Zs(e)||ec(e)||Ks(e);}(e))return new Cp(e,t,n,r);throw new Error(si3(e));}function Zp(e,t={}){var i;t.logger&&(i=t.logger,Ri2=i),t.fieldTitle&&ja(t.fieldTitle);try{const i=gc(k(t.config,e.config)),r=hl(e,i),o=Kp(r,null,"",void 0,i);o.parse(),function(e,t){pm(e.sources);let n=0,i=0;for(let i=0;i<5&&hm(e,t,!0);i++)n++;e.sources.map(fm);for(let n=0;n<5&&hm(e,t,!1);n++)i++;pm(e.sources),5===Math.max(n,i)&&qi2("Maximum optimization runs(5) reached.");}(o.component.data,o);const a=function(e,t,n={},i){const r=e.config?bc(e.config):void 0,o=[].concat(e.assembleSelectionData([]),function(e,t){const n=[],i=gp(n);let r=0;for(const t of e.sources){t.hasName()||(t.dataName="source_"+r++);const e=t.assemble();i(t,e);}for(const e of n)0===e.transform.length&&delete e.transform;let o=0;for(const[e,t]of n.entries())0!==(t.transform??[]).length||t.source||n.splice(o++,0,n.splice(e,1)[0]);for(const t of n)for(const n of t.transform??[])"lookup"===n.type&&(n.from=e.outputNodes[n.from].getSource());for(const e of n)e.name in t&&(e.values=t[e.name]);return n;}(e.component.data,n)),a=e.assembleProjections(),s=e.assembleTitle(),c=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0);let u=e.assembleLayoutSignals();u=u.filter(e=>"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1));const{params:f,...d}=t;return{$schema:"https://vega.github.io/schema/vega/v5.json",...e.description?{description:e.description}:{},...d,...s?{title:s}:{},...c?{style:c}:{},...l?{encode:{update:l}}:{},data:o,...a.length>0?{projections:a}:{},...e.assembleGroup([...u,...e.assembleSelectionTopLevelSignals([]),...Qs(f)]),...r?{config:r}:{},...i?{usermeta:i}:{}};}(o,function(e,t,i,r){const o=r.component.layoutSize.get("width"),a=r.component.layoutSize.get("height");void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):Mn(t)&&(t={type:t});if(o&&a&&(s=t.type,"fit"===s||"fit-x"===s||"fit-y"===s)){if("step"===o&&"step"===a)qi2(fi3()),t.type="pad";else if("step"===o||"step"===a){const e="step"===o?"width":"height";qi2(fi3(Qt4(e)));const n="width"===e?"height":"width";t.type=function(e){return e?`fit-${Qt4(e)}`:"fit";}(n);}}var s;return{...1===H21(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t},...wl(i,!1),...wl(e,!0)};}(e,r.autosize,i,o),e.datasets,e.usermeta);return{spec:a,normalized:r};}finally{t.logger&&(Ri2=Mi2),t.fieldTitle&&ja(Ta1);}}const eg=$21;const __default1=null;const mod13=function(){return{accessPathDepth:oe7,accessPathWithDatum:Z23,compile:Zp,contains:T21,deepEqual:ge7,deleteNestedProperty:Q19,duplicate:z23,entries:G21,every:j21,fieldIntersection:B22,flatAccessWithDatum:ee8,getFirstDefined:ae9,hasIntersection:U19,hash:P20,internalField:ue8,isBoolean:Y21,isEmpty:I19,isEqual:q19,isInternalField:fe7,isNullOrFalse:N23,isNumeric:me8,keys:H21,logicalExpr:J23,mergeDeep:A22,never:C20,normalize:hl,normalizeAngle:de7,omit:O20,pick:_21,prefixGenerator:W22,removePathFromField:re9,replaceAll:ie8,replacePathInField:ne8,resetIdCounter:le8,setEqual:L20,some:E24,stringify:he7,titleCase:K24,unique:R20,uniqueId:ce8,vals:V20,varName:X22,version:eg,default:null};}();function e18(e){const[n,r]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:n,version:r};}var e19="3.0.0";const t16="#fff",i23="#888",l24={background:"#333",view:{stroke:i23},title:{color:t16,subtitleColor:t16},style:{"guide-label":{fill:t16},"guide-title":{fill:t16}},axis:{domainColor:t16,gridColor:i23,tickColor:t16}},a19="#4572a7",o21={background:"#fff",arc:{fill:a19},area:{fill:a19},line:{stroke:a19,strokeWidth:2},path:{stroke:a19},rect:{fill:a19},shape:{stroke:a19},symbol:{fill:a19,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},r20="#30a2da",f17="#cbcbcb",d18="#f0f0f0",n19="#333",s25={arc:{fill:r20},area:{fill:r20},axis:{domainColor:f17,grid:!0,gridColor:f17,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:f17,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:d18,group:{fill:d18},legend:{labelColor:n19,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:n19,titleFontSize:14,titlePadding:10},line:{stroke:r20,strokeWidth:2},path:{stroke:r20,strokeWidth:.5},rect:{fill:r20},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:r20},bar:{binSpacing:2,fill:r20,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},c23="#000",g21={group:{fill:"#e5e5e5"},arc:{fill:c23},area:{fill:c23},line:{stroke:c23},path:{stroke:c23},rect:{fill:c23},shape:{stroke:c23},symbol:{fill:c23,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},b22="Benton Gothic, sans-serif",h28="#82c6df",k23="Benton Gothic Bold, sans-serif",F21="normal",m22={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"]},p18={background:"#ffffff",title:{anchor:"start",color:"#000000",font:k23,fontSize:22,fontWeight:"normal"},arc:{fill:h28},area:{fill:h28},line:{stroke:h28,strokeWidth:2},path:{stroke:h28},rect:{fill:h28},shape:{stroke:h28},symbol:{fill:h28,size:30},axis:{labelFont:b22,labelFontSize:11.5,labelFontWeight:"normal",titleFont:k23,titleFontSize:13,titleFontWeight:F21},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:b22,labelFontSize:11.5,symbolType:"square",titleFont:k23,titleFontSize:13,titleFontWeight:F21},range:{category:m22["category-6"],diverging:m22["fireandice-6"],heatmap:m22["fire-7"],ordinal:m22["fire-7"],ramp:m22["fire-7"]}},y19="#ab5787",z24="#979797",S21={background:"#f9f9f9",arc:{fill:y19},area:{fill:y19},line:{stroke:y19},path:{stroke:y19},rect:{fill:y19},shape:{stroke:y19},symbol:{fill:y19,size:30},axis:{domainColor:z24,domainWidth:.5,gridWidth:.2,labelColor:z24,tickColor:z24,tickWidth:.2,titleColor:z24},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},C21="#3e5c69",u21={background:"#fff",arc:{fill:C21},area:{fill:C21},line:{stroke:C21},path:{stroke:C21},rect:{fill:C21},shape:{stroke:C21},symbol:{fill:C21},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},x25="#1696d2",W23="#000000",B23="Lato",D21="Lato",P21={"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},A23={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:B23},axisX:{domain:!0,domainColor:W23,domainWidth:1,grid:!1,labelFontSize:12,labelFont:D21,labelAngle:0,tickColor:W23,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:B23},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:D21,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:B23,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:D21,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:B23,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:P21["six-groups-cat-1"],diverging:P21["diverging-colors"],heatmap:P21["diverging-colors"],ordinal:P21["six-groups-seq"],ramp:P21["shades-blue"]},area:{fill:x25},rect:{fill:x25},line:{color:x25,stroke:x25,strokeWidth:5},trail:{color:x25,stroke:x25,strokeWidth:0,size:1},path:{stroke:x25,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:x25,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:x25,stroke:null}},arc:{fill:x25},shape:{stroke:x25},symbol:{fill:x25,size:30}},v25="#3366CC",E25="#ccc",w23="Arial, sans-serif",q20={arc:{fill:v25},area:{fill:v25},path:{stroke:v25},rect:{fill:v25},shape:{stroke:v25},symbol:{stroke:v25},circle:{fill:v25},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:w23,fontSize:12},"guide-title":{font:w23,fontSize:12},"group-title":{font:w23,fontSize:12}},title:{font:w23,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:E25,tickColor:E25,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},X23=e=>e*(1/3+1),Y22=X23(9),T22=X23(10),M24=X23(12),I20="Segoe UI",L21="wf_standard-font, helvetica, arial, sans-serif",G22="#252423",O21="#605E5C",J24="transparent",N24="#118DFF",Q20="#DEEFFF",R21=[Q20,N24],U20={view:{stroke:J24},background:J24,font:I20,header:{titleFont:L21,titleFontSize:M24,titleColor:G22,labelFont:I20,labelFontSize:T22,labelColor:O21},axis:{ticks:!1,grid:!1,domain:!1,labelColor:O21,labelFontSize:Y22,titleFont:L21,titleColor:G22,titleFontSize:M24,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:N24},line:{stroke:N24,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:I20,fontSize:Y22,fill:O21},arc:{fill:N24},area:{fill:N24,line:!0,opacity:.6},path:{stroke:N24},rect:{fill:N24},point:{fill:N24,filled:!0,size:75},shape:{stroke:N24},symbol:{fill:N24,strokeWidth:1.5,size:50},legend:{titleFont:I20,titleFontWeight:"bold",titleColor:O21,labelFont:I20,labelFontSize:T22,labelColor:O21,symbolType:"circle",symbolSize:75},range:{category:[N24,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:R21,heatmap:R21,ordinal:[Q20,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",N24]}},_22='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',j22={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},H22=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],K25=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function V21({theme:e,background:t}){const i=["white","g10"].includes(e)?"light":"dark",l=j22.gridBg[e],a=j22.textPrimary[e],o=j22.textSecondary[e],r="dark"===i?H22:K25,f="dark"===i?"#d4bbff":"#6929c4";return{background:t,arc:{fill:f},area:{fill:f},path:{stroke:f},rect:{fill:f},shape:{stroke:f},symbol:{stroke:f},circle:{fill:f},view:{fill:l,stroke:l},group:{fill:l},title:{color:a,anchor:"start",dy:-15,fontSize:16,font:_22,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:'IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',labelFontWeight:400,titleColor:a,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:j22.layerAccent01[e],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:_22,fill:o,fontWeight:400},"guide-title":{font:_22,fill:o,fontWeight:400}},range:{category:r,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}};}const Z24=V21({theme:"white",background:"#ffffff"}),$22=V21({theme:"g10",background:"#f4f4f4"}),ee9=V21({theme:"g90",background:"#262626"}),te8=V21({theme:"g100",background:"#161616"}),ie9=e19;const mod14=function(){return{carbong10:$22,carbong100:te8,carbong90:ee9,carbonwhite:Z24,dark:l24,excel:o21,fivethirtyeight:s25,ggplot2:g21,googlecharts:q20,latimes:p18,powerbi:U20,quartz:S21,urbaninstitute:A23,version:ie9,vox:u21,default:null};}();function o22(i,o,l,r){if(w(i))return`[${i.map(t=>o(Mn(t)?t:s26(t,l))).join(", ")}]`;if(E(i)){let t="";const{title:e,image:d,...h}=i;e&&(t+=`<h2>${o(e)}</h2>`),d&&(t+=`<img src="${new URL(o(d),r||location.href).href}">`);const p=Object.keys(h);if(p.length>0){t+="<table>";for(const e of p){let i=h[e];void 0!==i&&(E(i)&&(i=s26(i,l)),t+=`<tr><td class="key">${o(e)}</td><td class="value">${o(i)}</td></tr>`);}t+="</table>";}return t||"{}";}return o(i);}function l25(t){const e=[];return function(n,i){if("object"!=typeof i||null===i)return i;const o=e.indexOf(this)+1;return e.length=o,e.length>t?"[Object]":e.indexOf(i)>=0?"[Circular]":(e.push(i),i);};}function s26(t,e){return JSON.stringify(t,l25(e));}var r21="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n";const d19="vg-tooltip-element",h29={offsetX:10,offsetY:10,id:d19,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:p19,maxDepth:2,formatTooltip:o22,baseURL:"",anchor:"cursor",position:["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right"]};function p19(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;");}function a20(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return r21.toString().replaceAll(d19,t);}function c24(t,e,{offsetX:n,offsetY:i}){const o=u22({x1:t.clientX,x2:t.clientX,y1:t.clientY,y2:t.clientY},e,n,i),l=["bottom-right","bottom-left","top-right","top-left"];for(const t of l)if(m23(o[t],e))return o[t];return o["top-left"];}function f18(t,e,n,i,o){const{position:l,offsetX:s,offsetY:r}=o,d=u22(g22(t._el.getBoundingClientRect(),t._origin,n),i,s,r),h=Array.isArray(l)?l:[l];for(const t of h)if(m23(d[t],i)&&!x26(e,d[t],i))return d[t];return c24(e,i,o);}function g22(t,e,n){const i=n.isVoronoi?n.datum.bounds:n.bounds;let o=t.left+e[0]+i.x1,l=t.top+e[1]+i.y1,s=n;for(;s.mark.group;)s=s.mark.group,o+=s.x??0,l+=s.y??0;return{x1:o,x2:o+(i.x2-i.x1),y1:l,y2:l+(i.y2-i.y1)};}function u22(t,e,n,i){const o=(t.x1+t.x2)/2,l=(t.y1+t.y2)/2,s=t.x1-e.width-n,r=o-e.width/2,d=t.x2+n,h=t.y1-e.height-i,p=l-e.height/2,a=t.y2+i;return{top:{x:r,y:h},bottom:{x:r,y:a},left:{x:s,y:p},right:{x:d,y:p},"top-left":{x:s,y:h},"top-right":{x:d,y:h},"bottom-left":{x:s,y:a},"bottom-right":{x:d,y:a}};}function m23(t,e){return t.x>=0&&t.y>=0&&t.x+e.width<=window.innerWidth&&t.y+e.height<=window.innerHeight;}function x26(t,e,n){return t.clientX>=e.x&&t.clientX<=e.x+n.width&&t.clientY>=e.y&&t.clientY<=e.y+n.height;}class b23{call;options;el;constructor(t){this.options={...h29,...t};const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=a20(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t);}}tooltipHandler(t,e,n,i){if(this.el=document.getElementById(this.options.id),!this.el){this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip");(document.fullscreenElement??document.body).appendChild(this.el);}if(null==i||""===i)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(i,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:l}="mark"===this.options.anchor?f18(t,e,n,this.el.getBoundingClientRect(),this.options):c24(e,this.el.getBoundingClientRect(),this.options);this.el.style.top=`${l}px`,this.el.style.left=`${o}px`;}}var h30="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function f19(){throw new Error("setTimeout has not been defined");}function d20(){throw new Error("clearTimeout has not been defined");}var E26=f19,m24=d20;function v26(e){if(E26===setTimeout)return setTimeout(e,0);if((E26===f19||!E26)&&setTimeout)return E26=setTimeout,setTimeout(e,0);try{return E26(e,0);}catch(t){try{return E26.call(null,e,0);}catch(t){return E26.call(this,e,0);}}}"function"==typeof h30.setTimeout&&(E26=setTimeout),"function"==typeof h30.clearTimeout&&(m24=clearTimeout);var g23,w24=[],O22=!1,I21=-1;function R22(){O22&&g23&&(O22=!1,g23.length?w24=g23.concat(w24):I21=-1,w24.length&&$23());}function $23(){if(!O22){var e=v26(R22);O22=!0;for(var t=w24.length;t;){for(g23=w24,w24=[];++I21<t;)g23&&g23[I21].run();I21=-1,t=w24.length;}g23=null,O22=!1,function(e){if(m24===clearTimeout)return clearTimeout(e);if((m24===d20||!m24)&&clearTimeout)return m24=clearTimeout,clearTimeout(e);try{return m24(e);}catch(t){try{return m24.call(null,e);}catch(t){return m24.call(this,e);}}}(e);}}function A24(e,t){this.fun=e,this.array=t;}A24.prototype.run=function(){this.fun.apply(null,this.array);};function N25(){}var L22=N25,T23=N25,y20=N25,b24=N25,S22=N25,_23=N25,P22=N25;var x27=h30.performance||{},D22=x27.now||x27.mozNow||x27.msNow||x27.oNow||x27.webkitNow||function(){return(new Date).getTime();};var C22=new Date;var F22,M25={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];w24.push(new A24(e,t)),1!==w24.length||O22||v26($23);},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:L22,addListener:T23,once:y20,off:b24,removeListener:S22,removeAllListeners:_23,emit:P22,binding:function(e){throw new Error("process.binding is not supported");},cwd:function(){return"/";},chdir:function(e){throw new Error("process.chdir is not supported");},umask:function(){return 0;},hrtime:function(e){var t=.001*D22.call(x27),r=Math.floor(t),n=Math.floor(t%1*1e9);return e&&(r-=e[0],(n-=e[1])<0&&(r--,n+=1e9)),[r,n];},platform:"browser",release:{},config:{},uptime:function(){return(new Date-C22)/1e3;}},j23=(F22=function(e,t){return F22=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t;}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);},F22(e,t);},function(e,t){function r(){this.constructor=e;}F22(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r);}),G23=Object.prototype.hasOwnProperty;function U21(e,t){return G23.call(e,t);}function k24(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t;}if(Object.keys)return Object.keys(e);var n=[];for(var o in e)U21(e,o)&&n.push(o);return n;}function X24(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e;}}function V22(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++;}return!0;}function H23(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1");}function B24(e){return e.replace(/~1/g,"/").replace(/~0/g,"~");}function z25(e){if(void 0===e)return!0;if(e){if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(z25(e[t]))return!0;}else if("object"==typeof e){for(var n=k24(e),o=n.length,i=0;i<o;i++)if(z25(e[n[i]]))return!0;}}return!1;}function W24(e,t){var r=[e];for(var n in t){var o="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==o&&r.push(n+": "+o);}return r.join("\n");}var J25=function(e){function t(t,r,n,o,i){var s=this.constructor,a=e.call(this,W24(t,{name:r,index:n,operation:o,tree:i}))||this;return a.name=r,a.index=n,a.operation=o,a.tree=i,Object.setPrototypeOf(a,s.prototype),a.message=W24(t,{name:r,index:n,operation:o,tree:i}),a;}return j23(t,e),t;}(Error),Y23=J25,q21=X24,Q21={add:function(e,t,r){return e[t]=this.value,{newDocument:r};},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n};},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n};},move:function(e,t,r){var n=Z25(r,this.path);n&&(n=X24(n));var o=ee10(r,{op:"remove",path:this.from}).removed;return ee10(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n};},copy:function(e,t,r){var n=Z25(r,this.from);return ee10(r,{op:"add",path:this.path,value:X24(n)}),{newDocument:r};},test:function(e,t,r){return{newDocument:r,test:oe8(e[t],this.value)};},_get:function(e,t,r){return this.value=e[t],{newDocument:r};}},K26={add:function(e,t,r){return V22(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t};},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]};},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n};},move:Q21.move,copy:Q21.copy,test:Q21.test,_get:Q21._get};function Z25(e,t){if(""==t)return e;var r={op:"_get",path:t};return ee10(e,r),r.value;}function ee10(e,t,r,n,o,i){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===i&&(i=0),r&&("function"==typeof r?r(t,0,e,t.path):re10(t,0)),""===t.path){var s={newDocument:e};if("add"===t.op)return s.newDocument=t.value,s;if("replace"===t.op)return s.newDocument=t.value,s.removed=e,s;if("move"===t.op||"copy"===t.op)return s.newDocument=Z25(e,t.from),"move"===t.op&&(s.removed=e),s;if("test"===t.op){if(s.test=oe8(e,t.value),!1===s.test)throw new Y23("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s.newDocument=e,s;}if("remove"===t.op)return s.removed=e,s.newDocument=null,s;if("_get"===t.op)return t.value=e,s;if(r)throw new Y23("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return s;}n||(e=X24(e));var a=(t.path||"").split("/"),c=e,p=1,l=a.length,u=void 0,h=void 0,f=void 0;for(f="function"==typeof r?r:re10;;){if((h=a[p])&&-1!=h.indexOf("~")&&(h=B24(h)),o&&("__proto__"==h||"prototype"==h&&p>0&&"constructor"==a[p-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===u&&(void 0===c[h]?u=a.slice(0,p).join("/"):p==l-1&&(u=t.path),void 0!==u&&f(t,0,e,u)),p++,Array.isArray(c)){if("-"===h)h=c.length;else{if(r&&!V22(h))throw new Y23("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);V22(h)&&(h=~~h);}if(p>=l){if(r&&"add"===t.op&&h>c.length)throw new Y23("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(s=K26[t.op].call(t,c,h,e)).test)throw new Y23("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s;}}else if(p>=l){if(!1===(s=Q21[t.op].call(t,c,h,e)).test)throw new Y23("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return s;}if(c=c[h],r&&p<l&&(!c||"object"!=typeof c))throw new Y23("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e);}}function te9(e,t,r,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!0),r&&!Array.isArray(t))throw new Y23("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=X24(e));for(var i=new Array(t.length),s=0,a=t.length;s<a;s++)i[s]=ee10(e,t[s],r,!0,o,s),e=i[s].newDocument;return i.newDocument=e,i;}function re10(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new Y23("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(!Q21[e.op])throw new Y23("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r);if("string"!=typeof e.path)throw new Y23("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new Y23('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new Y23("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new Y23("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&z25(e.value))throw new Y23("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r){if("add"==e.op){var o=e.path.split("/").length,i=n.split("/").length;if(o!==i+1&&o!==i)throw new Y23("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r);}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new Y23("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r);}else if("move"===e.op||"copy"===e.op){var s=ne9([{op:"_get",path:e.from,value:void 0}],r);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new Y23("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r);}}}function ne9(e,t,r){try{if(!Array.isArray(e))throw new Y23("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)te9(X24(t),X24(e),r||!0);else{r=r||re10;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0);}}catch(e){if(e instanceof Y23)return e;throw e;}}function oe8(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,o,i=Array.isArray(e),s=Array.isArray(t);if(i&&s){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!oe8(e[r],t[r]))return!1;return!0;}if(i!=s)return!1;var a=Object.keys(e);if((n=a.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=n;0!=r--;)if(!oe8(e[o=a[r]],t[o]))return!1;return!0;}return e!=e&&t!=t;}var ie10=Object.freeze({__proto__:null,JsonPatchError:Y23,_areEquals:oe8,applyOperation:ee10,applyPatch:te9,applyReducer:function(e,t,r){var n=ee10(e,t);if(!1===n.test)throw new Y23("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument;},deepClone:q21,getValueByPointer:Z25,validate:ne9,validator:re10}),se9=new WeakMap,ae10=function(e){this.observers=new Map,this.obj=e;},ce9=function(e,t){this.callback=e,this.observer=t;};function pe7(e,t){void 0===t&&(t=!1);var r=se9.get(e.object);le9(r.value,e.object,e.patches,"",t),e.patches.length&&te9(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n;}function le9(e,t,r,n,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=k24(t),s=k24(e),a=!1,c=s.length-1;c>=0;c--){var p=e[u=s[c]];if(!U21(t,u)||void 0===t[u]&&void 0!==p&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&r.push({op:"test",path:n+"/"+H23(u),value:X24(p)}),r.push({op:"remove",path:n+"/"+H23(u)}),a=!0):(o&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}));else{var l=t[u];"object"==typeof p&&null!=p&&"object"==typeof l&&null!=l&&Array.isArray(p)===Array.isArray(l)?le9(p,l,r,n+"/"+H23(u),o):p!==l&&(o&&r.push({op:"test",path:n+"/"+H23(u),value:X24(p)}),r.push({op:"replace",path:n+"/"+H23(u),value:X24(l)}));}}if(a||i.length!=s.length)for(c=0;c<i.length;c++){var u;U21(e,u=i[c])||void 0===t[u]||r.push({op:"add",path:n+"/"+H23(u),value:X24(t[u])});}}}var ue9,he8,fe8,de8,Ee6=Object.freeze({__proto__:null,compare:function(e,t,r){void 0===r&&(r=!1);var n=[];return le9(e,t,n,"",r),n;},generate:pe7,observe:function(e,t){var r,n=function(e){return se9.get(e);}(e);if(n){var o=function(e,t){return e.observers.get(t);}(n,t);r=o&&o.observer;}else n=new ae10(e),se9.set(e,n);if(r)return r;if(r={},n.value=X24(e),t){r.callback=t,r.next=null;var i=function(){pe7(r);},s=function(){clearTimeout(r.next),r.next=setTimeout(i);};"undefined"!=typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s));}return r.patches=[],r.object=e,r.unobserve=function(){pe7(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback);}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s));},n.observers.set(t,new ce9(t,r)),r;},unobserve:function(e,t){t.unobserve();}});function me9(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;}function ve7(){if(de8)return fe8;de8=1;const e=Object.freeze({loose:!0}),t=Object.freeze({});return fe8=r=>r?"object"!=typeof r?e:r:t;}Object.assign({},ie10,Ee6,{JsonPatchError:J25,deepClone:X24,escapePathComponent:H23,unescapePathComponent:B24});var ge8,we7,Oe6,Ie7,Re6,$e4,Ae6,Ne7,Le6,Te6,ye7,be7,Se6,_e7,Pe6,xe7,De6,Ce7,Fe6,Me7,je5,Ge5,Ue6,ke6,Xe5,Ve4,He6,Be6,ze7,We4,Je5,Ye5={exports:{}};function qe5(){if(we7)return ge8;we7=1;const e=Number.MAX_SAFE_INTEGER||9007199254740991;return ge8={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};}function Qe5(){if(Ie7)return Oe6;Ie7=1;const e=M25.env&&M25.env.NODE_DEBUG&&/\bsemver\b/i.test(M25.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};return Oe6=e;}function Ke4(){return Re6||(Re6=1,function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:o}=qe5(),i=Qe5(),s=(t=e.exports={}).re=[],a=t.safeRe=[],c=t.src=[],p=t.safeSrc=[],l=t.t={};let u=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[h,n]],d=(e,t,r)=>{const n=(e=>{for(const[t,r]of f)e=e.split(`${t}*`).join(`${t}{0,${r}}`).split(`${t}+`).join(`${t}{1,${r}}`);return e;})(t),o=u++;i(e,o,t),l[e]=o,c[o]=t,p[o]=n,s[o]=new RegExp(t,r?"g":void 0),a[o]=new RegExp(n,r?"g":void 0);};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),d("MAINVERSION",`(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})\\.(${c[l.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})\\.(${c[l.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${c[l.NUMERICIDENTIFIER]}|${c[l.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${c[l.NUMERICIDENTIFIERLOOSE]}|${c[l.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${c[l.PRERELEASEIDENTIFIER]}(?:\\.${c[l.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${c[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[l.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${h}+`),d("BUILD",`(?:\\+(${c[l.BUILDIDENTIFIER]}(?:\\.${c[l.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${c[l.MAINVERSION]}${c[l.PRERELEASE]}?${c[l.BUILD]}?`),d("FULL",`^${c[l.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${c[l.MAINVERSIONLOOSE]}${c[l.PRERELEASELOOSE]}?${c[l.BUILD]}?`),d("LOOSE",`^${c[l.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${c[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${c[l.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:\\.(${c[l.XRANGEIDENTIFIER]})(?:${c[l.PRERELEASE]})?${c[l.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[l.XRANGEIDENTIFIERLOOSE]})(?:${c[l.PRERELEASELOOSE]})?${c[l.BUILD]}?)?)?`),d("XRANGE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${c[l.GTLT]}\\s*${c[l.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),d("COERCE",`${c[l.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",c[l.COERCEPLAIN]+`(?:${c[l.PRERELEASE]})?`+`(?:${c[l.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",c[l.COERCE],!0),d("COERCERTLFULL",c[l.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${c[l.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",d("TILDE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${c[l.LONETILDE]}${c[l.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${c[l.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",d("CARET",`^${c[l.LONECARET]}${c[l.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${c[l.LONECARET]}${c[l.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${c[l.GTLT]}\\s*(${c[l.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${c[l.GTLT]}\\s*(${c[l.LOOSEPLAIN]}|${c[l.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${c[l.XRANGEPLAIN]})\\s+-\\s+(${c[l.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${c[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[l.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$");}(Ye5,Ye5.exports)),Ye5.exports;}function Ze4(){if(Le6)return Ne7;Le6=1;const e=Qe5(),{MAX_LENGTH:t,MAX_SAFE_INTEGER:r}=qe5(),{safeRe:n,safeSrc:o,t:i}=Ke4(),s=ve7(),{compareIdentifiers:a}=function(){if(Ae6)return $e4;Ae6=1;const e=/^[0-9]+$/,t=(t,r)=>{const n=e.test(t),o=e.test(r);return n&&o&&(t=+t,r=+r),t===r?0:n&&!o?-1:o&&!n?1:t<r?-1:1;};return $e4={compareIdentifiers:t,rcompareIdentifiers:(e,r)=>t(r,e)};}();class c{constructor(o,a){if(a=s(a),o instanceof c){if(o.loose===!!a.loose&&o.includePrerelease===!!a.includePrerelease)return o;o=o.version;}else if("string"!=typeof o)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof o}".`);if(o.length>t)throw new TypeError(`version is longer than ${t} characters`);e("SemVer",o,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const p=o.trim().match(a.loose?n[i.LOOSE]:n[i.FULL]);if(!p)throw new TypeError(`Invalid Version: ${o}`);if(this.raw=o,this.major=+p[1],this.minor=+p[2],this.patch=+p[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");p[4]?this.prerelease=p[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t;}return e;}):this.prerelease=[],this.build=p[5]?p[5].split("."):[],this.format();}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version;}toString(){return this.version;}compare(t){if(e("SemVer.compare",this.version,this.options,t),!(t instanceof c)){if("string"==typeof t&&t===this.version)return 0;t=new c(t,this.options);}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t);}compareMain(e){return e instanceof c||(e=new c(e,this.options)),a(this.major,e.major)||a(this.minor,e.minor)||a(this.patch,e.patch);}comparePre(t){if(t instanceof c||(t=new c(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],o=t.prerelease[r];if(e("prerelease compare",r,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return a(n,o);}while(++r)}compareBuild(t){t instanceof c||(t=new c(t,this.options));let r=0;do{const n=this.build[r],o=t.build[r];if(e("build compare",r,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return a(n,o);}while(++r)}inc(e,t,r){if(e.startsWith("pre")){if(!t&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?o[i.PRERELEASELOOSE]:o[i.PRERELEASE]}$`),r=`-${t}`.match(e);if(!r||r[1]!==t)throw new Error(`invalid identifier: ${t}`);}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,r),this.inc("pre",t,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,r),this.inc("pre",t,r);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(r)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let n=this.prerelease.length;for(;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);if(-1===n){if(t===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e);}}if(t){let n=[t,e];!1===r&&(n=[t]),0===a(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=n):this.prerelease=n;}break;}default:throw new Error(`invalid increment argument: ${e}`);}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this;}}return Ne7=c;}function et11(){if(ye7)return Te6;ye7=1;const e=Ze4();return Te6=(t,r,n)=>new e(t,n).compare(new e(r,n));}function tt11(){if(Xe5)return ke6;Xe5=1;const e=function(){if(Se6)return be7;Se6=1;const e=et11();return be7=(t,r,n)=>0===e(t,r,n);}(),t=function(){if(Pe6)return _e7;Pe6=1;const e=et11();return _e7=(t,r,n)=>0!==e(t,r,n);}(),r=function(){if(De6)return xe7;De6=1;const e=et11();return xe7=(t,r,n)=>e(t,r,n)>0;}(),n=function(){if(Fe6)return Ce7;Fe6=1;const e=et11();return Ce7=(t,r,n)=>e(t,r,n)>=0;}(),o=function(){if(je5)return Me7;je5=1;const e=et11();return Me7=(t,r,n)=>e(t,r,n)<0;}(),i=function(){if(Ue6)return Ge5;Ue6=1;const e=et11();return Ge5=(t,r,n)=>e(t,r,n)<=0;}();return ke6=(s,a,c,p)=>{switch(a){case"===":return"object"==typeof s&&(s=s.version),"object"==typeof c&&(c=c.version),s===c;case"!==":return"object"==typeof s&&(s=s.version),"object"==typeof c&&(c=c.version),s!==c;case"":case"=":case"==":return e(s,c,p);case"!=":return t(s,c,p);case">":return r(s,c,p);case">=":return n(s,c,p);case"<":return o(s,c,p);case"<=":return i(s,c,p);default:throw new TypeError(`Invalid operator: ${a}`);}};}function rt12(){if(ze7)return Be6;ze7=1;const e=/\s+/g;class t{constructor(r,i){if(i=n(i),r instanceof t)return r.loose===!!i.loose&&r.includePrerelease===!!i.includePrerelease?r:new t(r.raw,i);if(r instanceof o)return this.raw=r.value,this.set=[[r]],this.formatted=void 0,this;if(this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease,this.raw=r.trim().replace(e," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!d(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1){for(const e of this.set)if(1===e.length&&E(e[0])){this.set=[e];break;}}}this.formatted=void 0;}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim();}}return this.formatted;}format(){return this.range;}toString(){return this.range;}parseRange(e){const t=((this.options.includePrerelease&&h)|(this.options.loose&&f))+":"+e,n=r.get(t);if(n)return n;const s=this.options.loose,E=s?a[c.HYPHENRANGELOOSE]:a[c.HYPHENRANGE];e=e.replace(E,T(this.options.includePrerelease)),i("hyphen replace",e),e=e.replace(a[c.COMPARATORTRIM],p),i("comparator trim",e),e=e.replace(a[c.TILDETRIM],l),i("tilde trim",e),e=e.replace(a[c.CARETTRIM],u),i("caret trim",e);let m=e.split(" ").map(e=>v(e,this.options)).join(" ").split(/\s+/).map(e=>L(e,this.options));s&&(m=m.filter(e=>(i("loose invalid filter",e,this.options),!!e.match(a[c.COMPARATORLOOSE])))),i("range list",m);const g=new Map,w=m.map(e=>new o(e,this.options));for(const e of w){if(d(e))return[e];g.set(e.value,e);}g.size>1&&g.has("")&&g.delete("");const O=[...g.values()];return r.set(t,O),O;}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(t=>m(t,r)&&e.set.some(e=>m(e,r)&&t.every(t=>e.every(e=>t.intersects(e,r)))));}test(e){if(!e)return!1;if("string"==typeof e)try{e=new s(e,this.options);}catch(e){return!1;}for(let t=0;t<this.set.length;t++)if(y(this.set[t],e,this.options))return!0;return!1;}}Be6=t;const r=new(he8?ue9:(he8=1,ue9=class{constructor(){this.max=1e3,this.map=new Map;}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t);}delete(e){return this.map.delete(e);}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e);}this.map.set(e,t);}return this;}})),n=ve7(),o=function(){if(He6)return Ve4;He6=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e;}constructor(n,o){if(o=r(o),n instanceof t){if(n.loose===!!o.loose)return n;n=n.value;}n=n.trim().split(/\s+/).join(" "),s("comparator",n,o),this.options=o,this.loose=!!o.loose,this.parse(n),this.semver===e?this.value="":this.value=this.operator+this.semver.version,s("comp",this);}parse(t){const r=this.options.loose?n[o.COMPARATORLOOSE]:n[o.COMPARATOR],i=t.match(r);if(!i)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==i[1]?i[1]:"","="===this.operator&&(this.operator=""),i[2]?this.semver=new a(i[2],this.options.loose):this.semver=e;}toString(){return this.value;}test(t){if(s("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new a(t,this.options);}catch(e){return!1;}return i(t,this.operator,this.semver,this.options);}intersects(e,n){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(e.value,n).test(this.value):""===e.operator?""===e.value||new c(this.value,n).test(e.semver):!((n=r(n)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!n.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(i(this.semver,"<",e.semver,n)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(i(this.semver,">",e.semver,n)&&this.operator.startsWith("<")&&e.operator.startsWith(">")));}}Ve4=t;const r=ve7(),{safeRe:n,t:o}=Ke4(),i=tt11(),s=Qe5(),a=Ze4(),c=rt12();return Ve4;}(),i=Qe5(),s=Ze4(),{safeRe:a,t:c,comparatorTrimReplace:p,tildeTrimReplace:l,caretTrimReplace:u}=Ke4(),{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:f}=qe5(),d=e=>"<0.0.0-0"===e.value,E=e=>""===e.value,m=(e,t)=>{let r=!0;const n=e.slice();let o=n.pop();for(;r&&n.length;)r=n.every(e=>o.intersects(e,t)),o=n.pop();return r;},v=(e,t)=>(i("comp",e,t),e=I(e,t),i("caret",e),e=w(e,t),i("tildes",e),e=$(e,t),i("xrange",e),e=N(e,t),i("stars",e),e),g=e=>!e||"x"===e.toLowerCase()||"*"===e,w=(e,t)=>e.trim().split(/\s+/).map(e=>O(e,t)).join(" "),O=(e,t)=>{const r=t.loose?a[c.TILDELOOSE]:a[c.TILDE];return e.replace(r,(t,r,n,o,s)=>{let a;return i("tilde",e,t,r,n,o,s),g(r)?a="":g(n)?a=`>=${r}.0.0 <${+r+1}.0.0-0`:g(o)?a=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:s?(i("replaceTilde pr",s),a=`>=${r}.${n}.${o}-${s} <${r}.${+n+1}.0-0`):a=`>=${r}.${n}.${o} <${r}.${+n+1}.0-0`,i("tilde return",a),a;});},I=(e,t)=>e.trim().split(/\s+/).map(e=>R(e,t)).join(" "),R=(e,t)=>{i("caret",e,t);const r=t.loose?a[c.CARETLOOSE]:a[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,o,s,a)=>{let c;return i("caret",e,t,r,o,s,a),g(r)?c="":g(o)?c=`>=${r}.0.0${n} <${+r+1}.0.0-0`:g(s)?c="0"===r?`>=${r}.${o}.0${n} <${r}.${+o+1}.0-0`:`>=${r}.${o}.0${n} <${+r+1}.0.0-0`:a?(i("replaceCaret pr",a),c="0"===r?"0"===o?`>=${r}.${o}.${s}-${a} <${r}.${o}.${+s+1}-0`:`>=${r}.${o}.${s}-${a} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${s}-${a} <${+r+1}.0.0-0`):(i("no pr"),c="0"===r?"0"===o?`>=${r}.${o}.${s}${n} <${r}.${o}.${+s+1}-0`:`>=${r}.${o}.${s}${n} <${r}.${+o+1}.0-0`:`>=${r}.${o}.${s} <${+r+1}.0.0-0`),i("caret return",c),c;});},$=(e,t)=>(i("replaceXRanges",e,t),e.split(/\s+/).map(e=>A(e,t)).join(" ")),A=(e,t)=>{e=e.trim();const r=t.loose?a[c.XRANGELOOSE]:a[c.XRANGE];return e.replace(r,(r,n,o,s,a,c)=>{i("xRange",e,r,n,o,s,a,c);const p=g(o),l=p||g(s),u=l||g(a),h=u;return"="===n&&h&&(n=""),c=t.includePrerelease?"-0":"",p?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&h?(l&&(s=0),a=0,">"===n?(n=">=",l?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):"<="===n&&(n="<",l?o=+o+1:s=+s+1),"<"===n&&(c="-0"),r=`${n+o}.${s}.${a}${c}`):l?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:u&&(r=`>=${o}.${s}.0${c} <${o}.${+s+1}.0-0`),i("xRange return",r),r;});},N=(e,t)=>(i("replaceStars",e,t),e.trim().replace(a[c.STAR],"")),L=(e,t)=>(i("replaceGTE0",e,t),e.trim().replace(a[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,r,n,o,i,s,a,c,p,l,u,h)=>`${r=g(n)?"":g(o)?`>=${n}.0.0${e?"-0":""}`:g(i)?`>=${n}.${o}.0${e?"-0":""}`:s?`>=${r}`:`>=${r}${e?"-0":""}`} ${c=g(p)?"":g(l)?`<${+p+1}.0.0-0`:g(u)?`<${p}.${+l+1}.0-0`:h?`<=${p}.${l}.${u}-${h}`:e?`<${p}.${l}.${+u+1}-0`:`<=${c}`}`.trim(),y=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(i(e[r].semver),e[r].semver!==o.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0;}return!1;}return!0;};return Be6;}var nt12=function(){if(Je5)return We4;Je5=1;const e=rt12();return We4=(t,r,n)=>{try{r=new e(r,n);}catch(e){return!1;}return r.test(t);},We4;}(),ot10=me9(nt12);var it11='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n';function st10(e,...t){for(const r of t)at12(e,r);return e;}function at12(e,t){for(const r of Object.keys(t))x(e,r,t[r],!0);}let lt11=mod13;const ut10="undefined"!=typeof window?window:void 0;void 0===lt11&&ut10?.vl?.compile&&(lt11=ut10.vl);const ht10={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},ft9={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},dt9={vega:"Vega","vega-lite":"Vega-Lite"},Et8={vega:mod12.version,"vega-lite":lt11?lt11.version:"not available"},mt9={vega:e=>e,"vega-lite":(e,t)=>lt11.compile(e,{config:t}).spec},vt8='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',gt10="chart-wrapper";function wt9(e,t,r,n){const o=`<html><head>${t}</head><body><pre><code class="json">`,i=`</code></pre>${r}</body></html>`,s=window.open("");s.document.write(o+e+i),s.document.title=`${dt9[n]} JSON Source`;}function Ot7(e,t){if(e.$schema){const r=e18(e.$schema);t&&t!==r.library&&console.warn(`The given visualization spec is written in ${dt9[r.library]}, but mode argument sets ${dt9[t]??t}.`);const n=r.library;return ot10(Et8[n],`^${r.version.slice(1)}`)||console.warn(`The input spec uses ${dt9[n]} ${r.version}, but the current version of ${dt9[n]} is v${Et8[n]}.`),n;}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t??"vega";}function It7(e){return!(!e||!("load"in e));}function Rt8(e){return It7(e)?e:mod12.loader(e);}async function $t6(t1,s,c={}){let h,f;Mn(s)?(f=Rt8(c.loader),h=JSON.parse(await f.load(s))):h=s;const d=function(e){const t=e.usermeta?.embedOptions??{};return Mn(t.defaultStyle)&&(t.defaultStyle=!1),t;}(h),E1=d.loader;f&&!E1||(f=Rt8(c.loader??E1));const m=await At6(d,f),v=await At6(c,f),g={...st10(v,m),config:k(v.config??{},m.config??{})};return await async function(t1,r,s={},c){const h=s.theme?k(mod14[s.theme],s.config??{}):s.config,f=gn(s.actions)?s.actions:st10({},ht10,s.actions??{}),d={...ft9,...s.i18n},E1=s.renderer??"svg",m=s.logLevel??mod12.Warn,v=s.downloadFileName??"visualization",g="string"==typeof t1?document.querySelector(t1):t1;if(!g)throw new Error(`${t1} does not exist`);if(!1!==s.defaultStyle){const e="vega-embed-style",{root:t,rootContainer:r}=function(e){const t=e.getRootNode?e.getRootNode():document;return t instanceof ShadowRoot?{root:t,rootContainer:t}:{root:document,rootContainer:document.head??document.body};}(g);if(!t.getElementById(e)){const t=document.createElement("style");t.id=e,t.innerHTML=void 0===s.defaultStyle||!0===s.defaultStyle?it11.toString():s.defaultStyle,r.appendChild(t);}}const w=Ot7(r,s.mode);let O=mt9[w](r,h);if("vega-lite"===w&&O.$schema){const e=e18(O.$schema);ot10(Et8.vega,`^${e.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${e.version}, but current version is v${Et8.vega}.`);}g.classList.add("vega-embed"),f&&g.classList.add("has-actions");g.innerHTML="";let I=g;if(f){const e=document.createElement("div");e.classList.add(gt10),g.appendChild(e),I=e;}const R=s.patch;R&&(O=R instanceof Function?R(O):te9(O,R,!0,!1).newDocument);s.formatLocale&&mod12.formatLocale(s.formatLocale);s.timeFormatLocale&&mod12.timeFormatLocale(s.timeFormatLocale);if(s.expressionFunctions)for(const e in s.expressionFunctions){const t=s.expressionFunctions[e];"fn"in t?mod12.expressionFunction(e,t.fn,t.visitor):t instanceof Function&&mod12.expressionFunction(e,t);}const{ast:$}=s,A=mod12.parse(O,"vega-lite"===w?{}:h,{ast:$}),N=new(s.viewClass||mod12.View)(A,{loader:c,logLevel:m,renderer:E1,...$?{expr:mod12.expressionInterpreter??s.expr??h27}:{}});if(N.addSignalListener("autosize",(e,t)=>{const{type:r}=t;"fit-x"==r?(I.classList.add("fit-x"),I.classList.remove("fit-y")):"fit-y"==r?(I.classList.remove("fit-x"),I.classList.add("fit-y")):"fit"==r?I.classList.add("fit-x","fit-y"):I.classList.remove("fit-x","fit-y");}),!1!==s.tooltip){const{loader:e,tooltip:t}=s,r=e&&!It7(e)?e?.baseURL:void 0,n="function"==typeof t?t:new b23({baseURL:r,...!0===t?{}:t}).call;N.tooltip(n);}let L,{hover:T}=s;void 0===T&&(T="vega"===w);if(T){const{hoverSet:e,updateSet:t}="boolean"==typeof T?{}:T;N.hover(e,t);}s&&(null!=s.width&&N.width(s.width),null!=s.height&&N.height(s.height),null!=s.padding&&N.padding(s.padding));if(await N.initialize(I,s.bind).runAsync(),!1!==f){let t1=g;if(!1!==s.defaultStyle||s.forceActionsMenu){const e=document.createElement("details");e.title=d.CLICK_TO_VIEW_ACTIONS,g.append(e),t1=e;const r=document.createElement("summary");r.innerHTML=vt8,e.append(r),L=t=>{e.contains(t.target)||e.removeAttribute("open");},document.addEventListener("click",L);}const n=document.createElement("div");if(t1.append(n),n.classList.add("vega-actions"),!0===f||!1!==f.export){for(const e of["svg","png"])if(!0===f||!0===f.export||f.export[e]){const t=d[`${e.toUpperCase()}_ACTION`],r=document.createElement("a"),o=E(s.scaleFactor)?s.scaleFactor[e]:s.scaleFactor;r.text=t,r.href="#",r.target="_blank",r.download=`${v}.${e}`,r.addEventListener("mousedown",async function(t){t.preventDefault();const r=await N.toImageURL(e,o);this.href=r;}),n.append(r);}}if(!0===f||!1!==f.source){const t1=document.createElement("a");t1.text=d.SOURCE_ACTION,t1.href="#",t1.addEventListener("click",function(t1){wt9(t(r),s.sourceHeader??"",s.sourceFooter??"",w),t1.preventDefault();}),n.append(t1);}if("vega-lite"===w&&(!0===f||!1!==f.compiled)){const t1=document.createElement("a");t1.text=d.COMPILED_ACTION,t1.href="#",t1.addEventListener("click",function(t1){wt9(t(O),s.sourceHeader??"",s.sourceFooter??"","vega"),t1.preventDefault();}),n.append(t1);}if(!0===f||!1!==f.editor){const t1=s.editorUrl??"https://vega.github.io/editor/",o=document.createElement("a");o.text=d.EDITOR_ACTION,o.href="#",o.addEventListener("click",function(n){!function(e,t,r){const n=e.open(t),{origin:o}=new URL(t);let i=40;e.addEventListener("message",function t(r){r.source===n&&(i=0,e.removeEventListener("message",t,!1));},!1),setTimeout(function e(){i<=0||(n.postMessage(r,o),setTimeout(e,250),i-=1);},250);}(window,t1,{config:h,mode:R?"vega":w,renderer:E1,spec:t(R?O:r)}),n.preventDefault();}),n.append(o);}}function y(){L&&document.removeEventListener("click",L),N.finalize();}return{view:N,spec:r,vgSpec:O,finalize:y,embedOptions:s};}(t1,h,g,f);}async function At6(e,t){const n=Mn(e.config)?JSON.parse(await t.load(e.config)):e.config??{},o=Mn(e.patch)?JSON.parse(await t.load(e.patch)):e.patch;return{...e,...o?{patch:o}:{},...n?{config:n}:{}};}window.vegaEmbed=$t6;window.vega=__default;window.vegaLite=__default1;
  </script>
</head>
<body>
<div class="vega-visualization" id="vis"></div>
<script type="text/javascript">
  const spec = {"config": {"view": {"continuousWidth": 300, "continuousHeight": 300}}, "data": {"name": "data-58580f079e78d2ecf11da8f9bbaf431e"}, "mark": {"type": "bar"}, "encoding": {"color": {"field": "generation", "legend": {"orient": "left"}, "scale": {"domain": [1, 3.5, 7], "range": ["lightgreen", "orange", "purple"]}, "title": null, "type": "quantitative"}, "tooltip": [{"field": "type1", "type": "nominal"}, {"field": "count", "type": "quantitative"}], "x": {"field": "count", "title": "Anzahl", "type": "quantitative"}, "y": {"field": "type1", "sort": "-x", "title": "Pokemontyp", "type": "nominal"}}, "height": 350, "title": {"text": "Pokemon nach Typ und Generation", "anchor": "start", "offset": 20, "orient": "top", "subtitle": "Inklusive Subtitel"}, "width": 600, "$schema": "https://vega.github.io/schema/vega-lite/v5.20.1.json", "datasets": {"data-58580f079e78d2ecf11da8f9bbaf431e": [{"generation": 1, "type1": "water", "count": 28}, {"generation": 1, "type1": "normal", "count": 22}, {"generation": 1, "type1": "poison", "count": 14}, {"generation": 1, "type1": "bug", "count": 12}, {"generation": 1, "type1": "grass", "count": 12}, {"generation": 1, "type1": "fire", "count": 12}, {"generation": 1, "type1": "electric", "count": 9}, {"generation": 1, "type1": "rock", "count": 9}, {"generation": 1, "type1": "psychic", "count": 8}, {"generation": 1, "type1": "ground", "count": 8}, {"generation": 1, "type1": "fighting", "count": 7}, {"generation": 1, "type1": "ghost", "count": 3}, {"generation": 1, "type1": "dragon", "count": 3}, {"generation": 1, "type1": "ice", "count": 2}, {"generation": 1, "type1": "fairy", "count": 2}, {"generation": 2, "type1": "water", "count": 18}, {"generation": 2, "type1": "normal", "count": 15}, {"generation": 2, "type1": "bug", "count": 10}, {"generation": 2, "type1": "grass", "count": 9}, {"generation": 2, "type1": "fire", "count": 8}, {"generation": 2, "type1": "psychic", "count": 7}, {"generation": 2, "type1": "electric", "count": 6}, {"generation": 2, "type1": "dark", "count": 5}, {"generation": 2, "type1": "fairy", "count": 5}, {"generation": 2, "type1": "ice", "count": 4}, {"generation": 2, "type1": "rock", "count": 4}, {"generation": 2, "type1": "ground", "count": 3}, {"generation": 2, "type1": "steel", "count": 2}, {"generation": 2, "type1": "fighting", "count": 2}, {"generation": 2, "type1": "ghost", "count": 1}, {"generation": 2, "type1": "poison", "count": 1}, {"generation": 3, "type1": "water", "count": 24}, {"generation": 3, "type1": "normal", "count": 18}, {"generation": 3, "type1": "grass", "count": 12}, {"generation": 3, "type1": "bug", "count": 12}, {"generation": 3, "type1": "steel", "count": 9}, {"generation": 3, "type1": "rock", "count": 8}, {"generation": 3, "type1": "psychic", "count": 8}, {"generation": 3, "type1": "dragon", "count": 7}, {"generation": 3, "type1": "ground", "count": 6}, {"generation": 3, "type1": "ice", "count": 6}, {"generation": 3, "type1": "fire", "count": 6}, {"generation": 3, "type1": "fighting", "count": 4}, {"generation": 3, "type1": "dark", "count": 4}, {"generation": 3, "type1": "ghost", "count": 4}, {"generation": 3, "type1": "electric", "count": 4}, {"generation": 3, "type1": "poison", "count": 3}, {"generation": 4, "type1": "normal", "count": 17}, {"generation": 4, "type1": "grass", "count": 13}, {"generation": 4, "type1": "water", "count": 13}, {"generation": 4, "type1": "bug", "count": 8}, {"generation": 4, "type1": "psychic", "count": 7}, {"generation": 4, "type1": "electric", "count": 7}, {"generation": 4, "type1": "rock", "count": 6}, {"generation": 4, "type1": "poison", "count": 6}, {"generation": 4, "type1": "ghost", "count": 6}, {"generation": 4, "type1": "fire", "count": 5}, {"generation": 4, "type1": "ground", "count": 4}, {"generation": 4, "type1": "ice", "count": 3}, {"generation": 4, "type1": "steel", "count": 3}, {"generation": 4, "type1": "dark", "count": 3}, {"generation": 4, "type1": "dragon", "count": 3}, {"generation": 4, "type1": "fighting", "count": 2}, {"generation": 4, "type1": "fairy", "count": 1}, {"generation": 5, "type1": "bug", "count": 18}, {"generation": 5, "type1": "normal", "count": 17}, {"generation": 5, "type1": "water", "count": 17}, {"generation": 5, "type1": "grass", "count": 15}, {"generation": 5, "type1": "psychic", "count": 14}, {"generation": 5, "type1": "dark", "count": 13}, {"generation": 5, "type1": "ground", "count": 9}, {"generation": 5, "type1": "fire", "count": 8}, {"generation": 5, "type1": "electric", "count": 7}, {"generation": 5, "type1": "dragon", "count": 7}, {"generation": 5, "type1": "fighting", "count": 7}, {"generation": 5, "type1": "rock", "count": 6}, {"generation": 5, "type1": "ice", "count": 6}, {"generation": 5, "type1": "ghost", "count": 5}, {"generation": 5, "type1": "steel", "count": 4}, {"generation": 5, "type1": "poison", "count": 2}, {"generation": 5, "type1": "flying", "count": 1}, {"generation": 6, "type1": "fairy", "count": 9}, {"generation": 6, "type1": "fire", "count": 8}, {"generation": 6, "type1": "rock", "count": 8}, {"generation": 6, "type1": "water", "count": 5}, {"generation": 6, "type1": "grass", "count": 5}, {"generation": 6, "type1": "normal", "count": 4}, {"generation": 6, "type1": "steel", "count": 4}, {"generation": 6, "type1": "dragon", "count": 4}, {"generation": 6, "type1": "ghost", "count": 4}, {"generation": 6, "type1": "fighting", "count": 3}, {"generation": 6, "type1": "psychic", "count": 3}, {"generation": 6, "type1": "electric", "count": 3}, {"generation": 6, "type1": "dark", "count": 3}, {"generation": 6, "type1": "bug", "count": 3}, {"generation": 6, "type1": "ice", "count": 2}, {"generation": 6, "type1": "flying", "count": 2}, {"generation": 6, "type1": "poison", "count": 2}, {"generation": 7, "type1": "grass", "count": 12}, {"generation": 7, "type1": "normal", "count": 12}, {"generation": 7, "type1": "bug", "count": 9}, {"generation": 7, "type1": "water", "count": 9}, {"generation": 7, "type1": "psychic", "count": 6}, {"generation": 7, "type1": "fire", "count": 5}, {"generation": 7, "type1": "rock", "count": 4}, {"generation": 7, "type1": "ghost", "count": 4}, {"generation": 7, "type1": "poison", "count": 4}, {"generation": 7, "type1": "fighting", "count": 3}, {"generation": 7, "type1": "electric", "count": 3}, {"generation": 7, "type1": "dragon", "count": 3}, {"generation": 7, "type1": "steel", "count": 2}, {"generation": 7, "type1": "ground", "count": 2}, {"generation": 7, "type1": "fairy", "count": 1}, {"generation": 7, "type1": "dark", "count": 1}]}};
  const embedOpt = {"mode": "vega-lite"};
  vegaEmbed('#vis', spec, embedOpt).catch(console.error);
</script>
</body>
</html>